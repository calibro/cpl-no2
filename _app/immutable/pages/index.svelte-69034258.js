import{Q as xx,R as bx,S as $a,i as tl,s as el,l as ae,a as rn,m as le,n as he,h as vt,c as on,p as Dt,q as br,b as de,G as Xt,E as Gr,O as Ms,o as F2,T as md,C as Z0,U as B2,V as U2,r as Ge,u as qe,W as by,X as V2,v as To,H as Vc,Y as Ki,J as Gd,Z as Y0,L as qd,M as Xd,N as Zd,f as Ye,t as en,e as ri,w as qr,x as Xr,y as Zr,_ as So,g as hu,d as fu,B as Yr,$ as Im,K as wx,a0 as W0,a1 as G2,a2 as j0,a3 as q2,a4 as X2,a5 as s0,a6 as a0,a7 as Ix,a8 as Ex,a9 as Z2,aa as _d}from"../chunks/index-5737bde0.js";import{r as Y2,w as Yd,b as Sx}from"../chunks/paths-f57497ee.js";import{p as W2}from"../chunks/stores-b6a52815.js";function yd(n,{delay:t=0,duration:e=400,easing:r=xx}={}){const s=+getComputedStyle(n).opacity;return{delay:t,duration:e,easing:r,css:c=>`opacity: ${c*s}`}}function ny(n,t){return n==null||t==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function j2(n,t){return n==null||t==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Cx(n){let t,e,r;n.length!==2?(t=ny,e=(l,x)=>ny(n(l),x),r=(l,x)=>n(l)-x):(t=n===ny||n===j2?n:H2,e=n,r=n);function s(l,x,I=0,T=l.length){if(I<T){if(t(x,x)!==0)return T;do{const P=I+T>>>1;e(l[P],x)<0?I=P+1:T=P}while(I<T)}return I}function c(l,x,I=0,T=l.length){if(I<T){if(t(x,x)!==0)return T;do{const P=I+T>>>1;e(l[P],x)<=0?I=P+1:T=P}while(I<T)}return I}function p(l,x,I=0,T=l.length){const P=s(l,x,I,T-1);return P>I&&r(l[P-1],x)>-r(l[P],x)?P-1:P}return{left:s,center:p,right:c}}function H2(){return 0}function K2(n){return n===null?NaN:+n}const J2=Cx(ny),Q2=J2.right;Cx(K2).center;const $2=Q2;var Gv=Math.sqrt(50),qv=Math.sqrt(10),Xv=Math.sqrt(2);function tI(n,t,e){var r,s=-1,c,p,l;if(t=+t,n=+n,e=+e,n===t&&e>0)return[n];if((r=t<n)&&(c=n,n=t,t=c),(l=Tx(n,t,e))===0||!isFinite(l))return[];if(l>0){let x=Math.round(n/l),I=Math.round(t/l);for(x*l<n&&++x,I*l>t&&--I,p=new Array(c=I-x+1);++s<c;)p[s]=(x+s)*l}else{l=-l;let x=Math.round(n*l),I=Math.round(t*l);for(x/l<n&&++x,I/l>t&&--I,p=new Array(c=I-x+1);++s<c;)p[s]=(x+s)/l}return r&&p.reverse(),p}function Tx(n,t,e){var r=(t-n)/Math.max(0,e),s=Math.floor(Math.log(r)/Math.LN10),c=r/Math.pow(10,s);return s>=0?(c>=Gv?10:c>=qv?5:c>=Xv?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(c>=Gv?10:c>=qv?5:c>=Xv?2:1)}function eI(n,t,e){var r=Math.abs(t-n)/Math.max(0,e),s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),c=r/s;return c>=Gv?s*=10:c>=qv?s*=5:c>=Xv&&(s*=2),t<n?-s:s}function nI(n,t,e){n=+n,t=+t,e=(s=arguments.length)<2?(t=n,n=0,1):s<3?1:+e;for(var r=-1,s=Math.max(0,Math.ceil((t-n)/e))|0,c=new Array(s);++r<s;)c[r]=n+r*e;return c}function rI(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n);break}return this}function iI(n,t){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}function wy(n,t,e){n.prototype=t.prototype=e,e.constructor=n}function l0(n,t){var e=Object.create(n.prototype);for(var r in t)e[r]=t[r];return e}function Wd(){}var Xf=.7,vd=1/Xf,dd="\\s*([+-]?\\d+)\\s*",im="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oI=/^#([0-9a-f]{3,8})$/,sI=new RegExp(`^rgb\\(${dd},${dd},${dd}\\)$`),aI=new RegExp(`^rgb\\(${$u},${$u},${$u}\\)$`),lI=new RegExp(`^rgba\\(${dd},${dd},${dd},${im}\\)$`),uI=new RegExp(`^rgba\\(${$u},${$u},${$u},${im}\\)$`),cI=new RegExp(`^hsl\\(${im},${$u},${$u}\\)$`),hI=new RegExp(`^hsla\\(${im},${$u},${$u},${im}\\)$`),H0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wy(Wd,om,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:K0,formatHex:K0,formatHex8:fI,formatHsl:pI,formatRgb:J0,toString:J0});function K0(){return this.rgb().formatHex()}function fI(){return this.rgb().formatHex8()}function pI(){return Px(this).formatHsl()}function J0(){return this.rgb().formatRgb()}function om(n){var t,e;return n=(n+"").trim().toLowerCase(),(t=oI.exec(n))?(e=t[1].length,t=parseInt(t[1],16),e===6?Q0(t):e===3?new Ds(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?V_(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?V_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sI.exec(n))?new Ds(t[1],t[2],t[3],1):(t=aI.exec(n))?new Ds(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=lI.exec(n))?V_(t[1],t[2],t[3],t[4]):(t=uI.exec(n))?V_(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=cI.exec(n))?e1(t[1],t[2]/100,t[3]/100,1):(t=hI.exec(n))?e1(t[1],t[2]/100,t[3]/100,t[4]):H0.hasOwnProperty(n)?Q0(H0[n]):n==="transparent"?new Ds(NaN,NaN,NaN,0):null}function Q0(n){return new Ds(n>>16&255,n>>8&255,n&255,1)}function V_(n,t,e,r){return r<=0&&(n=t=e=NaN),new Ds(n,t,e,r)}function Ax(n){return n instanceof Wd||(n=om(n)),n?(n=n.rgb(),new Ds(n.r,n.g,n.b,n.opacity)):new Ds}function Zv(n,t,e,r){return arguments.length===1?Ax(n):new Ds(n,t,e,r==null?1:r)}function Ds(n,t,e,r){this.r=+n,this.g=+t,this.b=+e,this.opacity=+r}wy(Ds,Zv,l0(Wd,{brighter(n){return n=n==null?vd:Math.pow(vd,n),new Ds(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Xf:Math.pow(Xf,n),new Ds(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Ds(Gf(this.r),Gf(this.g),Gf(this.b),sy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$0,formatHex:$0,formatHex8:dI,formatRgb:t1,toString:t1}));function $0(){return`#${Vf(this.r)}${Vf(this.g)}${Vf(this.b)}`}function dI(){return`#${Vf(this.r)}${Vf(this.g)}${Vf(this.b)}${Vf((isNaN(this.opacity)?1:this.opacity)*255)}`}function t1(){const n=sy(this.opacity);return`${n===1?"rgb(":"rgba("}${Gf(this.r)}, ${Gf(this.g)}, ${Gf(this.b)}${n===1?")":`, ${n})`}`}function sy(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Gf(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Vf(n){return n=Gf(n),(n<16?"0":"")+n.toString(16)}function e1(n,t,e,r){return r<=0?n=t=e=NaN:e<=0||e>=1?n=t=NaN:t<=0&&(n=NaN),new cu(n,t,e,r)}function Px(n){if(n instanceof cu)return new cu(n.h,n.s,n.l,n.opacity);if(n instanceof Wd||(n=om(n)),!n)return new cu;if(n instanceof cu)return n;n=n.rgb();var t=n.r/255,e=n.g/255,r=n.b/255,s=Math.min(t,e,r),c=Math.max(t,e,r),p=NaN,l=c-s,x=(c+s)/2;return l?(t===c?p=(e-r)/l+(e<r)*6:e===c?p=(r-t)/l+2:p=(t-e)/l+4,l/=x<.5?c+s:2-c-s,p*=60):l=x>0&&x<1?0:p,new cu(p,l,x,n.opacity)}function gI(n,t,e,r){return arguments.length===1?Px(n):new cu(n,t,e,r==null?1:r)}function cu(n,t,e,r){this.h=+n,this.s=+t,this.l=+e,this.opacity=+r}wy(cu,gI,l0(Wd,{brighter(n){return n=n==null?vd:Math.pow(vd,n),new cu(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Xf:Math.pow(Xf,n),new cu(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*t,s=2*e-r;return new Ds(zv(n>=240?n-240:n+120,s,r),zv(n,s,r),zv(n<120?n+240:n-120,s,r),this.opacity)},clamp(){return new cu(n1(this.h),G_(this.s),G_(this.l),sy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=sy(this.opacity);return`${n===1?"hsl(":"hsla("}${n1(this.h)}, ${G_(this.s)*100}%, ${G_(this.l)*100}%${n===1?")":`, ${n})`}`}}));function n1(n){return n=(n||0)%360,n<0?n+360:n}function G_(n){return Math.max(0,Math.min(1,n||0))}function zv(n,t,e){return(n<60?t+(e-t)*n/60:n<180?e:n<240?t+(e-t)*(240-n)/60:t)*255}const mI=Math.PI/180,_I=180/Math.PI;var Lx=-.14861,u0=1.78277,c0=-.29227,Iy=-.90649,sm=1.97294,r1=sm*Iy,i1=sm*u0,o1=u0*c0-Iy*Lx;function yI(n){if(n instanceof qf)return new qf(n.h,n.s,n.l,n.opacity);n instanceof Ds||(n=Ax(n));var t=n.r/255,e=n.g/255,r=n.b/255,s=(o1*r+r1*t-i1*e)/(o1+r1-i1),c=r-s,p=(sm*(e-s)-c0*c)/Iy,l=Math.sqrt(p*p+c*c)/(sm*s*(1-s)),x=l?Math.atan2(p,c)*_I-120:NaN;return new qf(x<0?x+360:x,l,s,n.opacity)}function qh(n,t,e,r){return arguments.length===1?yI(n):new qf(n,t,e,r==null?1:r)}function qf(n,t,e,r){this.h=+n,this.s=+t,this.l=+e,this.opacity=+r}wy(qf,qh,l0(Wd,{brighter(n){return n=n==null?vd:Math.pow(vd,n),new qf(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Xf:Math.pow(Xf,n),new qf(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=isNaN(this.h)?0:(this.h+120)*mI,t=+this.l,e=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(n),s=Math.sin(n);return new Ds(255*(t+e*(Lx*r+u0*s)),255*(t+e*(c0*r+Iy*s)),255*(t+e*(sm*r)),this.opacity)}}));const Ey=n=>()=>n;function Mx(n,t){return function(e){return n+e*t}}function vI(n,t,e){return n=Math.pow(n,e),t=Math.pow(t,e)-n,e=1/e,function(r){return Math.pow(n+r*t,e)}}function xI(n,t){var e=t-n;return e?Mx(n,e>180||e<-180?e-360*Math.round(e/360):e):Ey(isNaN(n)?t:n)}function bI(n){return(n=+n)==1?gd:function(t,e){return e-t?vI(t,e,n):Ey(isNaN(t)?e:t)}}function gd(n,t){var e=t-n;return e?Mx(n,e):Ey(isNaN(n)?t:n)}const Yv=function n(t){var e=bI(t);function r(s,c){var p=e((s=Zv(s)).r,(c=Zv(c)).r),l=e(s.g,c.g),x=e(s.b,c.b),I=gd(s.opacity,c.opacity);return function(T){return s.r=p(T),s.g=l(T),s.b=x(T),s.opacity=I(T),s+""}}return r.gamma=n,r}(1);function wI(n,t){t||(t=[]);var e=n?Math.min(t.length,n.length):0,r=t.slice(),s;return function(c){for(s=0;s<e;++s)r[s]=n[s]*(1-c)+t[s]*c;return r}}function II(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function EI(n,t){var e=t?t.length:0,r=n?Math.min(e,n.length):0,s=new Array(r),c=new Array(e),p;for(p=0;p<r;++p)s[p]=Sy(n[p],t[p]);for(;p<e;++p)c[p]=t[p];return function(l){for(p=0;p<r;++p)c[p]=s[p](l);return c}}function SI(n,t){var e=new Date;return n=+n,t=+t,function(r){return e.setTime(n*(1-r)+t*r),e}}function ay(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function CI(n,t){var e={},r={},s;(n===null||typeof n!="object")&&(n={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in n?e[s]=Sy(n[s],t[s]):r[s]=t[s];return function(c){for(s in e)r[s]=e[s](c);return r}}var Wv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ov=new RegExp(Wv.source,"g");function TI(n){return function(){return n}}function AI(n){return function(t){return n(t)+""}}function PI(n,t){var e=Wv.lastIndex=Ov.lastIndex=0,r,s,c,p=-1,l=[],x=[];for(n=n+"",t=t+"";(r=Wv.exec(n))&&(s=Ov.exec(t));)(c=s.index)>e&&(c=t.slice(e,c),l[p]?l[p]+=c:l[++p]=c),(r=r[0])===(s=s[0])?l[p]?l[p]+=s:l[++p]=s:(l[++p]=null,x.push({i:p,x:ay(r,s)})),e=Ov.lastIndex;return e<t.length&&(c=t.slice(e),l[p]?l[p]+=c:l[++p]=c),l.length<2?x[0]?AI(x[0].x):TI(t):(t=x.length,function(I){for(var T=0,P;T<t;++T)l[(P=x[T]).i]=P.x(I);return l.join("")})}function Sy(n,t){var e=typeof t,r;return t==null||e==="boolean"?Ey(t):(e==="number"?ay:e==="string"?(r=om(t))?(t=r,Yv):PI:t instanceof om?Yv:t instanceof Date?SI:II(t)?wI:Array.isArray(t)?EI:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?CI:ay)(n,t)}function Dx(n,t){return n=+n,t=+t,function(e){return Math.round(n*(1-e)+t*e)}}function Nx(n){return function t(e){e=+e;function r(s,c){var p=n((s=qh(s)).h,(c=qh(c)).h),l=gd(s.s,c.s),x=gd(s.l,c.l),I=gd(s.opacity,c.opacity);return function(T){return s.h=p(T),s.s=l(T),s.l=x(Math.pow(T,e)),s.opacity=I(T),s+""}}return r.gamma=t,r}(1)}Nx(xI);var Rx=Nx(gd);function LI(n){return function(){return n}}function MI(n){return+n}var s1=[0,1];function Uh(n){return n}function jv(n,t){return(t-=n=+n)?function(e){return(e-n)/t}:LI(isNaN(t)?NaN:.5)}function DI(n,t){var e;return n>t&&(e=n,n=t,t=e),function(r){return Math.max(n,Math.min(t,r))}}function NI(n,t,e){var r=n[0],s=n[1],c=t[0],p=t[1];return s<r?(r=jv(s,r),c=e(p,c)):(r=jv(r,s),c=e(c,p)),function(l){return c(r(l))}}function RI(n,t,e){var r=Math.min(n.length,t.length)-1,s=new Array(r),c=new Array(r),p=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++p<r;)s[p]=jv(n[p],n[p+1]),c[p]=e(t[p],t[p+1]);return function(l){var x=$2(n,l,1,r)-1;return c[x](s[x](l))}}function zI(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function OI(){var n=s1,t=s1,e=Sy,r,s,c,p=Uh,l,x,I;function T(){var D=Math.min(n.length,t.length);return p!==Uh&&(p=DI(n[0],n[D-1])),l=D>2?RI:NI,x=I=null,P}function P(D){return D==null||isNaN(D=+D)?c:(x||(x=l(n.map(r),t,e)))(r(p(D)))}return P.invert=function(D){return p(s((I||(I=l(t,n.map(r),ay)))(D)))},P.domain=function(D){return arguments.length?(n=Array.from(D,MI),T()):n.slice()},P.range=function(D){return arguments.length?(t=Array.from(D),T()):t.slice()},P.rangeRound=function(D){return t=Array.from(D),e=Dx,T()},P.clamp=function(D){return arguments.length?(p=D?!0:Uh,T()):p!==Uh},P.interpolate=function(D){return arguments.length?(e=D,T()):e},P.unknown=function(D){return arguments.length?(c=D,P):c},function(D,G){return r=D,s=G,T()}}function kI(){return OI()(Uh,Uh)}function FI(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function ly(n,t){if((e=(n=t?n.toExponential(t-1):n.toExponential()).indexOf("e"))<0)return null;var e,r=n.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+n.slice(e+1)]}function xd(n){return n=ly(Math.abs(n)),n?n[1]:NaN}function BI(n,t){return function(e,r){for(var s=e.length,c=[],p=0,l=n[0],x=0;s>0&&l>0&&(x+l+1>r&&(l=Math.max(1,r-x)),c.push(e.substring(s-=l,s+l)),!((x+=l+1)>r));)l=n[p=(p+1)%n.length];return c.reverse().join(t)}}function UI(n){return function(t){return t.replace(/[0-9]/g,function(e){return n[+e]})}}var VI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uy(n){if(!(t=VI.exec(n)))throw new Error("invalid format: "+n);var t;return new h0({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}uy.prototype=h0.prototype;function h0(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}h0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function GI(n){t:for(var t=n.length,e=1,r=-1,s;e<t;++e)switch(n[e]){case".":r=s=e;break;case"0":r===0&&(r=e),s=e;break;default:if(!+n[e])break t;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(s+1):n}var zx;function qI(n,t){var e=ly(n,t);if(!e)return n+"";var r=e[0],s=e[1],c=s-(zx=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,p=r.length;return c===p?r:c>p?r+new Array(c-p+1).join("0"):c>0?r.slice(0,c)+"."+r.slice(c):"0."+new Array(1-c).join("0")+ly(n,Math.max(0,t+c-1))[0]}function a1(n,t){var e=ly(n,t);if(!e)return n+"";var r=e[0],s=e[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const l1={"%":(n,t)=>(n*100).toFixed(t),b:n=>Math.round(n).toString(2),c:n=>n+"",d:FI,e:(n,t)=>n.toExponential(t),f:(n,t)=>n.toFixed(t),g:(n,t)=>n.toPrecision(t),o:n=>Math.round(n).toString(8),p:(n,t)=>a1(n*100,t),r:a1,s:qI,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function u1(n){return n}var c1=Array.prototype.map,h1=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function XI(n){var t=n.grouping===void 0||n.thousands===void 0?u1:BI(c1.call(n.grouping,Number),n.thousands+""),e=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",c=n.numerals===void 0?u1:UI(c1.call(n.numerals,String)),p=n.percent===void 0?"%":n.percent+"",l=n.minus===void 0?"\u2212":n.minus+"",x=n.nan===void 0?"NaN":n.nan+"";function I(P){P=uy(P);var D=P.fill,G=P.align,Y=P.sign,et=P.symbol,at=P.zero,rt=P.width,wt=P.comma,xt=P.precision,Gt=P.trim,ee=P.type;ee==="n"?(wt=!0,ee="g"):l1[ee]||(xt===void 0&&(xt=12),Gt=!0,ee="g"),(at||D==="0"&&G==="=")&&(at=!0,D="0",G="=");var $t=et==="$"?e:et==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",Zt=et==="$"?r:/[%p]/.test(ee)?p:"",Mt=l1[ee],It=/[defgprs%]/.test(ee);xt=xt===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,xt)):Math.max(0,Math.min(20,xt));function Wt(ft){var re=$t,Yt=Zt,Ft,Oe,Jt;if(ee==="c")Yt=Mt(ft)+Yt,ft="";else{ft=+ft;var $e=ft<0||1/ft<0;if(ft=isNaN(ft)?x:Mt(Math.abs(ft),xt),Gt&&(ft=GI(ft)),$e&&+ft==0&&Y!=="+"&&($e=!1),re=($e?Y==="("?Y:l:Y==="-"||Y==="("?"":Y)+re,Yt=(ee==="s"?h1[8+zx/3]:"")+Yt+($e&&Y==="("?")":""),It){for(Ft=-1,Oe=ft.length;++Ft<Oe;)if(Jt=ft.charCodeAt(Ft),48>Jt||Jt>57){Yt=(Jt===46?s+ft.slice(Ft+1):ft.slice(Ft))+Yt,ft=ft.slice(0,Ft);break}}}wt&&!at&&(ft=t(ft,1/0));var pn=re.length+ft.length+Yt.length,Cn=pn<rt?new Array(rt-pn+1).join(D):"";switch(wt&&at&&(ft=t(Cn+ft,Cn.length?rt-Yt.length:1/0),Cn=""),G){case"<":ft=re+ft+Yt+Cn;break;case"=":ft=re+Cn+ft+Yt;break;case"^":ft=Cn.slice(0,pn=Cn.length>>1)+re+ft+Yt+Cn.slice(pn);break;default:ft=Cn+re+ft+Yt;break}return c(ft)}return Wt.toString=function(){return P+""},Wt}function T(P,D){var G=I((P=uy(P),P.type="f",P)),Y=Math.max(-8,Math.min(8,Math.floor(xd(D)/3)))*3,et=Math.pow(10,-Y),at=h1[8+Y/3];return function(rt){return G(et*rt)+at}}return{format:I,formatPrefix:T}}var q_,Ox,kx;ZI({thousands:",",grouping:[3],currency:["$",""]});function ZI(n){return q_=XI(n),Ox=q_.format,kx=q_.formatPrefix,q_}function YI(n){return Math.max(0,-xd(Math.abs(n)))}function WI(n,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xd(t)/3)))*3-xd(Math.abs(n)))}function jI(n,t){return n=Math.abs(n),t=Math.abs(t)-n,Math.max(0,xd(t)-xd(n))+1}function HI(n,t,e,r){var s=eI(n,t,e),c;switch(r=uy(r==null?",f":r),r.type){case"s":{var p=Math.max(Math.abs(n),Math.abs(t));return r.precision==null&&!isNaN(c=WI(s,p))&&(r.precision=c),kx(r,p)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(c=jI(s,Math.max(Math.abs(n),Math.abs(t))))&&(r.precision=c-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(c=YI(s))&&(r.precision=c-(r.type==="%")*2);break}}return Ox(r)}function Fx(n){var t=n.domain;return n.ticks=function(e){var r=t();return tI(r[0],r[r.length-1],e==null?10:e)},n.tickFormat=function(e,r){var s=t();return HI(s[0],s[s.length-1],e==null?10:e,r)},n.nice=function(e){e==null&&(e=10);var r=t(),s=0,c=r.length-1,p=r[s],l=r[c],x,I,T=10;for(l<p&&(I=p,p=l,l=I,I=s,s=c,c=I);T-- >0;){if(I=Tx(p,l,e),I===x)return r[s]=p,r[c]=l,t(r);if(I>0)p=Math.floor(p/I)*I,l=Math.ceil(l/I)*I;else if(I<0)p=Math.ceil(p*I)/I,l=Math.floor(l*I)/I;else break;x=I}return n},n}function am(){var n=kI();return n.copy=function(){return zI(n,am())},rI.apply(n,arguments),Fx(n)}function KI(){var n=0,t=1,e,r,s,c,p=Uh,l=!1,x;function I(P){return P==null||isNaN(P=+P)?x:p(s===0?.5:(P=(c(P)-e)*s,l?Math.max(0,Math.min(1,P)):P))}I.domain=function(P){return arguments.length?([n,t]=P,e=c(n=+n),r=c(t=+t),s=e===r?0:1/(r-e),I):[n,t]},I.clamp=function(P){return arguments.length?(l=!!P,I):l},I.interpolator=function(P){return arguments.length?(p=P,I):p};function T(P){return function(D){var G,Y;return arguments.length?([G,Y]=D,p=P(G,Y),I):[p(0),p(1)]}}return I.range=T(Sy),I.rangeRound=T(Dx),I.unknown=function(P){return arguments.length?(x=P,I):x},function(P){return c=P,e=P(n),r=P(t),s=e===r?0:1/(r-e),I}}function JI(n,t){return t.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function Bx(){var n=Fx(KI()(Uh));return n.copy=function(){return JI(n,Bx())},iI.apply(n,arguments)}function Cy(n){for(var t=n.length/6|0,e=new Array(t),r=0;r<t;)e[r]="#"+n.slice(r*6,++r*6);return e}var f1=Rx(qh(-100,.75,.35),qh(80,1.5,.8));Rx(qh(260,.75,.35),qh(80,1.5,.8));qh();function Ty(n){var t=n.length;return function(e){return n[Math.max(0,Math.min(t-1,Math.floor(e*t)))]}}Ty(Cy("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Ty(Cy("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));var Ux=Ty(Cy("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));Ty(Cy("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const Hv=Yd(null),Vx=Yd(null),Gc=Yd(null),p1=Yd("address"),QI=[0,60],$I=am().domain([.25,1]).range([0,1]),tE=am().domain([.25,.16,0]).range([Ux(1),f1(1),f1(1)]).interpolate(Yv.gamma(2.2)),Gx=Y2(Bx(n=>n<=.25?tE(n):Ux(1-$I(n))).domain(QI).clamp(!0)),eE=(n,t=!1)=>{const{set:e,subscribe:r}=Yd(t);if(typeof window<"u"){const s=window.matchMedia(n),c=()=>e(!!s.matches);s.addEventListener("change",c),e(s.matches),bx(()=>s.removeEventListener("change",c))}return{subscribe:r}};var Uf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$g={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Uf,function(){var e,r,s;function c(l,x){if(!e)e=x;else if(!r)r=x;else{var I="var sharedChunk = {}; ("+e+")(sharedChunk); ("+r+")(sharedChunk);",T={};e(T),s=x(T),typeof window<"u"&&(s.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}c(["exports"],function(l){var x=I;function I(a,i,u,d){this.cx=3*a,this.bx=3*(u-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(d-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=i,this.p2x=u,this.p2y=d}function T(a,i,u,d){const _=new x(a,i,u,d);return function(b){return _.solve(b)}}I.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,i){if(i===void 0&&(i=1e-6),a<0)return 0;if(a>1)return 1;for(var u=a,d=0;d<8;d++){var _=this.sampleCurveX(u)-a;if(Math.abs(_)<i)return u;var b=this.sampleCurveDerivativeX(u);if(Math.abs(b)<1e-6)break;u-=_/b}var w=0,A=1;for(u=a,d=0;d<20&&(_=this.sampleCurveX(u),!(Math.abs(_-a)<i));d++)a>_?w=u:A=u,u=.5*(A-w)+w;return u},solve:function(a,i){return this.sampleCurveY(this.solveCurveX(a,i))}};const P=T(.25,.1,.25,1);function D(a,i,u){return Math.min(u,Math.max(i,a))}function G(a,i,u){const d=u-i,_=((a-i)%d+d)%d+i;return _===i?u:_}function Y(a,...i){for(const u of i)for(const d in u)a[d]=u[d];return a}let et=1;function at(a,i){a.forEach(u=>{i[u]&&(i[u]=i[u].bind(i))})}function rt(a,i,u){const d={};for(const _ in a)d[_]=i.call(u||this,a[_],_,a);return d}function wt(a,i,u){const d={};for(const _ in a)i.call(u||this,a[_],_,a)&&(d[_]=a[_]);return d}function xt(a){return Array.isArray(a)?a.map(xt):typeof a=="object"&&a?rt(a,xt):a}const Gt={};function ee(a){Gt[a]||(typeof console<"u"&&console.warn(a),Gt[a]=!0)}function $t(a,i,u){return(u.y-a.y)*(i.x-a.x)>(i.y-a.y)*(u.x-a.x)}function Zt(a){let i=0;for(let u,d,_=0,b=a.length,w=b-1;_<b;w=_++)u=a[_],d=a[w],i+=(d.x-u.x)*(u.y+d.y);return i}function Mt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function It(a){const i={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,d,_,b)=>{const w=_||b;return i[d]=!w||w.toLowerCase(),""}),i["max-age"]){const u=parseInt(i["max-age"],10);isNaN(u)?delete i["max-age"]:i["max-age"]=u}return i}let Wt,ft,re=null;function Yt(a){if(re==null){const i=a.navigator?a.navigator.userAgent:null;re=!!a.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return re}function Ft(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Oe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const i=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(a,i=0){const u=window.document.createElement("canvas"),d=u.getContext("2d");if(!d)throw new Error("failed to create canvas 2d context");return u.width=a.width,u.height=a.height,d.drawImage(a,0,0,a.width,a.height),d.getImageData(-i,-i,a.width+2*i,a.height+2*i)},resolveURL:a=>(Wt||(Wt=document.createElement("a")),Wt.href=a,Wt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ft==null&&(ft=matchMedia("(prefers-reduced-motion: reduce)")),ft.matches)}};var Jt=$e;function $e(a,i){this.x=a,this.y=i}$e.prototype={clone:function(){return new $e(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,i){return this.clone()._rotateAround(a,i)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var i=a.x-this.x,u=a.y-this.y;return i*i+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,i){return Math.atan2(this.x*i-this.y*a,this.x*a+this.y*i)},_matMult:function(a){var i=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=i,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var i=Math.cos(a),u=Math.sin(a),d=u*this.x+i*this.y;return this.x=i*this.x-u*this.y,this.y=d,this},_rotateAround:function(a,i){var u=Math.cos(a),d=Math.sin(a),_=i.y+d*(this.x-i.x)+u*(this.y-i.y);return this.x=i.x+u*(this.x-i.x)-d*(this.y-i.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},$e.convert=function(a){return a instanceof $e?a:Array.isArray(a)?new $e(a[0],a[1]):a};const pn={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Cn="mapbox-tiles";let _r,Xn,oi=500,Nr=50;function to(){typeof caches>"u"||_r||(_r=caches.open(Cn))}let Hr=1/0;const Vi={supported:!1,testSupport:function(a){!es&&eo&&(Ul?Fs(a):vs=a)}};let vs,eo,es=!1,Ul=!1;function Fs(a){const i=a.createTexture();a.bindTexture(a.TEXTURE_2D,i);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,eo),a.isContextLost())return;Vi.supported=!0}catch{}a.deleteTexture(i),es=!0}typeof document<"u"&&(eo=document.createElement("img"),eo.onload=function(){vs&&Fs(vs),vs=null,Ul=!0},eo.onerror=function(){es=!0,vs=null},eo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Mo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Mo);class Kr extends Error{constructor(i,u,d,_){super(`AJAXError: ${u} (${i}): ${d}`),this.status=i,this.statusText=u,this.url=d,this.body=_}}const si=Mt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function xs(a,i){const u=new AbortController,d=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:si(),signal:u.signal});let _=!1,b=!1;return a.type==="json"&&d.headers.set("Accept","application/json"),((w,A,M)=>{if(b)return;const z=Date.now();fetch(d).then(F=>F.ok?((U,X,j)=>{(a.type==="arrayBuffer"?U.arrayBuffer():a.type==="json"?U.json():U.text()).then(H=>{b||(X&&j&&function(ut,ct,St){if(to(),!_r)return;const Rt={status:ct.status,statusText:ct.statusText,headers:new Headers};ct.headers.forEach((qt,ne)=>Rt.headers.set(ne,qt));const Lt=It(ct.headers.get("Cache-Control")||"");Lt["no-store"]||(Lt["max-age"]&&Rt.headers.set("Expires",new Date(St+1e3*Lt["max-age"]).toUTCString()),new Date(Rt.headers.get("Expires")).getTime()-St<42e4||function(qt,ne){if(Xn===void 0)try{new Response(new ReadableStream),Xn=!0}catch{Xn=!1}Xn?ne(qt.body):qt.blob().then(ne)}(ct,qt=>{const ne=new Response(qt,Rt);to(),_r&&_r.then(Qt=>Qt.put(function(Me){const Ue=Me.indexOf("?");return Ue<0?Me:Me.slice(0,Ue)}(ut.url),ne)).catch(Qt=>ee(Qt.message))}))}(d,X,j),_=!0,i(null,H,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(H=>{b||i(new Error(H.message))})})(F,null,z):F.blob().then(U=>i(new Kr(F.status,F.statusText,a.url,U)))).catch(F=>{F.code!==20&&i(new Error(F.message))})})(),{cancel:()=>{b=!0,_||u.abort()}}}const sa=function(a,i){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(Mt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i);if(!Mt()){const d=a.url.substring(0,a.url.indexOf("://"));return(pn.REGISTERED_PROTOCOLS[d]||xs)(a,i)}}if(!(/^file:/.test(u=a.url)||/^file:/.test(si())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return xs(a,i);if(Mt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i,void 0,!0)}var u;return function(d,_){const b=new XMLHttpRequest;b.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const w in d.headers)b.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=d.credentials==="include",b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let w=b.response;if(d.type==="json")try{w=JSON.parse(b.response)}catch(A){return _(A)}_(null,w,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const w=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});_(new Kr(b.status,b.statusText,d.url,w))}},b.send(d.body),{cancel:()=>b.abort()}}(a,i)},ai=function(a,i){return sa(Y(a,{type:"arrayBuffer"}),i)};function il(a){const i=window.document.createElement("a");return i.href=a,i.protocol===window.document.location.protocol&&i.host===window.document.location.host}const bs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Gi,Rr;Gi=[],Rr=0;const ws=function(a,i){if(Vi.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),Rr>=pn.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:a,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Gi.push(b),b}Rr++;let u=!1;const d=()=>{if(!u)for(u=!0,Rr--;Gi.length&&Rr<pn.MAX_PARALLEL_IMAGE_REQUESTS;){const b=Gi.shift(),{requestParameters:w,callback:A,cancelled:M}=b;M||(b.cancel=ws(w,A).cancel)}},_=ai(a,(b,w,A,M)=>{d(),b?i(b):w&&function(z,F){typeof createImageBitmap=="function"?function(U,X){const j=new Blob([new Uint8Array(U)],{type:"image/png"});createImageBitmap(j).then(H=>{X(null,H)}).catch(H=>{X(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(z,F):function(U,X){const j=new Image;j.onload=()=>{X(null,j),URL.revokeObjectURL(j.src),j.onload=null,window.requestAnimationFrame(()=>{j.src=bs})},j.onerror=()=>X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new Blob([new Uint8Array(U)],{type:"image/png"});j.src=U.byteLength?URL.createObjectURL(H):bs}(z,F)}(w,(z,F)=>{z!=null?i(z):F!=null&&i(null,F,{cacheControl:A,expires:M})})});return{cancel:()=>{_.cancel(),d()}}};function ye(a,i,u){u[a]&&u[a].indexOf(i)!==-1||(u[a]=u[a]||[],u[a].push(i))}function aa(a,i,u){if(u&&u[a]){const d=u[a].indexOf(i);d!==-1&&u[a].splice(d,1)}}class bn{constructor(i,u={}){Y(this,u),this.type=i}}class Bs extends bn{constructor(i,u={}){super("error",Y({error:i},u))}}class ns{on(i,u){return this._listeners=this._listeners||{},ye(i,u,this._listeners),this}off(i,u){return aa(i,u,this._listeners),aa(i,u,this._oneTimeListeners),this}once(i,u){return this._oneTimeListeners=this._oneTimeListeners||{},ye(i,u,this._oneTimeListeners),this}fire(i,u){typeof i=="string"&&(i=new bn(i,u||{}));const d=i.type;if(this.listens(d)){i.target=this;const _=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const A of _)A.call(this,i);const b=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const A of b)aa(d,A,this._oneTimeListeners),A.call(this,i);const w=this._eventedParent;w&&(Y(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(i))}else i instanceof Bs&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,u){return this._eventedParent=i,this._eventedParentData=u,this}}var Bt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class ge{constructor(i,u,d,_){this.message=(i?`${i}: `:"")+d,_&&(this.identifier=_),u!=null&&u.__line__&&(this.line=u.__line__)}}function no(a){const i=a.value;return i?[new ge(a.key,i,"constants have been deprecated as of v8")]:[]}function Si(a,...i){for(const u of i)for(const d in u)a[d]=u[d];return a}function Bn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Vn(a){if(Array.isArray(a))return a.map(Vn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const i={};for(const u in a)i[u]=Vn(a[u]);return i}return Bn(a)}class Qn extends Error{constructor(i,u){super(u),this.message=u,this.key=i}}class Do{constructor(i,u=[]){this.parent=i,this.bindings={};for(const[d,_]of u)this.bindings[d]=_}concat(i){return new Do(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const dn={kind:"null"},ue={kind:"number"},gn={kind:"string"},tn={kind:"boolean"},Ci={kind:"color"},ro={kind:"object"},cn={kind:"value"},Is={kind:"collator"},rs={kind:"formatted"},Us={kind:"resolvedImage"};function Jr(a,i){return{kind:"array",itemType:a,N:i}}function $n(a){if(a.kind==="array"){const i=$n(a.itemType);return typeof a.N=="number"?`array<${i}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${i}>`}return a.kind}const No=[dn,ue,gn,tn,Ci,rs,ro,Jr(cn),Us];function Es(a,i){if(i.kind==="error")return null;if(a.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Es(a.itemType,i.itemType))&&(typeof a.N!="number"||a.N===i.N))return null}else{if(a.kind===i.kind)return null;if(a.kind==="value"){for(const u of No)if(!Es(u,i))return null}}return`Expected ${$n(a)} but found ${$n(i)} instead.`}function Qr(a,i){return i.some(u=>u.kind===a.kind)}function qi(a,i){return i.some(u=>u==="null"?a===null:u==="array"?Array.isArray(a):u==="object"?a&&!Array.isArray(a)&&typeof a=="object":u===typeof a)}var yo,Ra={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ol(a){return(a=Math.round(a))<0?0:a>255?255:a}function Vs(a){return ol(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function $(a){return(i=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:i>1?1:i;var i}function O(a,i,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?a+(i-a)*u*6:2*u<1?i:3*u<2?a+(i-a)*(2/3-u)*6:a}try{yo={}.parseCSSColor=function(a){var i,u=a.replace(/ /g,"").toLowerCase();if(u in Ra)return Ra[u].slice();if(u[0]==="#")return u.length===4?(i=parseInt(u.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:u.length===7&&(i=parseInt(u.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var d=u.indexOf("("),_=u.indexOf(")");if(d!==-1&&_+1===u.length){var b=u.substr(0,d),w=u.substr(d+1,_-(d+1)).split(","),A=1;switch(b){case"rgba":if(w.length!==4)return null;A=$(w.pop());case"rgb":return w.length!==3?null:[Vs(w[0]),Vs(w[1]),Vs(w[2]),A];case"hsla":if(w.length!==4)return null;A=$(w.pop());case"hsl":if(w.length!==3)return null;var M=(parseFloat(w[0])%360+360)%360/360,z=$(w[1]),F=$(w[2]),U=F<=.5?F*(z+1):F+z-F*z,X=2*F-U;return[ol(255*O(X,U,M+1/3)),ol(255*O(X,U,M)),ol(255*O(X,U,M-1/3)),A];default:return null}}return null}}catch{}class B{constructor(i,u,d,_=1){this.r=i,this.g=u,this.b=d,this.a=_}static parse(i){if(!i)return;if(i instanceof B)return i;if(typeof i!="string")return;const u=yo(i);return u?new B(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[i,u,d,_]=this.toArray();return`rgba(${Math.round(i)},${Math.round(u)},${Math.round(d)},${_})`}toArray(){const{r:i,g:u,b:d,a:_}=this;return _===0?[0,0,0,0]:[255*i/_,255*u/_,255*d/_,_]}}B.black=new B(0,0,0,1),B.white=new B(1,1,1,1),B.transparent=new B(0,0,0,0),B.red=new B(1,0,0,1);class K{constructor(i,u,d){this.sensitivity=i?u?"variant":"case":u?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,u){return this.collator.compare(i,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class tt{constructor(i,u,d,_,b){this.text=i,this.image=u,this.scale=d,this.fontStack=_,this.textColor=b}}class nt{constructor(i){this.sections=i}static fromString(i){return new nt([new tt(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof nt?i:nt.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const u of this.sections){if(u.image){i.push(["image",u.image.name]);continue}i.push(u.text);const d={};u.fontStack&&(d["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(d["font-scale"]=u.scale),u.textColor&&(d["text-color"]=["rgba"].concat(u.textColor.toArray())),i.push(d)}return i}}class dt{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new dt({name:i,available:!1}):null}serialize(){return["image",this.name]}}function ht(a,i,u,d){return typeof a=="number"&&a>=0&&a<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof u=="number"&&u>=0&&u<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[a,i,u,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[a,i,u,d]:[a,i,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pt(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof B||a instanceof K||a instanceof nt||a instanceof dt)return!0;if(Array.isArray(a)){for(const i of a)if(!pt(i))return!1;return!0}if(typeof a=="object"){for(const i in a)if(!pt(a[i]))return!1;return!0}return!1}function gt(a){if(a===null)return dn;if(typeof a=="string")return gn;if(typeof a=="boolean")return tn;if(typeof a=="number")return ue;if(a instanceof B)return Ci;if(a instanceof K)return Is;if(a instanceof nt)return rs;if(a instanceof dt)return Us;if(Array.isArray(a)){const i=a.length;let u;for(const d of a){const _=gt(d);if(u){if(u===_)continue;u=cn;break}u=_}return Jr(u||cn,i)}return ro}function Vt(a){const i=typeof a;return a===null?"":i==="string"||i==="number"||i==="boolean"?String(a):a instanceof B||a instanceof nt||a instanceof dt?a.toString():JSON.stringify(a)}class te{constructor(i,u){this.type=i,this.value=u}static parse(i,u){if(i.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!pt(i[1]))return u.error("invalid value");const d=i[1];let _=gt(d);const b=u.expectedType;return _.kind!=="array"||_.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(_=b),new te(_,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof B?["rgba"].concat(this.value.toArray()):this.value instanceof nt?this.value.serialize():this.value}}class zt{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const Ae={string:gn,number:ue,boolean:tn,object:ro};class we{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");let d,_=1;const b=i[0];if(b==="array"){let A,M;if(i.length>2){const z=i[1];if(typeof z!="string"||!(z in Ae)||z==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);A=Ae[z],_++}else A=cn;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return u.error('The length argument to "array" must be a positive integer literal',2);M=i[2],_++}d=Jr(A,M)}else d=Ae[b];const w=[];for(;_<i.length;_++){const A=u.parse(i[_],_,cn);if(!A)return null;w.push(A)}return new we(d,w)}evaluate(i){for(let u=0;u<this.args.length;u++){const d=this.args[u].evaluate(i);if(!Es(this.type,gt(d)))return d;if(u===this.args.length-1)throw new zt(`Expected value to be of type ${$n(this.type)}, but found ${$n(gt(d))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,u=[i.kind];if(i.kind==="array"){const d=i.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){u.push(d.kind);const _=i.N;(typeof _=="number"||this.args.length>1)&&u.push(_)}}return u.concat(this.args.map(d=>d.serialize()))}}class De{constructor(i){this.type=rs,this.sections=i}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");const d=i[1];if(!Array.isArray(d)&&typeof d=="object")return u.error("First argument must be an image or text section.");const _=[];let b=!1;for(let w=1;w<=i.length-1;++w){const A=i[w];if(b&&typeof A=="object"&&!Array.isArray(A)){b=!1;let M=null;if(A["font-scale"]&&(M=u.parse(A["font-scale"],1,ue),!M))return null;let z=null;if(A["text-font"]&&(z=u.parse(A["text-font"],1,Jr(gn)),!z))return null;let F=null;if(A["text-color"]&&(F=u.parse(A["text-color"],1,Ci),!F))return null;const U=_[_.length-1];U.scale=M,U.font=z,U.textColor=F}else{const M=u.parse(i[w],1,cn);if(!M)return null;const z=M.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:M,scale:null,font:null,textColor:null})}}return new De(_)}evaluate(i){return new nt(this.sections.map(u=>{const d=u.content.evaluate(i);return gt(d)===Us?new tt("",d,null,null,null):new tt(Vt(d),null,u.scale?u.scale.evaluate(i):null,u.font?u.font.evaluate(i).join(","):null,u.textColor?u.textColor.evaluate(i):null)}))}eachChild(i){for(const u of this.sections)i(u.content),u.scale&&i(u.scale),u.font&&i(u.font),u.textColor&&i(u.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const u of this.sections){i.push(u.content.serialize());const d={};u.scale&&(d["font-scale"]=u.scale.serialize()),u.font&&(d["text-font"]=u.font.serialize()),u.textColor&&(d["text-color"]=u.textColor.serialize()),i.push(d)}return i}}class ke{constructor(i){this.type=Us,this.input=i}static parse(i,u){if(i.length!==2)return u.error("Expected two arguments.");const d=u.parse(i[1],1,gn);return d?new ke(d):u.error("No image name provided.")}evaluate(i){const u=this.input.evaluate(i),d=dt.fromString(u);return d&&i.availableImages&&(d.available=i.availableImages.indexOf(u)>-1),d}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Mn={"to-boolean":tn,"to-color":Ci,"to-number":ue,"to-string":gn};class In{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expected at least one argument.");const d=i[0];if((d==="to-boolean"||d==="to-string")&&i.length!==2)return u.error("Expected one argument.");const _=Mn[d],b=[];for(let w=1;w<i.length;w++){const A=u.parse(i[w],w,cn);if(!A)return null;b.push(A)}return new In(_,b)}evaluate(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){let u,d;for(const _ of this.args){if(u=_.evaluate(i),d=null,u instanceof B)return u;if(typeof u=="string"){const b=i.parseColor(u);if(b)return b}else if(Array.isArray(u)&&(d=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:ht(u[0],u[1],u[2],u[3]),!d))return new B(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new zt(d||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const d of this.args){if(u=d.evaluate(i),u===null)return 0;const _=Number(u);if(!isNaN(_))return _}throw new zt(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?nt.fromString(Vt(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?dt.fromString(Vt(this.args[0].evaluate(i))):Vt(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new De([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ke(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(u=>{i.push(u.serialize())}),i}}const wn=["Unknown","Point","LineString","Polygon"];class sn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let u=this._parseColorCache[i];return u||(u=this._parseColorCache[i]=B.parse(i)),u}}class an{constructor(i,u,d,_){this.name=i,this.type=u,this._evaluate=d,this.args=_}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,u){const d=i[0],_=an.definitions[d];if(!_)return u.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,w=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,A=w.filter(([z])=>!Array.isArray(z)||z.length===i.length-1);let M=null;for(const[z,F]of A){M=new cc(u.registry,u.path,null,u.scope);const U=[];let X=!1;for(let j=1;j<i.length;j++){const H=i[j],ut=Array.isArray(z)?z[j-1]:z.type,ct=M.parse(H,1+U.length,ut);if(!ct){X=!0;break}U.push(ct)}if(!X)if(Array.isArray(z)&&z.length!==U.length)M.error(`Expected ${z.length} arguments, but found ${U.length} instead.`);else{for(let j=0;j<U.length;j++){const H=Array.isArray(z)?z[j]:z.type,ut=U[j];M.concat(j+1).checkSubtype(H,ut.type)}if(M.errors.length===0)return new an(d,b,F,U)}}if(A.length===1)u.errors.push(...M.errors);else{const z=(A.length?A:w).map(([U])=>{return X=U,Array.isArray(X)?`(${X.map($n).join(", ")})`:`(${$n(X.type)}...)`;var X}).join(" | "),F=[];for(let U=1;U<i.length;U++){const X=u.parse(i[U],1+F.length);if(!X)return null;F.push($n(X.type))}u.error(`Expected arguments of type ${z}, but found (${F.join(", ")}) instead.`)}return null}static register(i,u){an.definitions=u;for(const d in u)i[d]=an}}class zr{constructor(i,u,d){this.type=Is,this.locale=d,this.caseSensitive=i,this.diacriticSensitive=u}static parse(i,u){if(i.length!==2)return u.error("Expected one argument.");const d=i[1];if(typeof d!="object"||Array.isArray(d))return u.error("Collator options argument must be an object.");const _=u.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,tn);if(!_)return null;const b=u.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,tn);if(!b)return null;let w=null;return d.locale&&(w=u.parse(d.locale,1,gn),!w)?null:new zr(_,b,w)}evaluate(i){return new K(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const Lr=8192;function pi(a,i){a[0]=Math.min(a[0],i[0]),a[1]=Math.min(a[1],i[1]),a[2]=Math.max(a[2],i[0]),a[3]=Math.max(a[3],i[1])}function Ti(a,i){return!(a[0]<=i[0]||a[2]>=i[2]||a[1]<=i[1]||a[3]>=i[3])}function Su(a,i){const u=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,_=Math.pow(2,i.z);return[Math.round(u*_*Lr),Math.round(d*_*Lr)]}function lt(a,i,u){const d=a[0]-i[0],_=a[1]-i[1],b=a[0]-u[0],w=a[1]-u[1];return d*w-b*_==0&&d*b<=0&&_*w<=0}function xe(a,i){let u=!1;for(let w=0,A=i.length;w<A;w++){const M=i[w];for(let z=0,F=M.length;z<F-1;z++){if(lt(a,M[z],M[z+1]))return!1;(_=M[z])[1]>(d=a)[1]!=(b=M[z+1])[1]>d[1]&&d[0]<(b[0]-_[0])*(d[1]-_[1])/(b[1]-_[1])+_[0]&&(u=!u)}}var d,_,b;return u}function Je(a,i){for(let u=0;u<i.length;u++)if(xe(a,i[u]))return!0;return!1}function Un(a,i,u,d){const _=d[0]-u[0],b=d[1]-u[1],w=(a[0]-u[0])*b-_*(a[1]-u[1]),A=(i[0]-u[0])*b-_*(i[1]-u[1]);return w>0&&A<0||w<0&&A>0}function Ai(a,i,u){for(const z of u)for(let F=0;F<z.length-1;++F)if((A=[(w=z[F+1])[0]-(b=z[F])[0],w[1]-b[1]])[0]*(M=[(_=i)[0]-(d=a)[0],_[1]-d[1]])[1]-A[1]*M[0]!=0&&Un(d,_,b,w)&&Un(b,w,d,_))return!0;var d,_,b,w,A,M;return!1}function di(a,i){for(let u=0;u<a.length;++u)if(!xe(a[u],i))return!1;for(let u=0;u<a.length-1;++u)if(Ai(a[u],a[u+1],i))return!1;return!0}function za(a,i){for(let u=0;u<i.length;u++)if(di(a,i[u]))return!0;return!1}function sl(a,i,u){const d=[];for(let _=0;_<a.length;_++){const b=[];for(let w=0;w<a[_].length;w++){const A=Su(a[_][w],u);pi(i,A),b.push(A)}d.push(b)}return d}function Gs(a,i,u){const d=[];for(let _=0;_<a.length;_++){const b=sl(a[_],i,u);d.push(b)}return d}function io(a,i,u,d){if(a[0]<u[0]||a[0]>u[2]){const _=.5*d;let b=a[0]-u[0]>_?-d:u[0]-a[0]>_?d:0;b===0&&(b=a[0]-u[2]>_?-d:u[2]-a[0]>_?d:0),a[0]+=b}pi(i,a)}function qs(a,i,u,d){const _=Math.pow(2,d.z)*Lr,b=[d.x*Lr,d.y*Lr],w=[];for(const A of a)for(const M of A){const z=[M.x+b[0],M.y+b[1]];io(z,i,u,_),w.push(z)}return w}function Ro(a,i,u,d){const _=Math.pow(2,d.z)*Lr,b=[d.x*Lr,d.y*Lr],w=[];for(const M of a){const z=[];for(const F of M){const U=[F.x+b[0],F.y+b[1]];pi(i,U),z.push(U)}w.push(z)}if(i[2]-i[0]<=_/2){(A=i)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const M of w)for(const z of M)io(z,i,u,_)}var A;return w}class is{constructor(i,u){this.type=tn,this.geojson=i,this.geometries=u}static parse(i,u){if(i.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(pt(i[1])){const d=i[1];if(d.type==="FeatureCollection")for(let _=0;_<d.features.length;++_){const b=d.features[_].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new is(d,d.features[_].geometry)}else if(d.type==="Feature"){const _=d.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new is(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new is(d,d)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(u,d){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(d.type==="Polygon"){const A=sl(d.coordinates,b,w),M=qs(u.geometry(),_,b,w);if(!Ti(_,b))return!1;for(const z of M)if(!xe(z,A))return!1}if(d.type==="MultiPolygon"){const A=Gs(d.coordinates,b,w),M=qs(u.geometry(),_,b,w);if(!Ti(_,b))return!1;for(const z of M)if(!Je(z,A))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(u,d){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(d.type==="Polygon"){const A=sl(d.coordinates,b,w),M=Ro(u.geometry(),_,b,w);if(!Ti(_,b))return!1;for(const z of M)if(!di(z,A))return!1}if(d.type==="MultiPolygon"){const A=Gs(d.coordinates,b,w),M=Ro(u.geometry(),_,b,w);if(!Ti(_,b))return!1;for(const z of M)if(!za(z,A))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function al(a){if(a instanceof an&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof is)return!1;let i=!0;return a.eachChild(u=>{i&&!al(u)&&(i=!1)}),i}function ll(a){if(a instanceof an&&a.name==="feature-state")return!1;let i=!0;return a.eachChild(u=>{i&&!ll(u)&&(i=!1)}),i}function la(a,i){if(a instanceof an&&i.indexOf(a.name)>=0)return!1;let u=!0;return a.eachChild(d=>{u&&!la(d,i)&&(u=!1)}),u}class uc{constructor(i,u){this.type=u.type,this.name=i,this.boundExpression=u}static parse(i,u){if(i.length!==2||typeof i[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const d=i[1];return u.scope.has(d)?new uc(d,u.scope.get(d)):u.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class cc{constructor(i,u=[],d,_=new Do,b=[]){this.registry=i,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=b,this.expectedType=d}parse(i,u,d,_,b={}){return u?this.concat(u,d,_)._parse(i,b):this._parse(i,b)}_parse(i,u){function d(_,b,w){return w==="assert"?new we(b,[_]):w==="coerce"?new In(b,[_]):_}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=i[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[_];if(b){let w=b.parse(i,this);if(!w)return null;if(this.expectedType){const A=this.expectedType,M=w.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||M.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(A,M))return null}else w=d(w,A,u.typeAnnotation||"coerce");else w=d(w,A,u.typeAnnotation||"assert")}if(!(w instanceof te)&&w.type.kind!=="resolvedImage"&&hc(w)){const A=new sn;try{w=new te(w.type,w.evaluate(A))}catch(M){return this.error(M.message),null}}return w}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,u,d){const _=typeof i=="number"?this.path.concat(i):this.path,b=d?this.scope.concat(d):this.scope;return new cc(this.registry,_,u||null,b,this.errors)}error(i,...u){const d=`${this.key}${u.map(_=>`[${_}]`).join("")}`;this.errors.push(new Qn(d,i))}checkSubtype(i,u){const d=Es(i,u);return d&&this.error(d),d}}function hc(a){if(a instanceof uc)return hc(a.boundExpression);if(a instanceof an&&a.name==="error"||a instanceof zr||a instanceof is)return!1;const i=a instanceof In||a instanceof we;let u=!0;return a.eachChild(d=>{u=i?u&&hc(d):u&&d instanceof te}),!!u&&al(a)&&la(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function fc(a,i){const u=a.length-1;let d,_,b=0,w=u,A=0;for(;b<=w;)if(A=Math.floor((b+w)/2),d=a[A],_=a[A+1],d<=i){if(A===u||i<_)return A;b=A+1}else{if(!(d>i))throw new zt("Input is not a number.");w=A-1}return 0}class Cu{constructor(i,u,d){this.type=i,this.input=u,this.labels=[],this.outputs=[];for(const[_,b]of d)this.labels.push(_),this.outputs.push(b)}static parse(i,u){if(i.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return u.error("Expected an even number of arguments.");const d=u.parse(i[1],1,ue);if(!d)return null;const _=[];let b=null;u.expectedType&&u.expectedType.kind!=="value"&&(b=u.expectedType);for(let w=1;w<i.length;w+=2){const A=w===1?-1/0:i[w],M=i[w+1],z=w,F=w+1;if(typeof A!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(_.length&&_[_.length-1][0]>=A)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const U=u.parse(M,F,b);if(!U)return null;b=b||U.type,_.push([A,U])}return new Cu(b,d,_)}evaluate(i){const u=this.labels,d=this.outputs;if(u.length===1)return d[0].evaluate(i);const _=this.input.evaluate(i);if(_<=u[0])return d[0].evaluate(i);const b=u.length;return _>=u[b-1]?d[b-1].evaluate(i):d[fc(u,_)].evaluate(i)}eachChild(i){i(this.input);for(const u of this.outputs)i(u)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&i.push(this.labels[u]),i.push(this.outputs[u].serialize());return i}}function li(a,i,u){return a*(1-u)+i*u}var Tu=Object.freeze({__proto__:null,number:li,color:function(a,i,u){return new B(li(a.r,i.r,u),li(a.g,i.g,u),li(a.b,i.b,u),li(a.a,i.a,u))},array:function(a,i,u){return a.map((d,_)=>li(d,i[_],u))}});const ef=.95047,up=1.08883,cp=4/29,pc=6/29,nf=3*pc*pc,$d=Math.PI/180,tg=180/Math.PI;function rf(a){return a>.008856451679035631?Math.pow(a,1/3):a/nf+cp}function dc(a){return a>pc?a*a*a:nf*(a-cp)}function of(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function sf(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function hp(a){const i=sf(a.r),u=sf(a.g),d=sf(a.b),_=rf((.4124564*i+.3575761*u+.1804375*d)/ef),b=rf((.2126729*i+.7151522*u+.072175*d)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-rf((.0193339*i+.119192*u+.9503041*d)/up)),alpha:a.a}}function Zn(a){let i=(a.l+16)/116,u=isNaN(a.a)?i:i+a.a/500,d=isNaN(a.b)?i:i-a.b/200;return i=1*dc(i),u=ef*dc(u),d=up*dc(d),new B(of(3.2404542*u-1.5371385*i-.4985314*d),of(-.969266*u+1.8760108*i+.041556*d),of(.0556434*u-.2040259*i+1.0572252*d),a.alpha)}function eg(a,i,u){const d=i-a;return a+u*(d>180||d<-180?d-360*Math.round(d/360):d)}const cr={forward:hp,reverse:Zn,interpolate:function(a,i,u){return{l:li(a.l,i.l,u),a:li(a.a,i.a,u),b:li(a.b,i.b,u),alpha:li(a.alpha,i.alpha,u)}}},ar={forward:function(a){const{l:i,a:u,b:d}=hp(a),_=Math.atan2(d,u)*tg;return{h:_<0?_+360:_,c:Math.sqrt(u*u+d*d),l:i,alpha:a.a}},reverse:function(a){const i=a.h*$d,u=a.c;return Zn({l:a.l,a:Math.cos(i)*u,b:Math.sin(i)*u,alpha:a.alpha})},interpolate:function(a,i,u){return{h:eg(a.h,i.h,u),c:li(a.c,i.c,u),l:li(a.l,i.l,u),alpha:li(a.alpha,i.alpha,u)}}};var fp=Object.freeze({__proto__:null,lab:cr,hcl:ar});class os{constructor(i,u,d,_,b){this.type=i,this.operator=u,this.interpolation=d,this.input=_,this.labels=[],this.outputs=[];for(const[w,A]of b)this.labels.push(w),this.outputs.push(A)}static interpolationFactor(i,u,d,_){let b=0;if(i.name==="exponential")b=af(u,i.base,d,_);else if(i.name==="linear")b=af(u,1,d,_);else if(i.name==="cubic-bezier"){const w=i.controlPoints;b=new x(w[0],w[1],w[2],w[3]).solve(af(u,1,d,_))}return b}static parse(i,u){let[d,_,b,...w]=i;if(!Array.isArray(_)||_.length===0)return u.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const z=_[1];if(typeof z!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:z}}else{if(_[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const z=_.slice(1);if(z.length!==4||z.some(F=>typeof F!="number"||F<0||F>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:z}}}if(i.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(b=u.parse(b,2,ue),!b)return null;const A=[];let M=null;d==="interpolate-hcl"||d==="interpolate-lab"?M=Ci:u.expectedType&&u.expectedType.kind!=="value"&&(M=u.expectedType);for(let z=0;z<w.length;z+=2){const F=w[z],U=w[z+1],X=z+3,j=z+4;if(typeof F!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(A.length&&A[A.length-1][0]>=F)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const H=u.parse(U,j,M);if(!H)return null;M=M||H.type,A.push([F,H])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new os(M,d,_,b,A):u.error(`Type ${$n(M)} is not interpolatable.`)}evaluate(i){const u=this.labels,d=this.outputs;if(u.length===1)return d[0].evaluate(i);const _=this.input.evaluate(i);if(_<=u[0])return d[0].evaluate(i);const b=u.length;if(_>=u[b-1])return d[b-1].evaluate(i);const w=fc(u,_),A=os.interpolationFactor(this.interpolation,_,u[w],u[w+1]),M=d[w].evaluate(i),z=d[w+1].evaluate(i);return this.operator==="interpolate"?Tu[this.type.kind.toLowerCase()](M,z,A):this.operator==="interpolate-hcl"?ar.reverse(ar.interpolate(ar.forward(M),ar.forward(z),A)):cr.reverse(cr.interpolate(cr.forward(M),cr.forward(z),A))}eachChild(i){i(this.input);for(const u of this.outputs)i(u)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,i,this.input.serialize()];for(let d=0;d<this.labels.length;d++)u.push(this.labels[d],this.outputs[d].serialize());return u}}function af(a,i,u,d){const _=d-u,b=a-u;return _===0?0:i===1?b/_:(Math.pow(i,b)-1)/(Math.pow(i,_)-1)}class eh{constructor(i,u){this.type=i,this.args=u}static parse(i,u){if(i.length<2)return u.error("Expectected at least one argument.");let d=null;const _=u.expectedType;_&&_.kind!=="value"&&(d=_);const b=[];for(const A of i.slice(1)){const M=u.parse(A,1+b.length,d,void 0,{typeAnnotation:"omit"});if(!M)return null;d=d||M.type,b.push(M)}const w=_&&b.some(A=>Es(_,A.type));return new eh(w?cn:d,b)}evaluate(i){let u,d=null,_=0;for(const b of this.args)if(_++,d=b.evaluate(i),d&&d instanceof dt&&!d.available&&(u||(u=d.name),d=null,_===this.args.length&&(d=u)),d!==null)break;return d}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(u=>{i.push(u.serialize())}),i}}class nh{constructor(i,u){this.type=u.type,this.bindings=[].concat(i),this.result=u}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const u of this.bindings)i(u[1]);i(this.result)}static parse(i,u){if(i.length<4)return u.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const d=[];for(let b=1;b<i.length-1;b+=2){const w=i[b];if(typeof w!="string")return u.error(`Expected string, but found ${typeof w} instead.`,b);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);const A=u.parse(i[b+1],b+1);if(!A)return null;d.push([w,A])}const _=u.parse(i[i.length-1],i.length-1,u.expectedType,d);return _?new nh(d,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[u,d]of this.bindings)i.push(u,d.serialize());return i.push(this.result.serialize()),i}}class lf{constructor(i,u,d){this.type=i,this.index=u,this.input=d}static parse(i,u){if(i.length!==3)return u.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=u.parse(i[1],1,ue),_=u.parse(i[2],2,Jr(u.expectedType||cn));return d&&_?new lf(_.type.itemType,d,_):null}evaluate(i){const u=this.index.evaluate(i),d=this.input.evaluate(i);if(u<0)throw new zt(`Array index out of bounds: ${u} < 0.`);if(u>=d.length)throw new zt(`Array index out of bounds: ${u} > ${d.length-1}.`);if(u!==Math.floor(u))throw new zt(`Array index must be an integer, but found ${u} instead.`);return d[u]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class rh{constructor(i,u){this.type=tn,this.needle=i,this.haystack=u}static parse(i,u){if(i.length!==3)return u.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=u.parse(i[1],1,cn),_=u.parse(i[2],2,cn);return d&&_?Qr(d.type,[tn,gn,ue,dn,cn])?new rh(d,_):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${$n(d.type)} instead`):null}evaluate(i){const u=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!d)return!1;if(!qi(u,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${$n(gt(u))} instead.`);if(!qi(d,["string","array"]))throw new zt(`Expected second argument to be of type array or string, but found ${$n(gt(d))} instead.`);return d.indexOf(u)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ih{constructor(i,u,d){this.type=ue,this.needle=i,this.haystack=u,this.fromIndex=d}static parse(i,u){if(i.length<=2||i.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=u.parse(i[1],1,cn),_=u.parse(i[2],2,cn);if(!d||!_)return null;if(!Qr(d.type,[tn,gn,ue,dn,cn]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${$n(d.type)} instead`);if(i.length===4){const b=u.parse(i[3],3,ue);return b?new ih(d,_,b):null}return new ih(d,_)}evaluate(i){const u=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!qi(u,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${$n(gt(u))} instead.`);if(!qi(d,["string","array"]))throw new zt(`Expected second argument to be of type array or string, but found ${$n(gt(d))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(i);return d.indexOf(u,_)}return d.indexOf(u)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Pi{constructor(i,u,d,_,b,w){this.inputType=i,this.type=u,this.input=d,this.cases=_,this.outputs=b,this.otherwise=w}static parse(i,u){if(i.length<5)return u.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return u.error("Expected an even number of arguments.");let d,_;u.expectedType&&u.expectedType.kind!=="value"&&(_=u.expectedType);const b={},w=[];for(let z=2;z<i.length-1;z+=2){let F=i[z];const U=i[z+1];Array.isArray(F)||(F=[F]);const X=u.concat(z);if(F.length===0)return X.error("Expected at least one branch label.");for(const H of F){if(typeof H!="number"&&typeof H!="string")return X.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return X.error("Numeric branch labels must be integer values.");if(d){if(X.checkSubtype(d,gt(H)))return null}else d=gt(H);if(b[String(H)]!==void 0)return X.error("Branch labels must be unique.");b[String(H)]=w.length}const j=u.parse(U,z,_);if(!j)return null;_=_||j.type,w.push(j)}const A=u.parse(i[1],1,cn);if(!A)return null;const M=u.parse(i[i.length-1],i.length-1,_);return M?A.type.kind!=="value"&&u.concat(1).checkSubtype(d,A.type)?null:new Pi(d,_,A,b,w,M):null}evaluate(i){const u=this.input.evaluate(i);return(gt(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),d=[],_={};for(const w of u){const A=_[this.cases[w]];A===void 0?(_[this.cases[w]]=d.length,d.push([this.cases[w],[w]])):d[A][1].push(w)}const b=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,A]of d)i.push(A.length===1?b(A[0]):A.map(b)),i.push(this.outputs[w].serialize());return i.push(this.otherwise.serialize()),i}}class gc{constructor(i,u,d){this.type=i,this.branches=u,this.otherwise=d}static parse(i,u){if(i.length<4)return u.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return u.error("Expected an odd number of arguments.");let d;u.expectedType&&u.expectedType.kind!=="value"&&(d=u.expectedType);const _=[];for(let w=1;w<i.length-1;w+=2){const A=u.parse(i[w],w,tn);if(!A)return null;const M=u.parse(i[w+1],w+1,d);if(!M)return null;_.push([A,M]),d=d||M.type}const b=u.parse(i[i.length-1],i.length-1,d);return b?new gc(d,_,b):null}evaluate(i){for(const[u,d]of this.branches)if(u.evaluate(i))return d.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[u,d]of this.branches)i(u),i(d);i(this.otherwise)}outputDefined(){return this.branches.every(([i,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(u=>{i.push(u.serialize())}),i}}class ua{constructor(i,u,d,_){this.type=i,this.input=u,this.beginIndex=d,this.endIndex=_}static parse(i,u){if(i.length<=2||i.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=u.parse(i[1],1,cn),_=u.parse(i[2],2,ue);if(!d||!_)return null;if(!Qr(d.type,[Jr(cn),gn,cn]))return u.error(`Expected first argument to be of type array or string, but found ${$n(d.type)} instead`);if(i.length===4){const b=u.parse(i[3],3,ue);return b?new ua(d.type,d,_,b):null}return new ua(d.type,d,_)}evaluate(i){const u=this.input.evaluate(i),d=this.beginIndex.evaluate(i);if(!qi(u,["string","array"]))throw new zt(`Expected first argument to be of type array or string, but found ${$n(gt(u))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(i);return u.slice(d,_)}return u.slice(d)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function uf(a,i){return a==="=="||a==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function oh(a,i,u,d){return d.compare(i,u)===0}function Xi(a,i,u){const d=a!=="=="&&a!=="!=";return class qx{constructor(b,w,A){this.type=tn,this.lhs=b,this.rhs=w,this.collator=A,this.hasUntypedArgument=b.type.kind==="value"||w.type.kind==="value"}static parse(b,w){if(b.length!==3&&b.length!==4)return w.error("Expected two or three arguments.");const A=b[0];let M=w.parse(b[1],1,cn);if(!M)return null;if(!uf(A,M.type))return w.concat(1).error(`"${A}" comparisons are not supported for type '${$n(M.type)}'.`);let z=w.parse(b[2],2,cn);if(!z)return null;if(!uf(A,z.type))return w.concat(2).error(`"${A}" comparisons are not supported for type '${$n(z.type)}'.`);if(M.type.kind!==z.type.kind&&M.type.kind!=="value"&&z.type.kind!=="value")return w.error(`Cannot compare types '${$n(M.type)}' and '${$n(z.type)}'.`);d&&(M.type.kind==="value"&&z.type.kind!=="value"?M=new we(z.type,[M]):M.type.kind!=="value"&&z.type.kind==="value"&&(z=new we(M.type,[z])));let F=null;if(b.length===4){if(M.type.kind!=="string"&&z.type.kind!=="string"&&M.type.kind!=="value"&&z.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(F=w.parse(b[3],3,Is),!F)return null}return new qx(M,z,F)}evaluate(b){const w=this.lhs.evaluate(b),A=this.rhs.evaluate(b);if(d&&this.hasUntypedArgument){const M=gt(w),z=gt(A);if(M.kind!==z.kind||M.kind!=="string"&&M.kind!=="number")throw new zt(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${M.kind}, ${z.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const M=gt(w),z=gt(A);if(M.kind!=="string"||z.kind!=="string")return i(b,w,A)}return this.collator?u(b,w,A,this.collator.evaluate(b)):i(b,w,A)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[a];return this.eachChild(w=>{b.push(w.serialize())}),b}}}const pp=Xi("==",function(a,i,u){return i===u},oh),dp=Xi("!=",function(a,i,u){return i!==u},function(a,i,u,d){return!oh(0,i,u,d)}),gp=Xi("<",function(a,i,u){return i<u},function(a,i,u,d){return d.compare(i,u)<0}),mp=Xi(">",function(a,i,u){return i>u},function(a,i,u,d){return d.compare(i,u)>0}),_p=Xi("<=",function(a,i,u){return i<=u},function(a,i,u,d){return d.compare(i,u)<=0}),yp=Xi(">=",function(a,i,u){return i>=u},function(a,i,u,d){return d.compare(i,u)>=0});class vo{constructor(i,u,d,_,b){this.type=gn,this.number=i,this.locale=u,this.currency=d,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(i,u){if(i.length!==3)return u.error("Expected two arguments.");const d=u.parse(i[1],1,ue);if(!d)return null;const _=i[2];if(typeof _!="object"||Array.isArray(_))return u.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=u.parse(_.locale,1,gn),!b))return null;let w=null;if(_.currency&&(w=u.parse(_.currency,1,gn),!w))return null;let A=null;if(_["min-fraction-digits"]&&(A=u.parse(_["min-fraction-digits"],1,ue),!A))return null;let M=null;return _["max-fraction-digits"]&&(M=u.parse(_["max-fraction-digits"],1,ue),!M)?null:new vo(d,b,w,A,M)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class cf{constructor(i){this.type=ue,this.input=i}static parse(i,u){if(i.length!==2)return u.error(`Expected 1 argument, but found ${i.length-1} instead.`);const d=u.parse(i[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${$n(d.type)} instead.`):new cf(d):null}evaluate(i){const u=this.input.evaluate(i);if(typeof u=="string"||Array.isArray(u))return u.length;throw new zt(`Expected value to be of type string or array, but found ${$n(gt(u))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(u=>{i.push(u.serialize())}),i}}const Zi={"==":pp,"!=":dp,">":mp,"<":gp,">=":yp,"<=":_p,array:we,at:lf,boolean:we,case:gc,coalesce:eh,collator:zr,format:De,image:ke,in:rh,"index-of":ih,interpolate:os,"interpolate-hcl":os,"interpolate-lab":os,length:cf,let:nh,literal:te,match:Pi,number:we,"number-format":vo,object:we,slice:ua,step:Cu,string:we,"to-boolean":In,"to-color":In,"to-number":In,"to-string":In,var:uc,within:is};function vp(a,[i,u,d,_]){i=i.evaluate(a),u=u.evaluate(a),d=d.evaluate(a);const b=_?_.evaluate(a):1,w=ht(i,u,d,b);if(w)throw new zt(w);return new B(i/255*b,u/255*b,d/255*b,b)}function hf(a,i){return a in i}function ca(a,i){const u=i[a];return u===void 0?null:u}function ha(a){return{type:a}}function sh(a){return{result:"success",value:a}}function lr(a){return{result:"error",value:a}}function ss(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function ah(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ff(a){return!!a.expression&&a.expression.interpolated}function ln(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function lh(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function nr(a){return a}function uh(a,i){const u=i.type==="color",d=a.stops&&typeof a.stops[0][0]=="object",_=d||!(d||a.property!==void 0),b=a.type||(ff(i)?"exponential":"interval");if(u&&((a=Si({},a)).stops&&(a.stops=a.stops.map(z=>[z[0],B.parse(z[1])])),a.default=B.parse(a.default?a.default:i.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!fp[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let w,A,M;if(b==="exponential")w=pf;else if(b==="interval")w=Oa;else if(b==="categorical"){w=Er,A=Object.create(null);for(const z of a.stops)A[z[0]]=z[1];M=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);w=xp}if(d){const z={},F=[];for(let j=0;j<a.stops.length;j++){const H=a.stops[j],ut=H[0].zoom;z[ut]===void 0&&(z[ut]={zoom:ut,type:a.type,property:a.property,default:a.default,stops:[]},F.push(ut)),z[ut].stops.push([H[0].value,H[1]])}const U=[];for(const j of F)U.push([z[j].zoom,uh(z[j],i)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:os.interpolationFactor.bind(void 0,X),zoomStops:U.map(j=>j[0]),evaluate:({zoom:j},H)=>pf({stops:U,base:a.base},i,j).evaluate(j,H)}}if(_){const z=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:os.interpolationFactor.bind(void 0,z),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>w(a,i,F,A,M)}}return{kind:"source",evaluate(z,F){const U=F&&F.properties?F.properties[a.property]:void 0;return U===void 0?wr(a.default,i.default):w(a,i,U,A,M)}}}function wr(a,i,u){return a!==void 0?a:i!==void 0?i:u!==void 0?u:void 0}function Er(a,i,u,d,_){return wr(typeof u===_?d[u]:void 0,a.default,i.default)}function Oa(a,i,u){if(ln(u)!=="number")return wr(a.default,i.default);const d=a.stops.length;if(d===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[d-1][0])return a.stops[d-1][1];const _=fc(a.stops.map(b=>b[0]),u);return a.stops[_][1]}function pf(a,i,u){const d=a.base!==void 0?a.base:1;if(ln(u)!=="number")return wr(a.default,i.default);const _=a.stops.length;if(_===1||u<=a.stops[0][0])return a.stops[0][1];if(u>=a.stops[_-1][0])return a.stops[_-1][1];const b=fc(a.stops.map(F=>F[0]),u),w=function(F,U,X,j){const H=j-X,ut=F-X;return H===0?0:U===1?ut/H:(Math.pow(U,ut)-1)/(Math.pow(U,H)-1)}(u,d,a.stops[b][0],a.stops[b+1][0]),A=a.stops[b][1],M=a.stops[b+1][1];let z=Tu[i.type]||nr;if(a.colorSpace&&a.colorSpace!=="rgb"){const F=fp[a.colorSpace];z=(U,X)=>F.reverse(F.interpolate(F.forward(U),F.forward(X),w))}return typeof A.evaluate=="function"?{evaluate(...F){const U=A.evaluate.apply(void 0,F),X=M.evaluate.apply(void 0,F);if(U!==void 0&&X!==void 0)return z(U,X,w)}}:z(A,M,w)}function xp(a,i,u){return i.type==="color"?u=B.parse(u):i.type==="formatted"?u=nt.fromString(u.toString()):i.type==="resolvedImage"?u=dt.fromString(u.toString()):ln(u)===i.type||i.type==="enum"&&i.values[u]||(u=void 0),wr(u,a.default,i.default)}an.register(Zi,{error:[{kind:"error"},[gn],(a,[i])=>{throw new zt(i.evaluate(a))}],typeof:[gn,[cn],(a,[i])=>$n(gt(i.evaluate(a)))],"to-rgba":[Jr(ue,4),[Ci],(a,[i])=>i.evaluate(a).toArray()],rgb:[Ci,[ue,ue,ue],vp],rgba:[Ci,[ue,ue,ue,ue],vp],has:{type:tn,overloads:[[[gn],(a,[i])=>hf(i.evaluate(a),a.properties())],[[gn,ro],(a,[i,u])=>hf(i.evaluate(a),u.evaluate(a))]]},get:{type:cn,overloads:[[[gn],(a,[i])=>ca(i.evaluate(a),a.properties())],[[gn,ro],(a,[i,u])=>ca(i.evaluate(a),u.evaluate(a))]]},"feature-state":[cn,[gn],(a,[i])=>ca(i.evaluate(a),a.featureState||{})],properties:[ro,[],a=>a.properties()],"geometry-type":[gn,[],a=>a.geometryType()],id:[cn,[],a=>a.id()],zoom:[ue,[],a=>a.globals.zoom],"heatmap-density":[ue,[],a=>a.globals.heatmapDensity||0],"line-progress":[ue,[],a=>a.globals.lineProgress||0],accumulated:[cn,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[ue,ha(ue),(a,i)=>{let u=0;for(const d of i)u+=d.evaluate(a);return u}],"*":[ue,ha(ue),(a,i)=>{let u=1;for(const d of i)u*=d.evaluate(a);return u}],"-":{type:ue,overloads:[[[ue,ue],(a,[i,u])=>i.evaluate(a)-u.evaluate(a)],[[ue],(a,[i])=>-i.evaluate(a)]]},"/":[ue,[ue,ue],(a,[i,u])=>i.evaluate(a)/u.evaluate(a)],"%":[ue,[ue,ue],(a,[i,u])=>i.evaluate(a)%u.evaluate(a)],ln2:[ue,[],()=>Math.LN2],pi:[ue,[],()=>Math.PI],e:[ue,[],()=>Math.E],"^":[ue,[ue,ue],(a,[i,u])=>Math.pow(i.evaluate(a),u.evaluate(a))],sqrt:[ue,[ue],(a,[i])=>Math.sqrt(i.evaluate(a))],log10:[ue,[ue],(a,[i])=>Math.log(i.evaluate(a))/Math.LN10],ln:[ue,[ue],(a,[i])=>Math.log(i.evaluate(a))],log2:[ue,[ue],(a,[i])=>Math.log(i.evaluate(a))/Math.LN2],sin:[ue,[ue],(a,[i])=>Math.sin(i.evaluate(a))],cos:[ue,[ue],(a,[i])=>Math.cos(i.evaluate(a))],tan:[ue,[ue],(a,[i])=>Math.tan(i.evaluate(a))],asin:[ue,[ue],(a,[i])=>Math.asin(i.evaluate(a))],acos:[ue,[ue],(a,[i])=>Math.acos(i.evaluate(a))],atan:[ue,[ue],(a,[i])=>Math.atan(i.evaluate(a))],min:[ue,ha(ue),(a,i)=>Math.min(...i.map(u=>u.evaluate(a)))],max:[ue,ha(ue),(a,i)=>Math.max(...i.map(u=>u.evaluate(a)))],abs:[ue,[ue],(a,[i])=>Math.abs(i.evaluate(a))],round:[ue,[ue],(a,[i])=>{const u=i.evaluate(a);return u<0?-Math.round(-u):Math.round(u)}],floor:[ue,[ue],(a,[i])=>Math.floor(i.evaluate(a))],ceil:[ue,[ue],(a,[i])=>Math.ceil(i.evaluate(a))],"filter-==":[tn,[gn,cn],(a,[i,u])=>a.properties()[i.value]===u.value],"filter-id-==":[tn,[cn],(a,[i])=>a.id()===i.value],"filter-type-==":[tn,[gn],(a,[i])=>a.geometryType()===i.value],"filter-<":[tn,[gn,cn],(a,[i,u])=>{const d=a.properties()[i.value],_=u.value;return typeof d==typeof _&&d<_}],"filter-id-<":[tn,[cn],(a,[i])=>{const u=a.id(),d=i.value;return typeof u==typeof d&&u<d}],"filter->":[tn,[gn,cn],(a,[i,u])=>{const d=a.properties()[i.value],_=u.value;return typeof d==typeof _&&d>_}],"filter-id->":[tn,[cn],(a,[i])=>{const u=a.id(),d=i.value;return typeof u==typeof d&&u>d}],"filter-<=":[tn,[gn,cn],(a,[i,u])=>{const d=a.properties()[i.value],_=u.value;return typeof d==typeof _&&d<=_}],"filter-id-<=":[tn,[cn],(a,[i])=>{const u=a.id(),d=i.value;return typeof u==typeof d&&u<=d}],"filter->=":[tn,[gn,cn],(a,[i,u])=>{const d=a.properties()[i.value],_=u.value;return typeof d==typeof _&&d>=_}],"filter-id->=":[tn,[cn],(a,[i])=>{const u=a.id(),d=i.value;return typeof u==typeof d&&u>=d}],"filter-has":[tn,[cn],(a,[i])=>i.value in a.properties()],"filter-has-id":[tn,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[tn,[Jr(gn)],(a,[i])=>i.value.indexOf(a.geometryType())>=0],"filter-id-in":[tn,[Jr(cn)],(a,[i])=>i.value.indexOf(a.id())>=0],"filter-in-small":[tn,[gn,Jr(cn)],(a,[i,u])=>u.value.indexOf(a.properties()[i.value])>=0],"filter-in-large":[tn,[gn,Jr(cn)],(a,[i,u])=>function(d,_,b,w){for(;b<=w;){const A=b+w>>1;if(_[A]===d)return!0;_[A]>d?w=A-1:b=A+1}return!1}(a.properties()[i.value],u.value,0,u.value.length-1)],all:{type:tn,overloads:[[[tn,tn],(a,[i,u])=>i.evaluate(a)&&u.evaluate(a)],[ha(tn),(a,i)=>{for(const u of i)if(!u.evaluate(a))return!1;return!0}]]},any:{type:tn,overloads:[[[tn,tn],(a,[i,u])=>i.evaluate(a)||u.evaluate(a)],[ha(tn),(a,i)=>{for(const u of i)if(u.evaluate(a))return!0;return!1}]]},"!":[tn,[tn],(a,[i])=>!i.evaluate(a)],"is-supported-script":[tn,[gn],(a,[i])=>{const u=a.globals&&a.globals.isSupportedScript;return!u||u(i.evaluate(a))}],upcase:[gn,[gn],(a,[i])=>i.evaluate(a).toUpperCase()],downcase:[gn,[gn],(a,[i])=>i.evaluate(a).toLowerCase()],concat:[gn,ha(cn),(a,i)=>i.map(u=>Vt(u.evaluate(a))).join("")],"resolved-locale":[gn,[Is],(a,[i])=>i.evaluate(a).resolvedLocale()]});class ch{constructor(i,u){this.expression=i,this._warningHistory={},this._evaluator=new sn,this._defaultValue=u?function(d){return d.type==="color"&&lh(d.default)?new B(0,0,0,0):d.type==="color"?B.parse(d.default)||null:d.default===void 0?null:d.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(i,u,d,_,b,w){return this._evaluator.globals=i,this._evaluator.feature=u,this._evaluator.featureState=d,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(i,u,d,_,b,w){this._evaluator.globals=i,this._evaluator.feature=u||null,this._evaluator.featureState=d||null,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=w||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new zt(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function Au(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Zi}function Pu(a,i){const u=new cc(Zi,[],i?function(_){const b={color:Ci,string:gn,number:ue,enum:gn,boolean:tn,formatted:rs,resolvedImage:Us};return _.type==="array"?Jr(b[_.value]||cn,_.length):b[_.type]}(i):void 0),d=u.parse(a,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?sh(new ch(d,i)):lr(u.errors)}class mc{constructor(i,u){this.kind=i,this._styleExpression=u,this.isStateDependent=i!=="constant"&&!ll(u.expression)}evaluateWithoutErrorHandling(i,u,d,_,b,w){return this._styleExpression.evaluateWithoutErrorHandling(i,u,d,_,b,w)}evaluate(i,u,d,_,b,w){return this._styleExpression.evaluate(i,u,d,_,b,w)}}class hh{constructor(i,u,d,_){this.kind=i,this.zoomStops=d,this._styleExpression=u,this.isStateDependent=i!=="camera"&&!ll(u.expression),this.interpolationType=_}evaluateWithoutErrorHandling(i,u,d,_,b,w){return this._styleExpression.evaluateWithoutErrorHandling(i,u,d,_,b,w)}evaluate(i,u,d,_,b,w){return this._styleExpression.evaluate(i,u,d,_,b,w)}interpolationFactor(i,u,d){return this.interpolationType?os.interpolationFactor(this.interpolationType,i,u,d):0}}function _c(a,i){const u=Pu(a,i);if(u.result==="error")return u;const d=u.value.expression,_=al(d);if(!_&&!ss(i))return lr([new Qn("","data expressions not supported")]);const b=la(d,["zoom"]);if(!b&&!ah(i))return lr([new Qn("","zoom expressions not supported")]);const w=fh(d);return w||b?w instanceof Qn?lr([w]):w instanceof os&&!ff(i)?lr([new Qn("",'"interpolate" expressions cannot be used with this property')]):sh(w?new hh(_?"camera":"composite",u.value,w.labels,w instanceof os?w.interpolation:void 0):new mc(_?"constant":"source",u.value)):lr([new Qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ul{constructor(i,u){this._parameters=i,this._specification=u,Si(this,uh(this._parameters,this._specification))}static deserialize(i){return new ul(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function fh(a){let i=null;if(a instanceof nh)i=fh(a.result);else if(a instanceof eh){for(const u of a.args)if(i=fh(u),i)break}else(a instanceof Cu||a instanceof os)&&a.input instanceof an&&a.input.name==="zoom"&&(i=a);return i instanceof Qn||a.eachChild(u=>{const d=fh(u);d instanceof Qn?i=d:!i&&d?i=new Qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&d&&i!==d&&(i=new Qn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Ss(a){const i=a.key,u=a.value,d=a.valueSpec||{},_=a.objectElementValidators||{},b=a.style,w=a.styleSpec;let A=[];const M=ln(u);if(M!=="object")return[new ge(i,u,`object expected, ${M} found`)];for(const z in u){const F=z.split(".")[0],U=d[F]||d["*"];let X;if(_[F])X=_[F];else if(d[F])X=Oo;else if(_["*"])X=_["*"];else{if(!d["*"]){A.push(new ge(i,u[z],`unknown property "${z}"`));continue}X=Oo}A=A.concat(X({key:(i&&`${i}.`)+z,value:u[z],valueSpec:U,style:b,styleSpec:w,object:u,objectKey:z},u))}for(const z in d)_[z]||d[z].required&&d[z].default===void 0&&u[z]===void 0&&A.push(new ge(i,u,`missing required property "${z}"`));return A}function zo(a){const i=a.value,u=a.valueSpec,d=a.style,_=a.styleSpec,b=a.key,w=a.arrayElementValidator||Oo;if(ln(i)!=="array")return[new ge(b,i,`array expected, ${ln(i)} found`)];if(u.length&&i.length!==u.length)return[new ge(b,i,`array length ${u.length} expected, length ${i.length} found`)];if(u["min-length"]&&i.length<u["min-length"])return[new ge(b,i,`array length at least ${u["min-length"]} expected, length ${i.length} found`)];let A={type:u.value,values:u.values};_.$version<7&&(A.function=u.function),ln(u.value)==="object"&&(A=u.value);let M=[];for(let z=0;z<i.length;z++)M=M.concat(w({array:i,arrayIndex:z,value:i[z],valueSpec:A,style:d,styleSpec:_,key:`${b}[${z}]`}));return M}function ph(a){const i=a.key,u=a.value,d=a.valueSpec;let _=ln(u);return _==="number"&&u!=u&&(_="NaN"),_!=="number"?[new ge(i,u,`number expected, ${_} found`)]:"minimum"in d&&u<d.minimum?[new ge(i,u,`${u} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&u>d.maximum?[new ge(i,u,`${u} is greater than the maximum value ${d.maximum}`)]:[]}function Lu(a){const i=a.valueSpec,u=Bn(a.value.type);let d,_,b,w={};const A=u!=="categorical"&&a.value.property===void 0,M=!A,z=ln(a.value.stops)==="array"&&ln(a.value.stops[0])==="array"&&ln(a.value.stops[0][0])==="object",F=Ss({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(j){if(u==="identity")return[new ge(j.key,j.value,'identity function may not have a "stops" property')];let H=[];const ut=j.value;return H=H.concat(zo({key:j.key,value:ut,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:U})),ln(ut)==="array"&&ut.length===0&&H.push(new ge(j.key,ut,"array must have at least one stop")),H},default:function(j){return Oo({key:j.key,value:j.value,valueSpec:i,style:j.style,styleSpec:j.styleSpec})}}});return u==="identity"&&A&&F.push(new ge(a.key,a.value,'missing required property "property"')),u==="identity"||a.value.stops||F.push(new ge(a.key,a.value,'missing required property "stops"')),u==="exponential"&&a.valueSpec.expression&&!ff(a.valueSpec)&&F.push(new ge(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(M&&!ss(a.valueSpec)?F.push(new ge(a.key,a.value,"property functions not supported")):A&&!ah(a.valueSpec)&&F.push(new ge(a.key,a.value,"zoom functions not supported"))),u!=="categorical"&&!z||a.value.property!==void 0||F.push(new ge(a.key,a.value,'"property" property is required')),F;function U(j){let H=[];const ut=j.value,ct=j.key;if(ln(ut)!=="array")return[new ge(ct,ut,`array expected, ${ln(ut)} found`)];if(ut.length!==2)return[new ge(ct,ut,`array length 2 expected, length ${ut.length} found`)];if(z){if(ln(ut[0])!=="object")return[new ge(ct,ut,`object expected, ${ln(ut[0])} found`)];if(ut[0].zoom===void 0)return[new ge(ct,ut,"object stop key must have zoom")];if(ut[0].value===void 0)return[new ge(ct,ut,"object stop key must have value")];if(b&&b>Bn(ut[0].zoom))return[new ge(ct,ut[0].zoom,"stop zoom values must appear in ascending order")];Bn(ut[0].zoom)!==b&&(b=Bn(ut[0].zoom),_=void 0,w={}),H=H.concat(Ss({key:`${ct}[0]`,value:ut[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:ph,value:X}}))}else H=H.concat(X({key:`${ct}[0]`,value:ut[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},ut));return Au(Vn(ut[1]))?H.concat([new ge(`${ct}[1]`,ut[1],"expressions are not allowed in function stops.")]):H.concat(Oo({key:`${ct}[1]`,value:ut[1],valueSpec:i,style:j.style,styleSpec:j.styleSpec}))}function X(j,H){const ut=ln(j.value),ct=Bn(j.value),St=j.value!==null?j.value:H;if(d){if(ut!==d)return[new ge(j.key,St,`${ut} stop domain type must match previous stop domain type ${d}`)]}else d=ut;if(ut!=="number"&&ut!=="string"&&ut!=="boolean")return[new ge(j.key,St,"stop domain value must be a number, string, or boolean")];if(ut!=="number"&&u!=="categorical"){let Rt=`number expected, ${ut} found`;return ss(i)&&u===void 0&&(Rt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ge(j.key,St,Rt)]}return u!=="categorical"||ut!=="number"||isFinite(ct)&&Math.floor(ct)===ct?u!=="categorical"&&ut==="number"&&_!==void 0&&ct<_?[new ge(j.key,St,"stop domain values must appear in ascending order")]:(_=ct,u==="categorical"&&ct in w?[new ge(j.key,St,"stop domain values must be unique")]:(w[ct]=!0,[])):[new ge(j.key,St,`integer expected, found ${ct}`)]}}function Vl(a){const i=(a.expressionContext==="property"?_c:Pu)(Vn(a.value),a.valueSpec);if(i.result==="error")return i.value.map(d=>new ge(`${a.key}${d.key}`,a.value,d.message));const u=i.value.expression||i.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!u.outputDefined())return[new ge(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!ll(u))return[new ge(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!ll(u))return[new ge(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!la(u,["zoom","feature-state"]))return[new ge(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!al(u))return[new ge(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yc(a){const i=a.key,u=a.value,d=a.valueSpec,_=[];return Array.isArray(d.values)?d.values.indexOf(Bn(u))===-1&&_.push(new ge(i,u,`expected one of [${d.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(d.values).indexOf(Bn(u))===-1&&_.push(new ge(i,u,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(u)} found`)),_}function df(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const i of a.slice(1))if(!df(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}const bp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function dh(a){if(a==null)return{filter:()=>!0,needGeometry:!1};df(a)||(a=fa(a));const i=Pu(a,bp);if(i.result==="error")throw new Error(i.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,d,_)=>i.value.evaluate(u,d,{},_),needGeometry:wp(a)}}function gh(a,i){return a<i?-1:a>i?1:0}function wp(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let i=1;i<a.length;i++)if(wp(a[i]))return!0;return!1}function fa(a){if(!a)return!0;const i=a[0];return a.length<=1?i!=="any":i==="=="?gf(a[1],a[2],"=="):i==="!="?Gl(gf(a[1],a[2],"==")):i==="<"||i===">"||i==="<="||i===">="?gf(a[1],a[2],i):i==="any"?(u=a.slice(1),["any"].concat(u.map(fa))):i==="all"?["all"].concat(a.slice(1).map(fa)):i==="none"?["all"].concat(a.slice(1).map(fa).map(Gl)):i==="in"?mh(a[1],a.slice(2)):i==="!in"?Gl(mh(a[1],a.slice(2))):i==="has"?Mu(a[1]):i==="!has"?Gl(Mu(a[1])):i!=="within"||a;var u}function gf(a,i,u){switch(a){case"$type":return[`filter-type-${u}`,i];case"$id":return[`filter-id-${u}`,i];default:return[`filter-${u}`,a,i]}}function mh(a,i){if(i.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(u=>typeof u!=typeof i[0])?["filter-in-large",a,["literal",i.sort(gh)]]:["filter-in-small",a,["literal",i]]}}function Mu(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Gl(a){return["!",a]}function Cs(a){return df(Vn(a.value))?Vl(Si({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vc(a)}function vc(a){const i=a.value,u=a.key;if(ln(i)!=="array")return[new ge(u,i,`array expected, ${ln(i)} found`)];const d=a.styleSpec;let _,b=[];if(i.length<1)return[new ge(u,i,"filter array must have at least 1 element")];switch(b=b.concat(yc({key:`${u}[0]`,value:i[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),Bn(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&Bn(i[1])==="$type"&&b.push(new ge(u,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&b.push(new ge(u,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(_=ln(i[1]),_!=="string"&&b.push(new ge(`${u}[1]`,i[1],`string expected, ${_} found`)));for(let w=2;w<i.length;w++)_=ln(i[w]),Bn(i[1])==="$type"?b=b.concat(yc({key:`${u}[${w}]`,value:i[w],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&b.push(new ge(`${u}[${w}]`,i[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<i.length;w++)b=b.concat(vc({key:`${u}[${w}]`,value:i[w],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":_=ln(i[1]),i.length!==2?b.push(new ge(u,i,`filter array for "${i[0]}" operator must have 2 elements`)):_!=="string"&&b.push(new ge(`${u}[1]`,i[1],`string expected, ${_} found`));break;case"within":_=ln(i[1]),i.length!==2?b.push(new ge(u,i,`filter array for "${i[0]}" operator must have 2 elements`)):_!=="object"&&b.push(new ge(`${u}[1]`,i[1],`object expected, ${_} found`))}return b}function xc(a,i){const u=a.key,d=a.style,_=a.styleSpec,b=a.value,w=a.objectKey,A=_[`${i}_${a.layerType}`];if(!A)return[];const M=w.match(/^(.*)-transition$/);if(i==="paint"&&M&&A[M[1]]&&A[M[1]].transition)return Oo({key:u,value:b,valueSpec:_.transition,style:d,styleSpec:_});const z=a.valueSpec||A[w];if(!z)return[new ge(u,b,`unknown property "${w}"`)];let F;if(ln(b)==="string"&&ss(z)&&!z.tokens&&(F=/^{([^}]+)}$/.exec(b)))return[new ge(u,b,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const U=[];return a.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&U.push(new ge(u,b,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&lh(Vn(b))&&Bn(b.type)==="identity"&&U.push(new ge(u,b,'"text-font" does not support identity functions'))),U.concat(Oo({key:a.key,value:b,valueSpec:z,style:d,styleSpec:_,expressionContext:"property",propertyType:i,propertyKey:w}))}function Ip(a){return xc(a,"paint")}function Ep(a){return xc(a,"layout")}function ql(a){let i=[];const u=a.value,d=a.key,_=a.style,b=a.styleSpec;u.type||u.ref||i.push(new ge(d,u,'either "type" or "ref" is required'));let w=Bn(u.type);const A=Bn(u.ref);if(u.id){const M=Bn(u.id);for(let z=0;z<a.arrayIndex;z++){const F=_.layers[z];Bn(F.id)===M&&i.push(new ge(d,u.id,`duplicate layer id "${u.id}", previously used at line ${F.id.__line__}`))}}if("ref"in u){let M;["type","source","source-layer","filter","layout"].forEach(z=>{z in u&&i.push(new ge(d,u[z],`"${z}" is prohibited for ref layers`))}),_.layers.forEach(z=>{Bn(z.id)===A&&(M=z)}),M?M.ref?i.push(new ge(d,u.ref,"ref cannot reference another ref layer")):w=Bn(M.type):i.push(new ge(d,u.ref,`ref layer "${A}" not found`))}else if(w!=="background")if(u.source){const M=_.sources&&_.sources[u.source],z=M&&Bn(M.type);M?z==="vector"&&w==="raster"?i.push(new ge(d,u.source,`layer "${u.id}" requires a raster source`)):z==="raster"&&w!=="raster"?i.push(new ge(d,u.source,`layer "${u.id}" requires a vector source`)):z!=="vector"||u["source-layer"]?z==="raster-dem"&&w!=="hillshade"?i.push(new ge(d,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!u.paint||!u.paint["line-gradient"]||z==="geojson"&&M.lineMetrics||i.push(new ge(d,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new ge(d,u,`layer "${u.id}" must specify a "source-layer"`)):i.push(new ge(d,u.source,`source "${u.source}" not found`))}else i.push(new ge(d,u,'missing required property "source"'));return i=i.concat(Ss({key:d,value:u,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Oo({key:`${d}.type`,value:u.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,object:u,objectKey:"type"}),filter:Cs,layout:M=>Ss({layer:u,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":z=>Ep(Si({layerType:w},z))}}),paint:M=>Ss({layer:u,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":z=>Ip(Si({layerType:w},z))}})}})),i}function oo(a){const i=a.value,u=a.key,d=ln(i);return d!=="string"?[new ge(u,i,`string expected, ${d} found`)]:[]}const mf={promoteId:function({key:a,value:i}){if(ln(i)==="string")return oo({key:a,value:i});{const u=[];for(const d in i)u.push(...oo({key:`${a}.${d}`,value:i[d]}));return u}}};function bc(a){const i=a.value,u=a.key,d=a.styleSpec,_=a.style;if(!i.type)return[new ge(u,i,'"type" is required')];const b=Bn(i.type);let w;switch(b){case"vector":case"raster":case"raster-dem":return w=Ss({key:u,value:i,valueSpec:d[`source_${b.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:mf}),w;case"geojson":if(w=Ss({key:u,value:i,valueSpec:d.source_geojson,style:_,styleSpec:d,objectElementValidators:mf}),i.cluster)for(const A in i.clusterProperties){const[M,z]=i.clusterProperties[A],F=typeof M=="string"?[M,["accumulated"],["get",A]]:M;w.push(...Vl({key:`${u}.${A}.map`,value:z,expressionContext:"cluster-map"})),w.push(...Vl({key:`${u}.${A}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return w;case"video":return Ss({key:u,value:i,valueSpec:d.source_video,style:_,styleSpec:d});case"image":return Ss({key:u,value:i,valueSpec:d.source_image,style:_,styleSpec:d});case"canvas":return[new ge(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yc({key:`${u}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:d})}}function wc(a){const i=a.value,u=a.styleSpec,d=u.light,_=a.style;let b=[];const w=ln(i);if(i===void 0)return b;if(w!=="object")return b=b.concat([new ge("light",i,`object expected, ${w} found`)]),b;for(const A in i){const M=A.match(/^(.*)-transition$/);b=b.concat(M&&d[M[1]]&&d[M[1]].transition?Oo({key:A,value:i[A],valueSpec:u.transition,style:_,styleSpec:u}):d[A]?Oo({key:A,value:i[A],valueSpec:d[A],style:_,styleSpec:u}):[new ge(A,i[A],`unknown property "${A}"`)])}return b}const as={"*":()=>[],array:zo,boolean:function(a){const i=a.value,u=a.key,d=ln(i);return d!=="boolean"?[new ge(u,i,`boolean expected, ${d} found`)]:[]},number:ph,color:function(a){const i=a.key,u=a.value,d=ln(u);return d!=="string"?[new ge(i,u,`color expected, ${d} found`)]:yo(u)===null?[new ge(i,u,`color expected, "${u}" found`)]:[]},constants:no,enum:yc,filter:Cs,function:Lu,layer:ql,object:Ss,source:bc,light:wc,string:oo,formatted:function(a){return oo(a).length===0?[]:Vl(a)},resolvedImage:function(a){return oo(a).length===0?[]:Vl(a)}};function Oo(a){const i=a.value,u=a.valueSpec,d=a.styleSpec;return u.expression&&lh(Bn(i))?Lu(a):u.expression&&Au(Vn(i))?Vl(a):u.type&&as[u.type]?as[u.type](a):Ss(Si({},a,{valueSpec:u.type?d[u.type]:u}))}function ng(a){const i=a.value,u=a.key,d=oo(a);return d.length||(i.indexOf("{fontstack}")===-1&&d.push(new ge(u,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&d.push(new ge(u,i,'"glyphs" url must include a "{range}" token'))),d}function Ts(a,i=Bt){let u=[];return u=u.concat(Oo({key:"",value:a,valueSpec:i.$root,styleSpec:i,style:a,objectElementValidators:{glyphs:ng,"*":()=>[]}})),a.constants&&(u=u.concat(no({key:"constants",value:a.constants,style:a,styleSpec:i}))),Et(u)}function Et(a){return[].concat(a).sort((i,u)=>i.line-u.line)}function jt(a){return function(...i){return Et(a.apply(this,i))}}Ts.source=jt(bc),Ts.light=jt(wc),Ts.layer=jt(ql),Ts.filter=jt(Cs),Ts.paintProperty=jt(Ip),Ts.layoutProperty=jt(Ep);const Nt=Ts,Fe=Nt.light,mn=Nt.paintProperty,rr=Nt.layoutProperty;function gi(a,i){let u=!1;if(i&&i.length)for(const d of i)a.fire(new Bs(new Error(d.message))),u=!0;return u}class Yn{constructor(i,u,d){const _=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const w=new Int32Array(this.arrayBuffer);i=w[0],this.d=(u=w[1])+2*(d=w[2]);for(let M=0;M<this.d*this.d;M++){const z=w[3+M],F=w[3+M+1];_.push(z===F?null:w.subarray(z,F))}const A=w[3+_.length+1];this.keys=w.subarray(w[3+_.length],A),this.bboxes=w.subarray(A),this.insert=this._insertReadonly}else{this.d=u+2*d;for(let w=0;w<this.d*this.d;w++)_.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=i,this.padding=d,this.scale=u/i,this.uid=0;const b=d/u*i;this.min=-b,this.max=i+b}insert(i,u,d,_,b){this._forEachCell(u,d,_,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(_),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,u,d,_,b,w){this.cells[b].push(w)}query(i,u,d,_,b){const w=this.min,A=this.max;if(i<=w&&u<=w&&A<=d&&A<=_&&!b)return Array.prototype.slice.call(this.keys);{const M=[];return this._forEachCell(i,u,d,_,this._queryCell,M,{},b),M}}_queryCell(i,u,d,_,b,w,A,M){const z=this.cells[b];if(z!==null){const F=this.keys,U=this.bboxes;for(let X=0;X<z.length;X++){const j=z[X];if(A[j]===void 0){const H=4*j;(M?M(U[H+0],U[H+1],U[H+2],U[H+3]):i<=U[H+2]&&u<=U[H+3]&&d>=U[H+0]&&_>=U[H+1])?(A[j]=!0,w.push(F[j])):A[j]=!1}}}}_forEachCell(i,u,d,_,b,w,A,M){const z=this._convertToCellCoord(i),F=this._convertToCellCoord(u),U=this._convertToCellCoord(d),X=this._convertToCellCoord(_);for(let j=z;j<=U;j++)for(let H=F;H<=X;H++){const ut=this.d*H+j;if((!M||M(this._convertFromCellCoord(j),this._convertFromCellCoord(H),this._convertFromCellCoord(j+1),this._convertFromCellCoord(H+1)))&&b.call(this,i,u,d,_,ut,w,A,M))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,u=3+this.cells.length+1+1;let d=0;for(let w=0;w<this.cells.length;w++)d+=this.cells[w].length;const _=new Int32Array(u+d+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let b=u;for(let w=0;w<i.length;w++){const A=i[w];_[3+w]=b,_.set(A,b),b+=A.length}return _[3+i.length]=b,_.set(this.keys,b),b+=this.keys.length,_[3+i.length+1]=b,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer}static serialize(i,u){const d=i.toArrayBuffer();return u&&u.push(d),{buffer:d}}static deserialize(i){return new Yn(i.buffer)}}const cl={};function Ne(a,i,u={}){Object.defineProperty(i,"_classRegistryKey",{value:a,writeable:!1}),cl[a]={klass:i,omit:u.omit||[],shallow:u.shallow||[]}}Ne("Object",Object),Ne("TransferableGridIndex",Yn),Ne("Color",B),Ne("Error",Error),Ne("AJAXError",Kr),Ne("ResolvedImage",dt),Ne("StylePropertyFunction",ul),Ne("StyleExpression",ch,{omit:["_evaluator"]}),Ne("ZoomDependentExpression",hh),Ne("ZoomConstantExpression",mc),Ne("CompoundExpression",an,{omit:["_evaluate"]});for(const a in Zi)Zi[a]._classRegistryKey||Ne(`Expression_${a}`,Zi[a]);function ko(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function hl(a,i){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(ko(a)||Ft(a))return i&&i.push(a),a;if(ArrayBuffer.isView(a)){const u=a;return i&&i.push(u.buffer),u}if(a instanceof ImageData)return i&&i.push(a.data.buffer),a;if(Array.isArray(a)){const u=[];for(const d of a)u.push(hl(d,i));return u}if(typeof a=="object"){const u=a.constructor,d=u._classRegistryKey;if(!d)throw new Error("can't serialize object of unregistered class");const _=u.serialize?u.serialize(a,i):{};if(!u.serialize){for(const b in a){if(!a.hasOwnProperty(b)||cl[d].omit.indexOf(b)>=0)continue;const w=a[b];_[b]=cl[d].shallow.indexOf(b)>=0?w:hl(w,i)}a instanceof Error&&(_.message=a.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(_.$name=d),_}throw new Error("can't serialize object of type "+typeof a)}function Xl(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||ko(a)||Ft(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Xl);if(typeof a=="object"){const i=a.$name||"Object";if(!cl[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:u}=cl[i];if(!u)throw new Error(`can't deserialize unregistered class ${i}`);if(u.deserialize)return u.deserialize(a);const d=Object.create(u.prototype);for(const _ of Object.keys(a)){if(_==="$name")continue;const b=a[_];d[_]=cl[i].shallow.indexOf(_)>=0?b:Xl(b)}return d}throw new Error("can't deserialize object of type "+typeof a)}class pa{constructor(){this.first=!0}update(i,u){const d=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=u),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=d,!0))}}const be={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Du(a){for(const i of a)if(Nu(i.charCodeAt(0)))return!0;return!1}function ur(a){for(const i of a)if(!rg(i.charCodeAt(0)))return!1;return!0}function rg(a){return!(be.Arabic(a)||be["Arabic Supplement"](a)||be["Arabic Extended-A"](a)||be["Arabic Presentation Forms-A"](a)||be["Arabic Presentation Forms-B"](a))}function Nu(a){return!(a!==746&&a!==747&&(a<4352||!(be["Bopomofo Extended"](a)||be.Bopomofo(a)||be["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||be["CJK Compatibility Ideographs"](a)||be["CJK Compatibility"](a)||be["CJK Radicals Supplement"](a)||be["CJK Strokes"](a)||!(!be["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||be["CJK Unified Ideographs Extension A"](a)||be["CJK Unified Ideographs"](a)||be["Enclosed CJK Letters and Months"](a)||be["Hangul Compatibility Jamo"](a)||be["Hangul Jamo Extended-A"](a)||be["Hangul Jamo Extended-B"](a)||be["Hangul Jamo"](a)||be["Hangul Syllables"](a)||be.Hiragana(a)||be["Ideographic Description Characters"](a)||be.Kanbun(a)||be["Kangxi Radicals"](a)||be["Katakana Phonetic Extensions"](a)||be.Katakana(a)&&a!==12540||!(!be["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!be["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||be["Unified Canadian Aboriginal Syllabics"](a)||be["Unified Canadian Aboriginal Syllabics Extended"](a)||be["Vertical Forms"](a)||be["Yijing Hexagram Symbols"](a)||be["Yi Syllables"](a)||be["Yi Radicals"](a))))}function Ic(a){return!(Nu(a)||function(i){return!!(be["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||be["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||be["Letterlike Symbols"](i)||be["Number Forms"](i)||be["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||be["Control Pictures"](i)&&i!==9251||be["Optical Character Recognition"](i)||be["Enclosed Alphanumerics"](i)||be["Geometric Shapes"](i)||be["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||be["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||be["CJK Symbols and Punctuation"](i)||be.Katakana(i)||be["Private Use Area"](i)||be["CJK Compatibility Forms"](i)||be["Small Form Variants"](i)||be["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(a))}function Sp(a){return a>=1424&&a<=2303||be["Arabic Presentation Forms-A"](a)||be["Arabic Presentation Forms-B"](a)}function ig(a,i){return!(!i&&Sp(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||be.Khmer(a))}function og(a){for(const i of a)if(Sp(i.charCodeAt(0)))return!0;return!1}const Zl="deferred",da="loading",Ru="loaded";let _h=null,Yi="unavailable",ka=null;const _f=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(Yi="error"),_h&&_h(a)};function zu(){Yl.fire(new bn("pluginStateChange",{pluginStatus:Yi,pluginURL:ka}))}const Yl=new ns,Wl=function(){return Yi},ga=function(){if(Yi!==Zl||!ka)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Yi=da,zu(),ka&&ai({url:ka},a=>{a?_f(a):(Yi=Ru,zu())})},xo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Yi===Ru||xo.applyArabicShaping!=null,isLoading:()=>Yi===da,setState(a){Yi=a.pluginStatus,ka=a.pluginURL},isParsed:()=>xo.applyArabicShaping!=null&&xo.processBidirectionalText!=null&&xo.processStyledBidirectionalText!=null,getPluginURL:()=>ka};class Sr{constructor(i,u){this.zoom=i,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pa,this.transition={})}isSupportedScript(i){return function(u,d){for(const _ of u)if(!ig(_.charCodeAt(0),d))return!1;return!0}(i,xo.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,u=i-Math.floor(i),d=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*u}}}class yh{constructor(i,u){this.property=i,this.value=u,this.expression=function(d,_){if(lh(d))return new ul(d,_);if(Au(d)){const b=_c(d,_);if(b.result==="error")throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));return b.value}{let b=d;return typeof d=="string"&&_.type==="color"&&(b=B.parse(d)),{kind:"constant",evaluate:()=>b}}}(u===void 0?i.specification.default:u,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,u,d){return this.property.possiblyEvaluate(this,i,u,d)}}class vh{constructor(i){this.property=i,this.value=new yh(i,void 0)}transitioned(i,u){return new Ec(this.property,this.value,u,Y({},i.transition,this.transition),i.now)}untransitioned(){return new Ec(this.property,this.value,null,{},0)}}class Ou{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return xt(this._values[i].value.value)}setValue(i,u){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new vh(this._values[i].property)),this._values[i].value=new yh(this._values[i].property,u===null?void 0:xt(u))}getTransition(i){return xt(this._values[i].transition)}setTransition(i,u){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new vh(this._values[i].property)),this._values[i].transition=xt(u)||void 0}serialize(){const i={};for(const u of Object.keys(this._values)){const d=this.getValue(u);d!==void 0&&(i[u]=d);const _=this.getTransition(u);_!==void 0&&(i[`${u}-transition`]=_)}return i}transitioned(i,u){const d=new xh(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].transitioned(i,u._values[_]);return d}untransitioned(){const i=new xh(this._properties);for(const u of Object.keys(this._values))i._values[u]=this._values[u].untransitioned();return i}}class Ec{constructor(i,u,d,_,b){this.property=i,this.value=u,this.begin=b+_.delay||0,this.end=this.begin+_.duration||0,i.specification.transition&&(_.delay||_.duration)&&(this.prior=d)}possiblyEvaluate(i,u,d){const _=i.now||0,b=this.value.possiblyEvaluate(i,u,d),w=this.prior;if(w){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return w.possiblyEvaluate(i,u,d);{const A=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(i,u,d),b,function(M){if(M<=0)return 0;if(M>=1)return 1;const z=M*M,F=z*M;return 4*(M<.5?F:3*(M-z)+F-.75)}(A))}}return b}}class xh{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,u,d){const _=new bh(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(i,u,d);return _}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class sg{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return xt(this._values[i].value)}setValue(i,u){this._values[i]=new yh(this._values[i].property,u===null?void 0:xt(u))}serialize(){const i={};for(const u of Object.keys(this._values)){const d=this.getValue(u);d!==void 0&&(i[u]=d)}return i}possiblyEvaluate(i,u,d){const _=new bh(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(i,u,d);return _}}class Xs{constructor(i,u,d){this.property=i,this.value=u,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,u,d,_){return this.property.evaluate(this.value,this.parameters,i,u,d,_)}}class bh{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Be{constructor(i){this.specification=i}possiblyEvaluate(i,u){return i.expression.evaluate(u)}interpolate(i,u,d){const _=Tu[this.specification.type];return _?_(i,u,d):i}}class Le{constructor(i,u){this.specification=i,this.overrides=u}possiblyEvaluate(i,u,d,_){return new Xs(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(u,null,{},d,_)}:i.expression,u)}interpolate(i,u,d){if(i.value.kind!=="constant"||u.value.kind!=="constant")return i;if(i.value.value===void 0||u.value.value===void 0)return new Xs(this,{kind:"constant",value:void 0},i.parameters);const _=Tu[this.specification.type];return _?new Xs(this,{kind:"constant",value:_(i.value.value,u.value.value,d)},i.parameters):i}evaluate(i,u,d,_,b,w){return i.kind==="constant"?i.value:i.evaluate(u,d,_,b,w)}}class mi extends Le{possiblyEvaluate(i,u,d,_){if(i.value===void 0)return new Xs(this,{kind:"constant",value:void 0},u);if(i.expression.kind==="constant"){const b=i.expression.evaluate(u,null,{},d,_),w=i.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,A=this._calculate(w,w,w,u);return new Xs(this,{kind:"constant",value:A},u)}if(i.expression.kind==="camera"){const b=this._calculate(i.expression.evaluate({zoom:u.zoom-1}),i.expression.evaluate({zoom:u.zoom}),i.expression.evaluate({zoom:u.zoom+1}),u);return new Xs(this,{kind:"constant",value:b},u)}return new Xs(this,i.expression,u)}evaluate(i,u,d,_,b,w){if(i.kind==="source"){const A=i.evaluate(u,d,_,b,w);return this._calculate(A,A,A,u)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(u.zoom)-1},d,_),i.evaluate({zoom:Math.floor(u.zoom)},d,_),i.evaluate({zoom:Math.floor(u.zoom)+1},d,_),u):i.value}_calculate(i,u,d,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:d,to:u}}interpolate(i){return i}}class Sc{constructor(i){this.specification=i}possiblyEvaluate(i,u,d,_){if(i.value!==void 0){if(i.expression.kind==="constant"){const b=i.expression.evaluate(u,null,{},d,_);return this._calculate(b,b,b,u)}return this._calculate(i.expression.evaluate(new Sr(Math.floor(u.zoom-1),u)),i.expression.evaluate(new Sr(Math.floor(u.zoom),u)),i.expression.evaluate(new Sr(Math.floor(u.zoom+1),u)),u)}}_calculate(i,u,d,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:i,to:u}:{from:d,to:u}}interpolate(i){return i}}class yf{constructor(i){this.specification=i}possiblyEvaluate(i,u,d,_){return!!i.expression.evaluate(u,null,{},d,_)}interpolate(){return!1}}class _i{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in i){const d=i[u];d.specification.overridable&&this.overridableProperties.push(u);const _=this.defaultPropertyValues[u]=new yh(d,void 0),b=this.defaultTransitionablePropertyValues[u]=new vh(d);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=_.possiblyEvaluate({})}}}Ne("DataDrivenProperty",Le),Ne("DataConstantProperty",Be),Ne("CrossFadedDataDrivenProperty",mi),Ne("CrossFadedProperty",Sc),Ne("ColorRampProperty",yf);const jl="-transition";class so extends ns{constructor(i,u){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),u.layout&&(this._unevaluatedLayout=new sg(u.layout)),u.paint)){this._transitionablePaint=new Ou(u.paint);for(const d in i.paint)this.setPaintProperty(d,i.paint[d],{validate:!1});for(const d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new bh(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,u,d={}){u!=null&&this._validate(rr,`layers.${this.id}.layout.${i}`,i,u,d)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,u):this.visibility=u)}getPaintProperty(i){return i.endsWith(jl)?this._transitionablePaint.getTransition(i.slice(0,-jl.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,u,d={}){if(u!=null&&this._validate(mn,`layers.${this.id}.paint.${i}`,i,u,d))return!1;if(i.endsWith(jl))return this._transitionablePaint.setTransition(i.slice(0,-jl.length),u||void 0),!1;{const _=this._transitionablePaint._values[i],b=_.property.specification["property-type"]==="cross-faded-data-driven",w=_.value.isDataDriven(),A=_.value;this._transitionablePaint.setValue(i,u),this._handleSpecialPaintPropertyUpdate(i);const M=this._transitionablePaint._values[i].value;return M.isDataDriven()||w||b||this._handleOverridablePaintPropertyUpdate(i,A,M)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,u,d){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,u){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,u)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),wt(i,(u,d)=>!(u===void 0||d==="layout"&&!Object.keys(u).length||d==="paint"&&!Object.keys(u).length))}_validate(i,u,d,_,b={}){return(!b||b.validate!==!1)&&gi(this,i.call(Nt,{key:u,layerType:this.type,objectKey:d,value:_,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const u=this.paint.get(i);if(u instanceof Xs&&ss(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const Cc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Hl{constructor(i,u){this._structArray=i,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ir{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,u){return i._trim(),u&&(i.isTransferred=!0,u.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const u=Object.create(this.prototype);return u.arrayBuffer=i.arrayBuffer,u.length=i.length,u.capacity=i.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Or(a,i=1){let u=0,d=0;return{members:a.map(_=>{const b=Cc[_.type].BYTES_PER_ELEMENT,w=u=ku(u,Math.max(i,b)),A=_.components||1;return d=Math.max(d,b),u+=b*A,{name:_.name,type:_.type,components:A,offset:w}}),size:ku(u,Math.max(d,i)),alignment:i}}function ku(a,i){return Math.ceil(a/i)*i}class Fa extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u){const d=this.length;return this.resize(d+1),this.emplace(d,i,u)}emplace(i,u,d){const _=2*i;return this.int16[_+0]=u,this.int16[_+1]=d,i}}Fa.prototype.bytesPerElement=4,Ne("StructArrayLayout2i4",Fa);class ma extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d,_){const b=this.length;return this.resize(b+1),this.emplace(b,i,u,d,_)}emplace(i,u,d,_,b){const w=4*i;return this.int16[w+0]=u,this.int16[w+1]=d,this.int16[w+2]=_,this.int16[w+3]=b,i}}ma.prototype.bytesPerElement=8,Ne("StructArrayLayout4i8",ma);class y extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,u,d,_,b,w)}emplace(i,u,d,_,b,w,A){const M=6*i;return this.int16[M+0]=u,this.int16[M+1]=d,this.int16[M+2]=_,this.int16[M+3]=b,this.int16[M+4]=w,this.int16[M+5]=A,i}}y.prototype.bytesPerElement=12,Ne("StructArrayLayout2i4i12",y);class o extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,u,d,_,b,w)}emplace(i,u,d,_,b,w,A){const M=4*i,z=8*i;return this.int16[M+0]=u,this.int16[M+1]=d,this.uint8[z+4]=_,this.uint8[z+5]=b,this.uint8[z+6]=w,this.uint8[z+7]=A,i}}o.prototype.bytesPerElement=8,Ne("StructArrayLayout2i4ub8",o);class h extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u){const d=this.length;return this.resize(d+1),this.emplace(d,i,u)}emplace(i,u,d){const _=2*i;return this.float32[_+0]=u,this.float32[_+1]=d,i}}h.prototype.bytesPerElement=8,Ne("StructArrayLayout2f8",h);class m extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w,A,M,z,F){const U=this.length;return this.resize(U+1),this.emplace(U,i,u,d,_,b,w,A,M,z,F)}emplace(i,u,d,_,b,w,A,M,z,F,U){const X=10*i;return this.uint16[X+0]=u,this.uint16[X+1]=d,this.uint16[X+2]=_,this.uint16[X+3]=b,this.uint16[X+4]=w,this.uint16[X+5]=A,this.uint16[X+6]=M,this.uint16[X+7]=z,this.uint16[X+8]=F,this.uint16[X+9]=U,i}}m.prototype.bytesPerElement=20,Ne("StructArrayLayout10ui20",m);class v extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w,A,M,z,F,U,X){const j=this.length;return this.resize(j+1),this.emplace(j,i,u,d,_,b,w,A,M,z,F,U,X)}emplace(i,u,d,_,b,w,A,M,z,F,U,X,j){const H=12*i;return this.int16[H+0]=u,this.int16[H+1]=d,this.int16[H+2]=_,this.int16[H+3]=b,this.uint16[H+4]=w,this.uint16[H+5]=A,this.uint16[H+6]=M,this.uint16[H+7]=z,this.int16[H+8]=F,this.int16[H+9]=U,this.int16[H+10]=X,this.int16[H+11]=j,i}}v.prototype.bytesPerElement=24,Ne("StructArrayLayout4i4ui4i24",v);class E extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,d){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,d)}emplace(i,u,d,_){const b=3*i;return this.float32[b+0]=u,this.float32[b+1]=d,this.float32[b+2]=_,i}}E.prototype.bytesPerElement=12,Ne("StructArrayLayout3f12",E);class L extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.uint32[1*i+0]=u,i}}L.prototype.bytesPerElement=4,Ne("StructArrayLayout1ul4",L);class N extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w,A,M,z){const F=this.length;return this.resize(F+1),this.emplace(F,i,u,d,_,b,w,A,M,z)}emplace(i,u,d,_,b,w,A,M,z,F){const U=10*i,X=5*i;return this.int16[U+0]=u,this.int16[U+1]=d,this.int16[U+2]=_,this.int16[U+3]=b,this.int16[U+4]=w,this.int16[U+5]=A,this.uint32[X+3]=M,this.uint16[U+8]=z,this.uint16[U+9]=F,i}}N.prototype.bytesPerElement=20,Ne("StructArrayLayout6i1ul2ui20",N);class C extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,u,d,_,b,w)}emplace(i,u,d,_,b,w,A){const M=6*i;return this.int16[M+0]=u,this.int16[M+1]=d,this.int16[M+2]=_,this.int16[M+3]=b,this.int16[M+4]=w,this.int16[M+5]=A,i}}C.prototype.bytesPerElement=12,Ne("StructArrayLayout2i2i2i12",C);class k extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,i,u,d,_,b)}emplace(i,u,d,_,b,w){const A=4*i,M=8*i;return this.float32[A+0]=u,this.float32[A+1]=d,this.float32[A+2]=_,this.int16[M+6]=b,this.int16[M+7]=w,i}}k.prototype.bytesPerElement=16,Ne("StructArrayLayout2f1f2i16",k);class V extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,d,_){const b=this.length;return this.resize(b+1),this.emplace(b,i,u,d,_)}emplace(i,u,d,_,b){const w=12*i,A=3*i;return this.uint8[w+0]=u,this.uint8[w+1]=d,this.float32[A+1]=_,this.float32[A+2]=b,i}}V.prototype.bytesPerElement=12,Ne("StructArrayLayout2ub2f12",V);class Z extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,d){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,d)}emplace(i,u,d,_){const b=3*i;return this.uint16[b+0]=u,this.uint16[b+1]=d,this.uint16[b+2]=_,i}}Z.prototype.bytesPerElement=6,Ne("StructArrayLayout3ui6",Z);class W extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St){const Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St)}emplace(i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St,Rt){const Lt=24*i,qt=12*i,ne=48*i;return this.int16[Lt+0]=u,this.int16[Lt+1]=d,this.uint16[Lt+2]=_,this.uint16[Lt+3]=b,this.uint32[qt+2]=w,this.uint32[qt+3]=A,this.uint32[qt+4]=M,this.uint16[Lt+10]=z,this.uint16[Lt+11]=F,this.uint16[Lt+12]=U,this.float32[qt+7]=X,this.float32[qt+8]=j,this.uint8[ne+36]=H,this.uint8[ne+37]=ut,this.uint8[ne+38]=ct,this.uint32[qt+10]=St,this.int16[Lt+22]=Rt,i}}W.prototype.bytesPerElement=48,Ne("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",W);class ot extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St,Rt,Lt,qt,ne,Qt,Me,Ue,Ee,Se,_e,Pe){const Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St,Rt,Lt,qt,ne,Qt,Me,Ue,Ee,Se,_e,Pe)}emplace(i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut,ct,St,Rt,Lt,qt,ne,Qt,Me,Ue,Ee,Se,_e,Pe,Ce){const ce=34*i,He=17*i;return this.int16[ce+0]=u,this.int16[ce+1]=d,this.int16[ce+2]=_,this.int16[ce+3]=b,this.int16[ce+4]=w,this.int16[ce+5]=A,this.int16[ce+6]=M,this.int16[ce+7]=z,this.uint16[ce+8]=F,this.uint16[ce+9]=U,this.uint16[ce+10]=X,this.uint16[ce+11]=j,this.uint16[ce+12]=H,this.uint16[ce+13]=ut,this.uint16[ce+14]=ct,this.uint16[ce+15]=St,this.uint16[ce+16]=Rt,this.uint16[ce+17]=Lt,this.uint16[ce+18]=qt,this.uint16[ce+19]=ne,this.uint16[ce+20]=Qt,this.uint16[ce+21]=Me,this.uint16[ce+22]=Ue,this.uint32[He+12]=Ee,this.float32[He+13]=Se,this.float32[He+14]=_e,this.float32[He+15]=Pe,this.float32[He+16]=Ce,i}}ot.prototype.bytesPerElement=68,Ne("StructArrayLayout8i15ui1ul4f68",ot);class J extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.float32[1*i+0]=u,i}}J.prototype.bytesPerElement=4,Ne("StructArrayLayout1f4",J);class it extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,u,d){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,d)}emplace(i,u,d,_){const b=3*i;return this.int16[b+0]=u,this.int16[b+1]=d,this.int16[b+2]=_,i}}it.prototype.bytesPerElement=6,Ne("StructArrayLayout3i6",it);class mt extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u,d){const _=this.length;return this.resize(_+1),this.emplace(_,i,u,d)}emplace(i,u,d,_){const b=4*i;return this.uint32[2*i+0]=u,this.uint16[b+2]=d,this.uint16[b+3]=_,i}}mt.prototype.bytesPerElement=8,Ne("StructArrayLayout1ul2ui8",mt);class yt extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,u){const d=this.length;return this.resize(d+1),this.emplace(d,i,u)}emplace(i,u,d){const _=2*i;return this.uint16[_+0]=u,this.uint16[_+1]=d,i}}yt.prototype.bytesPerElement=4,Ne("StructArrayLayout2ui4",yt);class Tt extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const u=this.length;return this.resize(u+1),this.emplace(u,i)}emplace(i,u){return this.uint16[1*i+0]=u,i}}Tt.prototype.bytesPerElement=2,Ne("StructArrayLayout1ui2",Tt);class bt extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,u,d,_){const b=this.length;return this.resize(b+1),this.emplace(b,i,u,d,_)}emplace(i,u,d,_,b){const w=4*i;return this.float32[w+0]=u,this.float32[w+1]=d,this.float32[w+2]=_,this.float32[w+3]=b,i}}bt.prototype.bytesPerElement=16,Ne("StructArrayLayout4f16",bt);class Kt extends Hl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Jt(this.anchorPointX,this.anchorPointY)}}Kt.prototype.size=20;class Ut extends N{get(i){return new Kt(this,i)}}Ne("CollisionBoxArray",Ut);class kt extends Hl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}kt.prototype.size=48;class se extends W{get(i){return new kt(this,i)}}Ne("PlacedSymbolArray",se);class me extends Hl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}me.prototype.size=68;class Ht extends ot{get(i){return new me(this,i)}}Ne("SymbolInstanceArray",Ht);class Re extends J{getoffsetX(i){return this.float32[1*i+0]}}Ne("GlyphOffsetArray",Re);class Ie extends it{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Ne("SymbolLineVertexArray",Ie);class We extends Hl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}We.prototype.size=8;class Nn extends mt{get(i){return new We(this,i)}}Ne("FeatureIndexArray",Nn);class En extends Fa{}class Dn extends Fa{}class kr extends y{}class hn extends o{}class Tn extends h{}class hr extends m{}class Wi extends v{}class Fr extends E{}class As extends L{}class Ps extends C{}class fl extends V{}class Fo extends Z{}class _a extends yt{}const pl=Or([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bo}=pl;class Gn{constructor(i=[]){this.segments=i}prepareSegment(i,u,d,_){let b=this.segments[this.segments.length-1];return i>Gn.MAX_VERTEX_ARRAY_LENGTH&&ee(`Max vertices per segment is ${Gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!b||b.vertexLength+i>Gn.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:u.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},_!==void 0&&(b.sortKey=_),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const i of this.segments)for(const u in i.vaos)i.vaos[u].destroy()}static simpleSegment(i,u,d,_){return new Gn([{vertexOffset:i,primitiveOffset:u,vertexLength:d,primitiveLength:_,vaos:{},sortKey:0}])}}function tr(a,i){return 256*(a=D(Math.floor(a),0,255))+D(Math.floor(i),0,255)}Gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ne("SegmentVector",Gn);const $r=Or([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Li={exports:{}},gr={exports:{}};gr.exports=function(a,i){var u,d,_,b,w,A,M,z;for(d=a.length-(u=3&a.length),_=i,w=3432918353,A=461845907,z=0;z<d;)M=255&a.charCodeAt(z)|(255&a.charCodeAt(++z))<<8|(255&a.charCodeAt(++z))<<16|(255&a.charCodeAt(++z))<<24,++z,_=27492+(65535&(b=5*(65535&(_=(_^=M=(65535&(M=(M=(65535&M)*w+(((M>>>16)*w&65535)<<16)&4294967295)<<15|M>>>17))*A+(((M>>>16)*A&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(M=0,u){case 3:M^=(255&a.charCodeAt(z+2))<<16;case 2:M^=(255&a.charCodeAt(z+1))<<8;case 1:_^=M=(65535&(M=(M=(65535&(M^=255&a.charCodeAt(z)))*w+(((M>>>16)*w&65535)<<16)&4294967295)<<15|M>>>17))*A+(((M>>>16)*A&65535)<<16)&4294967295}return _^=a.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var Kl={exports:{}};Kl.exports=function(a,i){for(var u,d=a.length,_=i^d,b=0;d>=4;)u=1540483477*(65535&(u=255&a.charCodeAt(b)|(255&a.charCodeAt(++b))<<8|(255&a.charCodeAt(++b))<<16|(255&a.charCodeAt(++b))<<24))+((1540483477*(u>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),d-=4,++b;switch(d){case 3:_^=(255&a.charCodeAt(b+2))<<16;case 2:_^=(255&a.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&a.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var Zs=gr.exports,wh=Kl.exports;Li.exports=Zs,Li.exports.murmur3=Zs,Li.exports.murmur2=wh;var Ys=Li.exports;class Fu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,u,d,_){this.ids.push(dl(i)),this.positions.push(u,d,_)}getPositions(i){const u=dl(i);let d=0,_=this.ids.length-1;for(;d<_;){const w=d+_>>1;this.ids[w]>=u?_=w:d=w+1}const b=[];for(;this.ids[d]===u;)b.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return b}static serialize(i,u){const d=new Float64Array(i.ids),_=new Uint32Array(i.positions);return ki(d,_,0,d.length-1),u&&u.push(d.buffer,_.buffer),{ids:d,positions:_}}static deserialize(i){const u=new Fu;return u.ids=i.ids,u.positions=i.positions,u.indexed=!0,u}}function dl(a){const i=+a;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:Ys(String(a))}function ki(a,i,u,d){for(;u<d;){const _=a[u+d>>1];let b=u-1,w=d+1;for(;;){do b++;while(a[b]<_);do w--;while(a[w]>_);if(b>=w)break;Ih(a,b,w),Ih(i,3*b,3*w),Ih(i,3*b+1,3*w+1),Ih(i,3*b+2,3*w+2)}w-u<d-w?(ki(a,i,u,w),u=w+1):(ki(a,i,w+1,d),d=w)}}function Ih(a,i,u){const d=a[i];a[i]=a[u],a[u]=d}Ne("FeaturePositionMap",Fu);class Ws{constructor(i,u){this.gl=i.gl,this.location=u}}class Jl extends Ws{constructor(i,u){super(i,u),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Eh extends Ws{constructor(i,u){super(i,u),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Ql extends Ws{constructor(i,u){super(i,u),this.current=B.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Dm=new Float32Array(16);function ag(a){return[tr(255*a.r,255*a.g),tr(255*a.b,255*a.a)]}class Bu{constructor(i,u,d){this.value=i,this.uniformNames=u.map(_=>`u_${_}`),this.type=d}setUniform(i,u,d){i.set(d.constantOr(this.value))}getBinding(i,u,d){return this.type==="color"?new Ql(i,u):new Jl(i,u)}}class Sh{constructor(i,u){this.uniformNames=u.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=i.tlbr}setUniform(i,u,d,_){const b=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&i.set(b)}getBinding(i,u,d){return d.substr(0,9)==="u_pattern"?new Eh(i,u):new Jl(i,u)}}class gl{constructor(i,u,d,_){this.expression=i,this.type=d,this.maxValue=0,this.paintVertexAttributes=u.map(b=>({name:`a_${b}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(i,u,d,_,b){const w=this.paintVertexArray.length,A=this.expression.evaluate(new Sr(0),u,{},_,[],b);this.paintVertexArray.resize(i),this._setPaintValue(w,i,A)}updatePaintArray(i,u,d,_){const b=this.expression.evaluate({zoom:0},d,_);this._setPaintValue(i,u,b)}_setPaintValue(i,u,d){if(this.type==="color"){const _=ag(d);for(let b=i;b<u;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=i;_<u;_++)this.paintVertexArray.emplace(_,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cr{constructor(i,u,d,_,b,w){this.expression=i,this.uniformNames=u.map(A=>`u_${A}_t`),this.type=d,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(A=>({name:`a_${A}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(i,u,d,_,b){const w=this.expression.evaluate(new Sr(this.zoom),u,{},_,[],b),A=this.expression.evaluate(new Sr(this.zoom+1),u,{},_,[],b),M=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(M,i,w,A)}updatePaintArray(i,u,d,_){const b=this.expression.evaluate({zoom:this.zoom},d,_),w=this.expression.evaluate({zoom:this.zoom+1},d,_);this._setPaintValue(i,u,b,w)}_setPaintValue(i,u,d,_){if(this.type==="color"){const b=ag(d),w=ag(_);for(let A=i;A<u;A++)this.paintVertexArray.emplace(A,b[0],b[1],w[0],w[1])}else{for(let b=i;b<u;b++)this.paintVertexArray.emplace(b,d,_);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(_))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,u){const d=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,_=D(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);i.set(_)}getBinding(i,u,d){return new Jl(i,u)}}class ml{constructor(i,u,d,_,b,w){this.expression=i,this.type=u,this.useIntegerZoom=d,this.zoom=_,this.layerId=w,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(i,u,d){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(_,i,u.patterns&&u.patterns[this.layerId],d)}updatePaintArray(i,u,d,_,b){this._setPaintValues(i,u,d.patterns&&d.patterns[this.layerId],b)}_setPaintValues(i,u,d,_){if(!_||!d)return;const{min:b,mid:w,max:A}=d,M=_[b],z=_[w],F=_[A];if(M&&z&&F)for(let U=i;U<u;U++)this.zoomInPaintVertexArray.emplace(U,z.tl[0],z.tl[1],z.br[0],z.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],z.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,z.tl[0],z.tl[1],z.br[0],z.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],z.pixelRatio,F.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,$r.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,$r.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lg{constructor(i,u,d){this.binders={},this._buffers=[];const _=[];for(const b in i.paint._values){if(!d(b))continue;const w=i.paint.get(b);if(!(w instanceof Xs&&ss(w.property.specification)))continue;const A=ug(b,i.type),M=w.value,z=w.property.specification.type,F=w.property.useIntegerZoom,U=w.property.specification["property-type"],X=U==="cross-faded"||U==="cross-faded-data-driven";if(M.kind==="constant")this.binders[b]=X?new Sh(M.value,A):new Bu(M.value,A,z),_.push(`/u_${b}`);else if(M.kind==="source"||X){const j=vf(b,z,"source");this.binders[b]=X?new ml(M,z,F,u,j,i.id):new gl(M,A,z,j),_.push(`/a_${b}`)}else{const j=vf(b,z,"composite");this.binders[b]=new Cr(M,A,z,F,u,j),_.push(`/z_${b}`)}}this.cacheKey=_.sort().join("")}getMaxValue(i){const u=this.binders[i];return u instanceof gl||u instanceof Cr?u.maxValue:0}populatePaintArrays(i,u,d,_,b){for(const w in this.binders){const A=this.binders[w];(A instanceof gl||A instanceof Cr||A instanceof ml)&&A.populatePaintArray(i,u,d,_,b)}}setConstantPatternPositions(i,u){for(const d in this.binders){const _=this.binders[d];_ instanceof Sh&&_.setConstantPatternPositions(i,u)}}updatePaintArrays(i,u,d,_,b){let w=!1;for(const A in i){const M=u.getPositions(A);for(const z of M){const F=d.feature(z.index);for(const U in this.binders){const X=this.binders[U];if((X instanceof gl||X instanceof Cr||X instanceof ml)&&X.expression.isStateDependent===!0){const j=_.paint.get(U);X.expression=j.value,X.updatePaintArray(z.start,z.end,F,i[A],b),w=!0}}}}return w}defines(){const i=[];for(const u in this.binders){const d=this.binders[u];(d instanceof Bu||d instanceof Sh)&&i.push(...d.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return i}getBinderAttributes(){const i=[];for(const u in this.binders){const d=this.binders[u];if(d instanceof gl||d instanceof Cr)for(let _=0;_<d.paintVertexAttributes.length;_++)i.push(d.paintVertexAttributes[_].name);else if(d instanceof ml)for(let _=0;_<$r.members.length;_++)i.push($r.members[_].name)}return i}getBinderUniforms(){const i=[];for(const u in this.binders){const d=this.binders[u];if(d instanceof Bu||d instanceof Sh||d instanceof Cr)for(const _ of d.uniformNames)i.push(_)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,u){const d=[];for(const _ in this.binders){const b=this.binders[_];if(b instanceof Bu||b instanceof Sh||b instanceof Cr){for(const w of b.uniformNames)if(u[w]){const A=b.getBinding(i,u[w],w);d.push({name:w,property:_,binding:A})}}}return d}setUniforms(i,u,d,_){for(const{name:b,property:w,binding:A}of u)this.binders[w].setUniform(A,_,d.get(w),b)}updatePaintBuffers(i){this._buffers=[];for(const u in this.binders){const d=this.binders[u];if(i&&d instanceof ml){const _=i.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(d instanceof gl||d instanceof Cr)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(i){for(const u in this.binders){const d=this.binders[u];(d instanceof gl||d instanceof Cr||d instanceof ml)&&d.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const u=this.binders[i];(u instanceof gl||u instanceof Cr||u instanceof ml)&&u.destroy()}}}class Uo{constructor(i,u,d=()=>!0){this.programConfigurations={};for(const _ of i)this.programConfigurations[_.id]=new lg(_,u,d);this.needsUpload=!1,this._featureMap=new Fu,this._bufferOffset=0}populatePaintArrays(i,u,d,_,b,w){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(i,u,_,b,w);u.id!==void 0&&this._featureMap.add(u.id,d,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,u,d,_){for(const b of d)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(i,this._featureMap,u,b,_)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function ug(a,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${i}-`,"").replace(/-/g,"_")]}function vf(a,i,u){const d={color:{source:h,composite:bt},number:{source:J,composite:h}},_=function(b){return{"line-pattern":{source:hr,composite:hr},"fill-pattern":{source:hr,composite:hr},"fill-extrusion-pattern":{source:hr,composite:hr}}[b]}(a);return _&&_[u]||d[i][u]}Ne("ConstantBinder",Bu),Ne("CrossFadedConstantBinder",Sh),Ne("SourceExpressionBinder",gl),Ne("CrossFadedCompositeBinder",ml),Ne("CompositeExpressionBinder",Cr),Ne("ProgramConfiguration",lg,{omit:["_buffers"]}),Ne("ProgramConfigurationSet",Uo);var Tr=8192;const Cp=Math.pow(2,14)-1,Vo=-Cp-1;function $l(a){const i=Tr/a.extent,u=a.loadGeometry();for(let d=0;d<u.length;d++){const _=u[d];for(let b=0;b<_.length;b++){const w=_[b],A=Math.round(w.x*i),M=Math.round(w.y*i);w.x=D(A,Vo,Cp),w.y=D(M,Vo,Cp),(A<w.x||A>w.x+1||M<w.y||M>w.y+1)&&ee("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function Tc(a,i){return{type:a.type,id:a.id,properties:a.properties,geometry:i?$l(a):[]}}function Tp(a,i,u,d,_){a.emplaceBack(2*i+(d+1)/2,2*u+(_+1)/2)}class cg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new En,this.indexArray=new Fo,this.segments=new Gn,this.programConfigurations=new Uo(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,d){const _=this.layers[0],b=[];let w=null,A=!1;_.type==="circle"&&(w=_.layout.get("circle-sort-key"),A=!w.isConstant());for(const{feature:M,id:z,index:F,sourceLayerIndex:U}of i){const X=this.layers[0]._featureFilter.needGeometry,j=Tc(M,X);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),j,d))continue;const H=A?w.evaluate(j,{},d):void 0,ut={id:z,properties:M.properties,type:M.type,sourceLayerIndex:U,index:F,geometry:X?j.geometry:$l(M),patterns:{},sortKey:H};b.push(ut)}A&&b.sort((M,z)=>M.sortKey-z.sortKey);for(const M of b){const{geometry:z,index:F,sourceLayerIndex:U}=M,X=i[F].feature;this.addFeature(M,z,F,d),u.featureIndex.insert(X,z,F,U,this.index)}}update(i,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Bo),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,u,d,_){for(const b of u)for(const w of b){const A=w.x,M=w.y;if(A<0||A>=Tr||M<0||M>=Tr)continue;const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),F=z.vertexLength;Tp(this.layoutVertexArray,A,M,-1,-1),Tp(this.layoutVertexArray,A,M,1,-1),Tp(this.layoutVertexArray,A,M,1,1),Tp(this.layoutVertexArray,A,M,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+3,F+2),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,{},_)}}function Ap(a,i){for(let u=0;u<a.length;u++)if(Uu(i,a[u]))return!0;for(let u=0;u<i.length;u++)if(Uu(a,i[u]))return!0;return!!hg(a,i)}function Uy(a,i,u){return!!Uu(a,i)||!!Ac(i,a,u)}function Ch(a,i){if(a.length===1)return zm(i,a[0]);for(let u=0;u<i.length;u++){const d=i[u];for(let _=0;_<d.length;_++)if(Uu(a,d[_]))return!0}for(let u=0;u<a.length;u++)if(zm(i,a[u]))return!0;for(let u=0;u<i.length;u++)if(hg(a,i[u]))return!0;return!1}function Nm(a,i,u){if(a.length>1){if(hg(a,i))return!0;for(let d=0;d<i.length;d++)if(Ac(i[d],a,u))return!0}for(let d=0;d<a.length;d++)if(Ac(a[d],i,u))return!0;return!1}function hg(a,i){if(a.length===0||i.length===0)return!1;for(let u=0;u<a.length-1;u++){const d=a[u],_=a[u+1];for(let b=0;b<i.length-1;b++)if(Vy(d,_,i[b],i[b+1]))return!0}return!1}function Vy(a,i,u,d){return $t(a,u,d)!==$t(i,u,d)&&$t(a,i,u)!==$t(a,i,d)}function Ac(a,i,u){const d=u*u;if(i.length===1)return a.distSqr(i[0])<d;for(let _=1;_<i.length;_++)if(Rm(a,i[_-1],i[_])<d)return!0;return!1}function Rm(a,i,u){const d=i.distSqr(u);if(d===0)return a.distSqr(i);const _=((a.x-i.x)*(u.x-i.x)+(a.y-i.y)*(u.y-i.y))/d;return a.distSqr(_<0?i:_>1?u:u.sub(i)._mult(_)._add(i))}function zm(a,i){let u,d,_,b=!1;for(let w=0;w<a.length;w++){u=a[w];for(let A=0,M=u.length-1;A<u.length;M=A++)d=u[A],_=u[M],d.y>i.y!=_.y>i.y&&i.x<(_.x-d.x)*(i.y-d.y)/(_.y-d.y)+d.x&&(b=!b)}return b}function Uu(a,i){let u=!1;for(let d=0,_=a.length-1;d<a.length;_=d++){const b=a[d],w=a[_];b.y>i.y!=w.y>i.y&&i.x<(w.x-b.x)*(i.y-b.y)/(w.y-b.y)+b.x&&(u=!u)}return u}function Om(a,i,u){const d=u[0],_=u[2];if(a.x<d.x&&i.x<d.x||a.x>_.x&&i.x>_.x||a.y<d.y&&i.y<d.y||a.y>_.y&&i.y>_.y)return!1;const b=$t(a,i,u[0]);return b!==$t(a,i,u[1])||b!==$t(a,i,u[2])||b!==$t(a,i,u[3])}function xf(a,i,u){const d=i.paint.get(a).value;return d.kind==="constant"?d.value:u.programConfigurations.get(i.id).getMaxValue(a)}function Pp(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Lp(a,i,u,d,_){if(!i[0]&&!i[1])return a;const b=Jt.convert(i)._mult(_);u==="viewport"&&b._rotate(-d);const w=[];for(let A=0;A<a.length;A++)w.push(a[A].sub(b));return w}Ne("CircleBucket",cg,{omit:["layers"]});const km=new _i({"circle-sort-key":new Le(Bt.layout_circle["circle-sort-key"])});var fg={paint:new _i({"circle-radius":new Le(Bt.paint_circle["circle-radius"]),"circle-color":new Le(Bt.paint_circle["circle-color"]),"circle-blur":new Le(Bt.paint_circle["circle-blur"]),"circle-opacity":new Le(Bt.paint_circle["circle-opacity"]),"circle-translate":new Be(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new Be(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Be(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Be(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Le(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Le(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Le(Bt.paint_circle["circle-stroke-opacity"])}),layout:km},Th=typeof Float32Array<"u"?Float32Array:Array;function bf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function pg(a,i,u){var d=i[0],_=i[1],b=i[2],w=i[3],A=i[4],M=i[5],z=i[6],F=i[7],U=i[8],X=i[9],j=i[10],H=i[11],ut=i[12],ct=i[13],St=i[14],Rt=i[15],Lt=u[0],qt=u[1],ne=u[2],Qt=u[3];return a[0]=Lt*d+qt*A+ne*U+Qt*ut,a[1]=Lt*_+qt*M+ne*X+Qt*ct,a[2]=Lt*b+qt*z+ne*j+Qt*St,a[3]=Lt*w+qt*F+ne*H+Qt*Rt,a[4]=(Lt=u[4])*d+(qt=u[5])*A+(ne=u[6])*U+(Qt=u[7])*ut,a[5]=Lt*_+qt*M+ne*X+Qt*ct,a[6]=Lt*b+qt*z+ne*j+Qt*St,a[7]=Lt*w+qt*F+ne*H+Qt*Rt,a[8]=(Lt=u[8])*d+(qt=u[9])*A+(ne=u[10])*U+(Qt=u[11])*ut,a[9]=Lt*_+qt*M+ne*X+Qt*ct,a[10]=Lt*b+qt*z+ne*j+Qt*St,a[11]=Lt*w+qt*F+ne*H+Qt*Rt,a[12]=(Lt=u[12])*d+(qt=u[13])*A+(ne=u[14])*U+(Qt=u[15])*ut,a[13]=Lt*_+qt*M+ne*X+Qt*ct,a[14]=Lt*b+qt*z+ne*j+Qt*St,a[15]=Lt*w+qt*F+ne*H+Qt*Rt,a}Math.hypot||(Math.hypot=function(){for(var a=0,i=arguments.length;i--;)a+=arguments[i]*arguments[i];return Math.sqrt(a)});var Ah,Fm=pg;function Pc(a,i,u){var d=i[0],_=i[1],b=i[2],w=i[3];return a[0]=u[0]*d+u[4]*_+u[8]*b+u[12]*w,a[1]=u[1]*d+u[5]*_+u[9]*b+u[13]*w,a[2]=u[2]*d+u[6]*_+u[10]*b+u[14]*w,a[3]=u[3]*d+u[7]*_+u[11]*b+u[15]*w,a}function Bm(a,i){const u=Pc([],[a.x,a.y,0,1],i);return new Jt(u[0]/u[3],u[1]/u[3])}Ah=new Th(4),Th!=Float32Array&&(Ah[0]=0,Ah[1]=0,Ah[2]=0,Ah[3]=0);class dg extends cg{}Ne("HeatmapBucket",dg,{omit:["layers"]});var Um={paint:new _i({"heatmap-radius":new Le(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Le(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Be(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yf(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Be(Bt.paint_heatmap["heatmap-opacity"])})};function gg(a,{width:i,height:u},d,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==i*u*d)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${i*u*d}`)}else _=new Uint8Array(i*u*d);return a.width=i,a.height=u,a.data=_,a}function mg(a,{width:i,height:u},d){if(i===a.width&&u===a.height)return;const _=gg({},{width:i,height:u},d);_g(a,_,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,i),height:Math.min(a.height,u)},d),a.width=i,a.height=u,a.data=_.data}function _g(a,i,u,d,_,b){if(_.width===0||_.height===0)return i;if(_.width>a.width||_.height>a.height||u.x>a.width-_.width||u.y>a.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>i.width||_.height>i.height||d.x>i.width-_.width||d.y>i.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const w=a.data,A=i.data;for(let M=0;M<_.height;M++){const z=((u.y+M)*a.width+u.x)*b,F=((d.y+M)*i.width+d.x)*b;for(let U=0;U<_.width*b;U++)A[F+U]=w[z+U]}return i}class Lc{constructor(i,u){gg(this,i,1,u)}resize(i){mg(this,i,1)}clone(){return new Lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,u,d,_,b){_g(i,u,d,_,b,1)}}class Ls{constructor(i,u){gg(this,i,4,u)}resize(i){mg(this,i,4)}replace(i,u){u?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ls({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,u,d,_,b){_g(i,u,d,_,b,4)}}function Mp(a){const i={},u=a.resolution||256,d=a.clips?a.clips.length:1,_=a.image||new Ls({width:u,height:d}),b=(w,A,M)=>{i[a.evaluationKey]=M;const z=a.expression.evaluate(i);_.data[w+A+0]=Math.floor(255*z.r/z.a),_.data[w+A+1]=Math.floor(255*z.g/z.a),_.data[w+A+2]=Math.floor(255*z.b/z.a),_.data[w+A+3]=Math.floor(255*z.a)};if(a.clips)for(let w=0,A=0;w<d;++w,A+=4*u)for(let M=0,z=0;M<u;M++,z+=4){const F=M/(u-1),{start:U,end:X}=a.clips[w];b(A,z,U*(1-F)+X*F)}else for(let w=0,A=0;w<u;w++,A+=4)b(0,A,w/(u-1));return _}Ne("AlphaImage",Lc),Ne("RGBAImage",Ls);var Gy={paint:new _i({"hillshade-illumination-direction":new Be(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Be(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Be(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Be(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Be(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Be(Bt.paint_hillshade["hillshade-accent-color"])})};const yg=Or([{name:"a_pos",components:2,type:"Int16"}],4),{members:Rn}=yg;var vg={exports:{}};function Dp(a,i,u){u=u||2;var d,_,b,w,A,M,z,F=i&&i.length,U=F?i[0]*u:a.length,X=Ph(a,0,U,u,!0),j=[];if(!X||X.next===X.prev)return j;if(F&&(X=function(ut,ct,St,Rt){var Lt,qt,ne,Qt=[];for(Lt=0,qt=ct.length;Lt<qt;Lt++)(ne=Ph(ut,ct[Lt]*Rt,Lt<qt-1?ct[Lt+1]*Rt:ut.length,Rt,!1))===ne.next&&(ne.steiner=!0),Qt.push(Vu(ne));for(Qt.sort(xg),Lt=0;Lt<Qt.length;Lt++)St=tu(St=Vm(Qt[Lt],St),St.next);return St}(a,i,X,u)),a.length>80*u){d=b=a[0],_=w=a[1];for(var H=u;H<U;H+=u)(A=a[H])<d&&(d=A),(M=a[H+1])<_&&(_=M),A>b&&(b=A),M>w&&(w=M);z=(z=Math.max(b-d,w-_))!==0?1/z:0}return wf(X,j,u,d,_,z),j}function Ph(a,i,u,d,_){var b,w;if(_===Op(a,i,u,d)>0)for(b=i;b<u;b+=d)w=Xm(b,a[b],a[b+1],w);else for(b=u-d;b>=i;b-=d)w=Xm(b,a[b],a[b+1],w);return w&&If(w,w.next)&&(va(w),w=w.next),w}function tu(a,i){if(!a)return a;i||(i=a);var u,d=a;do if(u=!1,d.steiner||!If(d,d.next)&&Mr(d.prev,d,d.next)!==0)d=d.next;else{if(va(d),(d=i=d.prev)===d.next)break;u=!0}while(u||d!==i);return i}function wf(a,i,u,d,_,b,w){if(a){!w&&b&&function(F,U,X,j){var H=F;do H.z===null&&(H.z=ls(H.x,H.y,U,X,j)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==F);H.prevZ.nextZ=null,H.prevZ=null,function(ut){var ct,St,Rt,Lt,qt,ne,Qt,Me,Ue=1;do{for(St=ut,ut=null,qt=null,ne=0;St;){for(ne++,Rt=St,Qt=0,ct=0;ct<Ue&&(Qt++,Rt=Rt.nextZ);ct++);for(Me=Ue;Qt>0||Me>0&&Rt;)Qt!==0&&(Me===0||!Rt||St.z<=Rt.z)?(Lt=St,St=St.nextZ,Qt--):(Lt=Rt,Rt=Rt.nextZ,Me--),qt?qt.nextZ=Lt:ut=Lt,Lt.prevZ=qt,qt=Lt;St=Rt}qt.nextZ=null,Ue*=2}while(ne>1)}(H)}(a,d,_,b);for(var A,M,z=a;a.prev!==a.next;)if(A=a.prev,M=a.next,b?ya(a,d,_,b):qy(a))i.push(A.i/u),i.push(a.i/u),i.push(M.i/u),va(a),a=M.next,z=M.next;else if((a=M)===z){w?w===1?wf(a=Xy(tu(a),i,u),i,u,d,_,b,2):w===2&&Np(a,i,u,d,_,b):wf(tu(a),i,u,d,_,b,1);break}}}function qy(a){var i=a.prev,u=a,d=a.next;if(Mr(i,u,d)>=0)return!1;for(var _=a.next.next;_!==a.prev;){if(Gu(i.x,i.y,u.x,u.y,d.x,d.y,_.x,_.y)&&Mr(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function ya(a,i,u,d){var _=a.prev,b=a,w=a.next;if(Mr(_,b,w)>=0)return!1;for(var A=_.x>b.x?_.x>w.x?_.x:w.x:b.x>w.x?b.x:w.x,M=_.y>b.y?_.y>w.y?_.y:w.y:b.y>w.y?b.y:w.y,z=ls(_.x<b.x?_.x<w.x?_.x:w.x:b.x<w.x?b.x:w.x,_.y<b.y?_.y<w.y?_.y:w.y:b.y<w.y?b.y:w.y,i,u,d),F=ls(A,M,i,u,d),U=a.prevZ,X=a.nextZ;U&&U.z>=z&&X&&X.z<=F;){if(U!==a.prev&&U!==a.next&&Gu(_.x,_.y,b.x,b.y,w.x,w.y,U.x,U.y)&&Mr(U.prev,U,U.next)>=0||(U=U.prevZ,X!==a.prev&&X!==a.next&&Gu(_.x,_.y,b.x,b.y,w.x,w.y,X.x,X.y)&&Mr(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;U&&U.z>=z;){if(U!==a.prev&&U!==a.next&&Gu(_.x,_.y,b.x,b.y,w.x,w.y,U.x,U.y)&&Mr(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;X&&X.z<=F;){if(X!==a.prev&&X!==a.next&&Gu(_.x,_.y,b.x,b.y,w.x,w.y,X.x,X.y)&&Mr(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function Xy(a,i,u){var d=a;do{var _=d.prev,b=d.next.next;!If(_,b)&&Rp(_,d,d.next,b)&&Mc(_,b)&&Mc(b,_)&&(i.push(_.i/u),i.push(d.i/u),i.push(b.i/u),va(d),va(d.next),d=a=b),d=d.next}while(d!==a);return tu(d)}function Np(a,i,u,d,_,b){var w=a;do{for(var A=w.next.next;A!==w.prev;){if(w.i!==A.i&&qm(w,A)){var M=eu(w,A);return w=tu(w,w.next),M=tu(M,M.next),wf(w,i,u,d,_,b),void wf(M,i,u,d,_,b)}A=A.next}w=w.next}while(w!==a)}function xg(a,i){return a.x-i.x}function Vm(a,i){var u=function(b,w){var A,M=w,z=b.x,F=b.y,U=-1/0;do{if(F<=M.y&&F>=M.next.y&&M.next.y!==M.y){var X=M.x+(F-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(X<=z&&X>U){if(U=X,X===z){if(F===M.y)return M;if(F===M.next.y)return M.next}A=M.x<M.next.x?M:M.next}}M=M.next}while(M!==w);if(!A)return null;if(z===U)return A;var j,H=A,ut=A.x,ct=A.y,St=1/0;M=A;do z>=M.x&&M.x>=ut&&z!==M.x&&Gu(F<ct?z:U,F,ut,ct,F<ct?U:z,F,M.x,M.y)&&(j=Math.abs(F-M.y)/(z-M.x),Mc(M,b)&&(j<St||j===St&&(M.x>A.x||M.x===A.x&&Gm(A,M)))&&(A=M,St=j)),M=M.next;while(M!==H);return A}(a,i);if(!u)return i;var d=eu(u,a),_=tu(u,u.next);return tu(d,d.next),i===u?_:i}function Gm(a,i){return Mr(a.prev,a,i.prev)<0&&Mr(i.next,a,a.next)<0}function ls(a,i,u,d,_){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-u)*_)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-d)*_)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Vu(a){var i=a,u=a;do(i.x<u.x||i.x===u.x&&i.y<u.y)&&(u=i),i=i.next;while(i!==a);return u}function Gu(a,i,u,d,_,b,w,A){return(_-w)*(i-A)-(a-w)*(b-A)>=0&&(a-w)*(d-A)-(u-w)*(i-A)>=0&&(u-w)*(b-A)-(_-w)*(d-A)>=0}function qm(a,i){return a.next.i!==i.i&&a.prev.i!==i.i&&!function(u,d){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==d.i&&_.next.i!==d.i&&Rp(_,_.next,u,d))return!0;_=_.next}while(_!==u);return!1}(a,i)&&(Mc(a,i)&&Mc(i,a)&&function(u,d){var _=u,b=!1,w=(u.x+d.x)/2,A=(u.y+d.y)/2;do _.y>A!=_.next.y>A&&_.next.y!==_.y&&w<(_.next.x-_.x)*(A-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next;while(_!==u);return b}(a,i)&&(Mr(a.prev,a,i.prev)||Mr(a,i.prev,i))||If(a,i)&&Mr(a.prev,a,a.next)>0&&Mr(i.prev,i,i.next)>0)}function Mr(a,i,u){return(i.y-a.y)*(u.x-i.x)-(i.x-a.x)*(u.y-i.y)}function If(a,i){return a.x===i.x&&a.y===i.y}function Rp(a,i,u,d){var _=Lh(Mr(a,i,u)),b=Lh(Mr(a,i,d)),w=Lh(Mr(u,d,a)),A=Lh(Mr(u,d,i));return _!==b&&w!==A||!(_!==0||!Ef(a,u,i))||!(b!==0||!Ef(a,d,i))||!(w!==0||!Ef(u,a,d))||!(A!==0||!Ef(u,i,d))}function Ef(a,i,u){return i.x<=Math.max(a.x,u.x)&&i.x>=Math.min(a.x,u.x)&&i.y<=Math.max(a.y,u.y)&&i.y>=Math.min(a.y,u.y)}function Lh(a){return a>0?1:a<0?-1:0}function Mc(a,i){return Mr(a.prev,a,a.next)<0?Mr(a,i,a.next)>=0&&Mr(a,a.prev,i)>=0:Mr(a,i,a.prev)<0||Mr(a,a.next,i)<0}function eu(a,i){var u=new zp(a.i,a.x,a.y),d=new zp(i.i,i.x,i.y),_=a.next,b=i.prev;return a.next=i,i.prev=a,u.next=_,_.prev=u,d.next=u,u.prev=d,b.next=d,d.prev=b,d}function Xm(a,i,u,d){var _=new zp(a,i,u);return d?(_.next=d.next,_.prev=d,d.next.prev=_,d.next=_):(_.prev=_,_.next=_),_}function va(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function zp(a,i,u){this.i=a,this.x=i,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Op(a,i,u,d){for(var _=0,b=i,w=u-d;b<u;b+=d)_+=(a[w]-a[b])*(a[b+1]+a[w+1]),w=b;return _}vg.exports=Dp,vg.exports.default=Dp,Dp.deviation=function(a,i,u,d){var _=i&&i.length,b=Math.abs(Op(a,0,_?i[0]*u:a.length,u));if(_)for(var w=0,A=i.length;w<A;w++)b-=Math.abs(Op(a,i[w]*u,w<A-1?i[w+1]*u:a.length,u));var M=0;for(w=0;w<d.length;w+=3){var z=d[w]*u,F=d[w+1]*u,U=d[w+2]*u;M+=Math.abs((a[z]-a[U])*(a[F+1]-a[z+1])-(a[z]-a[F])*(a[U+1]-a[z+1]))}return b===0&&M===0?0:Math.abs((M-b)/b)},Dp.flatten=function(a){for(var i=a[0][0].length,u={vertices:[],holes:[],dimensions:i},d=0,_=0;_<a.length;_++){for(var b=0;b<a[_].length;b++)for(var w=0;w<i;w++)u.vertices.push(a[_][b][w]);_>0&&u.holes.push(d+=a[_-1].length)}return u};var kp=vg.exports;function Zy(a,i,u,d,_){Zm(a,i,u||0,d||a.length-1,_||Ym)}function Zm(a,i,u,d,_){for(;d>u;){if(d-u>600){var b=d-u+1,w=i-u+1,A=Math.log(b),M=.5*Math.exp(2*A/3),z=.5*Math.sqrt(A*M*(b-M)/b)*(w-b/2<0?-1:1);Zm(a,i,Math.max(u,Math.floor(i-w*M/b+z)),Math.min(d,Math.floor(i+(b-w)*M/b+z)),_)}var F=a[i],U=u,X=d;for(Sf(a,u,i),_(a[d],F)>0&&Sf(a,u,d);U<X;){for(Sf(a,U,X),U++,X--;_(a[U],F)<0;)U++;for(;_(a[X],F)>0;)X--}_(a[u],F)===0?Sf(a,u,X):Sf(a,++X,d),X<=i&&(u=X+1),i<=X&&(d=X-1)}}function Sf(a,i,u){var d=a[i];a[i]=a[u],a[u]=d}function Ym(a,i){return a<i?-1:a>i?1:0}function Fp(a,i){const u=a.length;if(u<=1)return[a];const d=[];let _,b;for(let w=0;w<u;w++){const A=Zt(a[w]);A!==0&&(a[w].area=Math.abs(A),b===void 0&&(b=A<0),b===A<0?(_&&d.push(_),_=[a[w]]):_.push(a[w]))}if(_&&d.push(_),i>1)for(let w=0;w<d.length;w++)d[w].length<=i||(Zy(d[w],i,1,d[w].length-1,Yy),d[w]=d[w].slice(0,i));return d}function Yy(a,i){return i.area-a.area}function Bp(a,i,u){const d=u.patternDependencies;let _=!1;for(const b of i){const w=b.paint.get(`${a}-pattern`);w.isConstant()||(_=!0);const A=w.constantOr(null);A&&(_=!0,d[A.to]=!0,d[A.from]=!0)}return _}function Up(a,i,u,d,_){const b=_.patternDependencies;for(const w of i){const A=w.paint.get(`${a}-pattern`).value;if(A.kind!=="constant"){let M=A.evaluate({zoom:d-1},u,{},_.availableImages),z=A.evaluate({zoom:d},u,{},_.availableImages),F=A.evaluate({zoom:d+1},u,{},_.availableImages);M=M&&M.name?M.name:M,z=z&&z.name?z.name:z,F=F&&F.name?F.name:F,b[M]=!0,b[z]=!0,b[F]=!0,u.patterns[w.id]={min:M,mid:z,max:F}}}return u}class Go{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dn,this.indexArray=new Fo,this.indexArray2=new _a,this.programConfigurations=new Uo(i.layers,i.zoom),this.segments=new Gn,this.segments2=new Gn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,d){this.hasPattern=Bp("fill",this.layers,u);const _=this.layers[0].layout.get("fill-sort-key"),b=!_.isConstant(),w=[];for(const{feature:A,id:M,index:z,sourceLayerIndex:F}of i){const U=this.layers[0]._featureFilter.needGeometry,X=Tc(A,U);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),X,d))continue;const j=b?_.evaluate(X,{},d,u.availableImages):void 0,H={id:M,properties:A.properties,type:A.type,sourceLayerIndex:F,index:z,geometry:U?X.geometry:$l(A),patterns:{},sortKey:j};w.push(H)}b&&w.sort((A,M)=>A.sortKey-M.sortKey);for(const A of w){const{geometry:M,index:z,sourceLayerIndex:F}=A;if(this.hasPattern){const U=Up("fill",this.layers,A,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(A,M,z,d,{});u.featureIndex.insert(i[z].feature,M,z,F,this.index)}}update(i,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,d)}addFeatures(i,u,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Rn),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,u,d,_,b){for(const w of Fp(u,500)){let A=0;for(const j of w)A+=j.length;const M=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),z=M.vertexLength,F=[],U=[];for(const j of w){if(j.length===0)continue;j!==w[0]&&U.push(F.length/2);const H=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),ut=H.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(ut+j.length-1,ut),F.push(j[0].x),F.push(j[0].y);for(let ct=1;ct<j.length;ct++)this.layoutVertexArray.emplaceBack(j[ct].x,j[ct].y),this.indexArray2.emplaceBack(ut+ct-1,ut+ct),F.push(j[ct].x),F.push(j[ct].y);H.vertexLength+=j.length,H.primitiveLength+=j.length}const X=kp(F,U);for(let j=0;j<X.length;j+=3)this.indexArray.emplaceBack(z+X[j],z+X[j+1],z+X[j+2]);M.vertexLength+=A,M.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,_)}}Ne("FillBucket",Go,{omit:["layers","patternFeatures"]});const _l=new _i({"fill-sort-key":new Le(Bt.layout_fill["fill-sort-key"])});var Wy={paint:new _i({"fill-antialias":new Be(Bt.paint_fill["fill-antialias"]),"fill-opacity":new Le(Bt.paint_fill["fill-opacity"]),"fill-color":new Le(Bt.paint_fill["fill-color"]),"fill-outline-color":new Le(Bt.paint_fill["fill-outline-color"]),"fill-translate":new Be(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new Be(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new mi(Bt.paint_fill["fill-pattern"])}),layout:_l};const jy=Or([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),{members:Vp}=jy;var js={},Wm=Jt,bg=Mh;function Mh(a,i,u,d,_){this.properties={},this.extent=u,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=_,a.readFields(jm,this,i)}function jm(a,i,u){a==1?i.id=u.readVarint():a==2?function(d,_){for(var b=d.readVarint()+d.pos;d.pos<b;){var w=_._keys[d.readVarint()],A=_._values[d.readVarint()];_.properties[w]=A}}(u,i):a==3?i.type=u.readVarint():a==4&&(i._geometry=u.pos)}function Dh(a){for(var i,u,d=0,_=0,b=a.length,w=b-1;_<b;w=_++)d+=((u=a[w]).x-(i=a[_]).x)*(i.y+u.y);return d}Mh.types=["Unknown","Point","LineString","Polygon"],Mh.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var i,u=a.readVarint()+a.pos,d=1,_=0,b=0,w=0,A=[];a.pos<u;){if(_<=0){var M=a.readVarint();d=7&M,_=M>>3}if(_--,d===1||d===2)b+=a.readSVarint(),w+=a.readSVarint(),d===1&&(i&&A.push(i),i=[]),i.push(new Wm(b,w));else{if(d!==7)throw new Error("unknown command "+d);i&&i.push(i[0].clone())}}return i&&A.push(i),A},Mh.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var i=a.readVarint()+a.pos,u=1,d=0,_=0,b=0,w=1/0,A=-1/0,M=1/0,z=-1/0;a.pos<i;){if(d<=0){var F=a.readVarint();u=7&F,d=F>>3}if(d--,u===1||u===2)(_+=a.readSVarint())<w&&(w=_),_>A&&(A=_),(b+=a.readSVarint())<M&&(M=b),b>z&&(z=b);else if(u!==7)throw new Error("unknown command "+u)}return[w,M,A,z]},Mh.prototype.toGeoJSON=function(a,i,u){var d,_,b=this.extent*Math.pow(2,u),w=this.extent*a,A=this.extent*i,M=this.loadGeometry(),z=Mh.types[this.type];function F(j){for(var H=0;H<j.length;H++){var ut=j[H];j[H]=[360*(ut.x+w)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(ut.y+A)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(d=0;d<M.length;d++)U[d]=M[d][0];F(M=U);break;case 2:for(d=0;d<M.length;d++)F(M[d]);break;case 3:for(M=function(j){var H=j.length;if(H<=1)return[j];for(var ut,ct,St=[],Rt=0;Rt<H;Rt++){var Lt=Dh(j[Rt]);Lt!==0&&(ct===void 0&&(ct=Lt<0),ct===Lt<0?(ut&&St.push(ut),ut=[j[Rt]]):ut.push(j[Rt]))}return ut&&St.push(ut),St}(M),d=0;d<M.length;d++)for(_=0;_<M[d].length;_++)F(M[d][_])}M.length===1?M=M[0]:z="Multi"+z;var X={type:"Feature",geometry:{type:z,coordinates:M},properties:this.properties};return"id"in this&&(X.id=this.id),X};var Cf=bg,Hm=wg;function wg(a,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Km,this,i),this.length=this._features.length}function Km(a,i,u){a===15?i.version=u.readVarint():a===1?i.name=u.readString():a===5?i.extent=u.readVarint():a===2?i._features.push(u.pos):a===3?i._keys.push(u.readString()):a===4&&i._values.push(function(d){for(var _=null,b=d.readVarint()+d.pos;d.pos<b;){var w=d.readVarint()>>3;_=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return _}(u))}wg.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var i=this._pbf.readVarint()+this._pbf.pos;return new Cf(this._pbf,i,this.extent,this._keys,this._values)};var Gp=Hm;function Jm(a,i,u){if(a===3){var d=new Gp(u,u.readVarint()+u.pos);d.length&&(i[d.name]=d)}}js.VectorTile=function(a,i){this.layers=a.readFields(Jm,{},i)},js.VectorTileFeature=bg,js.VectorTileLayer=Hm;const qp=js.VectorTileFeature.types,Tf=Math.pow(2,13);function qu(a,i,u,d,_,b,w,A){a.emplaceBack(i,u,2*Math.floor(d*Tf)+w,_*Tf*2,b*Tf*2,Math.round(A))}class Ig{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new kr,this.indexArray=new Fo,this.programConfigurations=new Uo(i.layers,i.zoom),this.segments=new Gn,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,d){this.features=[],this.hasPattern=Bp("fill-extrusion",this.layers,u);for(const{feature:_,id:b,index:w,sourceLayerIndex:A}of i){const M=this.layers[0]._featureFilter.needGeometry,z=Tc(_,M);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),z,d))continue;const F={id:b,sourceLayerIndex:A,index:w,geometry:M?z.geometry:$l(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(Up("fill-extrusion",this.layers,F,this.zoom,u)):this.addFeature(F,F.geometry,w,d,{}),u.featureIndex.insert(_,F.geometry,w,A,this.index,!0)}}addFeatures(i,u,d){for(const _ of this.features){const{geometry:b}=_;this.addFeature(_,b,_.index,u,d)}}update(i,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Vp),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,u,d,_,b){for(const w of Fp(u,500)){let A=0;for(const j of w)A+=j.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const j of w){if(j.length===0||Xp(j))continue;let H=0;for(let ut=0;ut<j.length;ut++){const ct=j[ut];if(ut>=1){const St=j[ut-1];if(!Qm(ct,St)){M.vertexLength+4>Gn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Rt=ct.sub(St)._perp()._unit(),Lt=St.dist(ct);H+Lt>32768&&(H=0),qu(this.layoutVertexArray,ct.x,ct.y,Rt.x,Rt.y,0,0,H),qu(this.layoutVertexArray,ct.x,ct.y,Rt.x,Rt.y,0,1,H),H+=Lt,qu(this.layoutVertexArray,St.x,St.y,Rt.x,Rt.y,0,0,H),qu(this.layoutVertexArray,St.x,St.y,Rt.x,Rt.y,0,1,H);const qt=M.vertexLength;this.indexArray.emplaceBack(qt,qt+2,qt+1),this.indexArray.emplaceBack(qt+1,qt+2,qt+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+A>Gn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),qp[i.type]!=="Polygon")continue;const z=[],F=[],U=M.vertexLength;for(const j of w)if(j.length!==0){j!==w[0]&&F.push(z.length/2);for(let H=0;H<j.length;H++){const ut=j[H];qu(this.layoutVertexArray,ut.x,ut.y,0,0,1,1,0),z.push(ut.x),z.push(ut.y)}}const X=kp(z,F);for(let j=0;j<X.length;j+=3)this.indexArray.emplaceBack(U+X[j],U+X[j+2],U+X[j+1]);M.primitiveLength+=X.length/3,M.vertexLength+=A}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,_)}}function Qm(a,i){return a.x===i.x&&(a.x<0||a.x>Tr)||a.y===i.y&&(a.y<0||a.y>Tr)}function Xp(a){return a.every(i=>i.x<0)||a.every(i=>i.x>Tr)||a.every(i=>i.y<0)||a.every(i=>i.y>Tr)}Ne("FillExtrusionBucket",Ig,{omit:["layers","features"]});var $m={paint:new _i({"fill-extrusion-opacity":new Be(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Le(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Be(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Be(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new mi(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Le(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Le(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Be(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Dc(a,i){return a.x*i.x+a.y*i.y}function t_(a,i){if(a.length===1){let u=0;const d=i[u++];let _;for(;!_||d.equals(_);)if(_=i[u++],!_)return 1/0;for(;u<i.length;u++){const b=i[u],w=a[0],A=_.sub(d),M=b.sub(d),z=w.sub(d),F=Dc(A,A),U=Dc(A,M),X=Dc(M,M),j=Dc(z,A),H=Dc(z,M),ut=F*X-U*U,ct=(X*j-U*H)/ut,St=(F*H-U*j)/ut,Rt=d.z*(1-ct-St)+_.z*ct+b.z*St;if(isFinite(Rt))return Rt}return 1/0}{let u=1/0;for(const d of i)u=Math.min(u,d.z);return u}}const e_=Or([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:nu}=e_,n_=Or([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:r_}=n_,Hy=js.VectorTileFeature.types,i_=Math.cos(Math.PI/180*37.5),o_=Math.pow(2,14)/.5;class Eg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(u=>u.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new hn,this.layoutVertexArray2=new Tn,this.indexArray=new Fo,this.programConfigurations=new Uo(i.layers,i.zoom),this.segments=new Gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(i,u,d){this.hasPattern=Bp("line",this.layers,u);const _=this.layers[0].layout.get("line-sort-key"),b=!_.isConstant(),w=[];for(const{feature:A,id:M,index:z,sourceLayerIndex:F}of i){const U=this.layers[0]._featureFilter.needGeometry,X=Tc(A,U);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),X,d))continue;const j=b?_.evaluate(X,{},d):void 0,H={id:M,properties:A.properties,type:A.type,sourceLayerIndex:F,index:z,geometry:U?X.geometry:$l(A),patterns:{},sortKey:j};w.push(H)}b&&w.sort((A,M)=>A.sortKey-M.sortKey);for(const A of w){const{geometry:M,index:z,sourceLayerIndex:F}=A;if(this.hasPattern){const U=Up("line",this.layers,A,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(A,M,z,d,{});u.featureIndex.insert(i[z].feature,M,z,F,this.index)}}update(i,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,u,this.stateDependentLayers,d)}addFeatures(i,u,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,r_)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,nu),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,u,d,_,b){const w=this.layers[0].layout,A=w.get("line-join").evaluate(i,{}),M=w.get("line-cap"),z=w.get("line-miter-limit"),F=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const U of u)this.addLine(U,i,A,M,z,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,b,_)}addLine(i,u,d,_,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let St=0;St<i.length-1;St++)this.totalDistance+=i[St].dist(i[St+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=Hy[u.type]==="Polygon";let M=i.length;for(;M>=2&&i[M-1].equals(i[M-2]);)M--;let z=0;for(;z<M-1&&i[z].equals(i[z+1]);)z++;if(M<(A?3:2))return;d==="bevel"&&(b=1.05);const F=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let X,j,H,ut,ct;this.e1=this.e2=-1,A&&(X=i[M-2],ct=i[z].sub(X)._unit()._perp());for(let St=z;St<M;St++){if(H=St===M-1?A?i[z+1]:void 0:i[St+1],H&&i[St].equals(H))continue;ct&&(ut=ct),X&&(j=X),X=i[St],ct=H?H.sub(X)._unit()._perp():ut,ut=ut||ct;let Rt=ut.add(ct);Rt.x===0&&Rt.y===0||Rt._unit();const Lt=ut.x*ct.x+ut.y*ct.y,qt=Rt.x*ct.x+Rt.y*ct.y,ne=qt!==0?1/qt:1/0,Qt=2*Math.sqrt(2-2*qt),Me=qt<i_&&j&&H,Ue=ut.x*ct.y-ut.y*ct.x>0;if(Me&&St>z){const _e=X.dist(j);if(_e>2*F){const Pe=X.sub(X.sub(j)._mult(F/_e)._round());this.updateDistance(j,Pe),this.addCurrentVertex(Pe,ut,0,0,U),j=Pe}}const Ee=j&&H;let Se=Ee?d:A?"butt":_;if(Ee&&Se==="round"&&(ne<w?Se="miter":ne<=2&&(Se="fakeround")),Se==="miter"&&ne>b&&(Se="bevel"),Se==="bevel"&&(ne>2&&(Se="flipbevel"),ne<b&&(Se="miter")),j&&this.updateDistance(j,X),Se==="miter")Rt._mult(ne),this.addCurrentVertex(X,Rt,0,0,U);else if(Se==="flipbevel"){if(ne>100)Rt=ct.mult(-1);else{const _e=ne*ut.add(ct).mag()/ut.sub(ct).mag();Rt._perp()._mult(_e*(Ue?-1:1))}this.addCurrentVertex(X,Rt,0,0,U),this.addCurrentVertex(X,Rt.mult(-1),0,0,U)}else if(Se==="bevel"||Se==="fakeround"){const _e=-Math.sqrt(ne*ne-1),Pe=Ue?_e:0,Ce=Ue?0:_e;if(j&&this.addCurrentVertex(X,ut,Pe,Ce,U),Se==="fakeround"){const ce=Math.round(180*Qt/Math.PI/20);for(let He=1;He<ce;He++){let Ve=He/ce;if(Ve!==.5){const er=Ve-.5;Ve+=Ve*er*(Ve-1)*((1.0904+Lt*(Lt*(3.55645-1.43519*Lt)-3.2452))*er*er+(.848013+Lt*(.215638*Lt-1.06021)))}const Sn=ct.sub(ut)._mult(Ve)._add(ut)._unit()._mult(Ue?-1:1);this.addHalfVertex(X,Sn.x,Sn.y,!1,Ue,0,U)}}H&&this.addCurrentVertex(X,ct,-Pe,-Ce,U)}else if(Se==="butt")this.addCurrentVertex(X,Rt,0,0,U);else if(Se==="square"){const _e=j?1:-1;this.addCurrentVertex(X,Rt,_e,_e,U)}else Se==="round"&&(j&&(this.addCurrentVertex(X,ut,0,0,U),this.addCurrentVertex(X,ut,1,1,U,!0)),H&&(this.addCurrentVertex(X,ct,-1,-1,U,!0),this.addCurrentVertex(X,ct,0,0,U)));if(Me&&St<M-1){const _e=X.dist(H);if(_e>2*F){const Pe=X.add(H.sub(X)._mult(F/_e)._round());this.updateDistance(X,Pe),this.addCurrentVertex(Pe,ct,0,0,U),X=Pe}}}}addCurrentVertex(i,u,d,_,b,w=!1){const A=u.y*_-u.x,M=-u.y-u.x*_;this.addHalfVertex(i,u.x+u.y*d,u.y-u.x*d,w,!1,d,b),this.addHalfVertex(i,A,M,w,!0,-_,b),this.distance>o_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(i,u,d,_,b,w))}addHalfVertex({x:i,y:u},d,_,b,w,A,M){const z=.5*(this.lineClips?this.scaledDistance*(o_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(b?1:0),(u<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*_)+128,1+(A===0?0:A<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const F=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),M.primitiveLength++),w?this.e2=F:this.e1=F}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,u){this.distance+=i.dist(u),this.updateScaledDistance()}}Ne("LineBucket",Eg,{omit:["layers","patternFeatures"]});const ru=new _i({"line-cap":new Be(Bt.layout_line["line-cap"]),"line-join":new Le(Bt.layout_line["line-join"]),"line-miter-limit":new Be(Bt.layout_line["line-miter-limit"]),"line-round-limit":new Be(Bt.layout_line["line-round-limit"]),"line-sort-key":new Le(Bt.layout_line["line-sort-key"])});var Zp={paint:new _i({"line-opacity":new Le(Bt.paint_line["line-opacity"]),"line-color":new Le(Bt.paint_line["line-color"]),"line-translate":new Be(Bt.paint_line["line-translate"]),"line-translate-anchor":new Be(Bt.paint_line["line-translate-anchor"]),"line-width":new Le(Bt.paint_line["line-width"]),"line-gap-width":new Le(Bt.paint_line["line-gap-width"]),"line-offset":new Le(Bt.paint_line["line-offset"]),"line-blur":new Le(Bt.paint_line["line-blur"]),"line-dasharray":new Sc(Bt.paint_line["line-dasharray"]),"line-pattern":new mi(Bt.paint_line["line-pattern"]),"line-gradient":new yf(Bt.paint_line["line-gradient"])}),layout:ru};const Yp=new class extends Le{possiblyEvaluate(a,i){return i=new Sr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(a,i)}evaluate(a,i,u,d){return i=Y({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(a,i,u,d)}}(Zp.paint.properties["line-width"].specification);function Wp(a,i){return i>0?i+2*a:a}Yp.useIntegerZoom=!0;const jp=Or([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Nh=Or([{name:"a_projected_pos",components:3,type:"Float32"}],4);Or([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const un=Or([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Or([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Af=Or([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Sg=Or([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Nc(a,i,u){return a.sections.forEach(d=>{d.text=function(_,b,w){const A=b.layout.get("text-transform").evaluate(w,{});return A==="uppercase"?_=_.toLocaleUpperCase():A==="lowercase"&&(_=_.toLocaleLowerCase()),xo.applyArabicShaping&&(_=xo.applyArabicShaping(_)),_}(d.text,i,u)}),a}Or([{name:"triangle",components:3,type:"Uint16"}]),Or([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Or([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Or([{type:"Float32",name:"offsetX"}]),Or([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Pf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Mi=24,Hp=fr,bo=function(a,i,u,d,_){var b,w,A=8*_-d-1,M=(1<<A)-1,z=M>>1,F=-7,U=u?_-1:0,X=u?-1:1,j=a[i+U];for(U+=X,b=j&(1<<-F)-1,j>>=-F,F+=A;F>0;b=256*b+a[i+U],U+=X,F-=8);for(w=b&(1<<-F)-1,b>>=-F,F+=d;F>0;w=256*w+a[i+U],U+=X,F-=8);if(b===0)b=1-z;else{if(b===M)return w?NaN:1/0*(j?-1:1);w+=Math.pow(2,d),b-=z}return(j?-1:1)*w*Math.pow(2,b-d)},s_=function(a,i,u,d,_,b){var w,A,M,z=8*b-_-1,F=(1<<z)-1,U=F>>1,X=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=d?0:b-1,H=d?1:-1,ut=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(A=isNaN(i)?1:0,w=F):(w=Math.floor(Math.log(i)/Math.LN2),i*(M=Math.pow(2,-w))<1&&(w--,M*=2),(i+=w+U>=1?X/M:X*Math.pow(2,1-U))*M>=2&&(w++,M/=2),w+U>=F?(A=0,w=F):w+U>=1?(A=(i*M-1)*Math.pow(2,_),w+=U):(A=i*Math.pow(2,U-1)*Math.pow(2,_),w=0));_>=8;a[u+j]=255&A,j+=H,A/=256,_-=8);for(w=w<<_|A,z+=_;z>0;a[u+j]=255&w,j+=H,w/=256,z-=8);a[u+j-H]|=128*ut};function fr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}fr.Varint=0,fr.Fixed64=1,fr.Bytes=2,fr.Fixed32=5;var iu,Cg=4294967296,Tg=1/Cg,a_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ou(a){return a.type===fr.Bytes?a.readVarint()+a.pos:a.pos+1}function Rh(a,i,u){return u?4294967296*i+(a>>>0):4294967296*(i>>>0)+(a>>>0)}function yl(a,i,u){var d=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));u.realloc(d);for(var _=u.pos-1;_>=a;_--)u.buf[_+d]=u.buf[_]}function us(a,i){for(var u=0;u<a.length;u++)i.writeVarint(a[u])}function Ag(a,i){for(var u=0;u<a.length;u++)i.writeSVarint(a[u])}function Ky(a,i){for(var u=0;u<a.length;u++)i.writeFloat(a[u])}function Pg(a,i){for(var u=0;u<a.length;u++)i.writeDouble(a[u])}function Jy(a,i){for(var u=0;u<a.length;u++)i.writeBoolean(a[u])}function Qy(a,i){for(var u=0;u<a.length;u++)i.writeFixed32(a[u])}function Lf(a,i){for(var u=0;u<a.length;u++)i.writeSFixed32(a[u])}function l_(a,i){for(var u=0;u<a.length;u++)i.writeFixed64(a[u])}function u_(a,i){for(var u=0;u<a.length;u++)i.writeSFixed64(a[u])}function Kp(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+16777216*a[i+3]}function zh(a,i,u){a[u]=i,a[u+1]=i>>>8,a[u+2]=i>>>16,a[u+3]=i>>>24}function c_(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+(a[i+3]<<24)}function $y(a,i,u){a===1&&u.readMessage(h_,i)}function h_(a,i,u){if(a===3){const{id:d,bitmap:_,width:b,height:w,left:A,top:M,advance:z}=u.readMessage(f_,{});i.push({id:d,bitmap:new Lc({width:b+6,height:w+6},_),metrics:{width:b,height:w,left:A,top:M,advance:z}})}}function f_(a,i,u){a===1?i.id=u.readVarint():a===2?i.bitmap=u.readBytes():a===3?i.width=u.readVarint():a===4?i.height=u.readVarint():a===5?i.left=u.readSVarint():a===6?i.top=u.readSVarint():a===7&&(i.advance=u.readVarint())}function p_(a){let i=0,u=0;for(const w of a)i+=w.w*w.h,u=Math.max(u,w.w);a.sort((w,A)=>A.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),u),h:1/0}];let _=0,b=0;for(const w of a)for(let A=d.length-1;A>=0;A--){const M=d[A];if(!(w.w>M.w||w.h>M.h)){if(w.x=M.x,w.y=M.y,b=Math.max(b,w.y+w.h),_=Math.max(_,w.x+w.w),w.w===M.w&&w.h===M.h){const z=d.pop();A<d.length&&(d[A]=z)}else w.h===M.h?(M.x+=w.w,M.w-=w.w):w.w===M.w?(M.y+=w.h,M.h-=w.h):(d.push({x:M.x+w.w,y:M.y,w:M.w-w.w,h:w.h}),M.y+=w.h,M.h-=w.h);break}}return{w:_,h:b,fill:i/(_*b)||0}}fr.prototype={destroy:function(){this.buf=null},readFields:function(a,i,u){for(u=u||this.length;this.pos<u;){var d=this.readVarint(),_=d>>3,b=this.pos;this.type=7&d,a(_,i,this),this.pos===b&&this.skip(d)}return i},readMessage:function(a,i){return this.readFields(a,i,this.readVarint()+this.pos)},readFixed32:function(){var a=Kp(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=c_(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Kp(this.buf,this.pos)+Kp(this.buf,this.pos+4)*Cg;return this.pos+=8,a},readSFixed64:function(){var a=Kp(this.buf,this.pos)+c_(this.buf,this.pos+4)*Cg;return this.pos+=8,a},readFloat:function(){var a=bo(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=bo(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var i,u,d=this.buf;return i=127&(u=d[this.pos++]),u<128?i:(i|=(127&(u=d[this.pos++]))<<7,u<128?i:(i|=(127&(u=d[this.pos++]))<<14,u<128?i:(i|=(127&(u=d[this.pos++]))<<21,u<128?i:function(_,b,w){var A,M,z=w.buf;if(A=(112&(M=z[w.pos++]))>>4,M<128||(A|=(127&(M=z[w.pos++]))<<3,M<128)||(A|=(127&(M=z[w.pos++]))<<10,M<128)||(A|=(127&(M=z[w.pos++]))<<17,M<128)||(A|=(127&(M=z[w.pos++]))<<24,M<128)||(A|=(1&(M=z[w.pos++]))<<31,M<128))return Rh(_,A,b);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(u=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,i=this.pos;return this.pos=a,a-i>=12&&a_?function(u,d,_){return a_.decode(u.subarray(d,_))}(this.buf,i,a):function(u,d,_){for(var b="",w=d;w<_;){var A,M,z,F=u[w],U=null,X=F>239?4:F>223?3:F>191?2:1;if(w+X>_)break;X===1?F<128&&(U=F):X===2?(192&(A=u[w+1]))==128&&(U=(31&F)<<6|63&A)<=127&&(U=null):X===3?(M=u[w+2],(192&(A=u[w+1]))==128&&(192&M)==128&&((U=(15&F)<<12|(63&A)<<6|63&M)<=2047||U>=55296&&U<=57343)&&(U=null)):X===4&&(M=u[w+2],z=u[w+3],(192&(A=u[w+1]))==128&&(192&M)==128&&(192&z)==128&&((U=(15&F)<<18|(63&A)<<12|(63&M)<<6|63&z)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,X=1):U>65535&&(U-=65536,b+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),b+=String.fromCharCode(U),w+=X}return b}(this.buf,i,a)},readBytes:function(){var a=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,a);return this.pos=a,i},readPackedVarint:function(a,i){if(this.type!==fr.Bytes)return a.push(this.readVarint(i));var u=ou(this);for(a=a||[];this.pos<u;)a.push(this.readVarint(i));return a},readPackedSVarint:function(a){if(this.type!==fr.Bytes)return a.push(this.readSVarint());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==fr.Bytes)return a.push(this.readBoolean());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==fr.Bytes)return a.push(this.readFloat());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==fr.Bytes)return a.push(this.readDouble());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==fr.Bytes)return a.push(this.readFixed32());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==fr.Bytes)return a.push(this.readSFixed32());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==fr.Bytes)return a.push(this.readFixed64());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==fr.Bytes)return a.push(this.readSFixed64());var i=ou(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed64());return a},skip:function(a){var i=7&a;if(i===fr.Varint)for(;this.buf[this.pos++]>127;);else if(i===fr.Bytes)this.pos=this.readVarint()+this.pos;else if(i===fr.Fixed32)this.pos+=4;else{if(i!==fr.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(a,i){this.writeVarint(a<<3|i)},realloc:function(a){for(var i=this.length||16;i<this.pos+a;)i*=2;if(i!==this.length){var u=new Uint8Array(i);u.set(this.buf),this.buf=u,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),zh(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),zh(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),zh(this.buf,-1&a,this.pos),zh(this.buf,Math.floor(a*Tg),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),zh(this.buf,-1&a,this.pos),zh(this.buf,Math.floor(a*Tg),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(i,u){var d,_;if(i>=0?(d=i%4294967296|0,_=i/4294967296|0):(_=~(-i/4294967296),4294967295^(d=~(-i%4294967296))?d=d+1|0:(d=0,_=_+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(b,w,A){A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,A.buf[A.pos]=127&(b>>>=7)}(d,0,u),function(b,w){var A=(7&b)<<4;w.buf[w.pos++]|=A|((b>>>=3)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b|((b>>>=7)?128:0),b&&(w.buf[w.pos++]=127&b)))))}(_,u)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var i=this.pos;this.pos=function(d,_,b){for(var w,A,M=0;M<_.length;M++){if((w=_.charCodeAt(M))>55295&&w<57344){if(!A){w>56319||M+1===_.length?(d[b++]=239,d[b++]=191,d[b++]=189):A=w;continue}if(w<56320){d[b++]=239,d[b++]=191,d[b++]=189,A=w;continue}w=A-55296<<10|w-56320|65536,A=null}else A&&(d[b++]=239,d[b++]=191,d[b++]=189,A=null);w<128?d[b++]=w:(w<2048?d[b++]=w>>6|192:(w<65536?d[b++]=w>>12|224:(d[b++]=w>>18|240,d[b++]=w>>12&63|128),d[b++]=w>>6&63|128),d[b++]=63&w|128)}return b}(this.buf,a,this.pos);var u=this.pos-i;u>=128&&yl(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeFloat:function(a){this.realloc(4),s_(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),s_(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var i=a.length;this.writeVarint(i),this.realloc(i);for(var u=0;u<i;u++)this.buf[this.pos++]=a[u]},writeRawMessage:function(a,i){this.pos++;var u=this.pos;a(i,this);var d=this.pos-u;d>=128&&yl(u,d,this),this.pos=u-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,i,u){this.writeTag(a,fr.Bytes),this.writeRawMessage(i,u)},writePackedVarint:function(a,i){i.length&&this.writeMessage(a,us,i)},writePackedSVarint:function(a,i){i.length&&this.writeMessage(a,Ag,i)},writePackedBoolean:function(a,i){i.length&&this.writeMessage(a,Jy,i)},writePackedFloat:function(a,i){i.length&&this.writeMessage(a,Ky,i)},writePackedDouble:function(a,i){i.length&&this.writeMessage(a,Pg,i)},writePackedFixed32:function(a,i){i.length&&this.writeMessage(a,Qy,i)},writePackedSFixed32:function(a,i){i.length&&this.writeMessage(a,Lf,i)},writePackedFixed64:function(a,i){i.length&&this.writeMessage(a,l_,i)},writePackedSFixed64:function(a,i){i.length&&this.writeMessage(a,u_,i)},writeBytesField:function(a,i){this.writeTag(a,fr.Bytes),this.writeBytes(i)},writeFixed32Field:function(a,i){this.writeTag(a,fr.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(a,i){this.writeTag(a,fr.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(a,i){this.writeTag(a,fr.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(a,i){this.writeTag(a,fr.Fixed64),this.writeSFixed64(i)},writeVarintField:function(a,i){this.writeTag(a,fr.Varint),this.writeVarint(i)},writeSVarintField:function(a,i){this.writeTag(a,fr.Varint),this.writeSVarint(i)},writeStringField:function(a,i){this.writeTag(a,fr.Bytes),this.writeString(i)},writeFloatField:function(a,i){this.writeTag(a,fr.Fixed32),this.writeFloat(i)},writeDoubleField:function(a,i){this.writeTag(a,fr.Fixed64),this.writeDouble(i)},writeBooleanField:function(a,i){this.writeVarintField(a,Boolean(i))}};class Mf{constructor(i,{pixelRatio:u,version:d,stretchX:_,stretchY:b,content:w}){this.paddedRect=i,this.pixelRatio=u,this.stretchX=_,this.stretchY=b,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Lg{constructor(i,u){const d={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(i,d,b),this.addImages(u,_,b);const{w,h:A}=p_(b),M=new Ls({width:w||1,height:A||1});for(const z in i){const F=i[z],U=d[z].paddedRect;Ls.copy(F.data,M,{x:0,y:0},{x:U.x+1,y:U.y+1},F.data)}for(const z in u){const F=u[z],U=_[z].paddedRect,X=U.x+1,j=U.y+1,H=F.data.width,ut=F.data.height;Ls.copy(F.data,M,{x:0,y:0},{x:X,y:j},F.data),Ls.copy(F.data,M,{x:0,y:ut-1},{x:X,y:j-1},{width:H,height:1}),Ls.copy(F.data,M,{x:0,y:0},{x:X,y:j+ut},{width:H,height:1}),Ls.copy(F.data,M,{x:H-1,y:0},{x:X-1,y:j},{width:1,height:ut}),Ls.copy(F.data,M,{x:0,y:0},{x:X+H,y:j},{width:1,height:ut})}this.image=M,this.iconPositions=d,this.patternPositions=_}addImages(i,u,d){for(const _ in i){const b=i[_],w={x:0,y:0,w:b.data.width+2,h:b.data.height+2};d.push(w),u[_]=new Mf(w,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(i,u){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in i.updatedImages)this.patchUpdatedImage(this.iconPositions[d],i.getImage(d),u),this.patchUpdatedImage(this.patternPositions[d],i.getImage(d),u)}patchUpdatedImage(i,u,d){if(!i||!u||i.version===u.version)return;i.version=u.version;const[_,b]=i.tl;d.update(u.data,void 0,{x:_,y:b})}}Ne("ImagePosition",Mf),Ne("ImageAtlas",Lg),l.WritingMode=void 0,(iu=l.WritingMode||(l.WritingMode={}))[iu.none=0]="none",iu[iu.horizontal=1]="horizontal",iu[iu.vertical=2]="vertical",iu[iu.horizontalOnly=3]="horizontalOnly";const Xu=-17;class Rc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,u){const d=new Rc;return d.scale=i||1,d.fontStack=u,d}static forImage(i){const u=new Rc;return u.imageName=i,u}}class zc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,u){const d=new zc;for(let _=0;_<i.sections.length;_++){const b=i.sections[_];b.image?d.addImageSection(b):d.addTextSection(b,u)}return d}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let u="";for(let d=0;d<i.length;d++){const _=i.charCodeAt(d+1)||null,b=i.charCodeAt(d-1)||null;u+=_&&Ic(_)&&!Pf[i[d+1]]||b&&Ic(b)&&!Pf[i[d-1]]||!Pf[i[d]]?i[d]:Pf[i[d]]}return u}(this.text)}trim(){let i=0;for(let d=0;d<this.text.length&&Oc[this.text.charCodeAt(d)];d++)i++;let u=this.text.length;for(let d=this.text.length-1;d>=0&&d>=i&&Oc[this.text.charCodeAt(d)];d--)u--;this.text=this.text.substring(i,u),this.sectionIndex=this.sectionIndex.slice(i,u)}substring(i,u){const d=new zc;return d.text=this.text.substring(i,u),d.sectionIndex=this.sectionIndex.slice(i,u),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,u)=>Math.max(i,this.sections[u].scale),0)}addTextSection(i,u){this.text+=i.text,this.sections.push(Rc.forText(i.scale,i.fontStack||u));const d=this.sections.length-1;for(let _=0;_<i.text.length;++_)this.sectionIndex.push(d)}addImageSection(i){const u=i.image?i.image.name:"";if(u.length===0)return void ee("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Rc.forImage(u)),this.sectionIndex.push(this.sections.length-1)):ee("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Df(a,i,u,d,_,b,w,A,M,z,F,U,X,j,H,ut){const ct=zc.fromFeature(a,_);let St;U===l.WritingMode.vertical&&ct.verticalizePunctuation();const{processBidirectionalText:Rt,processStyledBidirectionalText:Lt}=xo;if(Rt&&ct.sections.length===1){St=[];const Qt=Rt(ct.toString(),Dg(ct,z,b,i,d,j,H));for(const Me of Qt){const Ue=new zc;Ue.text=Me,Ue.sections=ct.sections;for(let Ee=0;Ee<Me.length;Ee++)Ue.sectionIndex.push(0);St.push(Ue)}}else if(Lt){St=[];const Qt=Lt(ct.text,ct.sectionIndex,Dg(ct,z,b,i,d,j,H));for(const Me of Qt){const Ue=new zc;Ue.text=Me[0],Ue.sectionIndex=Me[1],Ue.sections=ct.sections,St.push(Ue)}}else St=function(Qt,Me){const Ue=[],Ee=Qt.text;let Se=0;for(const _e of Me)Ue.push(Qt.substring(Se,_e)),Se=_e;return Se<Ee.length&&Ue.push(Qt.substring(Se,Ee.length)),Ue}(ct,Dg(ct,z,b,i,d,j,H));const qt=[],ne={positionedLines:qt,text:ct.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(Qt,Me,Ue,Ee,Se,_e,Pe,Ce,ce,He,Ve,Sn){let er=0,Ar=Xu,yr=0,ji=0;const yi=Ce==="right"?1:Ce==="left"?0:.5;let vi=0;for(const xi of Se){xi.trim();const lo=xi.getMaxScale(),Io=(lo-1)*Mi,qo={positionedGlyphs:[],lineOffset:0};Qt.positionedLines[vi]=qo;const hs=qo.positionedGlyphs;let fs=0;if(!xi.length()){Ar+=_e,++vi;continue}for(let Bi=0;Bi<xi.length();Bi++){const An=xi.getSection(Bi),Ui=xi.getSectionIndex(Bi),je=xi.getCharCode(Bi);let Eo=0,Ur=null,pr=null,Ua=null,Xo=Mi;const wa=!(ce===l.WritingMode.horizontal||!Ve&&!Nu(je)||Ve&&(Oc[je]||(Fi=je,be.Arabic(Fi)||be["Arabic Supplement"](Fi)||be["Arabic Extended-A"](Fi)||be["Arabic Presentation Forms-A"](Fi)||be["Arabic Presentation Forms-B"](Fi))));if(An.imageName){const Hs=Ee[An.imageName];if(!Hs)continue;Ua=An.imageName,Qt.iconsInText=Qt.iconsInText||!0,pr=Hs.paddedRect;const ps=Hs.displaySize;An.scale=An.scale*Mi/Sn,Ur={width:ps[0],height:ps[1],left:1,top:-3,advance:wa?ps[1]:ps[0]},Eo=Io+(Mi-ps[1]*An.scale),Xo=Ur.advance;const au=wa?ps[0]*An.scale-Mi*lo:ps[1]*An.scale-Mi*lo;au>0&&au>fs&&(fs=au)}else{const Hs=Ue[An.fontStack],ps=Hs&&Hs[je];if(ps&&ps.rect)pr=ps.rect,Ur=ps.metrics;else{const au=Me[An.fontStack],Of=au&&au[je];if(!Of)continue;Ur=Of.metrics}Eo=(lo-An.scale)*Mi}wa?(Qt.verticalizable=!0,hs.push({glyph:je,imageName:Ua,x:er,y:Ar+Eo,vertical:wa,scale:An.scale,fontStack:An.fontStack,sectionIndex:Ui,metrics:Ur,rect:pr}),er+=Xo*An.scale+He):(hs.push({glyph:je,imageName:Ua,x:er,y:Ar+Eo,vertical:wa,scale:An.scale,fontStack:An.fontStack,sectionIndex:Ui,metrics:Ur,rect:pr}),er+=Ur.advance*An.scale+He)}hs.length!==0&&(yr=Math.max(er-He,yr),ev(hs,0,hs.length-1,yi,fs)),er=0;const qn=_e*lo+fs;qo.lineOffset=Math.max(fs,Io),Ar+=qn,ji=Math.max(qn,ji),++vi}var Fi;const ao=Ar-Xu,{horizontalAlign:wo,verticalAlign:cs}=Ng(Pe);(function(xi,lo,Io,qo,hs,fs,qn,Bi,An){const Ui=(lo-Io)*hs;let je=0;je=fs!==qn?-Bi*qo-Xu:(-qo*An+.5)*qn;for(const Eo of xi)for(const Ur of Eo.positionedGlyphs)Ur.x+=Ui,Ur.y+=je})(Qt.positionedLines,yi,wo,cs,yr,ji,_e,ao,Se.length),Qt.top+=-cs*ao,Qt.bottom=Qt.top+ao,Qt.left+=-wo*yr,Qt.right=Qt.left+yr}(ne,i,u,d,St,w,A,M,U,z,X,ut),!function(Qt){for(const Me of Qt)if(Me.positionedGlyphs.length!==0)return!1;return!0}(qt)&&ne}const Oc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},d_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ba(a,i,u,d,_,b){if(i.imageName){const w=d[i.imageName];return w?w.displaySize[0]*i.scale*Mi/b+_:0}{const w=u[i.fontStack],A=w&&w[a];return A?A.metrics.advance*i.scale+_:0}}function Zu(a,i,u,d){const _=Math.pow(a-i,2);return d?a<i?_/2:2*_:_+Math.abs(u)*u}function tv(a,i,u){let d=0;return a===10&&(d-=1e4),u&&(d+=150),a!==40&&a!==65288||(d+=50),i!==41&&i!==65289||(d+=50),d}function Mg(a,i,u,d,_,b){let w=null,A=Zu(i,u,_,b);for(const M of d){const z=Zu(i-M.x,u,_,b)+M.badness;z<=A&&(w=M,A=z)}return{index:a,x:i,priorBreak:w,badness:A}}function g_(a){return a?g_(a.priorBreak).concat(a.index):[]}function Dg(a,i,u,d,_,b,w){if(b!=="point")return[];if(!a)return[];const A=[],M=function(X,j,H,ut,ct,St){let Rt=0;for(let Lt=0;Lt<X.length();Lt++){const qt=X.getSection(Lt);Rt+=Ba(X.getCharCode(Lt),qt,ut,ct,j,St)}return Rt/Math.max(1,Math.ceil(Rt/H))}(a,i,u,d,_,w),z=a.text.indexOf("\u200B")>=0;let F=0;for(let X=0;X<a.length();X++){const j=a.getSection(X),H=a.getCharCode(X);if(Oc[H]||(F+=Ba(H,j,d,_,i,w)),X<a.length()-1){const ut=!((U=H)<11904||!(be["Bopomofo Extended"](U)||be.Bopomofo(U)||be["CJK Compatibility Forms"](U)||be["CJK Compatibility Ideographs"](U)||be["CJK Compatibility"](U)||be["CJK Radicals Supplement"](U)||be["CJK Strokes"](U)||be["CJK Symbols and Punctuation"](U)||be["CJK Unified Ideographs Extension A"](U)||be["CJK Unified Ideographs"](U)||be["Enclosed CJK Letters and Months"](U)||be["Halfwidth and Fullwidth Forms"](U)||be.Hiragana(U)||be["Ideographic Description Characters"](U)||be["Kangxi Radicals"](U)||be["Katakana Phonetic Extensions"](U)||be.Katakana(U)||be["Vertical Forms"](U)||be["Yi Radicals"](U)||be["Yi Syllables"](U)));(d_[H]||ut||j.imageName)&&A.push(Mg(X+1,F,M,A,tv(H,a.getCharCode(X+1),ut&&z),!1))}}var U;return g_(Mg(a.length(),F,M,A,0,!0))}function Ng(a){let i=.5,u=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:i,verticalAlign:u}}function ev(a,i,u,d,_){if(!d&&!_)return;const b=a[u],w=(a[u].x+b.metrics.advance*b.scale)*d;for(let A=i;A<=u;A++)a[A].x-=w,a[A].y+=_}function nv(a,i,u){const{horizontalAlign:d,verticalAlign:_}=Ng(u),b=i[0]-a.displaySize[0]*d,w=i[1]-a.displaySize[1]*_;return{image:a,top:w,bottom:w+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function m_(a,i,u,d,_,b){const w=a.image;let A;if(w.content){const ct=w.content,St=w.pixelRatio||1;A=[ct[0]/St,ct[1]/St,w.displaySize[0]-ct[2]/St,w.displaySize[1]-ct[3]/St]}const M=i.left*b,z=i.right*b;let F,U,X,j;u==="width"||u==="both"?(j=_[0]+M-d[3],U=_[0]+z+d[1]):(j=_[0]+(M+z-w.displaySize[0])/2,U=j+w.displaySize[0]);const H=i.top*b,ut=i.bottom*b;return u==="height"||u==="both"?(F=_[1]+H-d[0],X=_[1]+ut+d[2]):(F=_[1]+(H+ut-w.displaySize[1])/2,X=F+w.displaySize[1]),{image:w,top:F,right:U,bottom:X,left:j,collisionPadding:A}}const su=128;function __(a,i){const{expression:u}=i;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Sr(a+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:_}=u;let b=0;for(;b<d.length&&d[b]<=a;)b++;b=Math.max(0,b-1);let w=b;for(;w<d.length&&d[w]<a+1;)w++;w=Math.min(d.length-1,w);const A=d[b],M=d[w];return u.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:M,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:M,minSize:u.evaluate(new Sr(A)),maxSize:u.evaluate(new Sr(M)),interpolationType:_}}}class Yu extends Jt{constructor(i,u,d,_){super(i,u),this.angle=d,_!==void 0&&(this.segment=_)}clone(){return new Yu(this.x,this.y,this.angle,this.segment)}}function y_(a,i,u,d,_){if(i.segment===void 0)return!0;let b=i,w=i.segment+1,A=0;for(;A>-u/2;){if(w--,w<0)return!1;A-=a[w].dist(b),b=a[w]}A+=a[w].dist(a[w+1]),w++;const M=[];let z=0;for(;A<u/2;){const F=a[w],U=a[w+1];if(!U)return!1;let X=a[w-1].angleTo(F)-F.angleTo(U);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:A,angleDelta:X}),z+=X;A-M[0].distance>d;)z-=M.shift().angleDelta;if(z>_)return!1;w++,A+=F.dist(U)}return!0}function v_(a){let i=0;for(let u=0;u<a.length-1;u++)i+=a[u].dist(a[u+1]);return i}function Rg(a,i,u){return a?.6*i*u:0}function zg(a,i){return Math.max(a?a.right-a.left:0,i?i.right-i.left:0)}function x_(a,i,u,d,_,b){const w=Rg(u,_,b),A=zg(u,d)*b;let M=0;const z=v_(a)/2;for(let F=0;F<a.length-1;F++){const U=a[F],X=a[F+1],j=U.dist(X);if(M+j>z){const H=(z-M)/j,ut=li(U.x,X.x,H),ct=li(U.y,X.y,H),St=new Yu(ut,ct,X.angleTo(U),F);return St._round(),!w||y_(a,St,A,w,i)?St:void 0}M+=j}}function rv(a,i,u,d,_,b,w,A,M){const z=Rg(d,b,w),F=zg(d,_),U=F*w,X=a[0].x===0||a[0].x===M||a[0].y===0||a[0].y===M;return i-U<i/4&&(i=U+i/4),b_(a,X?i/2*A%i:(F/2+2*b)*w*A%i,i,z,u,U,X,!1,M)}function b_(a,i,u,d,_,b,w,A,M){const z=b/2,F=v_(a);let U=0,X=i-u,j=[];for(let H=0;H<a.length-1;H++){const ut=a[H],ct=a[H+1],St=ut.dist(ct),Rt=ct.angleTo(ut);for(;X+u<U+St;){X+=u;const Lt=(X-U)/St,qt=li(ut.x,ct.x,Lt),ne=li(ut.y,ct.y,Lt);if(qt>=0&&qt<M&&ne>=0&&ne<M&&X-z>=0&&X+z<=F){const Qt=new Yu(qt,ne,Rt,H);Qt._round(),d&&!y_(a,Qt,b,d,_)||j.push(Qt)}}U+=St}return A||j.length||w||(j=b_(a,U/2,u,d,_,b,w,!0,M)),j}function w_(a,i,u,d,_){const b=[];for(let w=0;w<a.length;w++){const A=a[w];let M;for(let z=0;z<A.length-1;z++){let F=A[z],U=A[z+1];F.x<i&&U.x<i||(F.x<i?F=new Jt(i,F.y+(i-F.x)/(U.x-F.x)*(U.y-F.y))._round():U.x<i&&(U=new Jt(i,F.y+(i-F.x)/(U.x-F.x)*(U.y-F.y))._round()),F.y<u&&U.y<u||(F.y<u?F=new Jt(F.x+(u-F.y)/(U.y-F.y)*(U.x-F.x),u)._round():U.y<u&&(U=new Jt(F.x+(u-F.y)/(U.y-F.y)*(U.x-F.x),u)._round()),F.x>=d&&U.x>=d||(F.x>=d?F=new Jt(d,F.y+(d-F.x)/(U.x-F.x)*(U.y-F.y))._round():U.x>=d&&(U=new Jt(d,F.y+(d-F.x)/(U.x-F.x)*(U.y-F.y))._round()),F.y>=_&&U.y>=_||(F.y>=_?F=new Jt(F.x+(_-F.y)/(U.y-F.y)*(U.x-F.x),_)._round():U.y>=_&&(U=new Jt(F.x+(_-F.y)/(U.y-F.y)*(U.x-F.x),_)._round()),M&&F.equals(M[M.length-1])||(M=[F],b.push(M)),M.push(U)))))}}return b}function Og(a,i,u,d){const _=[],b=a.image,w=b.pixelRatio,A=b.paddedRect.w-2,M=b.paddedRect.h-2,z=a.right-a.left,F=a.bottom-a.top,U=b.stretchX||[[0,A]],X=b.stretchY||[[0,M]],j=(_e,Pe)=>_e+Pe[1]-Pe[0],H=U.reduce(j,0),ut=X.reduce(j,0),ct=A-H,St=M-ut;let Rt=0,Lt=H,qt=0,ne=ut,Qt=0,Me=ct,Ue=0,Ee=St;if(b.content&&d){const _e=b.content;Rt=Jp(U,0,_e[0]),qt=Jp(X,0,_e[1]),Lt=Jp(U,_e[0],_e[2]),ne=Jp(X,_e[1],_e[3]),Qt=_e[0]-Rt,Ue=_e[1]-qt,Me=_e[2]-_e[0]-Lt,Ee=_e[3]-_e[1]-ne}const Se=(_e,Pe,Ce,ce)=>{const He=Qp(_e.stretch-Rt,Lt,z,a.left),Ve=$p(_e.fixed-Qt,Me,_e.stretch,H),Sn=Qp(Pe.stretch-qt,ne,F,a.top),er=$p(Pe.fixed-Ue,Ee,Pe.stretch,ut),Ar=Qp(Ce.stretch-Rt,Lt,z,a.left),yr=$p(Ce.fixed-Qt,Me,Ce.stretch,H),ji=Qp(ce.stretch-qt,ne,F,a.top),yi=$p(ce.fixed-Ue,Ee,ce.stretch,ut),vi=new Jt(He,Sn),Fi=new Jt(Ar,Sn),ao=new Jt(Ar,ji),wo=new Jt(He,ji),cs=new Jt(Ve/w,er/w),xi=new Jt(yr/w,yi/w),lo=i*Math.PI/180;if(lo){const hs=Math.sin(lo),fs=Math.cos(lo),qn=[fs,-hs,hs,fs];vi._matMult(qn),Fi._matMult(qn),wo._matMult(qn),ao._matMult(qn)}const Io=_e.stretch+_e.fixed,qo=Pe.stretch+Pe.fixed;return{tl:vi,tr:Fi,bl:wo,br:ao,tex:{x:b.paddedRect.x+1+Io,y:b.paddedRect.y+1+qo,w:Ce.stretch+Ce.fixed-Io,h:ce.stretch+ce.fixed-qo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:cs,pixelOffsetBR:xi,minFontScaleX:Me/w/z,minFontScaleY:Ee/w/F,isSDF:u}};if(d&&(b.stretchX||b.stretchY)){const _e=I_(U,ct,H),Pe=I_(X,St,ut);for(let Ce=0;Ce<_e.length-1;Ce++){const ce=_e[Ce],He=_e[Ce+1];for(let Ve=0;Ve<Pe.length-1;Ve++)_.push(Se(ce,Pe[Ve],He,Pe[Ve+1]))}}else _.push(Se({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:M+1}));return _}function Jp(a,i,u){let d=0;for(const _ of a)d+=Math.max(i,Math.min(u,_[1]))-Math.max(i,Math.min(u,_[0]));return d}function I_(a,i,u){const d=[{fixed:-1,stretch:0}];for(const[_,b]of a){const w=d[d.length-1];d.push({fixed:_-w.stretch,stretch:w.stretch}),d.push({fixed:_-w.stretch,stretch:w.stretch+(b-_)})}return d.push({fixed:i+1,stretch:u}),d}function Qp(a,i,u,d){return a/i*u+d}function $p(a,i,u,d){return a-i*u/d}Ne("Anchor",Yu);class td{constructor(i,u,d,_,b,w,A,M,z,F){if(this.boxStartIndex=i.length,z){let U=w.top,X=w.bottom;const j=w.collisionPadding;j&&(U-=j[1],X+=j[3]);let H=X-U;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{let U=w.top*A-M,X=w.bottom*A+M,j=w.left*A-M,H=w.right*A+M;const ut=w.collisionPadding;if(ut&&(j-=ut[0]*A,U-=ut[1]*A,H+=ut[2]*A,X+=ut[3]*A),F){const ct=new Jt(j,U),St=new Jt(H,U),Rt=new Jt(j,X),Lt=new Jt(H,X),qt=F*Math.PI/180;ct._rotate(qt),St._rotate(qt),Rt._rotate(qt),Lt._rotate(qt),j=Math.min(ct.x,St.x,Rt.x,Lt.x),H=Math.max(ct.x,St.x,Rt.x,Lt.x),U=Math.min(ct.y,St.y,Rt.y,Lt.y),X=Math.max(ct.y,St.y,Rt.y,Lt.y)}i.emplaceBack(u.x,u.y,j,U,H,X,d,_,b)}this.boxEndIndex=i.length}}class iv{constructor(i=[],u=xa){if(this.data=i,this.length=this.data.length,this.compare=u,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:u,compare:d}=this,_=u[i];for(;i>0;){const b=i-1>>1,w=u[b];if(d(_,w)>=0)break;u[i]=w,i=b}u[i]=_}_down(i){const{data:u,compare:d}=this,_=this.length>>1,b=u[i];for(;i<_;){let w=1+(i<<1),A=u[w];const M=w+1;if(M<this.length&&d(u[M],A)<0&&(w=M,A=u[M]),d(A,b)>=0)break;u[i]=A,i=w}u[i]=b}}function xa(a,i){return a<i?-1:a>i?1:0}function ov(a,i=1,u=!1){let d=1/0,_=1/0,b=-1/0,w=-1/0;const A=a[0];for(let j=0;j<A.length;j++){const H=A[j];(!j||H.x<d)&&(d=H.x),(!j||H.y<_)&&(_=H.y),(!j||H.x>b)&&(b=H.x),(!j||H.y>w)&&(w=H.y)}const M=Math.min(b-d,w-_);let z=M/2;const F=new iv([],sv);if(M===0)return new Jt(d,_);for(let j=d;j<b;j+=M)for(let H=_;H<w;H+=M)F.push(new Oh(j+z,H+z,z,a));let U=function(j){let H=0,ut=0,ct=0;const St=j[0];for(let Rt=0,Lt=St.length,qt=Lt-1;Rt<Lt;qt=Rt++){const ne=St[Rt],Qt=St[qt],Me=ne.x*Qt.y-Qt.x*ne.y;ut+=(ne.x+Qt.x)*Me,ct+=(ne.y+Qt.y)*Me,H+=3*Me}return new Oh(ut/H,ct/H,0,j)}(a),X=F.length;for(;F.length;){const j=F.pop();(j.d>U.d||!U.d)&&(U=j,u&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,X)),j.max-U.d<=i||(z=j.h/2,F.push(new Oh(j.p.x-z,j.p.y-z,z,a)),F.push(new Oh(j.p.x+z,j.p.y-z,z,a)),F.push(new Oh(j.p.x-z,j.p.y+z,z,a)),F.push(new Oh(j.p.x+z,j.p.y+z,z,a)),X+=4)}return u&&(console.log(`num probes: ${X}`),console.log(`best distance: ${U.d}`)),U.p}function sv(a,i){return i.max-a.max}function Oh(a,i,u,d){this.p=new Jt(a,i),this.h=u,this.d=function(_,b){let w=!1,A=1/0;for(let M=0;M<b.length;M++){const z=b[M];for(let F=0,U=z.length,X=U-1;F<U;X=F++){const j=z[F],H=z[X];j.y>_.y!=H.y>_.y&&_.x<(H.x-j.x)*(_.y-j.y)/(H.y-j.y)+j.x&&(w=!w),A=Math.min(A,Rm(_,j,H))}}return(w?1:-1)*Math.sqrt(A)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}const ed=Number.POSITIVE_INFINITY;function E_(a,i){return i[1]!==ed?function(u,d,_){let b=0,w=0;switch(d=Math.abs(d),_=Math.abs(_),u){case"top-right":case"top-left":case"top":w=_-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-_}switch(u){case"top-right":case"bottom-right":case"right":b=-d;break;case"top-left":case"bottom-left":case"left":b=d}return[b,w]}(a,i[0],i[1]):function(u,d){let _=0,b=0;d<0&&(d=0);const w=d/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=w-7;break;case"bottom-right":case"bottom-left":b=7-w;break;case"bottom":b=7-d;break;case"top":b=d-7}switch(u){case"top-right":case"bottom-right":_=-w;break;case"top-left":case"bottom-left":_=w;break;case"left":_=d;break;case"right":_=-d}return[_,b]}(a,i[0])}function kg(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function av(a,i,u,d,_,b,w,A,M,z,F){let U=b.textMaxSize.evaluate(i,{});U===void 0&&(U=w);const X=a.layers[0].layout,j=X.get("icon-offset").evaluate(i,{},F),H=S_(u.horizontal),ut=w/24,ct=a.tilePixelRatio*ut,St=a.tilePixelRatio*U/24,Rt=a.tilePixelRatio*A,Lt=a.tilePixelRatio*X.get("symbol-spacing"),qt=X.get("text-padding")*a.tilePixelRatio,ne=X.get("icon-padding")*a.tilePixelRatio,Qt=X.get("text-max-angle")/180*Math.PI,Me=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",Ue=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Ee=X.get("symbol-placement"),Se=Lt/2,_e=X.get("icon-text-fit");let Pe;d&&_e!=="none"&&(a.allowVerticalPlacement&&u.vertical&&(Pe=m_(d,u.vertical,_e,X.get("icon-text-fit-padding"),j,ut)),H&&(d=m_(d,H,_e,X.get("icon-text-fit-padding"),j,ut)));const Ce=(ce,He)=>{He.x<0||He.x>=Tr||He.y<0||He.y>=Tr||function(Ve,Sn,er,Ar,yr,ji,yi,vi,Fi,ao,wo,cs,xi,lo,Io,qo,hs,fs,qn,Bi,An,Ui,je,Eo,Ur){const pr=Ve.addToLineVertexArray(Sn,er);let Ua,Xo,wa,Hs,ps=0,au=0,Of=0,ld=0,jg=-1,Va=-1;const vl={};let kf=Ys(""),Vr=0,ti=0;if(vi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Vr,ti]=vi.layout.get("text-offset").evaluate(An,{},Eo).map(uo=>uo*Mi):(Vr=vi.layout.get("text-radial-offset").evaluate(An,{},Eo)*Mi,ti=ed),Ve.allowVerticalPlacement&&Ar.vertical){const uo=vi.layout.get("text-rotate").evaluate(An,{},Eo)+90;wa=new td(Fi,Sn,ao,wo,cs,Ar.vertical,xi,lo,Io,uo),yi&&(Hs=new td(Fi,Sn,ao,wo,cs,yi,hs,fs,Io,uo))}if(yr){const uo=vi.layout.get("icon-rotate").evaluate(An,{}),bi=vi.layout.get("icon-text-fit")!=="none",xl=Og(yr,uo,je,bi),Bf=yi?Og(yi,uo,je,bi):void 0;Xo=new td(Fi,Sn,ao,wo,cs,yr,hs,fs,!1,uo),ps=4*xl.length;const B_=Ve.iconSizeData;let Fc=null;B_.kind==="source"?(Fc=[su*vi.layout.get("icon-size").evaluate(An,{})],Fc[0]>Wu&&ee(`${Ve.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):B_.kind==="composite"&&(Fc=[su*Ui.compositeIconSizes[0].evaluate(An,{},Eo),su*Ui.compositeIconSizes[1].evaluate(An,{},Eo)],(Fc[0]>Wu||Fc[1]>Wu)&&ee(`${Ve.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ve.addSymbols(Ve.icon,xl,Fc,Bi,qn,An,l.WritingMode.none,Sn,pr.lineStartIndex,pr.lineLength,-1,Eo),jg=Ve.icon.placedSymbolArray.length-1,Bf&&(au=4*Bf.length,Ve.addSymbols(Ve.icon,Bf,Fc,Bi,qn,An,l.WritingMode.vertical,Sn,pr.lineStartIndex,pr.lineLength,-1,Eo),Va=Ve.icon.placedSymbolArray.length-1)}const Hg=Object.keys(Ar.horizontal);for(const uo of Hg){const bi=Ar.horizontal[uo];if(!Ua){kf=Ys(bi.text);const Bf=vi.layout.get("text-rotate").evaluate(An,{},Eo);Ua=new td(Fi,Sn,ao,wo,cs,bi,xi,lo,Io,Bf)}const xl=bi.positionedLines.length===1;if(Of+=nd(Ve,Sn,bi,ji,vi,Io,An,qo,pr,Ar.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,xl?Hg:[uo],vl,jg,Ui,Eo),xl)break}Ar.vertical&&(ld+=nd(Ve,Sn,Ar.vertical,ji,vi,Io,An,qo,pr,l.WritingMode.vertical,["vertical"],vl,Va,Ui,Eo));const xv=Ua?Ua.boxStartIndex:Ve.collisionBoxArray.length,bv=Ua?Ua.boxEndIndex:Ve.collisionBoxArray.length,wv=wa?wa.boxStartIndex:Ve.collisionBoxArray.length,Iv=wa?wa.boxEndIndex:Ve.collisionBoxArray.length,Ev=Xo?Xo.boxStartIndex:Ve.collisionBoxArray.length,Sv=Xo?Xo.boxEndIndex:Ve.collisionBoxArray.length,F_=Hs?Hs.boxStartIndex:Ve.collisionBoxArray.length,Ff=Hs?Hs.boxEndIndex:Ve.collisionBoxArray.length;let Ks=-1;const ud=(uo,bi)=>uo&&uo.circleDiameter?Math.max(uo.circleDiameter,bi):bi;Ks=ud(Ua,Ks),Ks=ud(wa,Ks),Ks=ud(Xo,Ks),Ks=ud(Hs,Ks);const Kg=Ks>-1?1:0;Kg&&(Ks*=Ur/Mi),Ve.glyphOffsetArray.length>=kh.MAX_GLYPHS&&ee("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),An.sortKey!==void 0&&Ve.addToSortKeyRanges(Ve.symbolInstances.length,An.sortKey),Ve.symbolInstances.emplaceBack(Sn.x,Sn.y,vl.right>=0?vl.right:-1,vl.center>=0?vl.center:-1,vl.left>=0?vl.left:-1,vl.vertical||-1,jg,Va,kf,xv,bv,wv,Iv,Ev,Sv,F_,Ff,ao,Of,ld,ps,au,Kg,0,xi,Vr,ti,Ks)}(a,He,ce,u,d,_,Pe,a.layers[0],a.collisionBoxArray,i.index,i.sourceLayerIndex,a.index,ct,qt,Me,M,Rt,ne,Ue,j,i,b,z,F,w)};if(Ee==="line")for(const ce of w_(i.geometry,0,0,Tr,Tr)){const He=rv(ce,Lt,Qt,u.vertical||H,d,24,St,a.overscaling,Tr);for(const Ve of He){const Sn=H;Sn&&lv(a,Sn.text,Se,Ve)||Ce(ce,Ve)}}else if(Ee==="line-center"){for(const ce of i.geometry)if(ce.length>1){const He=x_(ce,Qt,u.vertical||H,d,24,St);He&&Ce(ce,He)}}else if(i.type==="Polygon")for(const ce of Fp(i.geometry,0)){const He=ov(ce,16);Ce(ce[0],new Yu(He.x,He.y,0))}else if(i.type==="LineString")for(const ce of i.geometry)Ce(ce,new Yu(ce[0].x,ce[0].y,0));else if(i.type==="Point")for(const ce of i.geometry)for(const He of ce)Ce([He],new Yu(He.x,He.y,0))}const Wu=32640;function nd(a,i,u,d,_,b,w,A,M,z,F,U,X,j,H){const ut=function(Rt,Lt,qt,ne,Qt,Me,Ue,Ee){const Se=ne.layout.get("text-rotate").evaluate(Me,{})*Math.PI/180,_e=[];for(const Pe of Lt.positionedLines)for(const Ce of Pe.positionedGlyphs){if(!Ce.rect)continue;const ce=Ce.rect||{};let He=4,Ve=!0,Sn=1,er=0;const Ar=(Qt||Ee)&&Ce.vertical,yr=Ce.metrics.advance*Ce.scale/2;if(Ee&&Lt.verticalizable){const qn=(Ce.scale-1)*Mi,Bi=(Mi-Ce.metrics.width*Ce.scale)/2;er=Pe.lineOffset/2-(Ce.imageName?-Bi:qn)}if(Ce.imageName){const qn=Ue[Ce.imageName];Ve=qn.sdf,Sn=qn.pixelRatio,He=1/Sn}const ji=Qt?[Ce.x+yr,Ce.y]:[0,0];let yi=Qt?[0,0]:[Ce.x+yr+qt[0],Ce.y+qt[1]-er],vi=[0,0];Ar&&(vi=yi,yi=[0,0]);const Fi=(Ce.metrics.left-He)*Ce.scale-yr+yi[0],ao=(-Ce.metrics.top-He)*Ce.scale+yi[1],wo=Fi+ce.w*Ce.scale/Sn,cs=ao+ce.h*Ce.scale/Sn,xi=new Jt(Fi,ao),lo=new Jt(wo,ao),Io=new Jt(Fi,cs),qo=new Jt(wo,cs);if(Ar){const qn=new Jt(-yr,yr-Xu),Bi=-Math.PI/2,An=12-yr,Ui=new Jt(22-An,-(Ce.imageName?An:0)),je=new Jt(...vi);xi._rotateAround(Bi,qn)._add(Ui)._add(je),lo._rotateAround(Bi,qn)._add(Ui)._add(je),Io._rotateAround(Bi,qn)._add(Ui)._add(je),qo._rotateAround(Bi,qn)._add(Ui)._add(je)}if(Se){const qn=Math.sin(Se),Bi=Math.cos(Se),An=[Bi,-qn,qn,Bi];xi._matMult(An),lo._matMult(An),Io._matMult(An),qo._matMult(An)}const hs=new Jt(0,0),fs=new Jt(0,0);_e.push({tl:xi,tr:lo,bl:Io,br:qo,tex:ce,writingMode:Lt.writingMode,glyphOffset:ji,sectionIndex:Ce.sectionIndex,isSDF:Ve,pixelOffsetTL:hs,pixelOffsetBR:fs,minFontScaleX:0,minFontScaleY:0})}return _e}(0,u,A,_,b,w,d,a.allowVerticalPlacement),ct=a.textSizeData;let St=null;ct.kind==="source"?(St=[su*_.layout.get("text-size").evaluate(w,{})],St[0]>Wu&&ee(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ct.kind==="composite"&&(St=[su*j.compositeTextSizes[0].evaluate(w,{},H),su*j.compositeTextSizes[1].evaluate(w,{},H)],(St[0]>Wu||St[1]>Wu)&&ee(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,ut,St,A,b,w,z,i,M.lineStartIndex,M.lineLength,X,H);for(const Rt of F)U[Rt]=a.text.placedSymbolArray.length-1;return 4*ut.length}function S_(a){for(const i in a)return a[i];return null}function lv(a,i,u,d){const _=a.compareText;if(i in _){const b=_[i];for(let w=b.length-1;w>=0;w--)if(d.dist(b[w])<u)return!0}else _[i]=[];return _[i].push(d),!1}const uv=js.VectorTileFeature.types,cv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rd(a,i,u,d,_,b,w,A,M,z,F,U,X){const j=A?Math.min(Wu,Math.round(A[0])):0,H=A?Math.min(Wu,Math.round(A[1])):0;a.emplaceBack(i,u,Math.round(32*d),Math.round(32*_),b,w,(j<<1)+(M?1:0),H,16*z,16*F,256*U,256*X)}function Fg(a,i,u){a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u),a.emplaceBack(i.x,i.y,u)}function hv(a){for(const i of a.sections)if(og(i.text))return!0;return!1}class Bg{constructor(i){this.layoutVertexArray=new Wi,this.indexArray=new Fo,this.programConfigurations=i,this.segments=new Gn,this.dynamicLayoutVertexArray=new Fr,this.opacityVertexArray=new As,this.placedSymbolArray=new se}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,u,d,_){this.isEmpty()||(d&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,jp.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Nh.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,cv,!0),this.opacityVertexBuffer.itemSize=1),(d||_)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ne("SymbolBuffers",Bg);class Ug{constructor(i,u,d){this.layoutVertexArray=new i,this.layoutAttributes=u,this.indexArray=new d,this.segments=new Gn,this.collisionVertexArray=new fl}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,un.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ne("CollisionBuffers",Ug);class kh{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(w=>w.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bf([]),this.placementViewportMatrix=bf([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=__(this.zoom,u["text-size"]),this.iconSizeData=__(this.zoom,u["icon-size"]);const d=this.layers[0].layout,_=d.get("symbol-sort-key"),b=d.get("symbol-z-order");this.canOverlap=Gg(d,"text-overlap","text-allow-overlap")!=="never"||Gg(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(w=>l.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=i.sourceID}createArrays(){this.text=new Bg(new Uo(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Bg(new Uo(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Re,this.lineVertexArray=new Ie,this.symbolInstances=new Ht}calculateGlyphDependencies(i,u,d,_,b){for(let w=0;w<i.length;w++)if(u[i.charCodeAt(w)]=!0,(d||_)&&b){const A=Pf[i.charAt(w)];A&&(u[A.charCodeAt(0)]=!0)}}populate(i,u,d){const _=this.layers[0],b=_.layout,w=b.get("text-font"),A=b.get("text-field"),M=b.get("icon-image"),z=(A.value.kind!=="constant"||A.value.value instanceof nt&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),F=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,U=b.get("symbol-sort-key");if(this.features=[],!z&&!F)return;const X=u.iconDependencies,j=u.glyphDependencies,H=u.availableImages,ut=new Sr(this.zoom);for(const{feature:ct,id:St,index:Rt,sourceLayerIndex:Lt}of i){const qt=_._featureFilter.needGeometry,ne=Tc(ct,qt);if(!_._featureFilter.filter(ut,ne,d))continue;let Qt,Me;if(qt||(ne.geometry=$l(ct)),z){const Ee=_.getValueAndResolveTokens("text-field",ne,d,H),Se=nt.factory(Ee);hv(Se)&&(this.hasRTLText=!0),(!this.hasRTLText||Wl()==="unavailable"||this.hasRTLText&&xo.isParsed())&&(Qt=Nc(Se,_,ne))}if(F){const Ee=_.getValueAndResolveTokens("icon-image",ne,d,H);Me=Ee instanceof dt?Ee:dt.fromString(Ee)}if(!Qt&&!Me)continue;const Ue=this.sortFeaturesByKey?U.evaluate(ne,{},d):void 0;if(this.features.push({id:St,text:Qt,icon:Me,index:Rt,sourceLayerIndex:Lt,geometry:ne.geometry,properties:ct.properties,type:uv[ct.type],sortKey:Ue}),Me&&(X[Me.name]=!0),Qt){const Ee=w.evaluate(ne,{},d).join(","),Se=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const _e of Qt.sections)if(_e.image)X[_e.image.name]=!0;else{const Pe=Du(Qt.toString()),Ce=_e.fontStack||Ee,ce=j[Ce]=j[Ce]||{};this.calculateGlyphDependencies(_e.text,ce,Se,this.allowVerticalPlacement,Pe)}}}b.get("symbol-placement")==="line"&&(this.features=function(ct){const St={},Rt={},Lt=[];let qt=0;function ne(Ee){Lt.push(ct[Ee]),qt++}function Qt(Ee,Se,_e){const Pe=Rt[Ee];return delete Rt[Ee],Rt[Se]=Pe,Lt[Pe].geometry[0].pop(),Lt[Pe].geometry[0]=Lt[Pe].geometry[0].concat(_e[0]),Pe}function Me(Ee,Se,_e){const Pe=St[Se];return delete St[Se],St[Ee]=Pe,Lt[Pe].geometry[0].shift(),Lt[Pe].geometry[0]=_e[0].concat(Lt[Pe].geometry[0]),Pe}function Ue(Ee,Se,_e){const Pe=_e?Se[0][Se[0].length-1]:Se[0][0];return`${Ee}:${Pe.x}:${Pe.y}`}for(let Ee=0;Ee<ct.length;Ee++){const Se=ct[Ee],_e=Se.geometry,Pe=Se.text?Se.text.toString():null;if(!Pe){ne(Ee);continue}const Ce=Ue(Pe,_e),ce=Ue(Pe,_e,!0);if(Ce in Rt&&ce in St&&Rt[Ce]!==St[ce]){const He=Me(Ce,ce,_e),Ve=Qt(Ce,ce,Lt[He].geometry);delete St[Ce],delete Rt[ce],Rt[Ue(Pe,Lt[Ve].geometry,!0)]=Ve,Lt[He].geometry=null}else Ce in Rt?Qt(Ce,ce,_e):ce in St?Me(Ce,ce,_e):(ne(Ee),St[Ce]=qt-1,Rt[ce]=qt-1)}return Lt.filter(Ee=>Ee.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ct,St)=>ct.sortKey-St.sortKey)}update(i,u,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,u,this.layers,d),this.icon.programConfigurations.updatePaintArrays(i,u,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,u){const d=this.lineVertexArray.length;if(i.segment!==void 0){let _=i.dist(u[i.segment+1]),b=i.dist(u[i.segment]);const w={};for(let A=i.segment+1;A<u.length;A++)w[A]={x:u[A].x,y:u[A].y,tileUnitDistanceFromAnchor:_},A<u.length-1&&(_+=u[A+1].dist(u[A]));for(let A=i.segment||0;A>=0;A--)w[A]={x:u[A].x,y:u[A].y,tileUnitDistanceFromAnchor:b},A>0&&(b+=u[A-1].dist(u[A]));for(let A=0;A<u.length;A++){const M=w[A];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(i,u,d,_,b,w,A,M,z,F,U,X){const j=i.indexArray,H=i.layoutVertexArray,ut=i.segments.prepareSegment(4*u.length,H,j,this.canOverlap?w.sortKey:void 0),ct=this.glyphOffsetArray.length,St=ut.vertexLength,Rt=this.allowVerticalPlacement&&A===l.WritingMode.vertical?Math.PI/2:0,Lt=w.text&&w.text.sections;for(let qt=0;qt<u.length;qt++){const{tl:ne,tr:Qt,bl:Me,br:Ue,tex:Ee,pixelOffsetTL:Se,pixelOffsetBR:_e,minFontScaleX:Pe,minFontScaleY:Ce,glyphOffset:ce,isSDF:He,sectionIndex:Ve}=u[qt],Sn=ut.vertexLength,er=ce[1];rd(H,M.x,M.y,ne.x,er+ne.y,Ee.x,Ee.y,d,He,Se.x,Se.y,Pe,Ce),rd(H,M.x,M.y,Qt.x,er+Qt.y,Ee.x+Ee.w,Ee.y,d,He,_e.x,Se.y,Pe,Ce),rd(H,M.x,M.y,Me.x,er+Me.y,Ee.x,Ee.y+Ee.h,d,He,Se.x,_e.y,Pe,Ce),rd(H,M.x,M.y,Ue.x,er+Ue.y,Ee.x+Ee.w,Ee.y+Ee.h,d,He,_e.x,_e.y,Pe,Ce),Fg(i.dynamicLayoutVertexArray,M,Rt),j.emplaceBack(Sn,Sn+1,Sn+2),j.emplaceBack(Sn+1,Sn+2,Sn+3),ut.vertexLength+=4,ut.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ce[0]),qt!==u.length-1&&Ve===u[qt+1].sectionIndex||i.programConfigurations.populatePaintArrays(H.length,w,w.index,{},X,Lt&&Lt[Ve])}i.placedSymbolArray.emplaceBack(M.x,M.y,ct,this.glyphOffsetArray.length-ct,St,z,F,M.segment,d?d[0]:0,d?d[1]:0,_[0],_[1],A,0,!1,0,U)}_addCollisionDebugVertex(i,u,d,_,b,w){return u.emplaceBack(0,0),i.emplaceBack(d.x,d.y,_,b,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(i,u,d,_,b,w,A){const M=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),z=M.vertexLength,F=b.layoutVertexArray,U=b.collisionVertexArray,X=A.anchorX,j=A.anchorY;this._addCollisionDebugVertex(F,U,w,X,j,new Jt(i,u)),this._addCollisionDebugVertex(F,U,w,X,j,new Jt(d,u)),this._addCollisionDebugVertex(F,U,w,X,j,new Jt(d,_)),this._addCollisionDebugVertex(F,U,w,X,j,new Jt(i,_)),M.vertexLength+=4;const H=b.indexArray;H.emplaceBack(z,z+1),H.emplaceBack(z+1,z+2),H.emplaceBack(z+2,z+3),H.emplaceBack(z+3,z),M.primitiveLength+=4}addDebugCollisionBoxes(i,u,d,_){for(let b=i;b<u;b++){const w=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,_?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ug(Ps,Af.members,_a),this.iconCollisionBox=new Ug(Ps,Af.members,_a);for(let i=0;i<this.symbolInstances.length;i++){const u=this.symbolInstances.get(i);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(i,u,d,_,b,w,A,M,z){const F={};for(let U=u;U<d;U++){const X=i.get(U);F.textBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.textFeatureIndex=X.featureIndex;break}for(let U=_;U<b;U++){const X=i.get(U);F.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.verticalTextFeatureIndex=X.featureIndex;break}for(let U=w;U<A;U++){const X=i.get(U);F.iconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.iconFeatureIndex=X.featureIndex;break}for(let U=M;U<z;U++){const X=i.get(U);F.verticalIconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},F.verticalIconFeatureIndex=X.featureIndex;break}return F}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,u){const d=i.placedSymbolArray.get(u),_=d.vertexStartIndex+4*d.numGlyphs;for(let b=d.vertexStartIndex;b<_;b+=4)i.indexArray.emplaceBack(b,b+1,b+2),i.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(i),d=Math.cos(i),_=[],b=[],w=[];for(let A=0;A<this.symbolInstances.length;++A){w.push(A);const M=this.symbolInstances.get(A);_.push(0|Math.round(u*M.anchorX+d*M.anchorY)),b.push(M.featureIndex)}return w.sort((A,M)=>_[A]-_[M]||b[M]-b[A]),w}addToSortKeyRanges(i,u){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===u?d.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const d=this.symbolInstances.get(u);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((_,b,w)=>{_>=0&&w.indexOf(_)===b&&this.addIndicesForPlacedSymbol(this.text,_)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ne("SymbolBucket",kh,{omit:["layers","collisionBoxArray","features","compareText"]}),kh.MAX_GLYPHS=65535,kh.addDynamicAttributes=Fg;const fv=new _i({"symbol-placement":new Be(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new Be(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Be(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Le(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Be(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Be(Bt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Be(Bt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Be(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Be(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Be(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Le(Bt.layout_symbol["icon-size"]),"icon-text-fit":new Be(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Be(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Le(Bt.layout_symbol["icon-image"]),"icon-rotate":new Le(Bt.layout_symbol["icon-rotate"]),"icon-padding":new Be(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new Be(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new Le(Bt.layout_symbol["icon-offset"]),"icon-anchor":new Le(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Be(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Be(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Be(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new Le(Bt.layout_symbol["text-field"]),"text-font":new Le(Bt.layout_symbol["text-font"]),"text-size":new Le(Bt.layout_symbol["text-size"]),"text-max-width":new Le(Bt.layout_symbol["text-max-width"]),"text-line-height":new Be(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new Le(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new Le(Bt.layout_symbol["text-justify"]),"text-radial-offset":new Le(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Be(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new Le(Bt.layout_symbol["text-anchor"]),"text-max-angle":new Be(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new Be(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new Le(Bt.layout_symbol["text-rotate"]),"text-padding":new Be(Bt.layout_symbol["text-padding"]),"text-keep-upright":new Be(Bt.layout_symbol["text-keep-upright"]),"text-transform":new Le(Bt.layout_symbol["text-transform"]),"text-offset":new Le(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new Be(Bt.layout_symbol["text-allow-overlap"]),"text-overlap":new Be(Bt.layout_symbol["text-overlap"]),"text-ignore-placement":new Be(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new Be(Bt.layout_symbol["text-optional"])});var Vg={paint:new _i({"icon-opacity":new Le(Bt.paint_symbol["icon-opacity"]),"icon-color":new Le(Bt.paint_symbol["icon-color"]),"icon-halo-color":new Le(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Le(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Le(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new Be(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Be(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Le(Bt.paint_symbol["text-opacity"]),"text-color":new Le(Bt.paint_symbol["text-color"],{runtimeType:Ci,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Le(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new Le(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new Le(Bt.paint_symbol["text-halo-blur"]),"text-translate":new Be(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new Be(Bt.paint_symbol["text-translate-anchor"])}),layout:fv};class C_{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:dn,this.defaultValue=i}evaluate(i){if(i.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(i.formattedSection))return u.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ne("FormatSectionOverride",C_,{omit:["defaultValue"]});class id extends so{constructor(i){super(i,Vg)}recalculate(i,u){if(super.recalculate(i,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const _=[];for(const b of d)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,u,d,_){const b=this.layout.get(i).evaluate(u,{},d,_),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||Au(w.value)||!b?b:function(A,M){return M.replace(/{([^{}]+)}/g,(z,F)=>F in A?String(A[F]):"")}(u.properties,b)}createBucket(i){return new kh(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of Vg.paint.overridableProperties){if(!id.hasPaintOverride(this.layout,i))continue;const u=this.paint.get(i),d=new C_(u),_=new ch(d,u.property.specification);let b=null;b=u.value.kind==="constant"||u.value.kind==="source"?new mc("source",_):new hh("composite",_,u.value.zoomStops,u.value._interpolationType),this.paint._values[i]=new Xs(u.property,b,u.parameters)}}_handleOverridablePaintPropertyUpdate(i,u,d){return!(!this.layout||u.isDataDriven()||d.isDataDriven())&&id.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,u){const d=i.get("text-field"),_=Vg.paint.properties[u];let b=!1;const w=A=>{for(const M of A)if(_.overrides&&_.overrides.hasOverride(M))return void(b=!0)};if(d.value.kind==="constant"&&d.value.value instanceof nt)w(d.value.value.sections);else if(d.value.kind==="source"){const A=z=>{b||(z instanceof te&&gt(z.value)===rs?w(z.value.sections):z instanceof De?w(z.sections):z.eachChild(A))},M=d.value;M._styleExpression&&A(M._styleExpression.expression)}return b}}function Gg(a,i,u){let d="never";const _=a.get(i);return _?d=_:a.get(u)&&(d="always"),d}var pv={paint:new _i({"background-color":new Be(Bt.paint_background["background-color"]),"background-pattern":new Sc(Bt.paint_background["background-pattern"]),"background-opacity":new Be(Bt.paint_background["background-opacity"])})},dv={paint:new _i({"raster-opacity":new Be(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Be(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Be(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Be(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new Be(Bt.paint_raster["raster-saturation"]),"raster-contrast":new Be(Bt.paint_raster["raster-contrast"]),"raster-resampling":new Be(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new Be(Bt.paint_raster["raster-fade-duration"])})};class gv extends so{constructor(i){super(i,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}}const mv={circle:class extends so{constructor(a){super(a,fg)}createBucket(a){return new cg(a)}queryRadius(a){const i=a;return xf("circle-radius",this,i)+xf("circle-stroke-width",this,i)+Pp(this.paint.get("circle-translate"))}queryIntersectsFeature(a,i,u,d,_,b,w,A){const M=Lp(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,w),z=this.paint.get("circle-radius").evaluate(i,u)+this.paint.get("circle-stroke-width").evaluate(i,u),F=this.paint.get("circle-pitch-alignment")==="map",U=F?M:function(j,H){return j.map(ut=>Bm(ut,H))}(M,A),X=F?z*w:z;for(const j of d)for(const H of j){const ut=F?H:Bm(H,A);let ct=X;const St=Pc([],[H.x,H.y,0,1],A);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ct*=St[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ct*=b.cameraToCenterDistance/St[3]),Uy(U,ut,ct))return!0}return!1}},heatmap:class extends so{constructor(a){super(a,Um),this._updateColorRamp()}createBucket(a){return new dg(a)}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Mp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends so{constructor(a){super(a,Gy)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends so{constructor(a){super(a,Wy)}recalculate(a,i){super.recalculate(a,i);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Go(a)}queryRadius(){return Pp(this.paint.get("fill-translate"))}queryIntersectsFeature(a,i,u,d,_,b,w){return Ch(Lp(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,w),d)}isTileClipped(){return!0}},"fill-extrusion":class extends so{constructor(a){super(a,$m)}createBucket(a){return new Ig(a)}queryRadius(){return Pp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,i,u,d,_,b,w,A){const M=Lp(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,w),z=this.paint.get("fill-extrusion-height").evaluate(i,u),F=this.paint.get("fill-extrusion-base").evaluate(i,u),U=function(j,H,ut,ct){const St=[];for(const Rt of j){const Lt=[Rt.x,Rt.y,0,1];Pc(Lt,Lt,H),St.push(new Jt(Lt[0]/Lt[3],Lt[1]/Lt[3]))}return St}(M,A),X=function(j,H,ut,ct){const St=[],Rt=[],Lt=ct[8]*H,qt=ct[9]*H,ne=ct[10]*H,Qt=ct[11]*H,Me=ct[8]*ut,Ue=ct[9]*ut,Ee=ct[10]*ut,Se=ct[11]*ut;for(const _e of j){const Pe=[],Ce=[];for(const ce of _e){const He=ce.x,Ve=ce.y,Sn=ct[0]*He+ct[4]*Ve+ct[12],er=ct[1]*He+ct[5]*Ve+ct[13],Ar=ct[2]*He+ct[6]*Ve+ct[14],yr=ct[3]*He+ct[7]*Ve+ct[15],ji=Ar+ne,yi=yr+Qt,vi=Sn+Me,Fi=er+Ue,ao=Ar+Ee,wo=yr+Se,cs=new Jt((Sn+Lt)/yi,(er+qt)/yi);cs.z=ji/yi,Pe.push(cs);const xi=new Jt(vi/wo,Fi/wo);xi.z=ao/wo,Ce.push(xi)}St.push(Pe),Rt.push(Ce)}return[St,Rt]}(d,F,z,A);return function(j,H,ut){let ct=1/0;Ch(ut,H)&&(ct=t_(ut,H[0]));for(let St=0;St<H.length;St++){const Rt=H[St],Lt=j[St];for(let qt=0;qt<Rt.length-1;qt++){const ne=Rt[qt],Qt=[ne,Rt[qt+1],Lt[qt+1],Lt[qt],ne];Ap(ut,Qt)&&(ct=Math.min(ct,t_(ut,Qt)))}}return ct!==1/0&&ct}(X[0],X[1],U)}},line:class extends so{constructor(a){super(a,Zp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){a==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Cu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,i){super.recalculate(a,i),this.paint._values["line-floorwidth"]=Yp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Eg(a)}queryRadius(a){const i=a,u=Wp(xf("line-width",this,i),xf("line-gap-width",this,i)),d=xf("line-offset",this,i);return u/2+Math.abs(d)+Pp(this.paint.get("line-translate"))}queryIntersectsFeature(a,i,u,d,_,b,w){const A=Lp(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,w),M=w/2*Wp(this.paint.get("line-width").evaluate(i,u),this.paint.get("line-gap-width").evaluate(i,u)),z=this.paint.get("line-offset").evaluate(i,u);return z&&(d=function(F,U){const X=[];for(let j=0;j<F.length;j++){const H=F[j],ut=[];for(let ct=0;ct<H.length;ct++){const St=H[ct-1],Rt=H[ct],Lt=H[ct+1],qt=ct===0?new Jt(0,0):Rt.sub(St)._unit()._perp(),ne=ct===H.length-1?new Jt(0,0):Lt.sub(Rt)._unit()._perp(),Qt=qt._add(ne)._unit(),Me=Qt.x*ne.x+Qt.y*ne.y;Me!==0&&Qt._mult(1/Me),ut.push(Qt._mult(U)._add(Rt))}X.push(ut)}return X}(d,z*w)),function(F,U,X){for(let j=0;j<U.length;j++){const H=U[j];if(F.length>=3){for(let ut=0;ut<H.length;ut++)if(Uu(F,H[ut]))return!0}if(Nm(F,H,X))return!0}return!1}(A,d,M)}isTileClipped(){return!0}},symbol:id,background:class extends so{constructor(a){super(a,pv)}},raster:class extends so{constructor(a){super(a,dv)}}};class _v{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const od=63710088e-1;class Br{constructor(i,u){if(isNaN(i)||isNaN(u))throw new Error(`Invalid LngLat object: (${i}, ${u})`);if(this.lng=+i,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Br(G(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const u=Math.PI/180,d=this.lat*u,_=i.lat*u,b=Math.sin(d)*Math.sin(_)+Math.cos(d)*Math.cos(_)*Math.cos((i.lng-this.lng)*u);return od*Math.acos(Math.min(b,1))}toBounds(i=0){const u=360*i/40075017,d=u/Math.cos(Math.PI/180*this.lat);return new kc(new Br(this.lng-d,this.lat-u),new Br(this.lng+d,this.lat+u))}static convert(i){if(i instanceof Br)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Br(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Br(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class kc{constructor(i,u){i&&(u?this.setSouthWest(i).setNorthEast(u):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Br?new Br(i.lng,i.lat):Br.convert(i),this}setSouthWest(i){return this._sw=i instanceof Br?new Br(i.lng,i.lat):Br.convert(i),this}extend(i){const u=this._sw,d=this._ne;let _,b;if(i instanceof Br)_=i,b=i;else{if(!(i instanceof kc))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(kc.convert(i)):this.extend(Br.convert(i)):this;if(_=i._sw,b=i._ne,!_||!b)return this}return u||d?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),d.lng=Math.max(b.lng,d.lng),d.lat=Math.max(b.lat,d.lat)):(this._sw=new Br(_.lng,_.lat),this._ne=new Br(b.lng,b.lat)),this}getCenter(){return new Br((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Br(this.getWest(),this.getNorth())}getSouthEast(){return new Br(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:u,lat:d}=Br.convert(i);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&_}static convert(i){return i instanceof kc?i:i&&new kc(i)}}const T_=2*Math.PI*od;function A_(a){return T_*Math.cos(a*Math.PI/180)}function P_(a){return(180+a)/360}function L_(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function M_(a,i){return a/A_(i)}function qg(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class sd{constructor(i,u,d=0){this.x=+i,this.y=+u,this.z=+d}static fromLngLat(i,u=0){const d=Br.convert(i);return new sd(P_(d.lng),L_(d.lat),M_(u,d.lat))}toLngLat(){return new Br(360*this.x-180,qg(this.y))}toAltitude(){return this.z*A_(qg(this.y))}meterInMercatorCoordinateUnits(){return 1/T_*(i=qg(this.y),1/Math.cos(i*Math.PI/180));var i}}function Xg(a,i,u){var d=2*Math.PI*6378137/256/Math.pow(2,u);return[a*d-2*Math.PI*6378137/2,i*d-2*Math.PI*6378137/2]}class Zg{constructor(i,u,d){this.z=i,this.x=u,this.y=d,this.key=Rf(0,i,i,u,d)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,u,d){const _=(w=this.y,A=this.z,M=Xg(256*(b=this.x),256*(w=Math.pow(2,A)-w-1),A),z=Xg(256*(b+1),256*(w+1),A),M[0]+","+M[1]+","+z[0]+","+z[1]);var b,w,A,M,z;const F=function(U,X,j){let H,ut="";for(let ct=U;ct>0;ct--)H=1<<ct-1,ut+=(X&H?1:0)+(j&H?2:0);return ut}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,F).replace(/{bbox-epsg-3857}/g,_)}getTilePoint(i){const u=Math.pow(2,this.z);return new Jt((i.x*u-this.x)*Tr,(i.y*u-this.y)*Tr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Nf{constructor(i,u){this.wrap=i,this.canonical=u,this.key=Rf(i,u.z,u.z,u.x,u.y)}}class ba{constructor(i,u,d,_,b){this.overscaledZ=i,this.wrap=u,this.canonical=new Zg(d,+_,+b),this.key=Rf(u,i,d,_,b)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const u=this.canonical.z-i;return i>this.canonical.z?new ba(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ba(i,this.wrap,i,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(i,u){const d=this.canonical.z-i;return i>this.canonical.z?Rf(this.wrap*+u,i,this.canonical.z,this.canonical.x,this.canonical.y):Rf(this.wrap*+u,i,i,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const u=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>u&&i.canonical.y===this.canonical.y>>u}children(i){if(this.overscaledZ>=i)return[new ba(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,d=2*this.canonical.x,_=2*this.canonical.y;return[new ba(u,this.wrap,u,d,_),new ba(u,this.wrap,u,d+1,_),new ba(u,this.wrap,u,d,_+1),new ba(u,this.wrap,u,d+1,_+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new ba(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new ba(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new sd(i.x-this.wrap,i.y))}}function Rf(a,i,u,d,_){(a*=2)<0&&(a=-1*a-1);const b=1<<u;return(b*b*a+b*_+d).toString(36)+u.toString(36)+i.toString(36)}Ne("CanonicalTileID",Zg),Ne("OverscaledTileID",ba,{omit:["posMatrix"]});class D_{constructor(i,u,d){if(this.uid=i,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return void ee(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const _=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=d||"mapbox";for(let b=0;b<_;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(_,b)]=this.data[this._idx(_-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,_)]=this.data[this._idx(b,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]}get(i,u){const d=new Uint8Array(this.data.buffer),_=4*this._idx(i,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(d[_],d[_+1],d[_+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(i,u){if(i<-1||i>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(i+1)}_unpackMapbox(i,u,d){return(256*i*256+256*u+d)/10-1e4}_unpackTerrarium(i,u,d){return 256*i+u+d/256-32768}getPixels(){return new Ls({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,u,d){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let _=u*this.dim,b=u*this.dim+this.dim,w=d*this.dim,A=d*this.dim+this.dim;switch(u){case-1:_=b-1;break;case 1:b=_+1}switch(d){case-1:w=A-1;break;case 1:A=w+1}const M=-u*this.dim,z=-d*this.dim;for(let F=w;F<A;F++)for(let U=_;U<b;U++)this.data[this._idx(U,F)]=i.data[this._idx(U+M,F+z)]}}Ne("DEMData",D_);class N_{constructor(i){this._stringToNumber={},this._numberToString=[];for(let u=0;u<i.length;u++){const d=i[u];this._stringToNumber[d]=u,this._numberToString[u]=d}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}class R_{constructor(i,u,d,_,b){this.type="Feature",this._vectorTileFeature=i,i._z=u,i._x=d,i._y=_,this.properties=i.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(i[u]=this[u]);return i}}class z_{constructor(i,u){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Yn(Tr,16,0),this.grid3D=new Yn(Tr,16,0),this.featureIndexArray=new Nn,this.promoteId=u}insert(i,u,d,_,b,w){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,_,b);const M=w?this.grid3D:this.grid;for(let z=0;z<u.length;z++){const F=u[z],U=[1/0,1/0,-1/0,-1/0];for(let X=0;X<F.length;X++){const j=F[X];U[0]=Math.min(U[0],j.x),U[1]=Math.min(U[1],j.y),U[2]=Math.max(U[2],j.x),U[3]=Math.max(U[3],j.y)}U[0]<Tr&&U[1]<Tr&&U[2]>=0&&U[3]>=0&&M.insert(A,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new js.VectorTile(new Hp(this.rawTileData)).layers,this.sourceLayerCoder=new N_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,u,d,_){this.loadVTLayers();const b=i.params||{},w=Tr/i.tileSize/i.scale,A=dh(b.filter),M=i.queryGeometry,z=i.queryPadding*w,F=k_(M),U=this.grid.query(F.minX-z,F.minY-z,F.maxX+z,F.maxY+z),X=k_(i.cameraQueryGeometry),j=this.grid3D.query(X.minX-z,X.minY-z,X.maxX+z,X.maxY+z,(ct,St,Rt,Lt)=>function(qt,ne,Qt,Me,Ue){for(const Se of qt)if(ne<=Se.x&&Qt<=Se.y&&Me>=Se.x&&Ue>=Se.y)return!0;const Ee=[new Jt(ne,Qt),new Jt(ne,Ue),new Jt(Me,Ue),new Jt(Me,Qt)];if(qt.length>2){for(const Se of Ee)if(Uu(qt,Se))return!0}for(let Se=0;Se<qt.length-1;Se++)if(Om(qt[Se],qt[Se+1],Ee))return!0;return!1}(i.cameraQueryGeometry,ct-z,St-z,Rt+z,Lt+z));for(const ct of j)U.push(ct);U.sort(yv);const H={};let ut;for(let ct=0;ct<U.length;ct++){const St=U[ct];if(St===ut)continue;ut=St;const Rt=this.featureIndexArray.get(St);let Lt=null;this.loadMatchingFeature(H,Rt.bucketIndex,Rt.sourceLayerIndex,Rt.featureIndex,A,b.layers,b.availableImages,u,d,_,(qt,ne,Qt)=>(Lt||(Lt=$l(qt)),ne.queryIntersectsFeature(M,qt,Qt,Lt,this.z,i.transform,w,i.pixelPosMatrix)))}return H}loadMatchingFeature(i,u,d,_,b,w,A,M,z,F,U){const X=this.bucketLayerIDs[u];if(w&&!function(ct,St){for(let Rt=0;Rt<ct.length;Rt++)if(St.indexOf(ct[Rt])>=0)return!0;return!1}(w,X))return;const j=this.sourceLayerCoder.decode(d),H=this.vtLayers[j].feature(_);if(b.needGeometry){const ct=Tc(H,!0);if(!b.filter(new Sr(this.tileID.overscaledZ),ct,this.tileID.canonical))return}else if(!b.filter(new Sr(this.tileID.overscaledZ),H))return;const ut=this.getId(H,j);for(let ct=0;ct<X.length;ct++){const St=X[ct];if(w&&w.indexOf(St)<0)continue;const Rt=M[St];if(!Rt)continue;let Lt={};ut&&F&&(Lt=F.getState(Rt.sourceLayer||"_geojsonTileLayer",ut));const qt=Y({},z[St]);qt.paint=O_(qt.paint,Rt.paint,H,Lt,A),qt.layout=O_(qt.layout,Rt.layout,H,Lt,A);const ne=!U||U(H,Rt,Lt);if(!ne)continue;const Qt=new R_(H,this.z,this.x,this.y,ut);Qt.layer=qt;let Me=i[St];Me===void 0&&(Me=i[St]=[]),Me.push({featureIndex:_,feature:Qt,intersectionZ:ne})}}lookupSymbolFeatures(i,u,d,_,b,w,A,M){const z={};this.loadVTLayers();const F=dh(b);for(const U of i)this.loadMatchingFeature(z,d,_,U,F,w,A,M,u);return z}hasLayer(i){for(const u of this.bucketLayerIDs)for(const d of u)if(i===d)return!0;return!1}getId(i,u){let d=i.id;return this.promoteId&&(d=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof d=="boolean"&&(d=Number(d))),d}}function O_(a,i,u,d,_){return rt(a,(b,w)=>{const A=i instanceof bh?i.get(w):null;return A&&A.evaluate?A.evaluate(u,d,_):A})}function k_(a){let i=1/0,u=1/0,d=-1/0,_=-1/0;for(const b of a)i=Math.min(i,b.x),u=Math.min(u,b.y),d=Math.max(d,b.x),_=Math.max(_,b.y);return{minX:i,minY:u,maxX:d,maxY:_}}function yv(a,i){return i-a}var Yg;Ne("FeatureIndex",z_,{omit:["rawTileData","sourceLayerCoder"]}),l.PerformanceMarkers=void 0,(Yg=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Yg.load="load",Yg.fullLoad="fullLoad";let ad=null,zf=[];const Wg=1e3/30,vv={mark(a){performance.mark(a)},frame(a){const i=a;ad!=null&&zf.push(i-ad),ad=i},clearMetrics(){ad=null,zf=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const a in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[a])},getPerformanceMetrics(){performance.measure("loadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure("fullLoadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const a=performance.getEntriesByName("loadTime")[0].duration,i=performance.getEntriesByName("fullLoadTime")[0].duration,u=zf.length,d=1/(zf.reduce((b,w)=>b+w,0)/u/1e3),_=zf.filter(b=>b>Wg).reduce((b,w)=>b+(w-Wg)/Wg,0);return{loadTime:a,fullLoadTime:i,fps:d,percentDroppedFrames:_/(u+_)*100}}};l.AJAXError=Kr,l.ARRAY_TYPE=Th,l.Actor=class{constructor(a,i,u){this.target=a,this.parent=i,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},at(["receive","process"],this),this.invoker=new _v(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Mt()?a:window}send(a,i,u,d,_=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[b]=u);const w=Yt(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:a,hasCallback:!!u,targetMapId:d,mustQueue:_,sourceMapId:this.mapId,data:hl(i,w)},w),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const i=a.data,u=i.id;if(u&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){delete this.tasks[u];const d=this.cancelCallbacks[u];delete this.cancelCallbacks[u],d&&d()}else Mt()||i.mustQueue?(this.tasks[u]=i,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,i)}process(){if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),i=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),i&&this.processTask(a,i)}processTask(a,i){if(i.type==="<response>"){const u=this.callbacks[a];delete this.callbacks[a],u&&(i.error?u(Xl(i.error)):u(null,Xl(i.data)))}else{let u=!1;const d=Yt(this.globalScope)?void 0:[],_=i.hasCallback?(A,M)=>{u=!0,delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:A?hl(A):null,data:hl(M,d)},d)}:A=>{u=!0};let b=null;const w=Xl(i.data);if(this.parent[i.type])b=this.parent[i.type](i.sourceMapId,w,_);else if(this.parent.getWorkerSource){const A=i.type.split(".");b=this.parent.getWorkerSource(i.sourceMapId,A[0],w.source)[A[1]](w,_)}else _(new Error(`Could not find function ${i.type}`));!u&&b&&b.cancel&&(this.cancelCallbacks[a]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=Lc,l.CanonicalTileID=Zg,l.CollisionBoxArray=Ut,l.CollisionCircleLayoutArray=class extends k{},l.Color=B,l.DEMData=D_,l.DataConstantProperty=Be,l.DictionaryCoder=N_,l.EXTENT=Tr,l.ErrorEvent=Bs,l.EvaluationParameters=Sr,l.Event=bn,l.Evented=ns,l.FeatureIndex=z_,l.FillBucket=Go,l.FillExtrusionBucket=Ig,l.GeoJSONFeature=R_,l.ImageAtlas=Lg,l.ImagePosition=Mf,l.LineBucket=Eg,l.LineStripIndexArray=class extends Tt{},l.LngLat=Br,l.LngLatBounds=kc,l.MercatorCoordinate=sd,l.ONE_EM=Mi,l.OverscaledTileID=ba,l.PerformanceUtils=vv,l.PosArray=class extends Fa{},l.Properties=_i,l.QuadTriangleArray=class extends Z{},l.RGBAImage=Ls,l.RasterBoundsArray=class extends ma{},l.RequestPerformance=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},l.ResourceType=Mo,l.SegmentVector=Gn,l.SymbolBucket=kh,l.Transitionable=Ou,l.TriangleIndexArray=Fo,l.Uniform1f=Jl,l.Uniform1i=class extends Ws{constructor(a,i){super(a,i),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},l.Uniform2f=class extends Ws{constructor(a,i){super(a,i),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},l.Uniform3f=class extends Ws{constructor(a,i){super(a,i),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},l.Uniform4f=Eh,l.UniformColor=Ql,l.UniformMatrix4f=class extends Ws{constructor(a,i){super(a,i),this.current=Dm}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let i=1;i<16;i++)if(a[i]!==this.current[i]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},l.UnwrappedTileID=Nf,l.ValidationError=ge,l.ZoomHistory=pa,l.addDynamicAttributes=Fg,l.asyncAll=function(a,i,u){if(!a.length)return u(null,[]);let d=a.length;const _=new Array(a.length);let b=null;a.forEach((w,A)=>{i(w,(M,z)=>{M&&(b=M),_[A]=z,--d==0&&u(b,_)})})},l.bezier=T,l.bindAll=at,l.cacheEntryPossiblyAdded=function(a){Hr++,Hr>Nr&&(a.getActor().send("enforceCacheSizeLimit",oi),Hr=0)},l.clamp=D,l.clearTileCache=function(a){const i=caches.delete(Cn);a&&i.catch(a).then(()=>a())},l.clipLine=w_,l.clone=function(a){var i=new Th(16);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},l.clone$1=xt,l.collisionCircleLayout=Sg,l.config=pn,l.create=function(){var a=new Th(16);return Th!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},l.createExpression=Pu,l.createFilter=dh,l.createLayout=Or,l.createStyleLayer=function(a){return a.type==="custom"?new gv(a):new mv[a.type](a)},l.dot=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]+a[3]*i[3]},l.ease=P,l.emitValidationErrors=gi,l.enforceCacheSizeLimit=function(a){to(),_r&&_r.then(i=>{i.keys().then(u=>{for(let d=0;d<u.length-a;d++)i.delete(u[d])})})},l.evaluateSizeForFeature=function(a,{uSize:i,uSizeT:u},{lowerSize:d,upperSize:_}){return a.kind==="source"?d/su:a.kind==="composite"?li(d/su,_/su,u):i},l.evaluateSizeForZoom=function(a,i){let u=0,d=0;if(a.kind==="constant")d=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:w}=a,A=_?D(os.interpolationFactor(_,i,b,w),0,1):0;a.kind==="camera"?d=li(a.minSize,a.maxSize,A):u=A}return{uSizeT:u,uSize:d}},l.evaluateVariableOffset=E_,l.evented=Yl,l.exported=Oe,l.exported$1=Vi,l.extend=Y,l.filterObject=wt,l.getAnchorAlignment=Ng,l.getAnchorJustification=kg,l.getArrayBuffer=ai,l.getImage=ws,l.getJSON=function(a,i){return sa(Y(a,{type:"json"}),i)},l.getOverlapMode=Gg,l.getRTLTextPluginStatus=Wl,l.getReferrer=si,l.getVideo=function(a,i){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){i(null,u)};for(let d=0;d<a.length;d++){const _=window.document.createElement("source");il(a[d])||(u.crossOrigin="Anonymous"),_.src=a[d],u.appendChild(_)}return{cancel:()=>{}}},l.identity=bf,l.invert=function(a,i){var u=i[0],d=i[1],_=i[2],b=i[3],w=i[4],A=i[5],M=i[6],z=i[7],F=i[8],U=i[9],X=i[10],j=i[11],H=i[12],ut=i[13],ct=i[14],St=i[15],Rt=u*A-d*w,Lt=u*M-_*w,qt=u*z-b*w,ne=d*M-_*A,Qt=d*z-b*A,Me=_*z-b*M,Ue=F*ut-U*H,Ee=F*ct-X*H,Se=F*St-j*H,_e=U*ct-X*ut,Pe=U*St-j*ut,Ce=X*St-j*ct,ce=Rt*Ce-Lt*Pe+qt*_e+ne*Se-Qt*Ee+Me*Ue;return ce?(a[0]=(A*Ce-M*Pe+z*_e)*(ce=1/ce),a[1]=(_*Pe-d*Ce-b*_e)*ce,a[2]=(ut*Me-ct*Qt+St*ne)*ce,a[3]=(X*Qt-U*Me-j*ne)*ce,a[4]=(M*Se-w*Ce-z*Ee)*ce,a[5]=(u*Ce-_*Se+b*Ee)*ce,a[6]=(ct*qt-H*Me-St*Lt)*ce,a[7]=(F*Me-X*qt+j*Lt)*ce,a[8]=(w*Pe-A*Se+z*Ue)*ce,a[9]=(d*Se-u*Pe-b*Ue)*ce,a[10]=(H*Qt-ut*qt+St*Rt)*ce,a[11]=(U*qt-F*Qt-j*Rt)*ce,a[12]=(A*Ee-w*_e-M*Ue)*ce,a[13]=(u*_e-d*Ee+_*Ue)*ce,a[14]=(ut*Lt-H*ne-ct*Rt)*ce,a[15]=(F*ne-U*Lt+X*Rt)*ce,a):null},l.isImageBitmap=Ft,l.isSafari=Yt,l.keysDifference=function(a,i){const u=[];for(const d in a)d in i||u.push(d);return u},l.lazyLoadRTLTextPlugin=function(){xo.isLoading()||xo.isLoaded()||Wl()!=="deferred"||ga()},l.makeRequest=sa,l.mapObject=rt,l.mercatorXfromLng=P_,l.mercatorYfromLat=L_,l.mercatorZfromAltitude=M_,l.mul=Fm,l.multiply=pg,l.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},l.number=li,l.ortho=function(a,i,u,d,_,b,w){var A=1/(i-u),M=1/(d-_),z=1/(b-w);return a[0]=-2*A,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*M,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*z,a[11]=0,a[12]=(i+u)*A,a[13]=(_+d)*M,a[14]=(w+b)*z,a[15]=1,a},l.parseCacheControl=It,l.parseGlyphPBF=function(a){return new Hp(a).readFields($y,[])},l.pbf=Hp,l.performSymbolLayout=function(a,i,u,d,_,b,w){a.createArrays(),a.tilePixelRatio=Tr/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const A=a.layers[0].layout,M=a.layers[0]._unevaluatedLayout._values,z={layoutIconSize:M["icon-size"].possiblyEvaluate(new Sr(a.zoom+1),w),layoutTextSize:M["text-size"].possiblyEvaluate(new Sr(a.zoom+1),w),textMaxSize:M["text-size"].possiblyEvaluate(new Sr(18))};if(a.textSizeData.kind==="composite"){const{minZoom:H,maxZoom:ut}=a.textSizeData;z.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Sr(H),w),M["text-size"].possiblyEvaluate(new Sr(ut),w)]}if(a.iconSizeData.kind==="composite"){const{minZoom:H,maxZoom:ut}=a.iconSizeData;z.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Sr(H),w),M["icon-size"].possiblyEvaluate(new Sr(ut),w)]}const F=A.get("text-line-height")*Mi,U=A.get("text-rotation-alignment")!=="viewport"&&A.get("symbol-placement")!=="point",X=A.get("text-keep-upright"),j=A.get("text-size");for(const H of a.features){const ut=A.get("text-font").evaluate(H,{},w).join(","),ct=j.evaluate(H,{},w),St=z.layoutTextSize.evaluate(H,{},w),Rt=z.layoutIconSize.evaluate(H,{},w),Lt={horizontal:{},vertical:void 0},qt=H.text;let ne,Qt=[0,0];if(qt){const Ee=qt.toString(),Se=A.get("text-letter-spacing").evaluate(H,{},w)*Mi,_e=ur(Ee)?Se:0,Pe=A.get("text-anchor").evaluate(H,{},w),Ce=A.get("text-variable-anchor");if(!Ce){const er=A.get("text-radial-offset").evaluate(H,{},w);Qt=er?E_(Pe,[er*Mi,ed]):A.get("text-offset").evaluate(H,{},w).map(Ar=>Ar*Mi)}let ce=U?"center":A.get("text-justify").evaluate(H,{},w);const He=A.get("symbol-placement"),Ve=He==="point"?A.get("text-max-width").evaluate(H,{},w)*Mi:0,Sn=()=>{a.allowVerticalPlacement&&Du(Ee)&&(Lt.vertical=Df(qt,i,u,_,ut,Ve,F,Pe,"left",_e,Qt,l.WritingMode.vertical,!0,He,St,ct))};if(!U&&Ce){const er=ce==="auto"?Ce.map(yr=>kg(yr)):[ce];let Ar=!1;for(let yr=0;yr<er.length;yr++){const ji=er[yr];if(!Lt.horizontal[ji])if(Ar)Lt.horizontal[ji]=Lt.horizontal[0];else{const yi=Df(qt,i,u,_,ut,Ve,F,"center",ji,_e,Qt,l.WritingMode.horizontal,!1,He,St,ct);yi&&(Lt.horizontal[ji]=yi,Ar=yi.positionedLines.length===1)}}Sn()}else{ce==="auto"&&(ce=kg(Pe));const er=Df(qt,i,u,_,ut,Ve,F,Pe,ce,_e,Qt,l.WritingMode.horizontal,!1,He,St,ct);er&&(Lt.horizontal[ce]=er),Sn(),Du(Ee)&&U&&X&&(Lt.vertical=Df(qt,i,u,_,ut,Ve,F,Pe,ce,_e,Qt,l.WritingMode.vertical,!1,He,St,ct))}}let Me=!1;if(H.icon&&H.icon.name){const Ee=d[H.icon.name];Ee&&(ne=nv(_[H.icon.name],A.get("icon-offset").evaluate(H,{},w),A.get("icon-anchor").evaluate(H,{},w)),Me=!!Ee.sdf,a.sdfIcons===void 0?a.sdfIcons=Me:a.sdfIcons!==Me&&ee("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ee.pixelRatio!==a.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const Ue=S_(Lt.horizontal)||Lt.vertical;a.iconsInText=!!Ue&&Ue.iconsInText,(Ue||ne)&&av(a,H,Lt,ne,d,z,St,Rt,Qt,Me,w)}b&&a.generateCollisionDebugBuffers()},l.perspective=function(a,i,u,d,_){var b,w=1/Math.tan(i/2);return a[0]=w/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=w,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,_!=null&&_!==1/0?(a[10]=(_+d)*(b=1/(d-_)),a[14]=2*_*d*b):(a[10]=-1,a[14]=-2*d),a},l.pick=function(a,i){const u={};for(let d=0;d<i.length;d++){const _=i[d];_ in a&&(u[_]=a[_])}return u},l.plugin=xo,l.pointGeometry=Jt,l.polygonIntersectsPolygon=Ap,l.potpack=p_,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Ne,l.registerForPluginStateChange=function(a){return a({pluginStatus:Yi,pluginURL:ka}),Yl.on("pluginStateChange",a),a},l.renderColorRamp=Mp,l.rotateX=function(a,i,u){var d=Math.sin(u),_=Math.cos(u),b=i[4],w=i[5],A=i[6],M=i[7],z=i[8],F=i[9],U=i[10],X=i[11];return i!==a&&(a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[4]=b*_+z*d,a[5]=w*_+F*d,a[6]=A*_+U*d,a[7]=M*_+X*d,a[8]=z*_-b*d,a[9]=F*_-w*d,a[10]=U*_-A*d,a[11]=X*_-M*d,a},l.rotateZ=function(a,i,u){var d=Math.sin(u),_=Math.cos(u),b=i[0],w=i[1],A=i[2],M=i[3],z=i[4],F=i[5],U=i[6],X=i[7];return i!==a&&(a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=b*_+z*d,a[1]=w*_+F*d,a[2]=A*_+U*d,a[3]=M*_+X*d,a[4]=z*_-b*d,a[5]=F*_-w*d,a[6]=U*_-A*d,a[7]=X*_-M*d,a},l.scale=function(a,i,u){var d=u[0],_=u[1],b=u[2];return a[0]=i[0]*d,a[1]=i[1]*d,a[2]=i[2]*d,a[3]=i[3]*d,a[4]=i[4]*_,a[5]=i[5]*_,a[6]=i[6]*_,a[7]=i[7]*_,a[8]=i[8]*b,a[9]=i[9]*b,a[10]=i[10]*b,a[11]=i[11]*b,a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},l.scale$1=function(a,i,u){return a[0]=i[0]*u,a[1]=i[1]*u,a[2]=i[2]*u,a[3]=i[3]*u,a},l.setCacheLimits=function(a,i){oi=a,Nr=i},l.setRTLTextPlugin=function(a,i,u=!1){if(Yi===Zl||Yi===da||Yi===Ru)throw new Error("setRTLTextPlugin cannot be called multiple times.");ka=Oe.resolveURL(a),Yi=Zl,_h=i,zu(),u||ga()},l.spec=Bt,l.sphericalToCartesian=function([a,i,u]){return i+=90,i*=Math.PI/180,u*=Math.PI/180,{x:a*Math.cos(i)*Math.sin(u),y:a*Math.sin(i)*Math.sin(u),z:a*Math.cos(u)}},l.toEvaluationFeature=Tc,l.transformMat4=Pc,l.translate=function(a,i,u){var d,_,b,w,A,M,z,F,U,X,j,H,ut=u[0],ct=u[1],St=u[2];return i===a?(a[12]=i[0]*ut+i[4]*ct+i[8]*St+i[12],a[13]=i[1]*ut+i[5]*ct+i[9]*St+i[13],a[14]=i[2]*ut+i[6]*ct+i[10]*St+i[14],a[15]=i[3]*ut+i[7]*ct+i[11]*St+i[15]):(_=i[1],b=i[2],w=i[3],A=i[4],M=i[5],z=i[6],F=i[7],U=i[8],X=i[9],j=i[10],H=i[11],a[0]=d=i[0],a[1]=_,a[2]=b,a[3]=w,a[4]=A,a[5]=M,a[6]=z,a[7]=F,a[8]=U,a[9]=X,a[10]=j,a[11]=H,a[12]=d*ut+A*ct+U*St+i[12],a[13]=_*ut+M*ct+X*St+i[13],a[14]=b*ut+z*ct+j*St+i[14],a[15]=w*ut+F*ct+H*St+i[15]),a},l.triggerPluginCompletionEvent=_f,l.unicodeBlockLookup=be,l.uniqueId=function(){return et++},l.validateCustomStyleLayer=function(a){const i=[],u=a.id;return u===void 0&&i.push({message:`layers.${u}: missing required property "id"`}),a.render===void 0&&i.push({message:`layers.${u}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&i.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),i},l.validateLight=Fe,l.validateStyle=Nt,l.vectorTile=js,l.warnOnce=ee,l.wrap=G}),c(["./shared"],function(l){function x($){const O=typeof $;if(O==="number"||O==="boolean"||O==="string"||$==null)return JSON.stringify($);if(Array.isArray($)){let tt="[";for(const nt of $)tt+=`${x(nt)},`;return`${tt}]`}const B=Object.keys($).sort();let K="{";for(let tt=0;tt<B.length;tt++)K+=`${JSON.stringify(B[tt])}:${x($[B[tt]])},`;return`${K}}`}function I($){let O="";for(const B of l.refProperties)O+=`/${x($[B])}`;return O}class T{constructor(O){this.keyCache={},O&&this.replace(O)}replace(O){this._layerConfigs={},this._layers={},this.update(O,[])}update(O,B){for(const tt of O){this._layerConfigs[tt.id]=tt;const nt=this._layers[tt.id]=l.createStyleLayer(tt);nt._featureFilter=l.createFilter(nt.filter),this.keyCache[tt.id]&&delete this.keyCache[tt.id]}for(const tt of B)delete this.keyCache[tt],delete this._layerConfigs[tt],delete this._layers[tt];this.familiesBySource={};const K=function(tt,nt){const dt={};for(let pt=0;pt<tt.length;pt++){const gt=nt&&nt[tt[pt].id]||I(tt[pt]);nt&&(nt[tt[pt].id]=gt);let Vt=dt[gt];Vt||(Vt=dt[gt]=[]),Vt.push(tt[pt])}const ht=[];for(const pt in dt)ht.push(dt[pt]);return ht}(Object.values(this._layerConfigs),this.keyCache);for(const tt of K){const nt=tt.map(te=>this._layers[te.id]),dt=nt[0];if(dt.visibility==="none")continue;const ht=dt.source||"";let pt=this.familiesBySource[ht];pt||(pt=this.familiesBySource[ht]={});const gt=dt.sourceLayer||"_geojsonTileLayer";let Vt=pt[gt];Vt||(Vt=pt[gt]=[]),Vt.push(nt)}}}class P{constructor(O){const B={},K=[];for(const ht in O){const pt=O[ht],gt=B[ht]={};for(const Vt in pt){const te=pt[+Vt];if(!te||te.bitmap.width===0||te.bitmap.height===0)continue;const zt={x:0,y:0,w:te.bitmap.width+2,h:te.bitmap.height+2};K.push(zt),gt[Vt]={rect:zt,metrics:te.metrics}}}const{w:tt,h:nt}=l.potpack(K),dt=new l.AlphaImage({width:tt||1,height:nt||1});for(const ht in O){const pt=O[ht];for(const gt in pt){const Vt=pt[+gt];if(!Vt||Vt.bitmap.width===0||Vt.bitmap.height===0)continue;const te=B[ht][gt].rect;l.AlphaImage.copy(Vt.bitmap,dt,{x:0,y:0},{x:te.x+1,y:te.y+1},Vt.bitmap)}}this.image=dt,this.positions=B}}l.register("GlyphAtlas",P);class D{constructor(O){this.tileID=new l.OverscaledTileID(O.tileID.overscaledZ,O.tileID.wrap,O.tileID.canonical.z,O.tileID.canonical.x,O.tileID.canonical.y),this.uid=O.uid,this.zoom=O.zoom,this.pixelRatio=O.pixelRatio,this.tileSize=O.tileSize,this.source=O.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=O.showCollisionBoxes,this.collectResourceTiming=!!O.collectResourceTiming,this.returnDependencies=!!O.returnDependencies,this.promoteId=O.promoteId}parse(O,B,K,tt,nt){this.status="parsing",this.data=O,this.collisionBoxArray=new l.CollisionBoxArray;const dt=new l.DictionaryCoder(Object.keys(O.layers).sort()),ht=new l.FeatureIndex(this.tileID,this.promoteId);ht.bucketLayerIDs=[];const pt={},gt={featureIndex:ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Vt=B.familiesBySource[this.source];for(const wn in Vt){const sn=O.layers[wn];if(!sn)continue;sn.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${wn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const an=dt.encode(wn),zr=[];for(let Lr=0;Lr<sn.length;Lr++){const pi=sn.feature(Lr),Ti=ht.getId(pi,wn);zr.push({feature:pi,id:Ti,index:Lr,sourceLayerIndex:an})}for(const Lr of Vt[wn]){const pi=Lr[0];pi.minzoom&&this.zoom<Math.floor(pi.minzoom)||pi.maxzoom&&this.zoom>=pi.maxzoom||pi.visibility!=="none"&&(G(Lr,this.zoom,K),(pt[pi.id]=pi.createBucket({index:ht.bucketLayerIDs.length,layers:Lr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:an,sourceID:this.source})).populate(zr,gt,this.tileID.canonical),ht.bucketLayerIDs.push(Lr.map(Ti=>Ti.id)))}}let te,zt,Ae,we;const De=l.mapObject(gt.glyphDependencies,wn=>Object.keys(wn).map(Number));Object.keys(De).length?tt.send("getGlyphs",{uid:this.uid,stacks:De},(wn,sn)=>{te||(te=wn,zt=sn,In.call(this))}):zt={};const ke=Object.keys(gt.iconDependencies);ke.length?tt.send("getImages",{icons:ke,source:this.source,tileID:this.tileID,type:"icons"},(wn,sn)=>{te||(te=wn,Ae=sn,In.call(this))}):Ae={};const Mn=Object.keys(gt.patternDependencies);function In(){if(te)return nt(te);if(zt&&Ae&&we){const wn=new P(zt),sn=new l.ImageAtlas(Ae,we);for(const an in pt){const zr=pt[an];zr instanceof l.SymbolBucket?(G(zr.layers,this.zoom,K),l.performSymbolLayout(zr,zt,wn.positions,Ae,sn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):zr.hasPattern&&(zr instanceof l.LineBucket||zr instanceof l.FillBucket||zr instanceof l.FillExtrusionBucket)&&(G(zr.layers,this.zoom,K),zr.addFeatures(gt,this.tileID.canonical,sn.patternPositions))}this.status="done",nt(null,{buckets:Object.values(pt).filter(an=>!an.isEmpty()),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wn.image,imageAtlas:sn,glyphMap:this.returnDependencies?zt:null,iconMap:this.returnDependencies?Ae:null,glyphPositions:this.returnDependencies?wn.positions:null})}}Mn.length?tt.send("getImages",{icons:Mn,source:this.source,tileID:this.tileID,type:"patterns"},(wn,sn)=>{te||(te=wn,we=sn,In.call(this))}):we={},In.call(this)}}function G($,O,B){const K=new l.EvaluationParameters(O);for(const tt of $)tt.recalculate(K,B)}function Y($,O){const B=l.getArrayBuffer($.request,(K,tt,nt,dt)=>{K?O(K):tt&&O(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(tt)),rawData:tt,cacheControl:nt,expires:dt})});return()=>{B.cancel(),O()}}class et{constructor(O,B,K,tt){this.actor=O,this.layerIndex=B,this.availableImages=K,this.loadVectorData=tt||Y,this.loading={},this.loaded={}}loadTile(O,B){const K=O.uid;this.loading||(this.loading={});const tt=!!(O&&O.request&&O.request.collectResourceTiming)&&new l.RequestPerformance(O.request),nt=this.loading[K]=new D(O);nt.abort=this.loadVectorData(O,(dt,ht)=>{if(delete this.loading[K],dt||!ht)return nt.status="done",this.loaded[K]=nt,B(dt);const pt=ht.rawData,gt={};ht.expires&&(gt.expires=ht.expires),ht.cacheControl&&(gt.cacheControl=ht.cacheControl);const Vt={};if(tt){const te=tt.finish();te&&(Vt.resourceTiming=JSON.parse(JSON.stringify(te)))}nt.vectorTile=ht.vectorTile,nt.parse(ht.vectorTile,this.layerIndex,this.availableImages,this.actor,(te,zt)=>{if(te||!zt)return B(te);B(null,l.extend({rawTileData:pt.slice(0)},zt,gt,Vt))}),this.loaded=this.loaded||{},this.loaded[K]=nt})}reloadTile(O,B){const K=this.loaded,tt=O.uid,nt=this;if(K&&K[tt]){const dt=K[tt];dt.showCollisionBoxes=O.showCollisionBoxes;const ht=(pt,gt)=>{const Vt=dt.reloadCallback;Vt&&(delete dt.reloadCallback,dt.parse(dt.vectorTile,nt.layerIndex,this.availableImages,nt.actor,Vt)),B(pt,gt)};dt.status==="parsing"?dt.reloadCallback=ht:dt.status==="done"&&(dt.vectorTile?dt.parse(dt.vectorTile,this.layerIndex,this.availableImages,this.actor,ht):ht())}}abortTile(O,B){const K=this.loading,tt=O.uid;K&&K[tt]&&K[tt].abort&&(K[tt].abort(),delete K[tt]),B()}removeTile(O,B){const K=this.loaded,tt=O.uid;K&&K[tt]&&delete K[tt],B()}}class at{constructor(){this.loaded={}}loadTile(O,B){const{uid:K,encoding:tt,rawImageData:nt}=O,dt=l.isImageBitmap(nt)?this.getImageData(nt):nt,ht=new l.DEMData(K,dt,tt);this.loaded=this.loaded||{},this.loaded[K]=ht,B(null,ht)}getImageData(O){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(O.width,O.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=O.width,this.offscreenCanvas.height=O.height,this.offscreenCanvasContext.drawImage(O,0,0,O.width,O.height);const B=this.offscreenCanvasContext.getImageData(-1,-1,O.width+2,O.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:B.width,height:B.height},B.data)}removeTile(O){const B=this.loaded,K=O.uid;B&&B[K]&&delete B[K]}}var rt=function $(O,B){var K,tt=O&&O.type;if(tt==="FeatureCollection")for(K=0;K<O.features.length;K++)$(O.features[K],B);else if(tt==="GeometryCollection")for(K=0;K<O.geometries.length;K++)$(O.geometries[K],B);else if(tt==="Feature")$(O.geometry,B);else if(tt==="Polygon")wt(O.coordinates,B);else if(tt==="MultiPolygon")for(K=0;K<O.coordinates.length;K++)wt(O.coordinates[K],B);return O};function wt($,O){if($.length!==0){xt($[0],O);for(var B=1;B<$.length;B++)xt($[B],!O)}}function xt($,O){for(var B=0,K=0,tt=0,nt=$.length,dt=nt-1;tt<nt;dt=tt++){var ht=($[tt][0]-$[dt][0])*($[dt][1]+$[tt][1]),pt=B+ht;K+=Math.abs(B)>=Math.abs(ht)?B-pt+ht:ht-pt+B,B=pt}B+K>=0!=!!O&&$.reverse()}const Gt=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ee{constructor(O){this._feature=O,this.extent=l.EXTENT,this.type=O.type,this.properties=O.tags,"id"in O&&!isNaN(O.id)&&(this.id=parseInt(O.id,10))}loadGeometry(){if(this._feature.type===1){const O=[];for(const B of this._feature.geometry)O.push([new l.pointGeometry(B[0],B[1])]);return O}{const O=[];for(const B of this._feature.geometry){const K=[];for(const tt of B)K.push(new l.pointGeometry(tt[0],tt[1]));O.push(K)}return O}}toGeoJSON(O,B,K){return Gt.call(this,O,B,K)}}class $t{constructor(O){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=O.length,this._features=O}feature(O){return new ee(this._features[O])}}var Zt={exports:{}},Mt=l.pointGeometry,It=l.vectorTile.VectorTileFeature,Wt=ft;function ft($,O){this.options=O||{},this.features=$,this.length=$.length}function re($,O){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=O||4096}ft.prototype.feature=function($){return new re(this.features[$],this.options.extent)},re.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var O=0;O<$.length;O++){for(var B=$[O],K=[],tt=0;tt<B.length;tt++)K.push(new Mt(B[tt][0],B[tt][1]));this.geometry.push(K)}return this.geometry},re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,O=1/0,B=-1/0,K=1/0,tt=-1/0,nt=0;nt<$.length;nt++)for(var dt=$[nt],ht=0;ht<dt.length;ht++){var pt=dt[ht];O=Math.min(O,pt.x),B=Math.max(B,pt.x),K=Math.min(K,pt.y),tt=Math.max(tt,pt.y)}return[O,K,B,tt]},re.prototype.toGeoJSON=It.prototype.toGeoJSON;var Yt=l.pbf,Ft=Wt;function Oe($){var O=new Yt;return function(B,K){for(var tt in B.layers)K.writeMessage(3,Jt,B.layers[tt])}($,O),O.finish()}function Jt($,O){var B;O.writeVarintField(15,$.version||1),O.writeStringField(1,$.name||""),O.writeVarintField(5,$.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(B=0;B<$.length;B++)K.feature=$.feature(B),O.writeMessage(2,$e,K);var tt=K.keys;for(B=0;B<tt.length;B++)O.writeStringField(3,tt[B]);var nt=K.values;for(B=0;B<nt.length;B++)O.writeMessage(4,oi,nt[B])}function $e($,O){var B=$.feature;B.id!==void 0&&O.writeVarintField(1,B.id),O.writeMessage(2,pn,$),O.writeVarintField(3,B.type),O.writeMessage(4,Xn,B)}function pn($,O){var B=$.feature,K=$.keys,tt=$.values,nt=$.keycache,dt=$.valuecache;for(var ht in B.properties){var pt=B.properties[ht],gt=nt[ht];if(pt!==null){gt===void 0&&(K.push(ht),nt[ht]=gt=K.length-1),O.writeVarint(gt);var Vt=typeof pt;Vt!=="string"&&Vt!=="boolean"&&Vt!=="number"&&(pt=JSON.stringify(pt));var te=Vt+":"+pt,zt=dt[te];zt===void 0&&(tt.push(pt),dt[te]=zt=tt.length-1),O.writeVarint(zt)}}}function Cn($,O){return(O<<3)+(7&$)}function _r($){return $<<1^$>>31}function Xn($,O){for(var B=$.loadGeometry(),K=$.type,tt=0,nt=0,dt=B.length,ht=0;ht<dt;ht++){var pt=B[ht],gt=1;K===1&&(gt=pt.length),O.writeVarint(Cn(1,gt));for(var Vt=K===3?pt.length-1:pt.length,te=0;te<Vt;te++){te===1&&K!==1&&O.writeVarint(Cn(2,Vt-1));var zt=pt[te].x-tt,Ae=pt[te].y-nt;O.writeVarint(_r(zt)),O.writeVarint(_r(Ae)),tt+=zt,nt+=Ae}K===3&&O.writeVarint(Cn(7,1))}}function oi($,O){var B=typeof $;B==="string"?O.writeStringField(1,$):B==="boolean"?O.writeBooleanField(7,$):B==="number"&&($%1!=0?O.writeDoubleField(3,$):$<0?O.writeSVarintField(6,$):O.writeVarintField(5,$))}Zt.exports=Oe,Zt.exports.fromVectorTileJs=Oe,Zt.exports.fromGeojsonVt=function($,O){O=O||{};var B={};for(var K in $)B[K]=new Ft($[K].features,O),B[K].name=K,B[K].version=O.version,B[K].extent=O.extent;return Oe({layers:B})},Zt.exports.GeoJSONWrapper=Ft;var Nr=Zt.exports;function to($,O,B,K,tt,nt){if(tt-K<=B)return;const dt=K+tt>>1;Hr($,O,dt,K,tt,nt%2),to($,O,B,K,dt-1,nt+1),to($,O,B,dt+1,tt,nt+1)}function Hr($,O,B,K,tt,nt){for(;tt>K;){if(tt-K>600){const gt=tt-K+1,Vt=B-K+1,te=Math.log(gt),zt=.5*Math.exp(2*te/3),Ae=.5*Math.sqrt(te*zt*(gt-zt)/gt)*(Vt-gt/2<0?-1:1);Hr($,O,B,Math.max(K,Math.floor(B-Vt*zt/gt+Ae)),Math.min(tt,Math.floor(B+(gt-Vt)*zt/gt+Ae)),nt)}const dt=O[2*B+nt];let ht=K,pt=tt;for(Vi($,O,K,B),O[2*tt+nt]>dt&&Vi($,O,K,tt);ht<pt;){for(Vi($,O,ht,pt),ht++,pt--;O[2*ht+nt]<dt;)ht++;for(;O[2*pt+nt]>dt;)pt--}O[2*K+nt]===dt?Vi($,O,K,pt):(pt++,Vi($,O,pt,tt)),pt<=B&&(K=pt+1),B<=pt&&(tt=pt-1)}}function Vi($,O,B,K){vs($,B,K),vs(O,2*B,2*K),vs(O,2*B+1,2*K+1)}function vs($,O,B){const K=$[O];$[O]=$[B],$[B]=K}function eo($,O,B,K){const tt=$-B,nt=O-K;return tt*tt+nt*nt}const es=$=>$[0],Ul=$=>$[1];class Fs{constructor(O,B=es,K=Ul,tt=64,nt=Float64Array){this.nodeSize=tt,this.points=O;const dt=O.length<65536?Uint16Array:Uint32Array,ht=this.ids=new dt(O.length),pt=this.coords=new nt(2*O.length);for(let gt=0;gt<O.length;gt++)ht[gt]=gt,pt[2*gt]=B(O[gt]),pt[2*gt+1]=K(O[gt]);to(ht,pt,tt,0,ht.length-1,0)}range(O,B,K,tt){return function(nt,dt,ht,pt,gt,Vt,te){const zt=[0,nt.length-1,0],Ae=[];let we,De;for(;zt.length;){const ke=zt.pop(),Mn=zt.pop(),In=zt.pop();if(Mn-In<=te){for(let an=In;an<=Mn;an++)we=dt[2*an],De=dt[2*an+1],we>=ht&&we<=gt&&De>=pt&&De<=Vt&&Ae.push(nt[an]);continue}const wn=Math.floor((In+Mn)/2);we=dt[2*wn],De=dt[2*wn+1],we>=ht&&we<=gt&&De>=pt&&De<=Vt&&Ae.push(nt[wn]);const sn=(ke+1)%2;(ke===0?ht<=we:pt<=De)&&(zt.push(In),zt.push(wn-1),zt.push(sn)),(ke===0?gt>=we:Vt>=De)&&(zt.push(wn+1),zt.push(Mn),zt.push(sn))}return Ae}(this.ids,this.coords,O,B,K,tt,this.nodeSize)}within(O,B,K){return function(tt,nt,dt,ht,pt,gt){const Vt=[0,tt.length-1,0],te=[],zt=pt*pt;for(;Vt.length;){const Ae=Vt.pop(),we=Vt.pop(),De=Vt.pop();if(we-De<=gt){for(let sn=De;sn<=we;sn++)eo(nt[2*sn],nt[2*sn+1],dt,ht)<=zt&&te.push(tt[sn]);continue}const ke=Math.floor((De+we)/2),Mn=nt[2*ke],In=nt[2*ke+1];eo(Mn,In,dt,ht)<=zt&&te.push(tt[ke]);const wn=(Ae+1)%2;(Ae===0?dt-pt<=Mn:ht-pt<=In)&&(Vt.push(De),Vt.push(ke-1),Vt.push(wn)),(Ae===0?dt+pt>=Mn:ht+pt>=In)&&(Vt.push(ke+1),Vt.push(we),Vt.push(wn))}return te}(this.ids,this.coords,O,B,K,this.nodeSize)}}const Mo={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$=>$},Kr=Math.fround||(si=new Float32Array(1),$=>(si[0]=+$,si[0]));var si;class xs{constructor(O){this.options=ye(Object.create(Mo),O),this.trees=new Array(this.options.maxZoom+1)}load(O){const{log:B,minZoom:K,maxZoom:tt,nodeSize:nt}=this.options;B&&console.time("total time");const dt=`prepare ${O.length} points`;B&&console.time(dt),this.points=O;let ht=[];for(let pt=0;pt<O.length;pt++)O[pt].geometry&&ht.push(ai(O[pt],pt));this.trees[tt+1]=new Fs(ht,aa,bn,nt,Float32Array),B&&console.timeEnd(dt);for(let pt=tt;pt>=K;pt--){const gt=+Date.now();ht=this._cluster(ht,pt),this.trees[pt]=new Fs(ht,aa,bn,nt,Float32Array),B&&console.log("z%d: %d clusters in %dms",pt,ht.length,+Date.now()-gt)}return B&&console.timeEnd("total time"),this}getClusters(O,B){let K=((O[0]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,O[1]));let nt=O[2]===180?180:((O[2]+180)%360+360)%360-180;const dt=Math.max(-90,Math.min(90,O[3]));if(O[2]-O[0]>=360)K=-180,nt=180;else if(K>nt){const Vt=this.getClusters([K,tt,180,dt],B),te=this.getClusters([-180,tt,nt,dt],B);return Vt.concat(te)}const ht=this.trees[this._limitZoom(B)],pt=ht.range(Gi(K),Rr(dt),Gi(nt),Rr(tt)),gt=[];for(const Vt of pt){const te=ht.points[Vt];gt.push(te.numPoints?il(te):this.points[te.index])}return gt}getChildren(O){const B=this._getOriginId(O),K=this._getOriginZoom(O),tt="No cluster with the specified id.",nt=this.trees[K];if(!nt)throw new Error(tt);const dt=nt.points[B];if(!dt)throw new Error(tt);const ht=this.options.radius/(this.options.extent*Math.pow(2,K-1)),pt=nt.within(dt.x,dt.y,ht),gt=[];for(const Vt of pt){const te=nt.points[Vt];te.parentId===O&&gt.push(te.numPoints?il(te):this.points[te.index])}if(gt.length===0)throw new Error(tt);return gt}getLeaves(O,B,K){const tt=[];return this._appendLeaves(tt,O,B=B||10,K=K||0,0),tt}getTile(O,B,K){const tt=this.trees[this._limitZoom(O)],nt=Math.pow(2,O),{extent:dt,radius:ht}=this.options,pt=ht/dt,gt=(K-pt)/nt,Vt=(K+1+pt)/nt,te={features:[]};return this._addTileFeatures(tt.range((B-pt)/nt,gt,(B+1+pt)/nt,Vt),tt.points,B,K,nt,te),B===0&&this._addTileFeatures(tt.range(1-pt/nt,gt,1,Vt),tt.points,nt,K,nt,te),B===nt-1&&this._addTileFeatures(tt.range(0,gt,pt/nt,Vt),tt.points,-1,K,nt,te),te.features.length?te:null}getClusterExpansionZoom(O){let B=this._getOriginZoom(O)-1;for(;B<=this.options.maxZoom;){const K=this.getChildren(O);if(B++,K.length!==1)break;O=K[0].properties.cluster_id}return B}_appendLeaves(O,B,K,tt,nt){const dt=this.getChildren(B);for(const ht of dt){const pt=ht.properties;if(pt&&pt.cluster?nt+pt.point_count<=tt?nt+=pt.point_count:nt=this._appendLeaves(O,pt.cluster_id,K,tt,nt):nt<tt?nt++:O.push(ht),O.length===K)break}return nt}_addTileFeatures(O,B,K,tt,nt,dt){for(const ht of O){const pt=B[ht],gt=pt.numPoints;let Vt,te,zt;if(gt)Vt=bs(pt),te=pt.x,zt=pt.y;else{const De=this.points[pt.index];Vt=De.properties,te=Gi(De.geometry.coordinates[0]),zt=Rr(De.geometry.coordinates[1])}const Ae={type:1,geometry:[[Math.round(this.options.extent*(te*nt-K)),Math.round(this.options.extent*(zt*nt-tt))]],tags:Vt};let we;gt?we=pt.id:this.options.generateId?we=pt.index:this.points[pt.index].id&&(we=this.points[pt.index].id),we!==void 0&&(Ae.id=we),dt.features.push(Ae)}}_limitZoom(O){return Math.max(this.options.minZoom,Math.min(+O,this.options.maxZoom+1))}_cluster(O,B){const K=[],{radius:tt,extent:nt,reduce:dt,minPoints:ht}=this.options,pt=tt/(nt*Math.pow(2,B));for(let gt=0;gt<O.length;gt++){const Vt=O[gt];if(Vt.zoom<=B)continue;Vt.zoom=B;const te=this.trees[B+1],zt=te.within(Vt.x,Vt.y,pt),Ae=Vt.numPoints||1;let we=Ae;for(const De of zt){const ke=te.points[De];ke.zoom>B&&(we+=ke.numPoints||1)}if(we>Ae&&we>=ht){let De=Vt.x*Ae,ke=Vt.y*Ae,Mn=dt&&Ae>1?this._map(Vt,!0):null;const In=(gt<<5)+(B+1)+this.points.length;for(const wn of zt){const sn=te.points[wn];if(sn.zoom<=B)continue;sn.zoom=B;const an=sn.numPoints||1;De+=sn.x*an,ke+=sn.y*an,sn.parentId=In,dt&&(Mn||(Mn=this._map(Vt,!0)),dt(Mn,this._map(sn)))}Vt.parentId=In,K.push(sa(De/we,ke/we,In,we,Mn))}else if(K.push(Vt),we>1)for(const De of zt){const ke=te.points[De];ke.zoom<=B||(ke.zoom=B,K.push(ke))}}return K}_getOriginId(O){return O-this.points.length>>5}_getOriginZoom(O){return(O-this.points.length)%32}_map(O,B){if(O.numPoints)return B?ye({},O.properties):O.properties;const K=this.points[O.index].properties,tt=this.options.map(K);return B&&tt===K?ye({},tt):tt}}function sa($,O,B,K,tt){return{x:Kr($),y:Kr(O),zoom:1/0,id:B,parentId:-1,numPoints:K,properties:tt}}function ai($,O){const[B,K]=$.geometry.coordinates;return{x:Kr(Gi(B)),y:Kr(Rr(K)),zoom:1/0,index:O,parentId:-1}}function il($){return{type:"Feature",id:$.id,properties:bs($),geometry:{type:"Point",coordinates:[(O=$.x,360*(O-.5)),ws($.y)]}};var O}function bs($){const O=$.numPoints,B=O>=1e4?`${Math.round(O/1e3)}k`:O>=1e3?Math.round(O/100)/10+"k":O;return ye(ye({},$.properties),{cluster:!0,cluster_id:$.id,point_count:O,point_count_abbreviated:B})}function Gi($){return $/360+.5}function Rr($){const O=Math.sin($*Math.PI/180),B=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return B<0?0:B>1?1:B}function ws($){const O=(180-360*$)*Math.PI/180;return 360*Math.atan(Math.exp(O))/Math.PI-90}function ye($,O){for(const B in O)$[B]=O[B];return $}function aa($){return $.x}function bn($){return $.y}function Bs($,O,B,K){for(var tt,nt=K,dt=B-O>>1,ht=B-O,pt=$[O],gt=$[O+1],Vt=$[B],te=$[B+1],zt=O+3;zt<B;zt+=3){var Ae=ns($[zt],$[zt+1],pt,gt,Vt,te);if(Ae>nt)tt=zt,nt=Ae;else if(Ae===nt){var we=Math.abs(zt-dt);we<ht&&(tt=zt,ht=we)}}nt>K&&(tt-O>3&&Bs($,O,tt,K),$[tt+2]=nt,B-tt>3&&Bs($,tt,B,K))}function ns($,O,B,K,tt,nt){var dt=tt-B,ht=nt-K;if(dt!==0||ht!==0){var pt=(($-B)*dt+(O-K)*ht)/(dt*dt+ht*ht);pt>1?(B=tt,K=nt):pt>0&&(B+=dt*pt,K+=ht*pt)}return(dt=$-B)*dt+(ht=O-K)*ht}function Bt($,O,B,K){var tt={id:$===void 0?null:$,type:O,geometry:B,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(nt){var dt=nt.geometry,ht=nt.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")ge(nt,dt);else if(ht==="Polygon"||ht==="MultiLineString")for(var pt=0;pt<dt.length;pt++)ge(nt,dt[pt]);else if(ht==="MultiPolygon")for(pt=0;pt<dt.length;pt++)for(var gt=0;gt<dt[pt].length;gt++)ge(nt,dt[pt][gt])}(tt),tt}function ge($,O){for(var B=0;B<O.length;B+=3)$.minX=Math.min($.minX,O[B]),$.minY=Math.min($.minY,O[B+1]),$.maxX=Math.max($.maxX,O[B]),$.maxY=Math.max($.maxY,O[B+1])}function no($,O,B,K){if(O.geometry){var tt=O.geometry.coordinates,nt=O.geometry.type,dt=Math.pow(B.tolerance/((1<<B.maxZoom)*B.extent),2),ht=[],pt=O.id;if(B.promoteId?pt=O.properties[B.promoteId]:B.generateId&&(pt=K||0),nt==="Point")Si(tt,ht);else if(nt==="MultiPoint")for(var gt=0;gt<tt.length;gt++)Si(tt[gt],ht);else if(nt==="LineString")Bn(tt,ht,dt,!1);else if(nt==="MultiLineString"){if(B.lineMetrics){for(gt=0;gt<tt.length;gt++)Bn(tt[gt],ht=[],dt,!1),$.push(Bt(pt,"LineString",ht,O.properties));return}Vn(tt,ht,dt,!1)}else if(nt==="Polygon")Vn(tt,ht,dt,!0);else{if(nt!=="MultiPolygon"){if(nt==="GeometryCollection"){for(gt=0;gt<O.geometry.geometries.length;gt++)no($,{id:pt,geometry:O.geometry.geometries[gt],properties:O.properties},B,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(gt=0;gt<tt.length;gt++){var Vt=[];Vn(tt[gt],Vt,dt,!0),ht.push(Vt)}}$.push(Bt(pt,nt,ht,O.properties))}}function Si($,O){O.push(Qn($[0])),O.push(Do($[1])),O.push(0)}function Bn($,O,B,K){for(var tt,nt,dt=0,ht=0;ht<$.length;ht++){var pt=Qn($[ht][0]),gt=Do($[ht][1]);O.push(pt),O.push(gt),O.push(0),ht>0&&(dt+=K?(tt*gt-pt*nt)/2:Math.sqrt(Math.pow(pt-tt,2)+Math.pow(gt-nt,2))),tt=pt,nt=gt}var Vt=O.length-3;O[2]=1,Bs(O,0,Vt,B),O[Vt+2]=1,O.size=Math.abs(dt),O.start=0,O.end=O.size}function Vn($,O,B,K){for(var tt=0;tt<$.length;tt++){var nt=[];Bn($[tt],nt,B,K),O.push(nt)}}function Qn($){return $/360+.5}function Do($){var O=Math.sin($*Math.PI/180),B=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return B<0?0:B>1?1:B}function dn($,O,B,K,tt,nt,dt,ht){if(K/=O,nt>=(B/=O)&&dt<K)return $;if(dt<B||nt>=K)return null;for(var pt=[],gt=0;gt<$.length;gt++){var Vt=$[gt],te=Vt.geometry,zt=Vt.type,Ae=tt===0?Vt.minX:Vt.minY,we=tt===0?Vt.maxX:Vt.maxY;if(Ae>=B&&we<K)pt.push(Vt);else if(!(we<B||Ae>=K)){var De=[];if(zt==="Point"||zt==="MultiPoint")ue(te,De,B,K,tt);else if(zt==="LineString")gn(te,De,B,K,tt,!1,ht.lineMetrics);else if(zt==="MultiLineString")Ci(te,De,B,K,tt,!1);else if(zt==="Polygon")Ci(te,De,B,K,tt,!0);else if(zt==="MultiPolygon")for(var ke=0;ke<te.length;ke++){var Mn=[];Ci(te[ke],Mn,B,K,tt,!0),Mn.length&&De.push(Mn)}if(De.length){if(ht.lineMetrics&&zt==="LineString"){for(ke=0;ke<De.length;ke++)pt.push(Bt(Vt.id,zt,De[ke],Vt.tags));continue}zt!=="LineString"&&zt!=="MultiLineString"||(De.length===1?(zt="LineString",De=De[0]):zt="MultiLineString"),zt!=="Point"&&zt!=="MultiPoint"||(zt=De.length===3?"Point":"MultiPoint"),pt.push(Bt(Vt.id,zt,De,Vt.tags))}}}return pt.length?pt:null}function ue($,O,B,K,tt){for(var nt=0;nt<$.length;nt+=3){var dt=$[nt+tt];dt>=B&&dt<=K&&(O.push($[nt]),O.push($[nt+1]),O.push($[nt+2]))}}function gn($,O,B,K,tt,nt,dt){for(var ht,pt,gt=tn($),Vt=tt===0?cn:Is,te=$.start,zt=0;zt<$.length-3;zt+=3){var Ae=$[zt],we=$[zt+1],De=$[zt+2],ke=$[zt+3],Mn=$[zt+4],In=tt===0?Ae:we,wn=tt===0?ke:Mn,sn=!1;dt&&(ht=Math.sqrt(Math.pow(Ae-ke,2)+Math.pow(we-Mn,2))),In<B?wn>B&&(pt=Vt(gt,Ae,we,ke,Mn,B),dt&&(gt.start=te+ht*pt)):In>K?wn<K&&(pt=Vt(gt,Ae,we,ke,Mn,K),dt&&(gt.start=te+ht*pt)):ro(gt,Ae,we,De),wn<B&&In>=B&&(pt=Vt(gt,Ae,we,ke,Mn,B),sn=!0),wn>K&&In<=K&&(pt=Vt(gt,Ae,we,ke,Mn,K),sn=!0),!nt&&sn&&(dt&&(gt.end=te+ht*pt),O.push(gt),gt=tn($)),dt&&(te+=ht)}var an=$.length-3;Ae=$[an],we=$[an+1],De=$[an+2],(In=tt===0?Ae:we)>=B&&In<=K&&ro(gt,Ae,we,De),an=gt.length-3,nt&&an>=3&&(gt[an]!==gt[0]||gt[an+1]!==gt[1])&&ro(gt,gt[0],gt[1],gt[2]),gt.length&&O.push(gt)}function tn($){var O=[];return O.size=$.size,O.start=$.start,O.end=$.end,O}function Ci($,O,B,K,tt,nt){for(var dt=0;dt<$.length;dt++)gn($[dt],O,B,K,tt,nt,!1)}function ro($,O,B,K){$.push(O),$.push(B),$.push(K)}function cn($,O,B,K,tt,nt){var dt=(nt-O)/(K-O);return $.push(nt),$.push(B+(tt-B)*dt),$.push(1),dt}function Is($,O,B,K,tt,nt){var dt=(nt-B)/(tt-B);return $.push(O+(K-O)*dt),$.push(nt),$.push(1),dt}function rs($,O){for(var B=[],K=0;K<$.length;K++){var tt,nt=$[K],dt=nt.type;if(dt==="Point"||dt==="MultiPoint"||dt==="LineString")tt=Us(nt.geometry,O);else if(dt==="MultiLineString"||dt==="Polygon"){tt=[];for(var ht=0;ht<nt.geometry.length;ht++)tt.push(Us(nt.geometry[ht],O))}else if(dt==="MultiPolygon")for(tt=[],ht=0;ht<nt.geometry.length;ht++){for(var pt=[],gt=0;gt<nt.geometry[ht].length;gt++)pt.push(Us(nt.geometry[ht][gt],O));tt.push(pt)}B.push(Bt(nt.id,dt,tt,nt.tags))}return B}function Us($,O){var B=[];B.size=$.size,$.start!==void 0&&(B.start=$.start,B.end=$.end);for(var K=0;K<$.length;K+=3)B.push($[K]+O,$[K+1],$[K+2]);return B}function Jr($,O){if($.transformed)return $;var B,K,tt,nt=1<<$.z,dt=$.x,ht=$.y;for(B=0;B<$.features.length;B++){var pt=$.features[B],gt=pt.geometry,Vt=pt.type;if(pt.geometry=[],Vt===1)for(K=0;K<gt.length;K+=2)pt.geometry.push($n(gt[K],gt[K+1],O,nt,dt,ht));else for(K=0;K<gt.length;K++){var te=[];for(tt=0;tt<gt[K].length;tt+=2)te.push($n(gt[K][tt],gt[K][tt+1],O,nt,dt,ht));pt.geometry.push(te)}}return $.transformed=!0,$}function $n($,O,B,K,tt,nt){return[Math.round(B*($*K-tt)),Math.round(B*(O*K-nt))]}function No($,O,B,K,tt){for(var nt=O===tt.maxZoom?0:tt.tolerance/((1<<O)*tt.extent),dt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:B,y:K,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ht=0;ht<$.length;ht++){dt.numFeatures++,Es(dt,$[ht],nt,tt);var pt=$[ht].minX,gt=$[ht].minY,Vt=$[ht].maxX,te=$[ht].maxY;pt<dt.minX&&(dt.minX=pt),gt<dt.minY&&(dt.minY=gt),Vt>dt.maxX&&(dt.maxX=Vt),te>dt.maxY&&(dt.maxY=te)}return dt}function Es($,O,B,K){var tt=O.geometry,nt=O.type,dt=[];if(nt==="Point"||nt==="MultiPoint")for(var ht=0;ht<tt.length;ht+=3)dt.push(tt[ht]),dt.push(tt[ht+1]),$.numPoints++,$.numSimplified++;else if(nt==="LineString")Qr(dt,tt,$,B,!1,!1);else if(nt==="MultiLineString"||nt==="Polygon")for(ht=0;ht<tt.length;ht++)Qr(dt,tt[ht],$,B,nt==="Polygon",ht===0);else if(nt==="MultiPolygon")for(var pt=0;pt<tt.length;pt++){var gt=tt[pt];for(ht=0;ht<gt.length;ht++)Qr(dt,gt[ht],$,B,!0,ht===0)}if(dt.length){var Vt=O.tags||null;if(nt==="LineString"&&K.lineMetrics){for(var te in Vt={},O.tags)Vt[te]=O.tags[te];Vt.mapbox_clip_start=tt.start/tt.size,Vt.mapbox_clip_end=tt.end/tt.size}var zt={geometry:dt,type:nt==="Polygon"||nt==="MultiPolygon"?3:nt==="LineString"||nt==="MultiLineString"?2:1,tags:Vt};O.id!==null&&(zt.id=O.id),$.features.push(zt)}}function Qr($,O,B,K,tt,nt){var dt=K*K;if(K>0&&O.size<(tt?dt:K))B.numPoints+=O.length/3;else{for(var ht=[],pt=0;pt<O.length;pt+=3)(K===0||O[pt+2]>dt)&&(B.numSimplified++,ht.push(O[pt]),ht.push(O[pt+1])),B.numPoints++;tt&&function(gt,Vt){for(var te=0,zt=0,Ae=gt.length,we=Ae-2;zt<Ae;we=zt,zt+=2)te+=(gt[zt]-gt[we])*(gt[zt+1]+gt[we+1]);if(te>0===Vt)for(zt=0,Ae=gt.length;zt<Ae/2;zt+=2){var De=gt[zt],ke=gt[zt+1];gt[zt]=gt[Ae-2-zt],gt[zt+1]=gt[Ae-1-zt],gt[Ae-2-zt]=De,gt[Ae-1-zt]=ke}}(ht,nt),$.push(ht)}}function qi($,O){var B=(O=this.options=function(tt,nt){for(var dt in nt)tt[dt]=nt[dt];return tt}(Object.create(this.options),O)).debug;if(B&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");var K=function(tt,nt){var dt=[];if(tt.type==="FeatureCollection")for(var ht=0;ht<tt.features.length;ht++)no(dt,tt.features[ht],nt,ht);else no(dt,tt.type==="Feature"?tt:{geometry:tt},nt);return dt}($,O);this.tiles={},this.tileCoords=[],B&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),K=function(tt,nt){var dt=nt.buffer/nt.extent,ht=tt,pt=dn(tt,1,-1-dt,dt,0,-1,2,nt),gt=dn(tt,1,1-dt,2+dt,0,-1,2,nt);return(pt||gt)&&(ht=dn(tt,1,-dt,1+dt,0,-1,2,nt)||[],pt&&(ht=rs(pt,1).concat(ht)),gt&&(ht=ht.concat(rs(gt,-1)))),ht}(K,O),K.length&&this.splitTile(K,0,0,0),B&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function yo($,O,B){return 32*((1<<$)*B+O)+$}function Ra($,O){const B=$.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);const K=this._geoJSONIndex.getTile(B.z,B.x,B.y);if(!K)return O(null,null);const tt=new $t(K.features);let nt=Nr(tt);nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),O(null,{vectorTile:tt,rawData:nt.buffer})}qi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qi.prototype.splitTile=function($,O,B,K,tt,nt,dt){for(var ht=[$,O,B,K],pt=this.options,gt=pt.debug;ht.length;){K=ht.pop(),B=ht.pop(),O=ht.pop(),$=ht.pop();var Vt=1<<O,te=yo(O,B,K),zt=this.tiles[te];if(!zt&&(gt>1&&console.time("creation"),zt=this.tiles[te]=No($,O,B,K,pt),this.tileCoords.push({z:O,x:B,y:K}),gt)){gt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,B,K,zt.numFeatures,zt.numPoints,zt.numSimplified),console.timeEnd("creation"));var Ae="z"+O;this.stats[Ae]=(this.stats[Ae]||0)+1,this.total++}if(zt.source=$,tt){if(O===pt.maxZoom||O===tt)continue;var we=1<<tt-O;if(B!==Math.floor(nt/we)||K!==Math.floor(dt/we))continue}else if(O===pt.indexMaxZoom||zt.numPoints<=pt.indexMaxPoints)continue;if(zt.source=null,$.length!==0){gt>1&&console.time("clipping");var De,ke,Mn,In,wn,sn,an=.5*pt.buffer/pt.extent,zr=.5-an,Lr=.5+an,pi=1+an;De=ke=Mn=In=null,wn=dn($,Vt,B-an,B+Lr,0,zt.minX,zt.maxX,pt),sn=dn($,Vt,B+zr,B+pi,0,zt.minX,zt.maxX,pt),$=null,wn&&(De=dn(wn,Vt,K-an,K+Lr,1,zt.minY,zt.maxY,pt),ke=dn(wn,Vt,K+zr,K+pi,1,zt.minY,zt.maxY,pt),wn=null),sn&&(Mn=dn(sn,Vt,K-an,K+Lr,1,zt.minY,zt.maxY,pt),In=dn(sn,Vt,K+zr,K+pi,1,zt.minY,zt.maxY,pt),sn=null),gt>1&&console.timeEnd("clipping"),ht.push(De||[],O+1,2*B,2*K),ht.push(ke||[],O+1,2*B,2*K+1),ht.push(Mn||[],O+1,2*B+1,2*K),ht.push(In||[],O+1,2*B+1,2*K+1)}}},qi.prototype.getTile=function($,O,B){var K=this.options,tt=K.extent,nt=K.debug;if($<0||$>24)return null;var dt=1<<$,ht=yo($,O=(O%dt+dt)%dt,B);if(this.tiles[ht])return Jr(this.tiles[ht],tt);nt>1&&console.log("drilling down to z%d-%d-%d",$,O,B);for(var pt,gt=$,Vt=O,te=B;!pt&&gt>0;)gt--,Vt=Math.floor(Vt/2),te=Math.floor(te/2),pt=this.tiles[yo(gt,Vt,te)];return pt&&pt.source?(nt>1&&console.log("found parent tile z%d-%d-%d",gt,Vt,te),nt>1&&console.time("drilling down"),this.splitTile(pt.source,gt,Vt,te,$,O,B),nt>1&&console.timeEnd("drilling down"),this.tiles[ht]?Jr(this.tiles[ht],tt):null):null};class ol extends et{constructor(O,B,K,tt){super(O,B,K,Ra),tt&&(this.loadGeoJSON=tt)}loadData(O,B){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=B,this._pendingLoadDataParams=O,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())}_loadData(){if(!this._pendingCallback||!this._pendingLoadDataParams)return;const O=this._pendingCallback,B=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;const K=!!(B&&B.request&&B.request.collectResourceTiming)&&new l.RequestPerformance(B.request);this.loadGeoJSON(B,(tt,nt)=>{if(tt||!nt)return O(tt);if(typeof nt!="object")return O(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));{rt(nt,!0);try{if(B.filter){const ht=l.createExpression(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ht.result==="error")throw new Error(ht.value.map(gt=>`${gt.key}: ${gt.message}`).join(", "));const pt=nt.features.filter(gt=>ht.value.evaluate({zoom:0},gt));nt={type:"FeatureCollection",features:pt}}this._geoJSONIndex=B.cluster?new xs(function({superclusterOptions:ht,clusterProperties:pt}){if(!pt||!ht)return ht;const gt={},Vt={},te={accumulated:null,zoom:0},zt={properties:null},Ae=Object.keys(pt);for(const we of Ae){const[De,ke]=pt[we],Mn=l.createExpression(ke),In=l.createExpression(typeof De=="string"?[De,["accumulated"],["get",we]]:De);gt[we]=Mn.value,Vt[we]=In.value}return ht.map=we=>{zt.properties=we;const De={};for(const ke of Ae)De[ke]=gt[ke].evaluate(te,zt);return De},ht.reduce=(we,De)=>{zt.properties=De;for(const ke of Ae)te.accumulated=we[ke],we[ke]=Vt[ke].evaluate(te,zt)},ht}(B)).load(nt.features):function(ht,pt){return new qi(ht,pt)}(nt,B.geojsonVtOptions)}catch(ht){return O(ht)}this.loaded={};const dt={};if(K){const ht=K.finish();ht&&(dt.resourceTiming={},dt.resourceTiming[B.source]=JSON.parse(JSON.stringify(ht)))}O(null,dt)}})}coalesce(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())}reloadTile(O,B){const K=this.loaded;return K&&K[O.uid]?super.reloadTile(O,B):this.loadTile(O,B)}loadGeoJSON(O,B){if(O.request)l.getJSON(O.request,B);else{if(typeof O.data!="string")return B(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`));try{return B(null,JSON.parse(O.data))}catch{return B(new Error(`Input data given to '${O.source}' is not a valid GeoJSON object.`))}}}removeSource(O,B){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),B()}getClusterExpansionZoom(O,B){try{B(null,this._geoJSONIndex.getClusterExpansionZoom(O.clusterId))}catch(K){B(K)}}getClusterChildren(O,B){try{B(null,this._geoJSONIndex.getChildren(O.clusterId))}catch(K){B(K)}}getClusterLeaves(O,B){try{B(null,this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset))}catch(K){B(K)}}}class Vs{constructor(O){this.self=O,this.actor=new l.Actor(O,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:et,geojson:ol},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(B,K)=>{if(this.workerSourceTypes[B])throw new Error(`Worker source with name "${B}" already registered.`);this.workerSourceTypes[B]=K},this.self.registerRTLTextPlugin=B=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=B.applyArabicShaping,l.plugin.processBidirectionalText=B.processBidirectionalText,l.plugin.processStyledBidirectionalText=B.processStyledBidirectionalText}}setReferrer(O,B){this.referrer=B}setImages(O,B,K){this.availableImages[O]=B;for(const tt in this.workerSources[O]){const nt=this.workerSources[O][tt];for(const dt in nt)nt[dt].availableImages=B}K()}setLayers(O,B,K){this.getLayerIndex(O).replace(B),K()}updateLayers(O,B,K){this.getLayerIndex(O).update(B.layers,B.removedIds),K()}loadTile(O,B,K){this.getWorkerSource(O,B.type,B.source).loadTile(B,K)}loadDEMTile(O,B,K){this.getDEMWorkerSource(O,B.source).loadTile(B,K)}reloadTile(O,B,K){this.getWorkerSource(O,B.type,B.source).reloadTile(B,K)}abortTile(O,B,K){this.getWorkerSource(O,B.type,B.source).abortTile(B,K)}removeTile(O,B,K){this.getWorkerSource(O,B.type,B.source).removeTile(B,K)}removeDEMTile(O,B){this.getDEMWorkerSource(O,B.source).removeTile(B)}removeSource(O,B,K){if(!this.workerSources[O]||!this.workerSources[O][B.type]||!this.workerSources[O][B.type][B.source])return;const tt=this.workerSources[O][B.type][B.source];delete this.workerSources[O][B.type][B.source],tt.removeSource!==void 0?tt.removeSource(B,K):K()}loadWorkerSource(O,B,K){try{this.self.importScripts(B.url),K()}catch(tt){K(tt.toString())}}syncRTLPluginState(O,B,K){try{l.plugin.setState(B);const tt=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&tt!=null){this.self.importScripts(tt);const nt=l.plugin.isParsed();K(nt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${tt}`),nt)}}catch(tt){K(tt.toString())}}getAvailableImages(O){let B=this.availableImages[O];return B||(B=[]),B}getLayerIndex(O){let B=this.layerIndexes[O];return B||(B=this.layerIndexes[O]=new T),B}getWorkerSource(O,B,K){if(this.workerSources[O]||(this.workerSources[O]={}),this.workerSources[O][B]||(this.workerSources[O][B]={}),!this.workerSources[O][B][K]){const tt={send:(nt,dt,ht)=>{this.actor.send(nt,dt,ht,O)}};this.workerSources[O][B][K]=new this.workerSourceTypes[B](tt,this.getLayerIndex(O),this.getAvailableImages(O))}return this.workerSources[O][B][K]}getDEMWorkerSource(O,B){return this.demWorkerSources[O]||(this.demWorkerSources[O]={}),this.demWorkerSources[O][B]||(this.demWorkerSources[O][B]=new at),this.demWorkerSources[O][B]}enforceCacheSizeLimit(O,B){l.enforceCacheSizeLimit(B)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Vs(self)),Vs}),c(["./shared"],function(l){var x=I;function I(y){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,v,E=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(E);try{v=new Worker(L),m=!0}catch{m=!1}return v&&v.terminate(),URL.revokeObjectURL(L),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var v=m.getContext("2d");if(!v)return!1;var E=v.getImageData(0,0,1,1);return E&&E.width===m.width}()?(T[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(T[h]=function(m){var v,E=function(L){var N=document.createElement("canvas"),C=Object.create(I.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=L,N.getContext("webgl",C)||N.getContext("experimental-webgl",C)}(m);if(!E)return!1;try{v=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!v||E.isContextLost())&&(E.shaderSource(v,"void main() {}"),E.compileShader(v),E.getShaderParameter(v,E.COMPILE_STATUS)===!0)}(h)),T[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(y)}var T={};function P(y,o){if(Array.isArray(y)){if(!Array.isArray(o)||y.length!==o.length)return!1;for(let h=0;h<y.length;h++)if(!P(y[h],o[h]))return!1;return!0}if(typeof y=="object"&&y!==null&&o!==null){if(typeof o!="object"||Object.keys(y).length!==Object.keys(o).length)return!1;for(const h in y)if(!P(y[h],o[h]))return!1;return!0}return y===o}I.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class D{static testProp(o){if(!D.docStyle)return o[0];for(let h=0;h<o.length;h++)if(o[h]in D.docStyle)return o[h];return o[0]}static create(o,h,m){const v=window.document.createElement(o);return h!==void 0&&(v.className=h),m&&m.appendChild(v),v}static createNS(o,h){return window.document.createElementNS(o,h)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(o,h){o.style[D.transformProp]=h}static addEventListener(o,h,m,v={}){o.addEventListener(h,m,"passive"in v?v:v.capture)}static removeEventListener(o,h,m,v={}){o.removeEventListener(h,m,"passive"in v?v:v.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(o,h){const m=o.getBoundingClientRect();return new l.pointGeometry(h.clientX-m.left-o.clientLeft,h.clientY-m.top-o.clientTop)}static touchPos(o,h){const m=o.getBoundingClientRect(),v=[];for(let E=0;E<h.length;E++)v.push(new l.pointGeometry(h[E].clientX-m.left-o.clientLeft,h[E].clientY-m.top-o.clientTop));return v}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);class G{constructor(o){this._transformRequestFn=o}transformRequest(o,h){return this._transformRequestFn&&this._transformRequestFn(o,h)||{url:o}}normalizeSpriteURL(o,h,m){const v=function(E){const L=E.match(Y);if(!L)throw new Error(`Unable to parse URL "${E}"`);return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}(o);return v.path+=`${h}${m}`,function(E){const L=E.params.length?`?${E.params.join("&")}`:"";return`${E.protocol}://${E.authority}${E.path}${L}`}(v)}setTransformRequest(o){this._transformRequestFn=o}}const Y=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function et(y){var o=new l.ARRAY_TYPE(3);return o[0]=y[0],o[1]=y[1],o[2]=y[2],o}var at,rt=function(y,o,h){return y[0]=o[0]-h[0],y[1]=o[1]-h[1],y[2]=o[2]-h[2],y};at=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(at[0]=0,at[1]=0,at[2]=0);var wt=function(y){var o=y[0],h=y[1];return o*o+h*h};(function(){var y=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(y[0]=0,y[1]=0)})();class xt{constructor(o,h,m,v){this.context=o,this.format=m,this.texture=o.gl.createTexture(),this.update(h,v)}update(o,h,m){const{width:v,height:E}=o,L=!(this.size&&this.size[0]===v&&this.size[1]===E||m),{context:N}=this,{gl:C}=N;if(this.useMipmap=Boolean(h&&h.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!h||h.premultiply!==!1)),L)this.size=[v,E],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.isImageBitmap(o)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,o):C.texImage2D(C.TEXTURE_2D,0,this.format,v,E,0,this.format,C.UNSIGNED_BYTE,o.data);else{const{x:k,y:V}=m||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.isImageBitmap(o)?C.texSubImage2D(C.TEXTURE_2D,0,k,V,C.RGBA,C.UNSIGNED_BYTE,o):C.texSubImage2D(C.TEXTURE_2D,0,k,V,v,E,C.RGBA,C.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(o,h,m){const{context:v}=this,{gl:E}=v;E.bindTexture(E.TEXTURE_2D,this.texture),m!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=E.LINEAR),o!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,o),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,m||o),this.filter=o),h!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,h),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Gt(y){const{userImage:o}=y;return!!(o&&o.render&&o.render())&&(y.data.replace(new Uint8Array(o.data.buffer)),!0)}class ee extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:m}of this.requestors)this._notify(h,m);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,h){this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let m=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(h.content,h)||(this.fire(new l.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,h){if(!o)return!0;let m=0;for(const v of o){if(v[0]<m||v[1]<v[0]||h<v[1])return!1;m=v[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let m=!0;if(!this.isLoaded())for(const v of o)this.images[v]||(m=!1);this.isLoaded()||m?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const m={};for(const v of o){this.images[v]||this.fire(new l.Event("styleimagemissing",{id:v}));const E=this.images[v];E?m[v]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:Boolean(E.userImage&&E.userImage.render)}:l.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,m)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],m=this.getImage(o);if(!m)return null;if(h&&h.position.version===m.version)return h.position;if(h)h.position.version=m.version;else{const v={w:m.data.width+2,h:m.data.height+2,x:0,y:0},E=new l.ImagePosition(v,m);this.patterns[o]={bin:v,position:E}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new xt(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const E in this.patterns)o.push(this.patterns[E].bin);const{w:h,h:m}=l.potpack(o),v=this.atlasImage;v.resize({width:h||1,height:m||1});for(const E in this.patterns){const{bin:L}=this.patterns[E],N=L.x+1,C=L.y+1,k=this.images[E].data,V=k.width,Z=k.height;l.RGBAImage.copy(k,v,{x:0,y:0},{x:N,y:C},{width:V,height:Z}),l.RGBAImage.copy(k,v,{x:0,y:Z-1},{x:N,y:C-1},{width:V,height:1}),l.RGBAImage.copy(k,v,{x:0,y:0},{x:N,y:C+Z},{width:V,height:1}),l.RGBAImage.copy(k,v,{x:V-1,y:0},{x:N-1,y:C},{width:1,height:Z}),l.RGBAImage.copy(k,v,{x:0,y:0},{x:N+V,y:C},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const m=this.images[h];Gt(m)&&this.updateImage(h,m)}}}const $t=1e20;function Zt(y,o,h,m,v,E,L,N,C){for(let k=o;k<o+m;k++)Mt(y,h*E+k,E,v,L,N,C);for(let k=h;k<h+v;k++)Mt(y,k*E+o,1,m,L,N,C)}function Mt(y,o,h,m,v,E,L){E[0]=0,L[0]=-$t,L[1]=$t,v[0]=y[o];for(let N=1,C=0,k=0;N<m;N++){v[N]=y[o+N*h];const V=N*N;do{const Z=E[C];k=(v[N]-v[Z]+V-Z*Z)/(N-Z)/2}while(k<=L[C]&&--C>-1);C++,E[C]=N,L[C]=k,L[C+1]=$t}for(let N=0,C=0;N<m;N++){for(;L[C+1]<N;)C++;const k=E[C],V=N-k;y[o+N*h]=v[k]+V*V}}class It{constructor(o,h){this.requestManager=o,this.localIdeographFontFamily=h,this.entries={}}setURL(o){this.url=o}getGlyphs(o,h){const m=[];for(const v in o)for(const E of o[v])m.push({stack:v,id:E});l.asyncAll(m,({stack:v,id:E},L)=>{let N=this.entries[v];N||(N=this.entries[v]={glyphs:{},requests:{},ranges:{}});let C=N.glyphs[E];if(C!==void 0)return void L(null,{stack:v,id:E,glyph:C});if(C=this._tinySDF(N,v,E),C)return N.glyphs[E]=C,void L(null,{stack:v,id:E,glyph:C});const k=Math.floor(E/256);if(256*k>65535)return void L(new Error("glyphs > 65535 not supported"));if(N.ranges[k])return void L(null,{stack:v,id:E,glyph:C});let V=N.requests[k];V||(V=N.requests[k]=[],It.loadGlyphRange(v,k,this.url,this.requestManager,(Z,W)=>{if(W){for(const ot in W)this._doesCharSupportLocalGlyph(+ot)||(N.glyphs[+ot]=W[+ot]);N.ranges[k]=!0}for(const ot of V)ot(Z,W);delete N.requests[k]})),V.push((Z,W)=>{Z?L(Z):W&&L(null,{stack:v,id:E,glyph:W[E]||null})})},(v,E)=>{if(v)h(v);else if(E){const L={};for(const{stack:N,id:C,glyph:k}of E)(L[N]||(L[N]={}))[C]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};h(null,L)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](o)||l.unicodeBlockLookup["Hangul Syllables"](o)||l.unicodeBlockLookup.Hiragana(o)||l.unicodeBlockLookup.Katakana(o))}_tinySDF(o,h,m){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(m))return;let E=o.tinySDF;if(!E){let N="400";/bold/i.test(h)?N="900":/medium/i.test(h)?N="500":/light/i.test(h)&&(N="200"),E=o.tinySDF=new It.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:v,fontWeight:N})}const L=E.draw(String.fromCharCode(m));return{id:m,bitmap:new l.AlphaImage({width:L.width||30,height:L.height||30},L.data),metrics:{width:L.glyphWidth||24,height:L.glyphHeight||24,left:L.glyphLeft||0,top:L.glyphTop-27||-8,advance:L.glyphAdvance||24}}}}It.loadGlyphRange=function(y,o,h,m,v){const E=256*o,L=E+255,N=m.transformRequest(h.replace("{fontstack}",y).replace("{range}",`${E}-${L}`),l.ResourceType.Glyphs);l.getArrayBuffer(N,(C,k)=>{if(C)v(C);else if(k){const V={};for(const Z of l.parseGlyphPBF(k))V[Z.id]=Z;v(null,V)}})},It.TinySDF=class{constructor({fontSize:y=24,buffer:o=3,radius:h=8,cutoff:m=.25,fontFamily:v="sans-serif",fontWeight:E="normal",fontStyle:L="normal"}={}){this.buffer=o,this.cutoff=m,this.radius=h;const N=this.size=y+4*o,C=this._createCanvas(N),k=this.ctx=C.getContext("2d",{willReadFrequently:!0});k.font=`${L} ${E} ${y}px ${v}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(y){const o=document.createElement("canvas");return o.width=o.height=y,o}draw(y){const{width:o,actualBoundingBoxAscent:h,actualBoundingBoxDescent:m,actualBoundingBoxLeft:v,actualBoundingBoxRight:E}=this.ctx.measureText(y),L=Math.ceil(h),N=Math.min(this.size-this.buffer,Math.ceil(E-v)),C=Math.min(this.size-this.buffer,L+Math.ceil(m)),k=N+2*this.buffer,V=C+2*this.buffer,Z=Math.max(k*V,0),W=new Uint8ClampedArray(Z),ot={data:W,width:k,height:V,glyphWidth:N,glyphHeight:C,glyphTop:L,glyphLeft:0,glyphAdvance:o};if(N===0||C===0)return ot;const{ctx:J,buffer:it,gridInner:mt,gridOuter:yt}=this;J.clearRect(it,it,N,C),J.fillText(y,it,it+L);const Tt=J.getImageData(it,it,N,C);yt.fill($t,0,Z),mt.fill(0,0,Z);for(let bt=0;bt<C;bt++)for(let Kt=0;Kt<N;Kt++){const Ut=Tt.data[4*(bt*N+Kt)+3]/255;if(Ut===0)continue;const kt=(bt+it)*k+Kt+it;if(Ut===1)yt[kt]=0,mt[kt]=$t;else{const se=.5-Ut;yt[kt]=se>0?se*se:0,mt[kt]=se<0?se*se:0}}Zt(yt,0,0,k,V,k,this.f,this.v,this.z),Zt(mt,it,it,N,C,k,this.f,this.v,this.z);for(let bt=0;bt<Z;bt++){const Kt=Math.sqrt(yt[bt])-Math.sqrt(mt[bt]);W[bt]=Math.round(255-255*(Kt/this.radius+this.cutoff))}return ot}};const Wt=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(y,o){return l.sphericalToCartesian(y.expression.evaluate(o))}interpolate(y,o,h){return{x:l.number(y.x,o.x,h),y:l.number(y.y,o.y,h),z:l.number(y.z,o.z,h)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)}),ft="-transition";class re extends l.Evented{constructor(o){super(),this._transitionable=new l.Transitionable(Wt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(l.validateLight,o,h))for(const m in o){const v=o[m];m.endsWith(ft)?this._transitionable.setTransition(m.slice(0,-ft.length),v):this._transitionable.setValue(m,v)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,m){return(!m||m.validate!==!1)&&l.emitValidationErrors(this,o.call(l.validateStyle,l.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Yt{constructor(o,h){this.width=o,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,h){const m=o.join(",")+String(h);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(o,h)),this.dashEntry[m]}getDashRanges(o,h,m){const v=[];let E=o.length%2==1?-o[o.length-1]*m:0,L=o[0]*m,N=!0;v.push({left:E,right:L,isDash:N,zeroLength:o[0]===0});let C=o[0];for(let k=1;k<o.length;k++){N=!N;const V=o[k];E=C*m,C+=V,L=C*m,v.push({left:E,right:L,isDash:N,zeroLength:V===0})}return v}addRoundDash(o,h,m){const v=h/2;for(let E=-m;E<=m;E++){const L=this.width*(this.nextRow+m+E);let N=0,C=o[N];for(let k=0;k<this.width;k++){k/C.right>1&&(C=o[++N]);const V=Math.abs(k-C.left),Z=Math.abs(k-C.right),W=Math.min(V,Z);let ot;const J=E/m*(v+1);if(C.isDash){const it=v-Math.abs(J);ot=Math.sqrt(W*W+it*it)}else ot=v-Math.sqrt(W*W+J*J);this.data[L+k]=Math.max(0,Math.min(255,ot+128))}}}addRegularDash(o){for(let N=o.length-1;N>=0;--N){const C=o[N],k=o[N+1];C.zeroLength?o.splice(N,1):k&&k.isDash===C.isDash&&(k.left=C.left,o.splice(N,1))}const h=o[0],m=o[o.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);const v=this.width*this.nextRow;let E=0,L=o[E];for(let N=0;N<this.width;N++){N/L.right>1&&(L=o[++E]);const C=Math.abs(N-L.left),k=Math.abs(N-L.right),V=Math.min(C,k);this.data[v+N]=Math.max(0,Math.min(255,(L.isDash?V:-V)+128))}}addDash(o,h){const m=h?7:0,v=2*m+1;if(this.nextRow+v>this.height)return l.warnOnce("LineAtlas out of space"),null;let E=0;for(let N=0;N<o.length;N++)E+=o[N];if(E!==0){const N=this.width/E,C=this.getDashRanges(o,this.width,N);h?this.addRoundDash(C,N,m):this.addRegularDash(C)}const L={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:E};return this.nextRow+=v,this.dirty=!0,L}bind(o){const h=o.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}class Ft{constructor(o,h){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const m=this.workerPool.acquire(this.id);for(let v=0;v<m.length;v++){const E=new Ft.Actor(m[v],h,this.id);E.name=`Worker ${v}`,this.actors.push(E)}}broadcast(o,h,m){l.asyncAll(this.actors,(v,E)=>{v.send(o,h,E)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Oe(y,o,h){const m=function(v,E){if(v)return h(v);if(E){const L=l.pick(l.extend(E,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);E.vector_layers&&(L.vectorLayers=E.vector_layers,L.vectorLayerIds=L.vectorLayers.map(N=>N.id)),h(null,L)}};return y.url?l.getJSON(o.transformRequest(y.url,l.ResourceType.Source),m):l.exported.frame(()=>m(null,y))}Ft.Actor=l.Actor;class Jt{constructor(o,h,m){this.bounds=l.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),m=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*h),E=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*h),L=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=m&&o.x<E&&o.y>=v&&o.y<L}}class $e extends l.Evented{constructor(o,h,m,v){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(h,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o?this.fire(new l.ErrorEvent(o)):h&&(l.extend(this,h),h.bounds&&(this.tileBounds=new Jt(h.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(o,h){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(m,l.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function E(L,N){return delete o.request,o.aborted?h(null):L&&L.status!==404?h(L):(N&&N.resourceTiming&&(o.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&o.setExpiryData(N),o.loadVectorData(N,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}v.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",v,E.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",v,E.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class pn extends l.Evented{constructor(o,h,m,v){super(),this.id=o,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},h),l.extend(this,l.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Oe(this._options,this.map._requestManager,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new l.ErrorEvent(o)):h&&(l.extend(this,h),h.bounds&&(this.tileBounds=new Jt(h.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=l.getImage(this.map._requestManager.transformRequest(m,l.ResourceType.Tile),(v,E,L)=>{if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(v)o.state="errored",h(v);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(L);const N=this.map.painter.context,C=N.gl;o.texture=this.map.painter.getTileTexture(E.width),o.texture?o.texture.update(E,{useMipmap:!0}):(o.texture=new xt(N,E,C.RGBA,{useMipmap:!0}),o.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),N.extTextureFilterAnisotropic&&C.texParameterf(C.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax)),o.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),h(null)}})}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}}let Cn;class _r extends pn{constructor(o,h,m,v){super(o,h,m,v),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(o,h){const m=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function v(E,L){E&&(o.state="errored",h(E)),L&&(o.dem=L,o.needsHillshadePrepare=!0,o.state="loaded",h(null))}o.request=l.getImage(this.map._requestManager.transformRequest(m,l.ResourceType.Tile),function(E,L){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(E)o.state="errored",h(E);else if(L){this.map._refreshExpiredTiles&&o.setExpiryData(L),delete L.cacheControl,delete L.expires;const N=l.isImageBitmap(L)&&(Cn==null&&(Cn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Cn)?L:l.exported.getImageData(L,1),C={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:N,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",C,v.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const h=o.canonical,m=Math.pow(2,h.z),v=(h.x-1+m)%m,E=h.x===0?o.wrap-1:o.wrap,L=(h.x+1+m)%m,N=h.x+1===m?o.wrap+1:o.wrap,C={};return C[new l.OverscaledTileID(o.overscaledZ,E,h.z,v,h.y).key]={backfilled:!1},C[new l.OverscaledTileID(o.overscaledZ,N,h.z,L,h.y).key]={backfilled:!1},h.y>0&&(C[new l.OverscaledTileID(o.overscaledZ,E,h.z,v,h.y-1).key]={backfilled:!1},C[new l.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},C[new l.OverscaledTileID(o.overscaledZ,N,h.z,L,h.y-1).key]={backfilled:!1}),h.y+1<m&&(C[new l.OverscaledTileID(o.overscaledZ,E,h.z,v,h.y+1).key]={backfilled:!1},C[new l.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},C[new l.OverscaledTileID(o.overscaledZ,N,h.z,L,h.y+1).key]={backfilled:!1}),C}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Xn extends l.Evented{constructor(o,h,m,v){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(v),this._data=h.data,this._options=l.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const E=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*E,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*E,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:l.EXTENT,radius:(h.clusterRadius||50)*E,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData("content"),this}getClusterExpansionZoom(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this}getClusterChildren(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this}getClusterLeaves(o,h,m,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:m},v),this}_updateWorkerData(o){const h=l.extend({},this.workerOptions),m=this._data;typeof m=="string"?(h.request=this.map._requestManager.transformRequest(l.exported.resolveURL(m),l.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(m),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,h,(v,E)=>{if(this._pendingLoads--,this._removed||E&&E.abandoned)return;let L=null;if(E&&E.resourceTiming&&E.resourceTiming[this.id]&&(L=E.resourceTiming[this.id].slice(0)),this.actor.send(`${this.type}.coalesce`,{source:h.source},null),v)return void this.fire(new l.ErrorEvent(v));const N={dataType:"source",sourceDataType:o};this._collectResourceTiming&&L&&L.length>0&&l.extend(N,{resourceTiming:L}),this.fire(new l.Event("data",N))})}loaded(){return this._pendingLoads===0}loadTile(o,h){const m=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const v={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(m,v,(E,L)=>(delete o.request,o.unloadVectorData(),o.aborted?h(null):E?h(E):(o.loadVectorData(L,this.map.painter,m==="reloadTile"),h(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var oi=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Nr extends l.Evented{constructor(o,h,m,v){super(),this.id=o,this.dispatcher=m,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(o,h){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(m,v)=>{this._loaded=!0,m?this.fire(new l.ErrorEvent(m)):v&&(this.image=v,o&&(this.coordinates=o),h&&h(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o;const h=o.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(v){let E=1/0,L=1/0,N=-1/0,C=-1/0;for(const W of v)E=Math.min(E,W.x),L=Math.min(L,W.y),N=Math.max(N,W.x),C=Math.max(C,W.y);const k=Math.max(N-E,C-L),V=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),Z=Math.pow(2,V);return new l.CanonicalTileID(V,Math.floor((E+N)/2*Z),Math.floor((L+C)/2*Z))}(h),this.minzoom=this.maxzoom=this.tileID.z;const m=h.map(v=>this.tileID.getTilePoint(v)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,h=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new xt(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class to extends Nr{constructor(o,h,m,v){super(o,h,m,v),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const o=this.options;this.urls=[];for(const h of o.urls)this.urls.push(this.map._requestManager.transformRequest(h,l.ResourceType.Source).url);l.getVideo(this.urls,(h,m)=>{this._loaded=!0,h?this.fire(new l.ErrorEvent(h)):m&&(this.video=m,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,h=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new xt(o,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Hr extends Nr{constructor(o,h,m,v){super(o,h,m,v),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(L=>typeof L!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,m=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xt(h,this.canvas,m.RGBA,{premultiply:!0});for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Vi={vector:$e,raster:pn,"raster-dem":_r,geojson:Xn,video:to,image:Nr,canvas:Hr};function vs(y,o){const h=l.create();return l.translate(h,h,[1,1,0]),l.scale(h,h,[.5*y.width,.5*y.height,1]),l.multiply(h,h,y.calculatePosMatrix(o.toUnwrapped()))}function eo(y,o,h,m,v,E){const L=function(Z,W,ot){if(Z)for(const J of Z){const it=W[J];if(it&&it.source===ot&&it.type==="fill-extrusion")return!0}else for(const J in W){const it=W[J];if(it.source===ot&&it.type==="fill-extrusion")return!0}return!1}(v&&v.layers,o,y.id),N=E.maxPitchScaleFactor(),C=y.tilesIn(m,N,L);C.sort(es);const k=[];for(const Z of C)k.push({wrappedTileID:Z.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(o,h,y._state,Z.queryGeometry,Z.cameraQueryGeometry,Z.scale,v,E,N,vs(y.transform,Z.tileID))});const V=function(Z){const W={},ot={};for(const J of Z){const it=J.queryResults,mt=J.wrappedTileID,yt=ot[mt]=ot[mt]||{};for(const Tt in it){const bt=it[Tt],Kt=yt[Tt]=yt[Tt]||{},Ut=W[Tt]=W[Tt]||[];for(const kt of bt)Kt[kt.featureIndex]||(Kt[kt.featureIndex]=!0,Ut.push(kt))}}return W}(k);for(const Z in V)V[Z].forEach(W=>{const ot=W.feature,J=y.getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=J});return V}function es(y,o){const h=y.tileID,m=o.tileID;return h.overscaledZ-m.overscaledZ||h.canonical.y-m.canonical.y||h.wrap-m.wrap||h.canonical.x-m.canonical.x}class Ul{constructor(o,h){this.tileID=o,this.uid=l.uniqueId(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const h=o+this.timeAdded;h<l.exported.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}loadVectorData(o,h,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(v,E){const L={};if(!E)return L;for(const N of v){const C=N.layerIds.map(k=>E.getLayer(k)).filter(Boolean);if(C.length!==0){N.layers=C,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(k=>C.filter(V=>V.id===k)[0]));for(const k of C)L[k.id]=N}}return L}(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const E=this.buckets[v];if(E instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!m)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const E=this.buckets[v];if(E instanceof l.SymbolBucket&&E.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const v in this.buckets){const E=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(E))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const m in this.buckets){const v=this.buckets[m];v.uploadPending()&&v.upload(o)}const h=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xt(o,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xt(o,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,h,m,v,E,L,N,C,k,V){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:E,scale:L,tileSize:this.tileSize,pixelPosMatrix:V,transform:C,params:N,queryPadding:this.queryPadding*k},o,h,m):{}}querySourceFeatures(o,h){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),E=h?h.sourceLayer:"",L=v._geojsonTileLayer||v[E];if(!L)return;const N=l.createFilter(h&&h.filter),{z:C,x:k,y:V}=this.tileID.canonical,Z={z:C,x:k,y:V};for(let W=0;W<L.length;W++){const ot=L.feature(W);if(N.needGeometry){const mt=l.toEvaluationFeature(ot,!0);if(!N.filter(new l.EvaluationParameters(this.tileID.overscaledZ),mt,this.tileID.canonical))continue}else if(!N.filter(new l.EvaluationParameters(this.tileID.overscaledZ),ot))continue;const J=m.getId(ot,E),it=new l.GeoJSONFeature(ot,C,k,V,J);it.tile=Z,o.push(it)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const m=l.parseCacheControl(o.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const E=this.expirationTime-h;E?this.expirationTime=m+Math.max(E,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const E=this.buckets[v],L=E.layers[0].sourceLayer||"_geojsonTileLayer",N=m[L],C=o[L];if(!N||!C||Object.keys(C).length===0)continue;E.update(C,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=h&&h.style&&h.style.getLayer(v);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=l.exported.now()+o}setDependencies(o,h){const m={};for(const v of h)m[v]=!0;this.dependencies[o]=m}hasDependency(o,h){for(const m of o){const v=this.dependencies[m];if(v){for(const E of h)if(v[E])return!0}}return!1}}class Fs{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,m){const v=o.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const E={value:h,timeout:void 0};if(m!==void 0&&(E.timeout=setTimeout(()=>{this.remove(o,E)},m)),this.data[v].push(E),this.order.push(v),this.order.length>this.max){const L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const m=o.wrapped().key,v=h===void 0?0:this.data[m].indexOf(h),E=this.data[m][v];return this.data[m].splice(v,1),E.timeout&&clearTimeout(E.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(E.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const m in this.data)for(const v of this.data[m])o(v.value)||h.push(v);for(const m of h)this.remove(m.value.tileID,m)}}class Mo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,m){const v=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][v]=this.stateChanges[o][v]||{},l.extend(this.stateChanges[o][v],m),this.deletedStates[o]===null){this.deletedStates[o]={};for(const E in this.state[o])E!==v&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][v]===null){this.deletedStates[o][v]={};for(const E in this.state[o][v])m[E]||(this.deletedStates[o][v][E]=null)}else for(const E in m)this.deletedStates[o]&&this.deletedStates[o][v]&&this.deletedStates[o][v][E]===null&&delete this.deletedStates[o][v][E]}removeFeatureState(o,h,m){if(this.deletedStates[o]===null)return;const v=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},m&&h!==void 0)this.deletedStates[o][v]!==null&&(this.deletedStates[o][v]=this.deletedStates[o][v]||{},this.deletedStates[o][v][m]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][v])for(m in this.deletedStates[o][v]={},this.stateChanges[o][v])this.deletedStates[o][v][m]=null;else this.deletedStates[o][v]=null;else this.deletedStates[o]=null}getState(o,h){const m=String(h),v=l.extend({},(this.state[o]||{})[m],(this.stateChanges[o]||{})[m]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const E=this.deletedStates[o][h];if(E===null)return{};for(const L in E)delete v[L]}return v}initializeTileState(o,h){o.setFeatureState(this.state,h)}coalesceChanges(o,h){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const E={};for(const L in this.stateChanges[v])this.state[v][L]||(this.state[v][L]={}),l.extend(this.state[v][L],this.stateChanges[v][L]),E[L]=this.state[v][L];m[v]=E}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const E={};if(this.deletedStates[v]===null)for(const L in this.state[v])E[L]={},this.state[v][L]={};else for(const L in this.deletedStates[v]){if(this.deletedStates[v][L]===null)this.state[v][L]={};else for(const N of Object.keys(this.deletedStates[v][L]))delete this.state[v][L][N];E[L]=this.state[v][L]}m[v]=m[v]||{},l.extend(m[v],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const v in o)o[v].setFeatureState(m,h)}}class Kr extends l.Evented{constructor(o,h,m){super(),this.id=o,this.dispatcher=m,this.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(v,E,L,N){const C=new Vi[E.type](v,E,L,N);if(C.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${C.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],C),C}(o,h,m,this),this._tiles={},this._cache=new Fs(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mo}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const h=this._tiles[o];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,h){return this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new l.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const m=this._tiles[h];m.upload(o),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(si).map(o=>o.key)}getRenderableIds(o){const h=[];for(const m in this._tiles)this._isIdRenderable(m,o)&&h.push(this._tiles[m]);return o?h.sort((m,v)=>{const E=m.tileID,L=v.tileID,N=new l.pointGeometry(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),C=new l.pointGeometry(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-L.overscaledZ||C.y-N.y||C.x-N.x}).map(m=>m.tileID.key):h.map(m=>m.tileID).sort(si).map(m=>m.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,h){const m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=h),this._loadTile(m,this._tileLoaded.bind(this,m,o,h)))}_tileLoaded(o,h,m,v){if(v)return o.state="errored",void(v.status!==404?this._source.fire(new l.ErrorEvent(v,{tile:o})):this.update(this.transform));o.timeAdded=l.exported.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const E=h[v];if(o.neighboringTiles&&o.neighboringTiles[E]){const L=this.getTileByID(E);m(o,L),m(L,o)}}function m(v,E){v.needsHillshadePrepare=!0;let L=E.tileID.canonical.x-v.tileID.canonical.x;const N=E.tileID.canonical.y-v.tileID.canonical.y,C=Math.pow(2,v.tileID.canonical.z),k=E.tileID.key;L===0&&N===0||Math.abs(N)>1||(Math.abs(L)>1&&(Math.abs(L+C)===1?L+=C:Math.abs(L-C)===1&&(L-=C)),E.dem&&v.dem&&(v.dem.backfillBorder(E.dem,L,N),v.neighboringTiles&&v.neighboringTiles[k]&&(v.neighboringTiles[k].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,m,v){for(const E in this._tiles){let L=this._tiles[E];if(v[E]||!L.hasData()||L.tileID.overscaledZ<=h||L.tileID.overscaledZ>m)continue;let N=L.tileID;for(;L&&L.tileID.overscaledZ>h+1;){const k=L.tileID.scaledTo(L.tileID.overscaledZ-1);L=this._tiles[k.key],L&&L.hasData()&&(N=k)}let C=N;for(;C.overscaledZ>h;)if(C=C.scaledTo(C.overscaledZ-1),o[C.key]){v[N.key]=N;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=h?m:null}for(let m=o.overscaledZ-1;m>=h;m--){const v=o.scaledTo(m),E=this._getLoadedTile(v);if(E)return E}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const h=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,v=Math.floor(h*m*5),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(E)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const m={};for(const v in this._tiles){const E=this._tiles[v];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+h),m[E.tileID.key]=E}this._tiles=m;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}update(o){if(this.transform=o,!this._sourceLoaded||this._paused)return;let h;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?h=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new l.OverscaledTileID(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(h=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(h=h.filter(C=>this._source.hasTile(C)))):h=[];const m=o.coveringZoomLevel(this._source),v=Math.max(m-Kr.maxOverzooming,this._source.minzoom),E=Math.max(m+Kr.maxUnderzooming,this._source.minzoom),L=this._updateRetainedTiles(h,m);if(xs(this._source.type)){const C={},k={},V=Object.keys(L);for(const Z of V){const W=L[Z],ot=this._tiles[Z];if(!ot||ot.fadeEndTime&&ot.fadeEndTime<=l.exported.now())continue;const J=this.findLoadedParent(W,v);J&&(this._addTile(J.tileID),C[J.tileID.key]=J.tileID),k[Z]=W}this._retainLoadedChildren(k,m,E,L);for(const Z in C)L[Z]||(this._coveredTiles[Z]=!0,L[Z]=C[Z])}for(const C in L)this._tiles[C].clearFadeHold();const N=l.keysDifference(this._tiles,L);for(const C of N){const k=this._tiles[C];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(C)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,h){const m={},v={},E=Math.max(h-Kr.maxOverzooming,this._source.minzoom),L=Math.max(h+Kr.maxUnderzooming,this._source.minzoom),N={};for(const C of o){const k=this._addTile(C);m[C.key]=C,k.hasData()||h<this._source.maxzoom&&(N[C.key]=C)}this._retainLoadedChildren(N,h,L,m);for(const C of o){let k=this._tiles[C.key];if(k.hasData())continue;if(h+1>this._source.maxzoom){const Z=C.children(this._source.maxzoom)[0],W=this.getTile(Z);if(W&&W.hasData()){m[Z.key]=Z;continue}}else{const Z=C.children(this._source.maxzoom);if(m[Z[0].key]&&m[Z[1].key]&&m[Z[2].key]&&m[Z[3].key])continue}let V=k.wasRequested();for(let Z=C.overscaledZ-1;Z>=E;--Z){const W=C.scaledTo(Z);if(v[W.key]||(v[W.key]=!0,k=this.getTile(W),!k&&V&&(k=this._addTile(W)),k&&(m[W.key]=W,V=k.wasRequested(),k.hasData())))break}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let m,v=this._tiles[o].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){m=this._loadedParentTiles[v.key];break}h.push(v.key);const E=v.scaledTo(v.overscaledZ-1);if(m=this._getLoadedTile(E),m)break;v=E}for(const E of h)this._loadedParentTiles[E]=m}}_addTile(o){let h=this._tiles[o.key];if(h)return h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const m=h;return h||(h=new Ul(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h.uses++,this._tiles[o.key]=h,m||this._source.fire(new l.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const m=h.getExpiryTimeout();m&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},m))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,h,m){const v=[],E=this.transform;if(!E)return v;const L=m?E.getCameraQueryGeometry(o):o,N=o.map(J=>E.pointCoordinate(J)),C=L.map(J=>E.pointCoordinate(J)),k=this.getIds();let V=1/0,Z=1/0,W=-1/0,ot=-1/0;for(const J of C)V=Math.min(V,J.x),Z=Math.min(Z,J.y),W=Math.max(W,J.x),ot=Math.max(ot,J.y);for(let J=0;J<k.length;J++){const it=this._tiles[k[J]];if(it.holdingForFade())continue;const mt=it.tileID,yt=Math.pow(2,E.zoom-it.tileID.overscaledZ),Tt=h*it.queryPadding*l.EXTENT/it.tileSize/yt,bt=[mt.getTilePoint(new l.MercatorCoordinate(V,Z)),mt.getTilePoint(new l.MercatorCoordinate(W,ot))];if(bt[0].x-Tt<l.EXTENT&&bt[0].y-Tt<l.EXTENT&&bt[1].x+Tt>=0&&bt[1].y+Tt>=0){const Kt=N.map(kt=>mt.getTilePoint(kt)),Ut=C.map(kt=>mt.getTilePoint(kt));v.push({tile:it,tileID:mt,queryGeometry:Kt,cameraQueryGeometry:Ut,scale:yt})}}return v}getVisibleCoordinates(o){const h=this.getRenderableIds(o).map(m=>this._tiles[m].tileID);for(const m of h)m.posMatrix=this.transform.calculatePosMatrix(m.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(xs(this._source.type))for(const o in this._tiles){const h=this._tiles[o];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=l.exported.now())return!0}return!1}setFeatureState(o,h,m){this._state.updateState(o=o||"_geojsonTileLayer",h,m)}removeFeatureState(o,h,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,m)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,m){const v=this._tiles[o];v&&v.setDependencies(h,m)}reloadTilesForDependencies(o,h){for(const m in this._tiles)this._tiles[m].hasDependency(o,h)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(o,h))}}function si(y,o){const h=Math.abs(2*y.wrap)-+(y.wrap<0),m=Math.abs(2*o.wrap)-+(o.wrap<0);return y.overscaledZ-o.overscaledZ||m-h||o.canonical.y-y.canonical.y||o.canonical.x-y.canonical.x}function xs(y){return y==="raster"||y==="image"||y==="video"}Kr.maxOverzooming=10,Kr.maxUnderzooming=3;const sa="mapboxgl_preloaded_worker_pool";class ai{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<ai.workerCount;)this.workers.push(new Worker(ma.workerUrl));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[sa]}numActive(){return Object.keys(this.active).length}}const il=Math.floor(l.exported.hardwareConcurrency/2);let bs;function Gi(){return bs||(bs=new ai),bs}function Rr(y,o){const h={};for(const m in y)m!=="ref"&&(h[m]=y[m]);return l.refProperties.forEach(m=>{m in o&&(h[m]=o[m])}),h}function ws(y){y=y.slice();const o=Object.create(null);for(let h=0;h<y.length;h++)o[y[h].id]=y[h];for(let h=0;h<y.length;h++)"ref"in y[h]&&(y[h]=Rr(y[h],o[y[h].ref]));return y}ai.workerCount=Math.max(Math.min(il,6),1);const ye={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function aa(y,o,h){h.push({command:ye.addSource,args:[y,o[y]]})}function bn(y,o,h){o.push({command:ye.removeSource,args:[y]}),h[y]=!0}function Bs(y,o,h,m){bn(y,h,m),aa(y,o,h)}function ns(y,o,h){let m;for(m in y[h])if(Object.prototype.hasOwnProperty.call(y[h],m)&&m!=="data"&&!P(y[h][m],o[h][m]))return!1;for(m in o[h])if(Object.prototype.hasOwnProperty.call(o[h],m)&&m!=="data"&&!P(y[h][m],o[h][m]))return!1;return!0}function Bt(y,o,h,m,v,E){let L;for(L in o=o||{},y=y||{})Object.prototype.hasOwnProperty.call(y,L)&&(P(y[L],o[L])||h.push({command:E,args:[m,L,o[L],v]}));for(L in o)Object.prototype.hasOwnProperty.call(o,L)&&!Object.prototype.hasOwnProperty.call(y,L)&&(P(y[L],o[L])||h.push({command:E,args:[m,L,o[L],v]}))}function ge(y){return y.id}function no(y,o){return y[o.id]=o,y}class Si{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=l.clamp(o,0,1);let h=1,m=this._distances[h];const v=o*this.paddedLength+this.padding;for(;m<v&&h<this._distances.length;)m=this._distances[++h];const E=h-1,L=this._distances[E],N=m-L,C=N>0?(v-L)/N:0;return this.points[E].mult(1-C).add(this.points[h].mult(C))}}function Bn(y,o){let h=!0;return y==="always"||y!=="never"&&o!=="never"||(h=!1),h}class Vn{constructor(o,h,m){const v=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(h/m);for(let L=0;L<this.xCellCount*this.yCellCount;L++)v.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,m,v,E){this._forEachCell(h,m,v,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(E)}insertCircle(o,h,m,v){this._forEachCell(h-v,m-v,h+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(m),this.circles.push(v)}_insertBoxCell(o,h,m,v,E,L){this.boxCells[E].push(L)}_insertCircleCell(o,h,m,v,E,L){this.circleCells[E].push(L)}_query(o,h,m,v,E,L,N){if(m<0||o>this.width||v<0||h>this.height)return[];const C=[];if(o<=0&&h<=0&&this.width<=m&&this.height<=v){if(E)return[{key:null,x1:o,y1:h,x2:m,y2:v}];for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const V=this.circles[3*k],Z=this.circles[3*k+1],W=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:V-W,y1:Z-W,x2:V+W,y2:Z+W})}}else this._forEachCell(o,h,m,v,this._queryCell,C,{hitTest:E,overlapMode:L,seenUids:{box:{},circle:{}}},N);return C}query(o,h,m,v){return this._query(o,h,m,v,!1,null)}hitTest(o,h,m,v,E,L){return this._query(o,h,m,v,!0,E,L).length>0}hitTestCircle(o,h,m,v,E){const L=o-m,N=o+m,C=h-m,k=h+m;if(N<0||L>this.width||k<0||C>this.height)return!1;const V=[];return this._forEachCell(L,C,N,k,this._queryCellCircle,V,{hitTest:!0,overlapMode:v,circle:{x:o,y:h,radius:m},seenUids:{box:{},circle:{}}},E),V.length>0}_queryCell(o,h,m,v,E,L,N,C){const{seenUids:k,hitTest:V,overlapMode:Z}=N,W=this.boxCells[E];if(W!==null){const J=this.bboxes;for(const it of W)if(!k.box[it]){k.box[it]=!0;const mt=4*it,yt=this.boxKeys[it];if(o<=J[mt+2]&&h<=J[mt+3]&&m>=J[mt+0]&&v>=J[mt+1]&&(!C||C(yt))&&(!V||!Bn(Z,yt.overlapMode))&&(L.push({key:yt,x1:J[mt],y1:J[mt+1],x2:J[mt+2],y2:J[mt+3]}),V))return!0}}const ot=this.circleCells[E];if(ot!==null){const J=this.circles;for(const it of ot)if(!k.circle[it]){k.circle[it]=!0;const mt=3*it,yt=this.circleKeys[it];if(this._circleAndRectCollide(J[mt],J[mt+1],J[mt+2],o,h,m,v)&&(!C||C(yt))&&(!V||!Bn(Z,yt.overlapMode))){const Tt=J[mt],bt=J[mt+1],Kt=J[mt+2];if(L.push({key:yt,x1:Tt-Kt,y1:bt-Kt,x2:Tt+Kt,y2:bt+Kt}),V)return!0}}}return!1}_queryCellCircle(o,h,m,v,E,L,N,C){const{circle:k,seenUids:V,overlapMode:Z}=N,W=this.boxCells[E];if(W!==null){const J=this.bboxes;for(const it of W)if(!V.box[it]){V.box[it]=!0;const mt=4*it,yt=this.boxKeys[it];if(this._circleAndRectCollide(k.x,k.y,k.radius,J[mt+0],J[mt+1],J[mt+2],J[mt+3])&&(!C||C(yt))&&!Bn(Z,yt.overlapMode))return L.push(!0),!0}}const ot=this.circleCells[E];if(ot!==null){const J=this.circles;for(const it of ot)if(!V.circle[it]){V.circle[it]=!0;const mt=3*it,yt=this.circleKeys[it];if(this._circlesCollide(J[mt],J[mt+1],J[mt+2],k.x,k.y,k.radius)&&(!C||C(yt))&&!Bn(Z,yt.overlapMode))return L.push(!0),!0}}}_forEachCell(o,h,m,v,E,L,N,C){const k=this._convertToXCellCoord(o),V=this._convertToYCellCoord(h),Z=this._convertToXCellCoord(m),W=this._convertToYCellCoord(v);for(let ot=k;ot<=Z;ot++)for(let J=V;J<=W;J++)if(E.call(this,o,h,m,v,this.xCellCount*J+ot,L,N,C))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,m,v,E,L){const N=v-o,C=E-h,k=m+L;return k*k>N*N+C*C}_circleAndRectCollide(o,h,m,v,E,L,N){const C=(L-v)/2,k=Math.abs(o-(v+C));if(k>C+m)return!1;const V=(N-E)/2,Z=Math.abs(h-(E+V));if(Z>V+m)return!1;if(k<=C||Z<=V)return!0;const W=k-C,ot=Z-V;return W*W+ot*ot<=m*m}}function Qn(y,o,h,m,v){const E=l.create();return o?(l.scale(E,E,[1/v,1/v,1]),h||l.rotateZ(E,E,m.angle)):l.multiply(E,m.labelPlaneMatrix,y),E}function Do(y,o,h,m,v){if(o){const E=l.clone(y);return l.scale(E,E,[v,v,1]),h||l.rotateZ(E,E,-m.angle),E}return m.glCoordMatrix}function dn(y,o){const h=[y.x,y.y,0,1];$n(h,h,o);const m=h[3];return{point:new l.pointGeometry(h[0]/m,h[1]/m),signedDistanceFromCamera:m}}function ue(y,o){return .5+y/o*.5}function gn(y,o){const h=y[0]/y[3],m=y[1]/y[3];return h>=-o[0]&&h<=o[0]&&m>=-o[1]&&m<=o[1]}function tn(y,o,h,m,v,E,L,N,C){const k=m?y.textSizeData:y.iconSizeData,V=l.evaluateSizeForZoom(k,h.transform.zoom),Z=[256/h.width*2+1,256/h.height*2+1],W=m?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;W.clear();const ot=y.lineVertexArray,J=m?y.text.placedSymbolArray:y.icon.placedSymbolArray,it=h.transform.width/h.transform.height;let mt=!1;for(let yt=0;yt<J.length;yt++){const Tt=J.get(yt);if(Tt.hidden||Tt.writingMode===l.WritingMode.vertical&&!mt){Jr(Tt.numGlyphs,W);continue}mt=!1;const bt=[Tt.anchorX,Tt.anchorY,0,1];if(l.transformMat4(bt,bt,o),!gn(bt,Z)){Jr(Tt.numGlyphs,W);continue}const Kt=ue(h.transform.cameraToCenterDistance,bt[3]),Ut=l.evaluateSizeForFeature(k,V,Tt),kt=L?Ut/Kt:Ut*Kt,se=new l.pointGeometry(Tt.anchorX,Tt.anchorY),me=dn(se,v).point,Ht={},Re=cn(Tt,kt,!1,N,o,v,E,y.glyphOffsetArray,ot,W,me,se,Ht,it,C);mt=Re.useVertical,(Re.notEnoughRoom||mt||Re.needsFlipping&&cn(Tt,kt,!0,N,o,v,E,y.glyphOffsetArray,ot,W,me,se,Ht,it,C).notEnoughRoom)&&Jr(Tt.numGlyphs,W)}m?y.text.dynamicLayoutVertexBuffer.updateData(W):y.icon.dynamicLayoutVertexBuffer.updateData(W)}function Ci(y,o,h,m,v,E,L,N,C,k,V,Z){const W=N.glyphStartIndex+N.numGlyphs,ot=N.lineStartIndex,J=N.lineStartIndex+N.lineLength,it=o.getoffsetX(N.glyphStartIndex),mt=o.getoffsetX(W-1),yt=rs(y*it,h,m,v,E,L,N.segment,ot,J,C,k,V,Z);if(!yt)return null;const Tt=rs(y*mt,h,m,v,E,L,N.segment,ot,J,C,k,V,Z);return Tt?{first:yt,last:Tt}:null}function ro(y,o,h,m){return y===l.WritingMode.horizontal&&Math.abs(h.y-o.y)>Math.abs(h.x-o.x)*m?{useVertical:!0}:(y===l.WritingMode.vertical?o.y<h.y:o.x>h.x)?{needsFlipping:!0}:null}function cn(y,o,h,m,v,E,L,N,C,k,V,Z,W,ot,J){const it=o/24,mt=y.lineOffsetX*it,yt=y.lineOffsetY*it;let Tt;if(y.numGlyphs>1){const bt=y.glyphStartIndex+y.numGlyphs,Kt=y.lineStartIndex,Ut=y.lineStartIndex+y.lineLength,kt=Ci(it,N,mt,yt,h,V,Z,y,C,E,W,J);if(!kt)return{notEnoughRoom:!0};const se=dn(kt.first.point,L).point,me=dn(kt.last.point,L).point;if(m&&!h){const Ht=ro(y.writingMode,se,me,ot);if(Ht)return Ht}Tt=[kt.first];for(let Ht=y.glyphStartIndex+1;Ht<bt-1;Ht++)Tt.push(rs(it*N.getoffsetX(Ht),mt,yt,h,V,Z,y.segment,Kt,Ut,C,E,W,J));Tt.push(kt.last)}else{if(m&&!h){const Kt=dn(Z,v).point,Ut=y.lineStartIndex+y.segment+1,kt=new l.pointGeometry(C.getx(Ut),C.gety(Ut)),se=dn(kt,v),me=se.signedDistanceFromCamera>0?se.point:Is(Z,kt,Kt,1,v),Ht=ro(y.writingMode,Kt,me,ot);if(Ht)return Ht}const bt=rs(it*N.getoffsetX(y.glyphStartIndex),mt,yt,h,V,Z,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,C,E,W,J);if(!bt)return{notEnoughRoom:!0};Tt=[bt]}for(const bt of Tt)l.addDynamicAttributes(k,bt.point,bt.angle);return{}}function Is(y,o,h,m,v){const E=dn(y.add(y.sub(o)._unit()),v).point,L=h.sub(E);return h.add(L._mult(m/L.mag()))}function rs(y,o,h,m,v,E,L,N,C,k,V,Z,W){const ot=m?y-o:y+o;let J=ot>0?1:-1,it=0;m&&(J*=-1,it=Math.PI),J<0&&(it+=Math.PI);let mt=J>0?N+L:N+L+1,yt=v,Tt=v,bt=0,Kt=0;const Ut=Math.abs(ot),kt=[];for(;bt+Kt<=Ut;){if(mt+=J,mt<N||mt>=C)return null;if(Tt=yt,kt.push(yt),yt=Z[mt],yt===void 0){const Ie=new l.pointGeometry(k.getx(mt),k.gety(mt)),We=dn(Ie,V);if(We.signedDistanceFromCamera>0)yt=Z[mt]=We.point;else{const Nn=mt-J;yt=Is(bt===0?E:new l.pointGeometry(k.getx(Nn),k.gety(Nn)),Ie,Tt,Ut-bt+1,V)}}bt+=Kt,Kt=Tt.dist(yt)}const se=(Ut-bt)/Kt,me=yt.sub(Tt),Ht=me.mult(se)._add(Tt);Ht._add(me._unit()._perp()._mult(h*J));const Re=it+Math.atan2(yt.y-Tt.y,yt.x-Tt.x);return kt.push(Ht),{point:Ht,angle:W?Re:0,path:kt}}const Us=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Jr(y,o){for(let h=0;h<y;h++){const m=o.length;o.resize(m+4),o.float32.set(Us,3*m)}}function $n(y,o,h){const m=o[0],v=o[1];return y[0]=h[0]*m+h[4]*v+h[12],y[1]=h[1]*m+h[5]*v+h[13],y[3]=h[3]*m+h[7]*v+h[15],y}const No=100;class Es{constructor(o,h=new Vn(o.width+200,o.height+200,25),m=new Vn(o.width+200,o.height+200,25)){this.transform=o,this.grid=h,this.ignoredGrid=m,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+No,this.screenBottomBoundary=o.height+No,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200}placeCollisionBox(o,h,m,v,E){const L=this.projectAndGetPerspectiveRatio(v,o.anchorPointX,o.anchorPointY),N=m*L.perspectiveRatio,C=o.x1*N+L.point.x,k=o.y1*N+L.point.y,V=o.x2*N+L.point.x,Z=o.y2*N+L.point.y;return!this.isInsideGrid(C,k,V,Z)||h!=="always"&&this.grid.hitTest(C,k,V,Z,h,E)?{box:[],offscreen:!1}:{box:[C,k,V,Z],offscreen:this.isOffscreen(C,k,V,Z)}}placeCollisionCircles(o,h,m,v,E,L,N,C,k,V,Z,W,ot){const J=[],it=new l.pointGeometry(h.anchorX,h.anchorY),mt=dn(it,L),yt=ue(this.transform.cameraToCenterDistance,mt.signedDistanceFromCamera),Tt=(V?E/yt:E*yt)/l.ONE_EM,bt=dn(it,N).point,Kt=Ci(Tt,v,h.lineOffsetX*Tt,h.lineOffsetY*Tt,!1,bt,it,h,m,N,{},!1);let Ut=!1,kt=!1,se=!0;if(Kt){const me=.5*W*yt+ot,Ht=new l.pointGeometry(-100,-100),Re=new l.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ie=new Si,We=Kt.first,Nn=Kt.last;let En=[];for(let hn=We.path.length-1;hn>=1;hn--)En.push(We.path[hn]);for(let hn=1;hn<Nn.path.length;hn++)En.push(Nn.path[hn]);const Dn=2.5*me;if(C){const hn=En.map(Tn=>dn(Tn,C));En=hn.some(Tn=>Tn.signedDistanceFromCamera<=0)?[]:hn.map(Tn=>Tn.point)}let kr=[];if(En.length>0){const hn=En[0].clone(),Tn=En[0].clone();for(let hr=1;hr<En.length;hr++)hn.x=Math.min(hn.x,En[hr].x),hn.y=Math.min(hn.y,En[hr].y),Tn.x=Math.max(Tn.x,En[hr].x),Tn.y=Math.max(Tn.y,En[hr].y);kr=hn.x>=Ht.x&&Tn.x<=Re.x&&hn.y>=Ht.y&&Tn.y<=Re.y?[En]:Tn.x<Ht.x||hn.x>Re.x||Tn.y<Ht.y||hn.y>Re.y?[]:l.clipLine([En],Ht.x,Ht.y,Re.x,Re.y)}for(const hn of kr){Ie.reset(hn,.25*me);let Tn=0;Tn=Ie.length<=.5*me?1:Math.ceil(Ie.paddedLength/Dn)+1;for(let hr=0;hr<Tn;hr++){const Wi=hr/Math.max(Tn-1,1),Fr=Ie.lerp(Wi),As=Fr.x+No,Ps=Fr.y+No;J.push(As,Ps,me,0);const fl=As-me,Fo=Ps-me,_a=As+me,pl=Ps+me;if(se=se&&this.isOffscreen(fl,Fo,_a,pl),kt=kt||this.isInsideGrid(fl,Fo,_a,pl),o!=="always"&&this.grid.hitTestCircle(As,Ps,me,o,Z)&&(Ut=!0,!k))return{circles:[],offscreen:!1,collisionDetected:Ut}}}}return{circles:!k&&Ut||!kt?[]:J,offscreen:se,collisionDetected:Ut}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let m=1/0,v=1/0,E=-1/0,L=-1/0;for(const V of o){const Z=new l.pointGeometry(V.x+No,V.y+No);m=Math.min(m,Z.x),v=Math.min(v,Z.y),E=Math.max(E,Z.x),L=Math.max(L,Z.y),h.push(Z)}const N=this.grid.query(m,v,E,L).concat(this.ignoredGrid.query(m,v,E,L)),C={},k={};for(const V of N){const Z=V.key;if(C[Z.bucketInstanceId]===void 0&&(C[Z.bucketInstanceId]={}),C[Z.bucketInstanceId][Z.featureIndex])continue;const W=[new l.pointGeometry(V.x1,V.y1),new l.pointGeometry(V.x2,V.y1),new l.pointGeometry(V.x2,V.y2),new l.pointGeometry(V.x1,V.y2)];l.polygonIntersectsPolygon(h,W)&&(C[Z.bucketInstanceId][Z.featureIndex]=!0,k[Z.bucketInstanceId]===void 0&&(k[Z.bucketInstanceId]=[]),k[Z.bucketInstanceId].push(Z.featureIndex))}return k}insertCollisionBox(o,h,m,v,E,L){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:E,collisionGroupID:L,overlapMode:h},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,m,v,E,L){const N=m?this.ignoredGrid:this.grid,C={bucketInstanceId:v,featureIndex:E,collisionGroupID:L,overlapMode:h};for(let k=0;k<o.length;k+=4)N.insertCircle(C,o[k],o[k+1],o[k+2])}projectAndGetPerspectiveRatio(o,h,m){const v=[h,m,0,1];return $n(v,v,o),{point:new l.pointGeometry((v[0]/v[3]+1)/2*this.transform.width+No,(-v[1]/v[3]+1)/2*this.transform.height+No),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}}isOffscreen(o,h,m,v){return m<No||o>=this.screenRightBoundary||v<No||h>this.screenBottomBoundary}isInsideGrid(o,h,m,v){return m>=0&&o<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=l.identity([]);return l.translate(o,o,[-100,-100,0]),o}}function Qr(y,o,h){return o*(l.EXTENT/(y.tileSize*Math.pow(2,h-y.tileID.overscaledZ)))}class qi{constructor(o,h,m,v){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class yo{constructor(o,h,m,v,E){this.text=new qi(o?o.text:null,h,m,E),this.icon=new qi(o?o.icon:null,h,v,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ra{constructor(o,h,m){this.text=o,this.icon=h,this.skipFade=m}}class ol{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class Vs{constructor(o,h,m,v,E){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=E}}class ${constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:m=>m.collisionGroupID===h}}return this.collisionGroups[o]}}function O(y,o,h,m,v){const{horizontalAlign:E,verticalAlign:L}=l.getAnchorAlignment(y),N=-(E-.5)*o,C=-(L-.5)*h,k=l.evaluateVariableOffset(y,m);return new l.pointGeometry(N+k[0]*v,C+k[1]*v)}function B(y,o,h,m,v,E){const{x1:L,x2:N,y1:C,y2:k,anchorPointX:V,anchorPointY:Z}=y,W=new l.pointGeometry(o,h);return m&&W._rotate(v?E:-E),{x1:L+W.x,y1:C+W.y,x2:N+W.x,y2:k+W.y,anchorPointX:V,anchorPointY:Z}}class K{constructor(o,h,m,v){this.transform=o.clone(),this.collisionIndex=new Es(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new $(m),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,m,v){const E=m.getBucket(h),L=m.latestFeatureIndex;if(!E||!L||h.id!==E.layerIds[0])return;const N=m.collisionBoxArray,C=E.layers[0].layout,k=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),V=m.tileSize/l.EXTENT,Z=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),W=C.get("text-pitch-alignment")==="map",ot=C.get("text-rotation-alignment")==="map",J=Qr(m,1,this.transform.zoom),it=Qn(Z,W,ot,this.transform,J);let mt=null;if(W){const Tt=Do(Z,W,ot,this.transform,J);mt=l.multiply([],this.transform.labelPlaneMatrix,Tt)}this.retainedQueryData[E.bucketInstanceId]=new Vs(E.bucketInstanceId,L,E.sourceLayerIndex,E.index,m.tileID);const yt={bucket:E,layout:C,posMatrix:Z,textLabelPlaneMatrix:it,labelToScreenMatrix:mt,scale:k,textPixelRatio:V,holdingForFade:m.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(v)for(const Tt of E.sortKeyRanges){const{sortKey:bt,symbolInstanceStart:Kt,symbolInstanceEnd:Ut}=Tt;o.push({sortKey:bt,symbolInstanceStart:Kt,symbolInstanceEnd:Ut,parameters:yt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:yt})}attemptAnchorPlacement(o,h,m,v,E,L,N,C,k,V,Z,W,ot,J,it){const mt=[W.textOffset0,W.textOffset1],yt=O(o,m,v,mt,E),Tt=this.collisionIndex.placeCollisionBox(B(h,yt.x,yt.y,L,N,this.transform.angle),Z,C,k,V.predicate);if((!it||this.collisionIndex.placeCollisionBox(B(it,yt.x,yt.y,L,N,this.transform.angle),Z,C,k,V.predicate).box.length!==0)&&Tt.box.length>0){let bt;return this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(bt=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:mt,width:m,height:v,anchor:o,textBoxScale:E,prevAnchor:bt},this.markUsedJustification(ot,o,W,J),ot.allowVerticalPlacement&&(this.markUsedOrientation(ot,J,W),this.placedOrientations[W.crossTileID]=J),{shift:yt,placedGlyphBoxes:Tt}}}placeLayerBucketPart(o,h,m){const{bucket:v,layout:E,posMatrix:L,textLabelPlaneMatrix:N,labelToScreenMatrix:C,textPixelRatio:k,holdingForFade:V,collisionBoxArray:Z,partiallyEvaluatedTextSize:W,collisionGroup:ot}=o.parameters,J=E.get("text-optional"),it=E.get("icon-optional"),mt=l.getOverlapMode(E,"text-overlap","text-allow-overlap"),yt=mt==="always",Tt=l.getOverlapMode(E,"icon-overlap","icon-allow-overlap"),bt=Tt==="always",Kt=E.get("text-rotation-alignment")==="map",Ut=E.get("text-pitch-alignment")==="map",kt=E.get("icon-text-fit")!=="none",se=E.get("symbol-z-order")==="viewport-y",me=yt&&(bt||!v.hasIconData()||it),Ht=bt&&(yt||!v.hasTextData()||J);!v.collisionArrays&&Z&&v.deserializeCollisionBoxes(Z);const Re=(Ie,We)=>{if(h[Ie.crossTileID])return;if(V)return void(this.placements[Ie.crossTileID]=new Ra(!1,!1,!1));let Nn=!1,En=!1,Dn=!0,kr=null,hn={box:null,offscreen:null},Tn={box:null,offscreen:null},hr=null,Wi=null,Fr=null,As=0,Ps=0,fl=0;We.textFeatureIndex?As=We.textFeatureIndex:Ie.useRuntimeCollisionCircles&&(As=Ie.featureIndex),We.verticalTextFeatureIndex&&(Ps=We.verticalTextFeatureIndex);const Fo=We.textBox;if(Fo){const Bo=tr=>{let $r=l.WritingMode.horizontal;if(v.allowVerticalPlacement&&!tr&&this.prevPlacement){const Li=this.prevPlacement.placedOrientations[Ie.crossTileID];Li&&(this.placedOrientations[Ie.crossTileID]=Li,$r=Li,this.markUsedOrientation(v,$r,Ie))}return $r},Gn=(tr,$r)=>{if(v.allowVerticalPlacement&&Ie.numVerticalGlyphVertices>0&&We.verticalTextBox){for(const Li of v.writingModes)if(Li===l.WritingMode.vertical?(hn=$r(),Tn=hn):hn=tr(),hn&&hn.box&&hn.box.length)break}else hn=tr()};if(E.get("text-variable-anchor")){let tr=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ie.crossTileID]){const gr=this.prevPlacement.variableOffsets[Ie.crossTileID];tr.indexOf(gr.anchor)>0&&(tr=tr.filter(Kl=>Kl!==gr.anchor),tr.unshift(gr.anchor))}const $r=(gr,Kl,Zs)=>{const wh=gr.x2-gr.x1,Ys=gr.y2-gr.y1,Fu=Ie.textBoxScale,dl=kt&&Tt==="never"?Kl:null;let ki={box:[],offscreen:!1};const Ih=mt!=="never"?2*tr.length:tr.length;for(let Ws=0;Ws<Ih;++Ws){const Jl=this.attemptAnchorPlacement(tr[Ws%tr.length],gr,wh,Ys,Fu,Kt,Ut,k,L,ot,Ws>=tr.length?mt:"never",Ie,v,Zs,dl);if(Jl&&(ki=Jl.placedGlyphBoxes,ki&&ki.box&&ki.box.length)){Nn=!0,kr=Jl.shift;break}}return ki};Gn(()=>$r(Fo,We.iconBox,l.WritingMode.horizontal),()=>{const gr=We.verticalTextBox;return v.allowVerticalPlacement&&!(hn&&hn.box&&hn.box.length)&&Ie.numVerticalGlyphVertices>0&&gr?$r(gr,We.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),hn&&(Nn=hn.box,Dn=hn.offscreen);const Li=Bo(hn&&hn.box);if(!Nn&&this.prevPlacement){const gr=this.prevPlacement.variableOffsets[Ie.crossTileID];gr&&(this.variableOffsets[Ie.crossTileID]=gr,this.markUsedJustification(v,gr.anchor,Ie,Li))}}else{const tr=($r,Li)=>{const gr=this.collisionIndex.placeCollisionBox($r,mt,k,L,ot.predicate);return gr&&gr.box&&gr.box.length&&(this.markUsedOrientation(v,Li,Ie),this.placedOrientations[Ie.crossTileID]=Li),gr};Gn(()=>tr(Fo,l.WritingMode.horizontal),()=>{const $r=We.verticalTextBox;return v.allowVerticalPlacement&&Ie.numVerticalGlyphVertices>0&&$r?tr($r,l.WritingMode.vertical):{box:null,offscreen:null}}),Bo(hn&&hn.box&&hn.box.length)}}if(hr=hn,Nn=hr&&hr.box&&hr.box.length>0,Dn=hr&&hr.offscreen,Ie.useRuntimeCollisionCircles){const Bo=v.text.placedSymbolArray.get(Ie.centerJustifiedTextSymbolIndex),Gn=l.evaluateSizeForFeature(v.textSizeData,W,Bo),tr=E.get("text-padding");Wi=this.collisionIndex.placeCollisionCircles(mt,Bo,v.lineVertexArray,v.glyphOffsetArray,Gn,L,N,C,m,Ut,ot.predicate,Ie.collisionCircleDiameter,tr),Nn=yt||Wi.circles.length>0&&!Wi.collisionDetected,Dn=Dn&&Wi.offscreen}if(We.iconFeatureIndex&&(fl=We.iconFeatureIndex),We.iconBox){const Bo=Gn=>{const tr=kt&&kr?B(Gn,kr.x,kr.y,Kt,Ut,this.transform.angle):Gn;return this.collisionIndex.placeCollisionBox(tr,Tt,k,L,ot.predicate)};Tn&&Tn.box&&Tn.box.length&&We.verticalIconBox?(Fr=Bo(We.verticalIconBox),En=Fr.box.length>0):(Fr=Bo(We.iconBox),En=Fr.box.length>0),Dn=Dn&&Fr.offscreen}const _a=J||Ie.numHorizontalGlyphVertices===0&&Ie.numVerticalGlyphVertices===0,pl=it||Ie.numIconVertices===0;if(_a||pl?pl?_a||(En=En&&Nn):Nn=En&&Nn:En=Nn=En&&Nn,Nn&&hr&&hr.box&&this.collisionIndex.insertCollisionBox(hr.box,mt,E.get("text-ignore-placement"),v.bucketInstanceId,Tn&&Tn.box&&Ps?Ps:As,ot.ID),En&&Fr&&this.collisionIndex.insertCollisionBox(Fr.box,Tt,E.get("icon-ignore-placement"),v.bucketInstanceId,fl,ot.ID),Wi&&(Nn&&this.collisionIndex.insertCollisionCircles(Wi.circles,mt,E.get("text-ignore-placement"),v.bucketInstanceId,As,ot.ID),m)){const Bo=v.bucketInstanceId;let Gn=this.collisionCircleArrays[Bo];Gn===void 0&&(Gn=this.collisionCircleArrays[Bo]=new ol);for(let tr=0;tr<Wi.circles.length;tr+=4)Gn.circles.push(Wi.circles[tr+0]),Gn.circles.push(Wi.circles[tr+1]),Gn.circles.push(Wi.circles[tr+2]),Gn.circles.push(Wi.collisionDetected?1:0)}this.placements[Ie.crossTileID]=new Ra(Nn||me,En||Ht,Dn||v.justReloaded),h[Ie.crossTileID]=!0};if(se){const Ie=v.getSortedSymbolIndexes(this.transform.angle);for(let We=Ie.length-1;We>=0;--We){const Nn=Ie[We];Re(v.symbolInstances.get(Nn),v.collisionArrays[Nn])}}else for(let Ie=o.symbolInstanceStart;Ie<o.symbolInstanceEnd;Ie++)Re(v.symbolInstances.get(Ie),v.collisionArrays[Ie]);if(m&&v.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[v.bucketInstanceId];l.invert(Ie.invProjMatrix,L),Ie.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(o,h,m,v){let E;E=v===l.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(h)];const L=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const N of L)N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=E>=0&&N!==E?0:m.crossTileID)}markUsedOrientation(o,h,m){const v=h===l.WritingMode.horizontal||h===l.WritingMode.horizontalOnly?h:0,E=h===l.WritingMode.vertical?h:0,L=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const N of L)o.text.placedSymbolArray.get(N).placedOrientation=v;m.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let m=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(o):1,E=h?h.opacities:{},L=h?h.variableOffsets:{},N=h?h.placedOrientations:{};for(const C in this.placements){const k=this.placements[C],V=E[C];V?(this.opacities[C]=new yo(V,v,k.text,k.icon),m=m||k.text!==V.text.placed||k.icon!==V.icon.placed):(this.opacities[C]=new yo(null,v,k.text,k.icon,k.skipFade),m=m||k.text||k.icon)}for(const C in E){const k=E[C];if(!this.opacities[C]){const V=new yo(k,v,!1,!1);V.isHidden()||(this.opacities[C]=V,m=m||k.text.placed||k.icon.placed)}}for(const C in L)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=L[C]);for(const C in N)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=N[C]);m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const m={};for(const v of h){const E=v.getBucket(o);E&&v.latestFeatureIndex&&o.id===E.layerIds[0]&&this.updateBucketOpacities(E,m,v.collisionBoxArray)}}updateBucketOpacities(o,h,m){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const v=o.layers[0].layout,E=new yo(null,0,!1,!1,!0),L=v.get("text-allow-overlap"),N=v.get("icon-allow-overlap"),C=v.get("text-variable-anchor"),k=v.get("text-rotation-alignment")==="map",V=v.get("text-pitch-alignment")==="map",Z=v.get("icon-text-fit")!=="none",W=new yo(null,0,L&&(N||!o.hasIconData()||v.get("icon-optional")),N&&(L||!o.hasTextData()||v.get("text-optional")),!0);!o.collisionArrays&&m&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(m);const ot=(J,it,mt)=>{for(let yt=0;yt<it/4;yt++)J.opacityVertexArray.emplaceBack(mt)};for(let J=0;J<o.symbolInstances.length;J++){const it=o.symbolInstances.get(J),{numHorizontalGlyphVertices:mt,numVerticalGlyphVertices:yt,crossTileID:Tt}=it;let bt=this.opacities[Tt];h[Tt]?bt=E:bt||(bt=W,this.opacities[Tt]=bt),h[Tt]=!0;const Kt=it.numIconVertices>0,Ut=this.placedOrientations[it.crossTileID],kt=Ut===l.WritingMode.vertical,se=Ut===l.WritingMode.horizontal||Ut===l.WritingMode.horizontalOnly;if(mt>0||yt>0){const me=zt(bt.text);ot(o.text,mt,kt?Ae:me),ot(o.text,yt,se?Ae:me);const Ht=bt.text.isHidden();[it.rightJustifiedTextSymbolIndex,it.centerJustifiedTextSymbolIndex,it.leftJustifiedTextSymbolIndex].forEach(We=>{We>=0&&(o.text.placedSymbolArray.get(We).hidden=Ht||kt?1:0)}),it.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(it.verticalPlacedTextSymbolIndex).hidden=Ht||se?1:0);const Re=this.variableOffsets[it.crossTileID];Re&&this.markUsedJustification(o,Re.anchor,it,Ut);const Ie=this.placedOrientations[it.crossTileID];Ie&&(this.markUsedJustification(o,"left",it,Ie),this.markUsedOrientation(o,Ie,it))}if(Kt){const me=zt(bt.icon),Ht=!(Z&&it.verticalPlacedIconSymbolIndex&&kt);it.placedIconSymbolIndex>=0&&(ot(o.icon,it.numIconVertices,Ht?me:Ae),o.icon.placedSymbolArray.get(it.placedIconSymbolIndex).hidden=bt.icon.isHidden()),it.verticalPlacedIconSymbolIndex>=0&&(ot(o.icon,it.numVerticalIconVertices,Ht?Ae:me),o.icon.placedSymbolArray.get(it.verticalPlacedIconSymbolIndex).hidden=bt.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const me=o.collisionArrays[J];if(me){let Ht=new l.pointGeometry(0,0);if(me.textBox||me.verticalTextBox){let Ie=!0;if(C){const We=this.variableOffsets[Tt];We?(Ht=O(We.anchor,We.width,We.height,We.textOffset,We.textBoxScale),k&&Ht._rotate(V?this.transform.angle:-this.transform.angle)):Ie=!1}me.textBox&&tt(o.textCollisionBox.collisionVertexArray,bt.text.placed,!Ie||kt,Ht.x,Ht.y),me.verticalTextBox&&tt(o.textCollisionBox.collisionVertexArray,bt.text.placed,!Ie||se,Ht.x,Ht.y)}const Re=Boolean(!se&&me.verticalIconBox);me.iconBox&&tt(o.iconCollisionBox.collisionVertexArray,bt.icon.placed,Re,Z?Ht.x:0,Z?Ht.y:0),me.verticalIconBox&&tt(o.iconCollisionBox.collisionVertexArray,bt.icon.placed,!Re,Z?Ht.x:0,Z?Ht.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=J.invProjMatrix,o.placementViewportMatrix=J.viewportMatrix,o.collisionCircleArray=J.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const m=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function tt(y,o,h,m,v){y.emplaceBack(o?1:0,h?1:0,m||0,v||0),y.emplaceBack(o?1:0,h?1:0,m||0,v||0),y.emplaceBack(o?1:0,h?1:0,m||0,v||0),y.emplaceBack(o?1:0,h?1:0,m||0,v||0)}const nt=Math.pow(2,25),dt=Math.pow(2,24),ht=Math.pow(2,17),pt=Math.pow(2,16),gt=Math.pow(2,9),Vt=Math.pow(2,8),te=Math.pow(2,1);function zt(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const o=y.placed?1:0,h=Math.floor(127*y.opacity);return h*nt+o*dt+h*ht+o*pt+h*gt+o*Vt+h*te+o}const Ae=0;class we{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,h,m,v,E){const L=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(L,v,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((N,C)=>N.sortKey-C.sortKey));this._currentPartIndex<L.length;)if(h.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,E())return!0;return!1}}class De{constructor(o,h,m,v,E,L,N){this.placement=new K(o,E,L,N),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(o,h,m){const v=l.exported.now(),E=()=>{const L=l.exported.now()-v;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=h[o[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=N)&&(!L.maxzoom||L.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new we(L)),this._inProgressLayer.continuePlacement(m[L.source],this.placement,this._showCollisionBoxes,L,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const ke=512/l.EXTENT/2;class Mn{constructor(o,h,m){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let v=0;v<h.length;v++){const E=h.get(v),L=E.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,o)})}}getScaledCoordinates(o,h){const m=ke/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*l.EXTENT+o.anchorX)*m),y:Math.floor((h.canonical.y*l.EXTENT+o.anchorY)*m)}}findMatches(o,h,m){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let E=0;E<o.length;E++){const L=o.get(E);if(L.crossTileID)continue;const N=this.indexedSymbolInstances[L.key];if(!N)continue;const C=this.getScaledCoordinates(L,h);for(const k of N)if(Math.abs(k.coord.x-C.x)<=v&&Math.abs(k.coord.y-C.y)<=v&&!m[k.crossTileID]){m[k.crossTileID]=!0,L.crossTileID=k.crossTileID;break}}}}class In{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class wn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const m in this.indexes){const v=this.indexes[m],E={};for(const L in v){const N=v[L];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+h),E[N.tileID.key]=N}this.indexes[m]=E}this.lng=o}addBucket(o,h,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let E=0;E<h.symbolInstances.length;E++)h.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const v=this.usedCrossTileIDs[o.overscaledZ];for(const E in this.indexes){const L=this.indexes[E];if(Number(E)>o.overscaledZ)for(const N in L){const C=L[N];C.tileID.isChildOf(o)&&C.findMatches(h.symbolInstances,o,v)}else{const N=L[o.scaledTo(Number(E)).key];N&&N.findMatches(h.symbolInstances,o,v)}}for(let E=0;E<h.symbolInstances.length;E++){const L=h.symbolInstances.get(E);L.crossTileID||(L.crossTileID=m.generate(),v[L.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Mn(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const m in h.indexedSymbolInstances)for(const v of h.indexedSymbolInstances[m])delete this.usedCrossTileIDs[o][v.crossTileID]}removeStaleBuckets(o){let h=!1;for(const m in this.indexes){const v=this.indexes[m];for(const E in v)o[v[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[E]),delete v[E],h=!0)}return h}}class sn{constructor(){this.layerIndexes={},this.crossTileIDs=new In,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,m){let v=this.layerIndexes[o.id];v===void 0&&(v=this.layerIndexes[o.id]=new wn);let E=!1;const L={};v.handleWrapJump(m);for(const N of h){const C=N.getBucket(o);C&&o.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(N.tileID,C,this.crossTileIDs)&&(E=!0),L[C.bucketInstanceId]=!0)}return v.removeStaleBuckets(L)&&(E=!0),E}pruneUnusedLayers(o){const h={};o.forEach(m=>{h[m]=!0});for(const m in this.layerIndexes)h[m]||delete this.layerIndexes[m]}}const an=(y,o)=>l.emitValidationErrors(y,o&&o.filter(h=>h.identifier!=="source.canvas")),zr=l.pick(ye,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Lr=l.pick(ye,["setCenter","setZoom","setBearing","setPitch"]),pi=function(){const y={},o=l.spec.$version;for(const h in l.spec.$root){const m=l.spec.$root[h];if(m.required){let v=null;v=h==="version"?o:m.type==="array"?[]:{},v!=null&&(y[h]=v)}}return y}();class Ti extends l.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new Ft(Gi(),this),this.imageManager=new ee,this.imageManager.setEventedParent(this),this.glyphManager=new It(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new Yt(256,512),this.crossTileSymbolIndex=new sn,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const m=this;this._rtlTextPluginCallback=Ti.registerForPluginStateChange(v=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(E,L)=>{if(l.triggerPluginCompletionEvent(E),L&&L.every(N=>N))for(const N in m.sourceCaches)m.sourceCaches[N].reload()})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const E=this.sourceCaches[v.sourceId];if(!E)return;const L=E.getSource();if(L&&L.vectorLayerIds)for(const N in this._layers){const C=this._layers[N];C.source===L.id&&this._validateLayer(C)}})}loadURL(o,h={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const m=typeof h.validate!="boolean"||h.validate,v=this.map._requestManager.transformRequest(o,l.ResourceType.Style);this._request=l.getJSON(v,(E,L)=>{this._request=null,E?this.fire(new l.ErrorEvent(E)):L&&this._load(L,m)})}loadJSON(o,h={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(o,h.validate!==!1)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(pi,!1)}_load(o,h){if(h&&an(this,l.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o;for(const v in o.sources)this.addSource(v,o.sources[v],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);const m=ws(this.stylesheet.layers);this._order=m.map(v=>v.id),this._layers={},this._serializedLayers={};for(let v of m)v=l.createStyleLayer(v),v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new re(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}_loadSprite(o){this._spriteRequest=function(h,m,v,E){let L,N,C;const k=v>1?"@2x":"";let V=l.getJSON(m.transformRequest(m.normalizeSpriteURL(h,k,".json"),l.ResourceType.SpriteJSON),(ot,J)=>{V=null,C||(C=ot,L=J,W())}),Z=l.getImage(m.transformRequest(m.normalizeSpriteURL(h,k,".png"),l.ResourceType.SpriteImage),(ot,J)=>{Z=null,C||(C=ot,N=J,W())});function W(){if(C)E(C);else if(L&&N){const ot=l.exported.getImageData(N),J={};for(const it in L){const{width:mt,height:yt,x:Tt,y:bt,sdf:Kt,pixelRatio:Ut,stretchX:kt,stretchY:se,content:me}=L[it],Ht=new l.RGBAImage({width:mt,height:yt});l.RGBAImage.copy(ot,Ht,{x:Tt,y:bt},{x:0,y:0},{width:mt,height:yt}),J[it]={data:Ht,pixelRatio:Ut,sdf:Kt,stretchX:kt,stretchY:se,content:me}}E(null,J)}}return{cancel(){V&&(V.cancel(),V=null),Z&&(Z.cancel(),Z=null)}}}(o,this.map._requestManager,this.map.getPixelRatio(),(h,m)=>{if(this._spriteRequest=null,h)this.fire(new l.ErrorEvent(h));else if(m)for(const v in m)this.imageManager.addImage(v,m[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(o){const h=this.sourceCaches[o.source];if(!h)return;const m=o.sourceLayer;if(!m)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(m)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${v.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const h=[];for(const m of o){const v=this._layers[m];v.type!=="custom"&&h.push(v.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(v.length||E.length)&&this._updateWorkerLayers(v,E);for(const L in this._updatedSources){const N=this._updatedSources[L];N==="reload"?this._reloadSource(L):N==="clear"&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const m={};for(const v in this.sourceCaches){const E=this.sourceCaches[v];m[v]=E.used,E.used=!1}for(const v of this._order){const E=this._layers[v];E.recalculate(o,this._availableImages),!E.isHidden(o.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const v in m){const E=this.sourceCaches[v];m[v]!==E.used&&E.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),an(this,l.validateStyle(o)))return!1;(o=l.clone$1(o)).layers=ws(o.layers);const h=function(v,E){if(!v)return[{command:ye.setStyle,args:[E]}];let L=[];try{if(!P(v.version,E.version))return[{command:ye.setStyle,args:[E]}];P(v.center,E.center)||L.push({command:ye.setCenter,args:[E.center]}),P(v.zoom,E.zoom)||L.push({command:ye.setZoom,args:[E.zoom]}),P(v.bearing,E.bearing)||L.push({command:ye.setBearing,args:[E.bearing]}),P(v.pitch,E.pitch)||L.push({command:ye.setPitch,args:[E.pitch]}),P(v.sprite,E.sprite)||L.push({command:ye.setSprite,args:[E.sprite]}),P(v.glyphs,E.glyphs)||L.push({command:ye.setGlyphs,args:[E.glyphs]}),P(v.transition,E.transition)||L.push({command:ye.setTransition,args:[E.transition]}),P(v.light,E.light)||L.push({command:ye.setLight,args:[E.light]});const N={},C=[];(function(V,Z,W,ot){let J;for(J in Z=Z||{},V=V||{})Object.prototype.hasOwnProperty.call(V,J)&&(Object.prototype.hasOwnProperty.call(Z,J)||bn(J,W,ot));for(J in Z)Object.prototype.hasOwnProperty.call(Z,J)&&(Object.prototype.hasOwnProperty.call(V,J)?P(V[J],Z[J])||(V[J].type==="geojson"&&Z[J].type==="geojson"&&ns(V,Z,J)?W.push({command:ye.setGeoJSONSourceData,args:[J,Z[J].data]}):Bs(J,Z,W,ot)):aa(J,Z,W))})(v.sources,E.sources,C,N);const k=[];v.layers&&v.layers.forEach(V=>{N[V.source]?L.push({command:ye.removeLayer,args:[V.id]}):k.push(V)}),L=L.concat(C),function(V,Z,W){Z=Z||[];const ot=(V=V||[]).map(ge),J=Z.map(ge),it=V.reduce(no,{}),mt=Z.reduce(no,{}),yt=ot.slice(),Tt=Object.create(null);let bt,Kt,Ut,kt,se,me,Ht;for(bt=0,Kt=0;bt<ot.length;bt++)Ut=ot[bt],Object.prototype.hasOwnProperty.call(mt,Ut)?Kt++:(W.push({command:ye.removeLayer,args:[Ut]}),yt.splice(yt.indexOf(Ut,Kt),1));for(bt=0,Kt=0;bt<J.length;bt++)Ut=J[J.length-1-bt],yt[yt.length-1-bt]!==Ut&&(Object.prototype.hasOwnProperty.call(it,Ut)?(W.push({command:ye.removeLayer,args:[Ut]}),yt.splice(yt.lastIndexOf(Ut,yt.length-Kt),1)):Kt++,me=yt[yt.length-bt],W.push({command:ye.addLayer,args:[mt[Ut],me]}),yt.splice(yt.length-bt,0,Ut),Tt[Ut]=!0);for(bt=0;bt<J.length;bt++)if(Ut=J[bt],kt=it[Ut],se=mt[Ut],!Tt[Ut]&&!P(kt,se))if(P(kt.source,se.source)&&P(kt["source-layer"],se["source-layer"])&&P(kt.type,se.type)){for(Ht in Bt(kt.layout,se.layout,W,Ut,null,ye.setLayoutProperty),Bt(kt.paint,se.paint,W,Ut,null,ye.setPaintProperty),P(kt.filter,se.filter)||W.push({command:ye.setFilter,args:[Ut,se.filter]}),P(kt.minzoom,se.minzoom)&&P(kt.maxzoom,se.maxzoom)||W.push({command:ye.setLayerZoomRange,args:[Ut,se.minzoom,se.maxzoom]}),kt)Object.prototype.hasOwnProperty.call(kt,Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Bt(kt[Ht],se[Ht],W,Ut,Ht.slice(6),ye.setPaintProperty):P(kt[Ht],se[Ht])||W.push({command:ye.setLayerProperty,args:[Ut,Ht,se[Ht]]}));for(Ht in se)Object.prototype.hasOwnProperty.call(se,Ht)&&!Object.prototype.hasOwnProperty.call(kt,Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Bt(kt[Ht],se[Ht],W,Ut,Ht.slice(6),ye.setPaintProperty):P(kt[Ht],se[Ht])||W.push({command:ye.setLayerProperty,args:[Ut,Ht,se[Ht]]}))}else W.push({command:ye.removeLayer,args:[Ut]}),me=yt[yt.lastIndexOf(Ut)+1],W.push({command:ye.addLayer,args:[se,me]})}(k,E.layers,L)}catch(N){console.warn("Unable to compute style diff:",N),L=[{command:ye.setStyle,args:[E]}]}return L}(this.serialize(),o).filter(v=>!(v.command in Lr));if(h.length===0)return!1;const m=h.filter(v=>!(v.command in zr));if(m.length>0)throw new Error(`Unimplemented: ${m.map(v=>v.command).join(", ")}.`);return h.forEach(v=>{v.command!=="setTransition"&&this[v.command].apply(this,v.args)}),this.stylesheet=o,!0}addImage(o,h){if(this.getImage(o))return this.fire(new l.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,h),this._afterImageUpdated(o)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new l.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,h,m={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(l.validateStyle.source,`sources.${o}`,h,null,m))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[o]=new Kr(o,h,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:v.serialize(),sourceId:o})),v.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===o)return this.fire(new l.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${m}" is using it.`)));const h=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],h.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,h){this._checkLoaded(),this.sourceCaches[o].getSource().setData(h),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,h,m={}){this._checkLoaded();const v=o.id;if(this.getLayer(v))return void this.fire(new l.ErrorEvent(new Error(`Layer "${v}" already exists on this map.`)));let E;if(o.type==="custom"){if(an(this,l.validateCustomStyleLayer(o)))return;E=l.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(v,o.source),o=l.clone$1(o),o=l.extend(o,{source:v})),this._validate(l.validateStyle.layer,`layers.${v}`,o,{arrayIndex:-1},m))return;E=l.createStyleLayer(o),this._validateLayer(E),E.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[E.id]=E.serialize()}const L=h?this._order.indexOf(h):this._order.length;if(h&&L===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(L,0,v),this._layerOrderChanged=!0,this._layers[v]=E,this._removedLayers[v]&&E.source&&E.type!=="custom"){const N=this._removedLayers[v];delete this._removedLayers[v],N.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new l.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const m=this._order.indexOf(o);this._order.splice(m,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${h}".`))):(this._order.splice(v,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));h.setEventedParent(null);const m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,h,m){this._checkLoaded();const v=this.getLayer(o);v?v.minzoom===h&&v.maxzoom===m||(h!=null&&(v.minzoom=h),m!=null&&(v.maxzoom=m),this._updateLayer(v)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,h,m={}){this._checkLoaded();const v=this.getLayer(o);if(v){if(!P(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(l.validateStyle.filter,`layers.${v.id}.filter`,h,null,m)||(v.filter=l.clone$1(h),this._updateLayer(v)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return l.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,h,m,v={}){this._checkLoaded();const E=this.getLayer(o);E?P(E.getLayoutProperty(h),m)||(E.setLayoutProperty(h,m,v),this._updateLayer(E)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,h){const m=this.getLayer(o);if(m)return m.getLayoutProperty(h);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,h,m,v={}){this._checkLoaded();const E=this.getLayer(o);E?P(E.getPaintProperty(h),m)||(E.setPaintProperty(h,m,v)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,h){return this.getLayer(o).getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const m=o.source,v=o.sourceLayer,E=this.sourceCaches[m];if(E===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const L=E.getSource().type;L==="geojson"&&v?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||v?(o.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),E.setFeatureState(v,o.id,h)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,h){this._checkLoaded();const m=o.source,v=this.sourceCaches[m];if(v===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const E=v.getSource().type,L=E==="vector"?o.sourceLayer:void 0;E!=="vector"||L?h&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(L,o.id,h):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const h=o.source,m=o.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||m?(o.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),v.getFeatureState(m,o.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,o=>o.serialize()),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(o){const h=L=>this._layers[L].type==="fill-extrusion",m={},v=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(h(N)){m[N]=L;for(const C of o){const k=C[N];if(k)for(const V of k)v.push(V)}}}v.sort((L,N)=>N.intersectionZ-L.intersectionZ);const E=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(h(N))for(let C=v.length-1;C>=0;C--){const k=v[C].feature;if(m[k.layer.id]<L)break;E.push(k),v.pop()}else for(const C of o){const k=C[N];if(k)for(const V of k)E.push(V.feature)}}return E}queryRenderedFeatures(o,h,m){h&&h.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of h.layers){const N=this._layers[L];if(!N)return this.fire(new l.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];v[N.source]=!0}}const E=[];h.availableImages=this._availableImages;for(const L in this.sourceCaches)h.layers&&!v[L]||E.push(eo(this.sourceCaches[L],this._layers,this._serializedLayers,o,h,m));return this.placement&&E.push(function(L,N,C,k,V,Z,W){const ot={},J=Z.queryRenderedSymbols(k),it=[];for(const mt of Object.keys(J).map(Number))it.push(W[mt]);it.sort(es);for(const mt of it){const yt=mt.featureIndex.lookupSymbolFeatures(J[mt.bucketInstanceId],N,mt.bucketIndex,mt.sourceLayerIndex,V.filter,V.layers,V.availableImages,L);for(const Tt in yt){const bt=ot[Tt]=ot[Tt]||[],Kt=yt[Tt];Kt.sort((Ut,kt)=>{const se=mt.featureSortOrder;if(se){const me=se.indexOf(Ut.featureIndex);return se.indexOf(kt.featureIndex)-me}return kt.featureIndex-Ut.featureIndex});for(const Ut of Kt)bt.push(Ut)}}for(const mt in ot)ot[mt].forEach(yt=>{const Tt=yt.feature,bt=C[L[mt].source].getFeatureState(Tt.layer["source-layer"],Tt.id);Tt.source=Tt.layer.source,Tt.layer["source-layer"]&&(Tt.sourceLayer=Tt.layer["source-layer"]),Tt.state=bt});return ot}(this._layers,this._serializedLayers,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(o,h){h&&h.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);const m=this.sourceCaches[o];return m?function(v,E){const L=v.getRenderableIds().map(k=>v.getTileByID(k)),N=[],C={};for(let k=0;k<L.length;k++){const V=L[k],Z=V.tileID.canonical.key;C[Z]||(C[Z]=!0,V.querySourceFeatures(N,E))}return N}(m,h):[]}addSourceType(o,h,m){return Ti.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(Ti.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const m=this.light.getLight();let v=!1;for(const L in o)if(!P(o[L],m[L])){v=!0;break}if(!v)return;const E={now:l.exported.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(E)}_validate(o,h,m,v,E={}){return(!E||E.validate!==!1)&&an(this,o.call(l.validateStyle,l.extend({key:h,style:this.serialize(),value:m,styleSpec:l.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const h=this.sourceCaches[o];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const h in this.sourceCaches)this.sourceCaches[h].update(o)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,h,m,v,E=!1){let L=!1,N=!1;const C={};for(const k of this._order){const V=this._layers[k];if(V.type!=="symbol")continue;if(!C[V.source]){const W=this.sourceCaches[V.source];C[V.source]=W.getRenderableIds(!0).map(ot=>W.getTileByID(ot)).sort((ot,J)=>J.tileID.overscaledZ-ot.tileID.overscaledZ||(ot.tileID.isLessThan(J.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(V,C[V.source],o.center.lng);L=L||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),o.zoom))&&(this.pauseablePlacement=new De(o,this._order,E,h,m,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),N=!0),L&&this.pauseablePlacement.placement.setStale()),N||L)for(const k of this._order){const V=this._layers[k];V.type==="symbol"&&this.placement.updateLayerOpacities(V,C[V.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,m){this.imageManager.getImages(h.icons,m),this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];v&&v.setDependencies(h.tileID.key,h.type,h.icons)}getGlyphs(o,h,m){this.glyphManager.getGlyphs(h.stacks,m)}getResource(o,h,m){return l.makeRequest(h,m)}}Ti.getSourceType=function(y){return Vi[y]},Ti.setSourceType=function(y,o){Vi[y]=o},Ti.registerForPluginStateChange=l.registerForPluginStateChange;var Su=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),lt={prelude:xe(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),background:xe(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:xe(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xe(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:xe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xe(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:xe(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xe("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:xe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:xe(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:xe(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:xe(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:xe(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:xe(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:xe(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:xe(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xe(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:xe(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lineGradient:xe(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),linePattern:xe(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:xe(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:xe(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:xe(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),symbolSDF:xe(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:xe(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`)};function xe(y,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=o.match(/attribute ([\w]+) ([\w]+)/g),v=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=E?E.concat(v):v,N={};return{fragmentSource:y=y.replace(h,(C,k,V,Z,W)=>(N[W]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${V} ${Z} ${W};
#else
uniform ${V} ${Z} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${V} ${Z} ${W} = u_${W};
#endif
`)),vertexSource:o=o.replace(h,(C,k,V,Z,W)=>{const ot=Z==="float"?"vec2":"vec4",J=W.match(/color/)?"color":ot;return N[W]?k==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${V} ${ot} a_${W};
varying ${V} ${Z} ${W};
#else
uniform ${V} ${Z} u_${W};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${V} ${Z} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${J}(a_${W}, u_${W}_t);
#else
    ${V} ${Z} ${W} = u_${W};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${V} ${ot} a_${W};
#else
uniform ${V} ${Z} u_${W};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${Z} ${W} = a_${W};
#else
    ${V} ${Z} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${Z} ${W} = unpack_mix_${J}(a_${W}, u_${W}_t);
#else
    ${V} ${Z} ${W} = u_${W};
#endif
`}),staticAttributes:m,staticUniforms:L}}class Je{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,h,m,v,E,L,N,C){this.context=o;let k=this.boundPaintVertexBuffers.length!==v.length;for(let V=0;!k&&V<v.length;V++)this.boundPaintVertexBuffers[V]!==v[V]&&(k=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===m&&!k&&this.boundIndexBuffer===E&&this.boundVertexOffset===L&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===C?(o.bindVertexArrayOES.set(this.vao),N&&N.bind(),E&&E.dynamicDraw&&E.bind(),C&&C.bind()):this.freshBind(h,m,v,E,L,N,C)}freshBind(o,h,m,v,E,L,N){let C;const k=o.numAttributes,V=this.context,Z=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=N;else{C=V.currentNumAttributes||0;for(let W=k;W<C;W++)Z.disableVertexAttribArray(W)}h.enableAttributes(Z,o);for(const W of m)W.enableAttributes(Z,o);L&&L.enableAttributes(Z,o),N&&N.enableAttributes(Z,o),h.bind(),h.setVertexAttribPointers(Z,o,E);for(const W of m)W.bind(),W.setVertexAttribPointers(Z,o,E);L&&(L.bind(),L.setVertexAttribPointers(Z,o,E)),v&&v.bind(),N&&(N.bind(),N.setVertexAttribPointers(Z,o,E)),V.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Un(y){const o=[];for(let h=0;h<y.length;h++){if(y[h]===null)continue;const m=y[h].split(" ");o.push(m.pop())}return o}class Ai{constructor(o,h,m,v,E,L){const N=o.gl;this.program=N.createProgram();const C=Un(m.staticAttributes),k=v?v.getBinderAttributes():[],V=C.concat(k),Z=m.staticUniforms?Un(m.staticUniforms):[],W=v?v.getBinderUniforms():[],ot=Z.concat(W),J=[];for(const Ut of ot)J.indexOf(Ut)<0&&J.push(Ut);const it=v?v.defines():[];L&&it.push("#define OVERDRAW_INSPECTOR;");const mt=it.concat(lt.prelude.fragmentSource,m.fragmentSource).join(`
`),yt=it.concat(lt.prelude.vertexSource,m.vertexSource).join(`
`),Tt=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(Tt,mt),N.compileShader(Tt),N.attachShader(this.program,Tt);const bt=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(bt,yt),N.compileShader(bt),N.attachShader(this.program,bt),this.attributes={};const Kt={};this.numAttributes=V.length;for(let Ut=0;Ut<this.numAttributes;Ut++)V[Ut]&&(N.bindAttribLocation(this.program,Ut,V[Ut]),this.attributes[V[Ut]]=Ut);N.linkProgram(this.program),N.deleteShader(bt),N.deleteShader(Tt);for(let Ut=0;Ut<J.length;Ut++){const kt=J[Ut];if(kt&&!Kt[kt]){const se=N.getUniformLocation(this.program,kt);se&&(Kt[kt]=se)}}this.fixedUniforms=E(o,Kt),this.binderUniforms=v?v.getUniforms(o,Kt):[]}draw(o,h,m,v,E,L,N,C,k,V,Z,W,ot,J,it,mt){const yt=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(m),o.setStencilMode(v),o.setColorMode(E),o.setCullFace(L);for(const bt in this.fixedUniforms)this.fixedUniforms[bt].set(N[bt]);J&&J.setUniforms(o,this.binderUniforms,W,{zoom:ot});const Tt={[yt.LINES]:2,[yt.TRIANGLES]:3,[yt.LINE_STRIP]:1}[h];for(const bt of Z.get()){const Kt=bt.vaos||(bt.vaos={});(Kt[C]||(Kt[C]=new Je)).bind(o,this,k,J?J.getPaintVertexBuffers():[],V,bt.vertexOffset,it,mt),yt.drawElements(h,bt.primitiveLength*Tt,yt.UNSIGNED_SHORT,bt.primitiveOffset*Tt*2)}}}function di(y,o,h){const m=1/Qr(h,1,o.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),E=h.tileSize*Math.pow(2,o.transform.tileZoom)/v,L=E*(h.tileID.canonical.x+h.tileID.wrap*v),N=E*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[m,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[L>>16,N>>16],u_pixel_coord_lower:[65535&L,65535&N]}}const za=(y,o,h,m)=>{const v=o.style.light,E=v.properties.get("position"),L=[E.x,E.y,E.z],N=function(){var k=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();v.properties.get("anchor")==="viewport"&&function(k,V){var Z=Math.sin(V),W=Math.cos(V);k[0]=W,k[1]=Z,k[2]=0,k[3]=-Z,k[4]=W,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(N,-o.transform.angle),function(k,V,Z){var W=V[0],ot=V[1],J=V[2];k[0]=W*Z[0]+ot*Z[3]+J*Z[6],k[1]=W*Z[1]+ot*Z[4]+J*Z[7],k[2]=W*Z[2]+ot*Z[5]+J*Z[8]}(L,L,N);const C=v.properties.get("color");return{u_matrix:y,u_lightpos:L,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+h,u_opacity:m}},sl=(y,o,h,m,v,E,L)=>l.extend(za(y,o,h,m),di(E,o,L),{u_height_factor:-Math.pow(2,v.overscaledZ)/L.tileSize/8}),Gs=y=>({u_matrix:y}),io=(y,o,h,m)=>l.extend(Gs(y),di(h,o,m)),qs=(y,o)=>({u_matrix:y,u_world:o}),Ro=(y,o,h,m,v)=>l.extend(io(y,o,h,m),{u_world:v}),is=(y,o,h,m)=>{const v=y.transform;let E,L;if(m.paint.get("circle-pitch-alignment")==="map"){const N=Qr(h,1,v.zoom);E=!0,L=[N,N]}else E=!1,L=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(o.posMatrix,h,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:L}},al=(y,o,h)=>{const m=Qr(h,1,o.zoom),v=Math.pow(2,o.zoom-h.tileID.overscaledZ),E=h.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[o.pixelsToGLUnits[0]/(m*v),o.pixelsToGLUnits[1]/(m*v)],u_overscale_factor:E}},ll=(y,o,h=1)=>({u_matrix:y,u_color:o,u_overlay:0,u_overlay_scale:h}),la=y=>({u_matrix:y}),uc=(y,o,h,m)=>({u_matrix:y,u_extrude_scale:Qr(o,1,h),u_intensity:m});function cc(y,o){const h=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new l.MercatorCoordinate(0,m/h).toLngLat().lat,new l.MercatorCoordinate(0,(m+1)/h).toLngLat().lat]}const hc=(y,o,h)=>{const m=y.transform;return{u_matrix:ef(y,o,h),u_ratio:1/Qr(o,1,m.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},fc=(y,o,h,m)=>l.extend(hc(y,o,h),{u_image:0,u_image_height:m}),Cu=(y,o,h,m)=>{const v=y.transform,E=Tu(o,v);return{u_matrix:ef(y,o,h),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Qr(o,1,v.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[E,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},li=(y,o,h,m,v)=>{const E=y.lineAtlas,L=Tu(o,y.transform),N=h.layout.get("line-cap")==="round",C=E.getDash(m.from,N),k=E.getDash(m.to,N),V=C.width*v.fromScale,Z=k.width*v.toScale;return l.extend(hc(y,o,h),{u_patternscale_a:[L/V,-C.height/2],u_patternscale_b:[L/Z,-k.height/2],u_sdfgamma:E.width/(256*Math.min(V,Z)*y.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:k.y,u_mix:v.t})};function Tu(y,o){return 1/Qr(y,1,o.tileZoom)}function ef(y,o,h){return y.translatePosMatrix(o.tileID.posMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const up=(y,o,h,m,v)=>{return{u_matrix:y,u_tl_parent:o,u_scale_parent:h,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(L=v.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(E=v.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:cp(v.paint.get("raster-hue-rotate"))};var E,L};function cp(y){y*=Math.PI/180;const o=Math.sin(y),h=Math.cos(y);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const pc=(y,o,h,m,v,E,L,N,C,k)=>{const V=v.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:V.width/V.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:L,u_coord_matrix:N,u_is_text:+C,u_pitch_with_map:+m,u_texsize:k,u_texture:0}},nf=(y,o,h,m,v,E,L,N,C,k,V)=>{const Z=v.transform;return l.extend(pc(y,o,h,m,v,E,L,N,C,k),{u_gamma_scale:m?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:+V})},$d=(y,o,h,m,v,E,L,N,C,k)=>l.extend(nf(y,o,h,m,v,E,L,N,!0,C,!0),{u_texsize_icon:k,u_texture_icon:1}),tg=(y,o,h)=>({u_matrix:y,u_opacity:o,u_color:h}),rf=(y,o,h,m,v,E)=>l.extend(function(L,N,C,k){const V=C.imageManager.getPattern(L.from.toString()),Z=C.imageManager.getPattern(L.to.toString()),{width:W,height:ot}=C.imageManager.getPixelSize(),J=Math.pow(2,k.tileID.overscaledZ),it=k.tileSize*Math.pow(2,C.transform.tileZoom)/J,mt=it*(k.tileID.canonical.x+k.tileID.wrap*J),yt=it*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[W,ot],u_mix:N.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/Qr(k,1,C.transform.tileZoom),u_pixel_coord_upper:[mt>>16,yt>>16],u_pixel_coord_lower:[65535&mt,65535&yt]}}(m,E,h,v),{u_matrix:y,u_opacity:o}),dc={fillExtrusion:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_lightpos:new l.Uniform3f(y,o.u_lightpos),u_lightintensity:new l.Uniform1f(y,o.u_lightintensity),u_lightcolor:new l.Uniform3f(y,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(y,o.u_vertical_gradient),u_opacity:new l.Uniform1f(y,o.u_opacity)}),fillExtrusionPattern:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_lightpos:new l.Uniform3f(y,o.u_lightpos),u_lightintensity:new l.Uniform1f(y,o.u_lightintensity),u_lightcolor:new l.Uniform3f(y,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(y,o.u_vertical_gradient),u_height_factor:new l.Uniform1f(y,o.u_height_factor),u_image:new l.Uniform1i(y,o.u_image),u_texsize:new l.Uniform2f(y,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(y,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(y,o.u_scale),u_fade:new l.Uniform1f(y,o.u_fade),u_opacity:new l.Uniform1f(y,o.u_opacity)}),fill:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix)}),fillPattern:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_image:new l.Uniform1i(y,o.u_image),u_texsize:new l.Uniform2f(y,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(y,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(y,o.u_scale),u_fade:new l.Uniform1f(y,o.u_fade)}),fillOutline:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_world:new l.Uniform2f(y,o.u_world)}),fillOutlinePattern:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_world:new l.Uniform2f(y,o.u_world),u_image:new l.Uniform1i(y,o.u_image),u_texsize:new l.Uniform2f(y,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(y,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(y,o.u_scale),u_fade:new l.Uniform1f(y,o.u_fade)}),circle:(y,o)=>({u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(y,o.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(y,o.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(y,o.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(y,o.u_matrix)}),collisionBox:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(y,o.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(y,o.u_extrude_scale),u_overscale_factor:new l.Uniform1f(y,o.u_overscale_factor)}),collisionCircle:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_inv_matrix:new l.UniformMatrix4f(y,o.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(y,o.u_viewport_size)}),debug:(y,o)=>({u_color:new l.UniformColor(y,o.u_color),u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_overlay:new l.Uniform1i(y,o.u_overlay),u_overlay_scale:new l.Uniform1f(y,o.u_overlay_scale)}),clippingMask:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix)}),heatmap:(y,o)=>({u_extrude_scale:new l.Uniform1f(y,o.u_extrude_scale),u_intensity:new l.Uniform1f(y,o.u_intensity),u_matrix:new l.UniformMatrix4f(y,o.u_matrix)}),heatmapTexture:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_world:new l.Uniform2f(y,o.u_world),u_image:new l.Uniform1i(y,o.u_image),u_color_ramp:new l.Uniform1i(y,o.u_color_ramp),u_opacity:new l.Uniform1f(y,o.u_opacity)}),hillshade:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_image:new l.Uniform1i(y,o.u_image),u_latrange:new l.Uniform2f(y,o.u_latrange),u_light:new l.Uniform2f(y,o.u_light),u_shadow:new l.UniformColor(y,o.u_shadow),u_highlight:new l.UniformColor(y,o.u_highlight),u_accent:new l.UniformColor(y,o.u_accent)}),hillshadePrepare:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_image:new l.Uniform1i(y,o.u_image),u_dimension:new l.Uniform2f(y,o.u_dimension),u_zoom:new l.Uniform1f(y,o.u_zoom),u_unpack:new l.Uniform4f(y,o.u_unpack)}),line:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_ratio:new l.Uniform1f(y,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(y,o.u_units_to_pixels)}),lineGradient:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_ratio:new l.Uniform1f(y,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(y,o.u_units_to_pixels),u_image:new l.Uniform1i(y,o.u_image),u_image_height:new l.Uniform1f(y,o.u_image_height)}),linePattern:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_texsize:new l.Uniform2f(y,o.u_texsize),u_ratio:new l.Uniform1f(y,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_image:new l.Uniform1i(y,o.u_image),u_units_to_pixels:new l.Uniform2f(y,o.u_units_to_pixels),u_scale:new l.Uniform3f(y,o.u_scale),u_fade:new l.Uniform1f(y,o.u_fade)}),lineSDF:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_ratio:new l.Uniform1f(y,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(y,o.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(y,o.u_patternscale_a),u_patternscale_b:new l.Uniform2f(y,o.u_patternscale_b),u_sdfgamma:new l.Uniform1f(y,o.u_sdfgamma),u_image:new l.Uniform1i(y,o.u_image),u_tex_y_a:new l.Uniform1f(y,o.u_tex_y_a),u_tex_y_b:new l.Uniform1f(y,o.u_tex_y_b),u_mix:new l.Uniform1f(y,o.u_mix)}),raster:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_tl_parent:new l.Uniform2f(y,o.u_tl_parent),u_scale_parent:new l.Uniform1f(y,o.u_scale_parent),u_buffer_scale:new l.Uniform1f(y,o.u_buffer_scale),u_fade_t:new l.Uniform1f(y,o.u_fade_t),u_opacity:new l.Uniform1f(y,o.u_opacity),u_image0:new l.Uniform1i(y,o.u_image0),u_image1:new l.Uniform1i(y,o.u_image1),u_brightness_low:new l.Uniform1f(y,o.u_brightness_low),u_brightness_high:new l.Uniform1f(y,o.u_brightness_high),u_saturation_factor:new l.Uniform1f(y,o.u_saturation_factor),u_contrast_factor:new l.Uniform1f(y,o.u_contrast_factor),u_spin_weights:new l.Uniform3f(y,o.u_spin_weights)}),symbolIcon:(y,o)=>({u_is_size_zoom_constant:new l.Uniform1i(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(y,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(y,o.u_size_t),u_size:new l.Uniform1f(y,o.u_size),u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(y,o.u_pitch),u_rotate_symbol:new l.Uniform1i(y,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(y,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(y,o.u_fade_change),u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(y,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(y,o.u_coord_matrix),u_is_text:new l.Uniform1i(y,o.u_is_text),u_pitch_with_map:new l.Uniform1i(y,o.u_pitch_with_map),u_texsize:new l.Uniform2f(y,o.u_texsize),u_texture:new l.Uniform1i(y,o.u_texture)}),symbolSDF:(y,o)=>({u_is_size_zoom_constant:new l.Uniform1i(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(y,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(y,o.u_size_t),u_size:new l.Uniform1f(y,o.u_size),u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(y,o.u_pitch),u_rotate_symbol:new l.Uniform1i(y,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(y,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(y,o.u_fade_change),u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(y,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(y,o.u_coord_matrix),u_is_text:new l.Uniform1i(y,o.u_is_text),u_pitch_with_map:new l.Uniform1i(y,o.u_pitch_with_map),u_texsize:new l.Uniform2f(y,o.u_texsize),u_texture:new l.Uniform1i(y,o.u_texture),u_gamma_scale:new l.Uniform1f(y,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(y,o.u_is_halo)}),symbolTextAndIcon:(y,o)=>({u_is_size_zoom_constant:new l.Uniform1i(y,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(y,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(y,o.u_size_t),u_size:new l.Uniform1f(y,o.u_size),u_camera_to_center_distance:new l.Uniform1f(y,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(y,o.u_pitch),u_rotate_symbol:new l.Uniform1i(y,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(y,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(y,o.u_fade_change),u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(y,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(y,o.u_coord_matrix),u_is_text:new l.Uniform1i(y,o.u_is_text),u_pitch_with_map:new l.Uniform1i(y,o.u_pitch_with_map),u_texsize:new l.Uniform2f(y,o.u_texsize),u_texsize_icon:new l.Uniform2f(y,o.u_texsize_icon),u_texture:new l.Uniform1i(y,o.u_texture),u_texture_icon:new l.Uniform1i(y,o.u_texture_icon),u_gamma_scale:new l.Uniform1f(y,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(y,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(y,o.u_is_halo)}),background:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_opacity:new l.Uniform1f(y,o.u_opacity),u_color:new l.UniformColor(y,o.u_color)}),backgroundPattern:(y,o)=>({u_matrix:new l.UniformMatrix4f(y,o.u_matrix),u_opacity:new l.Uniform1f(y,o.u_opacity),u_image:new l.Uniform1i(y,o.u_image),u_pattern_tl_a:new l.Uniform2f(y,o.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(y,o.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(y,o.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(y,o.u_pattern_br_b),u_texsize:new l.Uniform2f(y,o.u_texsize),u_mix:new l.Uniform1f(y,o.u_mix),u_pattern_size_a:new l.Uniform2f(y,o.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(y,o.u_pattern_size_b),u_scale_a:new l.Uniform1f(y,o.u_scale_a),u_scale_b:new l.Uniform1f(y,o.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(y,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(y,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(y,o.u_tile_units_to_pixels)})};class of{constructor(o,h,m){this.context=o;const v=o.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const sf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class hp{constructor(o,h,m,v){this.length=h.length,this.attributes=m,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=o;const E=o.gl;this.buffer=E.createBuffer(),o.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let m=0;m<this.attributes.length;m++){const v=h.attributes[this.attributes[m].name];v!==void 0&&o.enableVertexAttribArray(v)}}setVertexAttribPointers(o,h,m){for(let v=0;v<this.attributes.length;v++){const E=this.attributes[v],L=h.attributes[E.name];L!==void 0&&o.vertexAttribPointer(L,E.components,o[sf[E.type]],!1,this.itemSize,E.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Zn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class eg extends Zn{getDefault(){return l.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class cr extends Zn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ar extends Zn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class fp extends Zn{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class os extends Zn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class af extends Zn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class eh extends Zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class nh extends Zn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class lf extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class rh extends Zn{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class ih extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Pi extends Zn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class gc extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class ua extends Zn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class uf extends Zn{getDefault(){return l.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class oh extends Zn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Xi extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class pp extends Zn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class dp extends Zn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class gp extends Zn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class mp extends Zn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class _p extends Zn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class yp extends Zn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class vo extends Zn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class cf extends Zn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Zi extends Zn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class vp extends Zn{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class hf extends Zn{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class ca extends Zn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ha extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class sh extends Zn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class lr extends Zn{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class ss extends lr{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class ah extends lr{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ff{constructor(o,h,m,v){this.context=o,this.width=h,this.height=m;const E=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new ss(o,E),v&&(this.depthAttachment=new ah(o,E))}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const m=this.depthAttachment.get();m&&o.deleteRenderbuffer(m)}o.deleteFramebuffer(this.framebuffer)}}class ln{constructor(o,h,m){this.blendFunction=o,this.blendColor=h,this.mask=m}}ln.Replace=[1,0],ln.disabled=new ln(ln.Replace,l.Color.transparent,[!1,!1,!1,!1]),ln.unblended=new ln(ln.Replace,l.Color.transparent,[!0,!0,!0,!0]),ln.alphaBlended=new ln([1,771],l.Color.transparent,[!0,!0,!0,!0]);class lh{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new eg(this),this.clearDepth=new cr(this),this.clearStencil=new ar(this),this.colorMask=new fp(this),this.depthMask=new os(this),this.stencilMask=new af(this),this.stencilFunc=new eh(this),this.stencilOp=new nh(this),this.stencilTest=new lf(this),this.depthRange=new rh(this),this.depthTest=new ih(this),this.depthFunc=new Pi(this),this.blend=new gc(this),this.blendFunc=new ua(this),this.blendColor=new uf(this),this.blendEquation=new oh(this),this.cullFace=new Xi(this),this.cullFaceSide=new pp(this),this.frontFace=new dp(this),this.program=new gp(this),this.activeTexture=new mp(this),this.viewport=new _p(this),this.bindFramebuffer=new yp(this),this.bindRenderbuffer=new vo(this),this.bindTexture=new cf(this),this.bindVertexBuffer=new Zi(this),this.bindElementBuffer=new vp(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new hf(this),this.pixelStoreUnpack=new ca(this),this.pixelStoreUnpackPremultiplyAlpha=new ha(this),this.pixelStoreUnpackFlipY=new sh(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new of(this,o,h)}createVertexBuffer(o,h,m){return new hp(this,o,h,m)}createRenderbuffer(o,h,m){const v=this.gl,E=v.createRenderbuffer();return this.bindRenderbuffer.set(E),v.renderbufferStorage(v.RENDERBUFFER,o,h,m),this.bindRenderbuffer.set(null),E}createFramebuffer(o,h,m){return new ff(this,o,h,m)}clear({color:o,depth:h}){const m=this.gl;let v=0;o&&(v|=m.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(v|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),m.clear(v)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){P(o.blendFunction,ln.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class nr{constructor(o,h,m){this.func=o,this.mask=h,this.range=m}}nr.ReadOnly=!1,nr.ReadWrite=!0,nr.disabled=new nr(519,nr.ReadOnly,[0,1]);const uh=7680;class wr{constructor(o,h,m,v,E,L){this.test=o,this.ref=h,this.mask=m,this.fail=v,this.depthFail=E,this.pass=L}}wr.disabled=new wr({func:519,mask:0},0,0,uh,uh,uh);class Er{constructor(o,h,m){this.enable=o,this.mode=h,this.frontFace=m}}let Oa;function pf(y,o,h,m,v,E,L){const N=y.context,C=N.gl,k=y.useProgram("collisionBox"),V=[];let Z=0,W=0;for(let bt=0;bt<m.length;bt++){const Kt=m[bt],Ut=o.getTile(Kt),kt=Ut.getBucket(h);if(!kt)continue;let se=Kt.posMatrix;v[0]===0&&v[1]===0||(se=y.translatePosMatrix(Kt.posMatrix,Ut,v,E));const me=L?kt.textCollisionBox:kt.iconCollisionBox,Ht=kt.collisionCircleArray;if(Ht.length>0){const Re=l.create(),Ie=se;l.mul(Re,kt.placementInvProjMatrix,y.transform.glCoordMatrix),l.mul(Re,Re,kt.placementViewportMatrix),V.push({circleArray:Ht,circleOffset:W,transform:Ie,invTransform:Re}),Z+=Ht.length/4,W=Z}me&&k.draw(N,C.LINES,nr.disabled,wr.disabled,y.colorModeForRenderPass(),Er.disabled,al(se,y.transform,Ut),h.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,null,y.transform.zoom,null,null,me.collisionVertexBuffer)}if(!L||!V.length)return;const ot=y.useProgram("collisionCircle"),J=new l.CollisionCircleLayoutArray;J.resize(4*Z),J._trim();let it=0;for(const bt of V)for(let Kt=0;Kt<bt.circleArray.length/4;Kt++){const Ut=4*Kt,kt=bt.circleArray[Ut+0],se=bt.circleArray[Ut+1],me=bt.circleArray[Ut+2],Ht=bt.circleArray[Ut+3];J.emplace(it++,kt,se,me,Ht,0),J.emplace(it++,kt,se,me,Ht,1),J.emplace(it++,kt,se,me,Ht,2),J.emplace(it++,kt,se,me,Ht,3)}(!Oa||Oa.length<2*Z)&&(Oa=function(bt){const Kt=2*bt,Ut=new l.QuadTriangleArray;Ut.resize(Kt),Ut._trim();for(let kt=0;kt<Kt;kt++){const se=6*kt;Ut.uint16[se+0]=4*kt+0,Ut.uint16[se+1]=4*kt+1,Ut.uint16[se+2]=4*kt+2,Ut.uint16[se+3]=4*kt+2,Ut.uint16[se+4]=4*kt+3,Ut.uint16[se+5]=4*kt+0}return Ut}(Z));const mt=N.createIndexBuffer(Oa,!0),yt=N.createVertexBuffer(J,l.collisionCircleLayout.members,!0);for(const bt of V){const Kt={u_matrix:bt.transform,u_inv_matrix:bt.invTransform,u_camera_to_center_distance:(Tt=y.transform).cameraToCenterDistance,u_viewport_size:[Tt.width,Tt.height]};ot.draw(N,C.TRIANGLES,nr.disabled,wr.disabled,y.colorModeForRenderPass(),Er.disabled,Kt,h.id,yt,mt,l.SegmentVector.simpleSegment(0,2*bt.circleOffset,bt.circleArray.length,bt.circleArray.length/2),null,y.transform.zoom,null,null,null)}var Tt;yt.destroy(),mt.destroy()}Er.disabled=new Er(!1,1029,2305),Er.backCCW=new Er(!0,1029,2305);const xp=l.identity(new Float32Array(16));function ch(y,o,h,m,v,E){const{horizontalAlign:L,verticalAlign:N}=l.getAnchorAlignment(y),C=-(L-.5)*o,k=-(N-.5)*h,V=l.evaluateVariableOffset(y,m);return new l.pointGeometry((C/v+V[0])*E,(k/v+V[1])*E)}function Au(y,o,h,m,v,E,L,N,C,k){const V=y.text.placedSymbolArray,Z=y.text.dynamicLayoutVertexArray,W=y.icon.dynamicLayoutVertexArray,ot={};Z.clear();for(let J=0;J<V.length;J++){const it=V.get(J),mt=y.allowVerticalPlacement&&!it.placedOrientation,yt=it.hidden||!it.crossTileID||mt?null:m[it.crossTileID];if(yt){const Tt=new l.pointGeometry(it.anchorX,it.anchorY),bt=dn(Tt,h?L:E),Kt=ue(v.cameraToCenterDistance,bt.signedDistanceFromCamera);let Ut=l.evaluateSizeForFeature(y.textSizeData,C,it)*Kt/l.ONE_EM;h&&(Ut*=y.tilePixelRatio/N);const{width:kt,height:se,anchor:me,textOffset:Ht,textBoxScale:Re}=yt,Ie=ch(me,kt,se,Ht,Re,Ut),We=h?dn(Tt.add(Ie),E).point:bt.point.add(o?Ie.rotate(-v.angle):Ie),Nn=y.allowVerticalPlacement&&it.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let En=0;En<it.numGlyphs;En++)l.addDynamicAttributes(Z,We,Nn);k&&it.associatedIconIndex>=0&&(ot[it.associatedIconIndex]={shiftedAnchor:We,angle:Nn})}else Jr(it.numGlyphs,Z)}if(k){W.clear();const J=y.icon.placedSymbolArray;for(let it=0;it<J.length;it++){const mt=J.get(it);if(mt.hidden)Jr(mt.numGlyphs,W);else{const yt=ot[it];if(yt)for(let Tt=0;Tt<mt.numGlyphs;Tt++)l.addDynamicAttributes(W,yt.shiftedAnchor,yt.angle);else Jr(mt.numGlyphs,W)}}y.icon.dynamicLayoutVertexBuffer.updateData(W)}y.text.dynamicLayoutVertexBuffer.updateData(Z)}function Pu(y,o,h){return h.iconsInText&&o?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function mc(y,o,h,m,v,E,L,N,C,k,V,Z){const W=y.context,ot=W.gl,J=y.transform,it=N==="map",mt=C==="map",yt=N!=="viewport"&&h.layout.get("symbol-placement")!=="point",Tt=it&&!mt&&!yt,bt=!h.layout.get("symbol-sort-key").isConstant();let Kt=!1;const Ut=y.depthModeForSublayer(0,nr.ReadOnly),kt=h.layout.get("text-variable-anchor"),se=[];for(const me of m){const Ht=o.getTile(me),Re=Ht.getBucket(h);if(!Re)continue;const Ie=v?Re.text:Re.icon;if(!Ie||!Ie.segments.get().length)continue;const We=Ie.programConfigurations.get(h.id),Nn=v||Re.sdfIcons,En=v?Re.textSizeData:Re.iconSizeData,Dn=mt||J.pitch!==0,kr=y.useProgram(Pu(Nn,v,Re),We),hn=l.evaluateSizeForZoom(En,J.zoom);let Tn,hr,Wi,Fr,As=[0,0],Ps=null;if(v){if(hr=Ht.glyphAtlasTexture,Wi=ot.LINEAR,Tn=Ht.glyphAtlasTexture.size,Re.iconsInText){As=Ht.imageAtlasTexture.size,Ps=Ht.imageAtlasTexture;const Zs=En.kind==="composite"||En.kind==="camera";Fr=Dn||y.options.rotating||y.options.zooming||Zs?ot.LINEAR:ot.NEAREST}}else{const Zs=h.layout.get("icon-size").constantOr(0)!==1||Re.iconsNeedLinear;hr=Ht.imageAtlasTexture,Wi=Nn||y.options.rotating||y.options.zooming||Zs||Dn?ot.LINEAR:ot.NEAREST,Tn=Ht.imageAtlasTexture.size}const fl=Qr(Ht,1,y.transform.zoom),Fo=Qn(me.posMatrix,mt,it,y.transform,fl),_a=Do(me.posMatrix,mt,it,y.transform,fl),pl=kt&&Re.hasTextData(),Bo=h.layout.get("icon-text-fit")!=="none"&&pl&&Re.hasIconData();if(yt){const Zs=h.layout.get("text-rotation-alignment")==="map";tn(Re,me.posMatrix,y,v,Fo,_a,mt,k,Zs)}const Gn=y.translatePosMatrix(me.posMatrix,Ht,E,L),tr=yt||v&&kt||Bo?xp:Fo,$r=y.translatePosMatrix(_a,Ht,E,L,!0),Li=Nn&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let gr;gr=Nn?Re.iconsInText?$d(En.kind,hn,Tt,mt,y,Gn,tr,$r,Tn,As):nf(En.kind,hn,Tt,mt,y,Gn,tr,$r,v,Tn,!0):pc(En.kind,hn,Tt,mt,y,Gn,tr,$r,v,Tn);const Kl={program:kr,buffers:Ie,uniformValues:gr,atlasTexture:hr,atlasTextureIcon:Ps,atlasInterpolation:Wi,atlasInterpolationIcon:Fr,isSDF:Nn,hasHalo:Li};if(bt&&Re.canOverlap){Kt=!0;const Zs=Ie.segments.get();for(const wh of Zs)se.push({segments:new l.SegmentVector([wh]),sortKey:wh.sortKey,state:Kl})}else se.push({segments:Ie.segments,sortKey:0,state:Kl})}Kt&&se.sort((me,Ht)=>me.sortKey-Ht.sortKey);for(const me of se){const Ht=me.state;if(W.activeTexture.set(ot.TEXTURE0),Ht.atlasTexture.bind(Ht.atlasInterpolation,ot.CLAMP_TO_EDGE),Ht.atlasTextureIcon&&(W.activeTexture.set(ot.TEXTURE1),Ht.atlasTextureIcon&&Ht.atlasTextureIcon.bind(Ht.atlasInterpolationIcon,ot.CLAMP_TO_EDGE)),Ht.isSDF){const Re=Ht.uniformValues;Ht.hasHalo&&(Re.u_is_halo=1,hh(Ht.buffers,me.segments,h,y,Ht.program,Ut,V,Z,Re)),Re.u_is_halo=0}hh(Ht.buffers,me.segments,h,y,Ht.program,Ut,V,Z,Ht.uniformValues)}}function hh(y,o,h,m,v,E,L,N,C){const k=m.context;v.draw(k,k.gl.TRIANGLES,E,L,N,Er.disabled,C,h.id,y.layoutVertexBuffer,y.indexBuffer,o,h.paint,m.transform.zoom,y.programConfigurations.get(h.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function _c(y,o,h,m,v,E,L){const N=y.context.gl,C=h.paint.get("fill-pattern"),k=C&&C.constantOr(1),V=h.getCrossfadeParameters();let Z,W,ot,J,it;L?(W=k&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=N.LINES):(W=k?"fillPattern":"fill",Z=N.TRIANGLES);for(const mt of m){const yt=o.getTile(mt);if(k&&!yt.patternsLoaded())continue;const Tt=yt.getBucket(h);if(!Tt)continue;const bt=Tt.programConfigurations.get(h.id),Kt=y.useProgram(W,bt);k&&(y.context.activeTexture.set(N.TEXTURE0),yt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),bt.updatePaintBuffers(V));const Ut=C.constantOr(null);if(Ut&&yt.imageAtlas){const se=yt.imageAtlas,me=se.patternPositions[Ut.to.toString()],Ht=se.patternPositions[Ut.from.toString()];me&&Ht&&bt.setConstantPatternPositions(me,Ht)}const kt=y.translatePosMatrix(mt.posMatrix,yt,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(L){J=Tt.indexBuffer2,it=Tt.segments2;const se=[N.drawingBufferWidth,N.drawingBufferHeight];ot=W==="fillOutlinePattern"&&k?Ro(kt,y,V,yt,se):qs(kt,se)}else J=Tt.indexBuffer,it=Tt.segments,ot=k?io(kt,y,V,yt):Gs(kt);Kt.draw(y.context,Z,v,y.stencilModeForClipping(mt),E,Er.disabled,ot,h.id,Tt.layoutVertexBuffer,J,it,h.paint,y.transform.zoom,bt)}}function ul(y,o,h,m,v,E,L){const N=y.context,C=N.gl,k=h.paint.get("fill-extrusion-pattern"),V=k.constantOr(1),Z=h.getCrossfadeParameters(),W=h.paint.get("fill-extrusion-opacity");for(const ot of m){const J=o.getTile(ot),it=J.getBucket(h);if(!it)continue;const mt=it.programConfigurations.get(h.id),yt=y.useProgram(V?"fillExtrusionPattern":"fillExtrusion",mt);V&&(y.context.activeTexture.set(C.TEXTURE0),J.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),mt.updatePaintBuffers(Z));const Tt=k.constantOr(null);if(Tt&&J.imageAtlas){const kt=J.imageAtlas,se=kt.patternPositions[Tt.to.toString()],me=kt.patternPositions[Tt.from.toString()];se&&me&&mt.setConstantPatternPositions(se,me)}const bt=y.translatePosMatrix(ot.posMatrix,J,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Kt=h.paint.get("fill-extrusion-vertical-gradient"),Ut=V?sl(bt,y,Kt,W,ot,Z,J):za(bt,y,Kt,W);yt.draw(N,N.gl.TRIANGLES,v,E,L,Er.backCCW,Ut,h.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,h.paint,y.transform.zoom,mt)}}function fh(y,o,h,m,v,E){const L=y.context,N=L.gl,C=o.fbo;if(!C)return;const k=y.useProgram("hillshade");L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,C.colorAttachment.get());const V=((Z,W,ot)=>{const J=ot.paint.get("hillshade-shadow-color"),it=ot.paint.get("hillshade-highlight-color"),mt=ot.paint.get("hillshade-accent-color");let yt=ot.paint.get("hillshade-illumination-direction")*(Math.PI/180);ot.paint.get("hillshade-illumination-anchor")==="viewport"&&(yt-=Z.transform.angle);const Tt=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix(W.tileID.toUnwrapped(),Tt),u_image:0,u_latrange:cc(0,W.tileID),u_light:[ot.paint.get("hillshade-exaggeration"),yt],u_shadow:J,u_highlight:it,u_accent:mt}})(y,o,h);k.draw(L,N.TRIANGLES,m,v,E,Er.disabled,V,h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function Ss(y,o,h,m,v,E){const L=y.context,N=L.gl,C=o.dem;if(C&&C.data){const k=C.dim,V=C.stride,Z=C.getPixels();if(L.activeTexture.set(N.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||y.getTileTexture(V),o.demTexture){const ot=o.demTexture;ot.update(Z,{premultiply:!1}),ot.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else o.demTexture=new xt(L,Z,N.RGBA,{premultiply:!1}),o.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);L.activeTexture.set(N.TEXTURE0);let W=o.fbo;if(!W){const ot=new xt(L,{width:k,height:k,data:null},N.RGBA);ot.bind(N.LINEAR,N.CLAMP_TO_EDGE),W=o.fbo=L.createFramebuffer(k,k,!0),W.colorAttachment.set(ot.texture)}L.bindFramebuffer.set(W.framebuffer),L.viewport.set([0,0,k,k]),y.useProgram("hillshadePrepare").draw(L,N.TRIANGLES,m,v,E,Er.disabled,((ot,J)=>{const it=J.stride,mt=l.create();return l.ortho(mt,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(mt,mt,[0,-l.EXTENT,0]),{u_matrix:mt,u_image:1,u_dimension:[it,it],u_zoom:ot.overscaledZ,u_unpack:J.getUnpackVector()}})(o.tileID,C),h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function zo(y,o,h,m,v){const E=m.paint.get("raster-fade-duration");if(E>0){const L=l.exported.now(),N=(L-y.timeAdded)/E,C=o?(L-o.timeAdded)/E:-1,k=h.getSource(),V=v.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),Z=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(y.tileID.overscaledZ-V),W=Z&&y.refreshedUponExpiration?1:l.clamp(Z?N:1-C,0,1);return y.refreshedUponExpiration&&N>=1&&(y.refreshedUponExpiration=!1),o?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}const ph=new l.Color(1,0,0,1),Lu=new l.Color(0,1,0,1),Vl=new l.Color(0,0,1,1),yc=new l.Color(1,0,1,1),df=new l.Color(0,1,1,1);function bp(y,o,h,m){gh(y,0,o+h/2,y.transform.width,h,m)}function dh(y,o,h,m){gh(y,o-h/2,0,h,y.transform.height,m)}function gh(y,o,h,m,v,E){const L=y.context,N=L.gl;N.enable(N.SCISSOR_TEST),N.scissor(o*y.pixelRatio,h*y.pixelRatio,m*y.pixelRatio,v*y.pixelRatio),L.clear({color:E}),N.disable(N.SCISSOR_TEST)}function wp(y,o,h){const m=y.context,v=m.gl,E=h.posMatrix,L=y.useProgram("debug"),N=nr.disabled,C=wr.disabled,k=y.colorModeForRenderPass(),V="$debug";m.activeTexture.set(v.TEXTURE0),y.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),L.draw(m,v.LINE_STRIP,N,C,k,Er.disabled,ll(E,l.Color.red),V,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments);const Z=o.getTileByID(h.key).latestRawTileData,W=Math.floor((Z&&Z.byteLength||0)/1024),ot=o.getTile(h).tileSize,J=512/Math.min(ot,512)*(h.overscaledZ/y.transform.zoom)*.5;let it=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(it+=` => ${h.overscaledZ}`),function(mt,yt){mt.initDebugOverlayCanvas();const Tt=mt.debugOverlayCanvas,bt=mt.context.gl,Kt=mt.debugOverlayCanvas.getContext("2d");Kt.clearRect(0,0,Tt.width,Tt.height),Kt.shadowColor="white",Kt.shadowBlur=2,Kt.lineWidth=1.5,Kt.strokeStyle="white",Kt.textBaseline="top",Kt.font="bold 36px Open Sans, sans-serif",Kt.fillText(yt,5,5),Kt.strokeText(yt,5,5),mt.debugOverlayTexture.update(Tt),mt.debugOverlayTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE)}(y,`${it} ${W}kb`),L.draw(m,v.TRIANGLES,N,C,ln.alphaBlended,Er.disabled,ll(E,l.Color.transparent,J),V,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments)}const fa={symbol:function(y,o,h,m,v){if(y.renderPass!=="translucent")return;const E=wr.disabled,L=y.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(N,C,k,V,Z,W,ot){const J=C.transform,it=Z==="map",mt=W==="map";for(const yt of N){const Tt=V.getTile(yt),bt=Tt.getBucket(k);if(!bt||!bt.text||!bt.text.segments.get().length)continue;const Kt=l.evaluateSizeForZoom(bt.textSizeData,J.zoom),Ut=Qr(Tt,1,C.transform.zoom),kt=Qn(yt.posMatrix,mt,it,C.transform,Ut),se=k.layout.get("icon-text-fit")!=="none"&&bt.hasIconData();if(Kt){const me=Math.pow(2,J.zoom-Tt.tileID.overscaledZ);Au(bt,it,mt,ot,J,kt,yt.posMatrix,me,Kt,se)}}}(m,y,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),v),h.paint.get("icon-opacity").constantOr(1)!==0&&mc(y,o,h,m,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),E,L),h.paint.get("text-opacity").constantOr(1)!==0&&mc(y,o,h,m,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),E,L),o.map.showCollisionBoxes&&(pf(y,o,h,m,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),pf(y,o,h,m,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(y,o,h,m){if(y.renderPass!=="translucent")return;const v=h.paint.get("circle-opacity"),E=h.paint.get("circle-stroke-width"),L=h.paint.get("circle-stroke-opacity"),N=!h.layout.get("circle-sort-key").isConstant();if(v.constantOr(1)===0&&(E.constantOr(1)===0||L.constantOr(1)===0))return;const C=y.context,k=C.gl,V=y.depthModeForSublayer(0,nr.ReadOnly),Z=wr.disabled,W=y.colorModeForRenderPass(),ot=[];for(let J=0;J<m.length;J++){const it=m[J],mt=o.getTile(it),yt=mt.getBucket(h);if(!yt)continue;const Tt=yt.programConfigurations.get(h.id),bt={programConfiguration:Tt,program:y.useProgram("circle",Tt),layoutVertexBuffer:yt.layoutVertexBuffer,indexBuffer:yt.indexBuffer,uniformValues:is(y,it,mt,h)};if(N){const Kt=yt.segments.get();for(const Ut of Kt)ot.push({segments:new l.SegmentVector([Ut]),sortKey:Ut.sortKey,state:bt})}else ot.push({segments:yt.segments,sortKey:0,state:bt})}N&&ot.sort((J,it)=>J.sortKey-it.sortKey);for(const J of ot){const{programConfiguration:it,program:mt,layoutVertexBuffer:yt,indexBuffer:Tt,uniformValues:bt}=J.state;mt.draw(C,k.TRIANGLES,V,Z,W,Er.disabled,bt,h.id,yt,Tt,J.segments,h.paint,y.transform.zoom,it)}},heatmap:function(y,o,h,m){if(h.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const v=y.context,E=v.gl,L=wr.disabled,N=new ln([E.ONE,E.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(C,k,V){const Z=C.gl;C.activeTexture.set(Z.TEXTURE1),C.viewport.set([0,0,k.width/4,k.height/4]);let W=V.heatmapFbo;if(W)Z.bindTexture(Z.TEXTURE_2D,W.colorAttachment.get()),C.bindFramebuffer.set(W.framebuffer);else{const ot=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,ot),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),W=V.heatmapFbo=C.createFramebuffer(k.width/4,k.height/4,!1),function(J,it,mt,yt){const Tt=J.gl;Tt.texImage2D(Tt.TEXTURE_2D,0,Tt.RGBA,it.width/4,it.height/4,0,Tt.RGBA,J.extRenderToTextureHalfFloat?J.extTextureHalfFloat.HALF_FLOAT_OES:Tt.UNSIGNED_BYTE,null),yt.colorAttachment.set(mt)}(C,k,ot,W)}})(v,y,h),v.clear({color:l.Color.transparent});for(let C=0;C<m.length;C++){const k=m[C];if(o.hasRenderableParent(k))continue;const V=o.getTile(k),Z=V.getBucket(h);if(!Z)continue;const W=Z.programConfigurations.get(h.id),ot=y.useProgram("heatmap",W),{zoom:J}=y.transform;ot.draw(v,E.TRIANGLES,nr.disabled,L,N,Er.disabled,uc(k.posMatrix,V,J,h.paint.get("heatmap-intensity")),h.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,h.paint,y.transform.zoom,W)}v.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(v,E){const L=v.context,N=L.gl,C=E.heatmapFbo;if(!C)return;L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,C.colorAttachment.get()),L.activeTexture.set(N.TEXTURE1);let k=E.colorRampTexture;k||(k=E.colorRampTexture=new xt(L,E.colorRamp,N.RGBA)),k.bind(N.LINEAR,N.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(L,N.TRIANGLES,nr.disabled,wr.disabled,v.colorModeForRenderPass(),Er.disabled,((V,Z,W,ot)=>{const J=l.create();l.ortho(J,0,V.width,V.height,0,0,1);const it=V.context.gl;return{u_matrix:J,u_world:[it.drawingBufferWidth,it.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}})(v,E),E.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,E.paint,v.transform.zoom)}(y,h))},line:function(y,o,h,m){if(y.renderPass!=="translucent")return;const v=h.paint.get("line-opacity"),E=h.paint.get("line-width");if(v.constantOr(1)===0||E.constantOr(1)===0)return;const L=y.depthModeForSublayer(0,nr.ReadOnly),N=y.colorModeForRenderPass(),C=h.paint.get("line-dasharray"),k=h.paint.get("line-pattern"),V=k.constantOr(1),Z=h.paint.get("line-gradient"),W=h.getCrossfadeParameters(),ot=V?"linePattern":C?"lineSDF":Z?"lineGradient":"line",J=y.context,it=J.gl;let mt=!0;for(const yt of m){const Tt=o.getTile(yt);if(V&&!Tt.patternsLoaded())continue;const bt=Tt.getBucket(h);if(!bt)continue;const Kt=bt.programConfigurations.get(h.id),Ut=y.context.program.get(),kt=y.useProgram(ot,Kt),se=mt||kt.program!==Ut,me=k.constantOr(null);if(me&&Tt.imageAtlas){const Re=Tt.imageAtlas,Ie=Re.patternPositions[me.to.toString()],We=Re.patternPositions[me.from.toString()];Ie&&We&&Kt.setConstantPatternPositions(Ie,We)}const Ht=V?Cu(y,Tt,h,W):C?li(y,Tt,h,C,W):Z?fc(y,Tt,h,bt.lineClipsArray.length):hc(y,Tt,h);if(V)J.activeTexture.set(it.TEXTURE0),Tt.imageAtlasTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE),Kt.updatePaintBuffers(W);else if(C&&(se||y.lineAtlas.dirty))J.activeTexture.set(it.TEXTURE0),y.lineAtlas.bind(J);else if(Z){const Re=bt.gradients[h.id];let Ie=Re.texture;if(h.gradientVersion!==Re.version){let We=256;if(h.stepInterpolant){const Nn=o.getSource().maxzoom,En=yt.canonical.z===Nn?Math.ceil(1<<y.transform.maxZoom-yt.canonical.z):1;We=l.clamp(l.nextPowerOfTwo(bt.maxLineLength/l.EXTENT*1024*En),256,J.maxTextureSize)}Re.gradient=l.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:We,image:Re.gradient||void 0,clips:bt.lineClipsArray}),Re.texture?Re.texture.update(Re.gradient):Re.texture=new xt(J,Re.gradient,it.RGBA),Re.version=h.gradientVersion,Ie=Re.texture}J.activeTexture.set(it.TEXTURE0),Ie.bind(h.stepInterpolant?it.NEAREST:it.LINEAR,it.CLAMP_TO_EDGE)}kt.draw(J,it.TRIANGLES,L,y.stencilModeForClipping(yt),N,Er.disabled,Ht,h.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,h.paint,y.transform.zoom,Kt,bt.layoutVertexBuffer2),mt=!1}},fill:function(y,o,h,m){const v=h.paint.get("fill-color"),E=h.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const L=y.colorModeForRenderPass(),N=h.paint.get("fill-pattern"),C=y.opaquePassEnabledForLayer()&&!N.constantOr(1)&&v.constantOr(l.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===C){const k=y.depthModeForSublayer(1,y.renderPass==="opaque"?nr.ReadWrite:nr.ReadOnly);_c(y,o,h,m,k,L,!1)}if(y.renderPass==="translucent"&&h.paint.get("fill-antialias")){const k=y.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,nr.ReadOnly);_c(y,o,h,m,k,L,!0)}},"fill-extrusion":function(y,o,h,m){const v=h.paint.get("fill-extrusion-opacity");if(v!==0&&y.renderPass==="translucent"){const E=new nr(y.context.gl.LEQUAL,nr.ReadWrite,y.depthRangeFor3D);if(v!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))ul(y,o,h,m,E,wr.disabled,ln.disabled),ul(y,o,h,m,E,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const L=y.colorModeForRenderPass();ul(y,o,h,m,E,wr.disabled,L)}}},hillshade:function(y,o,h,m){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const v=y.context,E=y.depthModeForSublayer(0,nr.ReadOnly),L=y.colorModeForRenderPass(),[N,C]=y.renderPass==="translucent"?y.stencilConfigForOverlap(m):[{},m];for(const k of C){const V=o.getTile(k);V.needsHillshadePrepare&&y.renderPass==="offscreen"?Ss(y,V,h,E,wr.disabled,L):y.renderPass==="translucent"&&fh(y,V,h,E,N[k.overscaledZ],L)}v.viewport.set([0,0,y.width,y.height])},raster:function(y,o,h,m){if(y.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!m.length)return;const v=y.context,E=v.gl,L=o.getSource(),N=y.useProgram("raster"),C=y.colorModeForRenderPass(),[k,V]=L instanceof Nr?[{},m]:y.stencilConfigForOverlap(m),Z=V[V.length-1].overscaledZ,W=!y.options.moving;for(const ot of V){const J=y.depthModeForSublayer(ot.overscaledZ-Z,h.paint.get("raster-opacity")===1?nr.ReadWrite:nr.ReadOnly,E.LESS),it=o.getTile(ot),mt=y.transform.calculatePosMatrix(ot.toUnwrapped(),W);it.registerFadeDuration(h.paint.get("raster-fade-duration"));const yt=o.findLoadedParent(ot,0),Tt=zo(it,yt,o,h,y.transform);let bt,Kt;const Ut=h.paint.get("raster-resampling")==="nearest"?E.NEAREST:E.LINEAR;v.activeTexture.set(E.TEXTURE0),it.texture.bind(Ut,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),v.activeTexture.set(E.TEXTURE1),yt?(yt.texture.bind(Ut,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),bt=Math.pow(2,yt.tileID.overscaledZ-it.tileID.overscaledZ),Kt=[it.tileID.canonical.x*bt%1,it.tileID.canonical.y*bt%1]):it.texture.bind(Ut,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST);const kt=up(mt,Kt||[0,0],bt||1,Tt,h);L instanceof Nr?N.draw(v,E.TRIANGLES,J,wr.disabled,C,Er.disabled,kt,h.id,L.boundsBuffer,y.quadTriangleIndexBuffer,L.boundsSegments):N.draw(v,E.TRIANGLES,J,k[ot.overscaledZ],C,Er.disabled,kt,h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,o,h){const m=h.paint.get("background-color"),v=h.paint.get("background-opacity");if(v===0)return;const E=y.context,L=E.gl,N=y.transform,C=N.tileSize,k=h.paint.get("background-pattern");if(y.isPatternMissing(k))return;const V=!k&&m.a===1&&v===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==V)return;const Z=wr.disabled,W=y.depthModeForSublayer(0,V==="opaque"?nr.ReadWrite:nr.ReadOnly),ot=y.colorModeForRenderPass(),J=y.useProgram(k?"backgroundPattern":"background"),it=N.coveringTiles({tileSize:C});k&&(E.activeTexture.set(L.TEXTURE0),y.imageManager.bind(y.context));const mt=h.getCrossfadeParameters();for(const yt of it){const Tt=y.transform.calculatePosMatrix(yt.toUnwrapped()),bt=k?rf(Tt,v,y,k,{tileID:yt,tileSize:C},mt):tg(Tt,v,m);J.draw(E,L.TRIANGLES,W,Z,ot,Er.disabled,bt,h.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}},debug:function(y,o,h){for(let m=0;m<h.length;m++)wp(y,o,h[m])},custom:function(y,o,h){const m=y.context,v=h.implementation;if(y.renderPass==="offscreen"){const E=v.prerender;E&&(y.setCustomLayerDefaults(),m.setColorMode(y.colorModeForRenderPass()),E.call(v,m.gl,y.transform.customLayerMatrix()),m.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),m.setColorMode(y.colorModeForRenderPass()),m.setStencilMode(wr.disabled);const E=v.renderingMode==="3d"?new nr(y.context.gl.LEQUAL,nr.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,nr.ReadOnly);m.setDepthMode(E),v.render(m.gl,y.transform.customLayerMatrix()),m.setDirty(),y.setBaseState(),m.bindFramebuffer.set(null)}}};class gf{constructor(o,h){this.context=new lh(o),this.transform=h,this._tileTextures={},this.setup(),this.numSublayers=Kr.maxUnderzooming+Kr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new sn,this.gpuTimers={}}resize(o,h,m){if(this.width=o*m,this.height=h*m,this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const o=this.context,h=new l.PosArray;h.emplaceBack(0,0),h.emplaceBack(l.EXTENT,0),h.emplaceBack(0,l.EXTENT),h.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,Su.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const m=new l.PosArray;m.emplaceBack(0,0),m.emplaceBack(l.EXTENT,0),m.emplaceBack(0,l.EXTENT),m.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=o.createVertexBuffer(m,Su.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const v=new l.RasterBoundsArray;v.emplaceBack(0,0,0,0),v.emplaceBack(l.EXTENT,0,l.EXTENT,0),v.emplaceBack(0,l.EXTENT,0,l.EXTENT),v.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(v,oi.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const E=new l.PosArray;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(E,Su.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const L=new l.LineStripIndexArray;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(L);const N=new l.TriangleIndexArray;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(N),this.emptyTexture=new xt(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA);const C=this.context.gl;this.stencilClearMode=new wr({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=l.create();l.ortho(m,0,this.width,this.height,0,0,1),l.scale(m,m,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,h.TRIANGLES,nr.disabled,this.stencilClearMode,ln.disabled,Er.disabled,la(m),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,h){if(this.currentStencilSource===o.source||!o.isTileClipped()||!h||!h.length)return;this.currentStencilSource=o.source;const m=this.context,v=m.gl;this.nextStencilID+h.length>256&&this.clearStencil(),m.setColorMode(ln.disabled),m.setDepthMode(nr.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of h){const N=this._tileClippingMaskIDs[L.key]=this.nextStencilID++;E.draw(m,v.TRIANGLES,nr.disabled,new wr({func:v.ALWAYS,mask:0},N,255,v.KEEP,v.KEEP,v.REPLACE),ln.disabled,Er.disabled,la(L.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new wr({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){const h=this.context.gl;return new wr({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,m=o.sort((L,N)=>N.overscaledZ-L.overscaledZ),v=m[m.length-1].overscaledZ,E=m[0].overscaledZ-v+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const L={};for(let N=0;N<E;N++)L[N+v]=new wr({func:h.GEQUAL,mask:255},N+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=E,[L,m]}return[{[v]:wr.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new ln([o.CONSTANT_COLOR,o.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ln.unblended:ln.alphaBlended}depthModeForSublayer(o,h,m){if(!this.opaquePassEnabledForLayer())return nr.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new nr(m||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const m=this.style._order,v=this.style.sourceCaches;for(const C in v){const k=v[C];k.used&&k.prepare(this.context)}const E={},L={},N={};for(const C in v){const k=v[C];E[C]=k.getVisibleCoordinates(),L[C]=E[C].slice().reverse(),N[C]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<m.length;C++)if(this.style._layers[m[C]].is3D()){this.opaquePassCutoff=C;break}this.renderPass="offscreen";for(const C of m){const k=this.style._layers[C];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const V=L[k.source];(k.type==="custom"||V.length)&&this.renderLayer(this,v[k.source],k,V)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[m[this.currentLayer]],k=v[C.source],V=E[C.source];this._renderTileClippingMasks(C,V),this.renderLayer(this,k,C,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const C=this.style._layers[m[this.currentLayer]],k=v[C.source],V=(C.type==="symbol"?N:L)[C.source];this._renderTileClippingMasks(C,E[C.source]),this.renderLayer(this,k,C,V)}if(this.options.showTileBoundaries){let C,k;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(k&&k.id)&&(k=this.style.sourceCaches[V.source]),(!C||C.getSource().maxzoom<k.getSource().maxzoom)&&(C=k))}),C&&fa.debug(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const k=C.transform.padding;bp(C,C.transform.height-(k.top||0),3,ph),bp(C,k.bottom||0,3,Lu),dh(C,k.left||0,3,Vl),dh(C,C.transform.width-(k.right||0),3,yc);const V=C.transform.centerPoint;(function(Z,W,ot,J){gh(Z,W-1,ot-10,2,20,J),gh(Z,W-10,ot-1,20,2,J)})(C,V.x,C.transform.height-V.y,df)}(this),this.context.setDefault()}renderLayer(o,h,m,v){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||v.length)&&(this.id=m.id,this.gpuTimingStart(m),fa[m.type](o,h,m,v,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let m=this.gpuTimers[o.id];m||(m=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),m.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,m.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const h={};for(const m in o){const v=o[m],E=this.context.extTimerQuery,L=E.getQueryObjectEXT(v.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(v.query),h[m]=L}return h}translatePosMatrix(o,h,m,v,E){if(!m[0]&&!m[1])return o;const L=E?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(L){const k=Math.sin(L),V=Math.cos(L);m=[m[0]*V-m[1]*k,m[0]*k+m[1]*V]}const N=[E?m[0]:Qr(h,m[0],this.transform.zoom),E?m[1]:Qr(h,m[1],this.transform.zoom),0],C=new Float32Array(16);return l.translate(C,o,N),C}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const h=this.imageManager.getPattern(o.from.toString()),m=this.imageManager.getPattern(o.to.toString());return!h||!m}useProgram(o,h){this.cache=this.cache||{};const m=`${o}${h?h.cacheKey:""}${this._showOverdrawInspector?"/overdraw":""}`;return this.cache[m]||(this.cache[m]=new Ai(this.context,o,lt[o],h,dc[o],this._showOverdrawInspector)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class mh{constructor(o,h){this.points=o,this.planes=h}static fromInvProjectionMatrix(o,h,m){const v=Math.pow(2,m),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>l.transformMat4([],N,o)).map(N=>l.scale$1([],N,1/N[3]/h*v)),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const C=function(W,ot){var J=ot[0],it=ot[1],mt=ot[2],yt=J*J+it*it+mt*mt;return yt>0&&(yt=1/Math.sqrt(yt)),W[0]=ot[0]*yt,W[1]=ot[1]*yt,W[2]=ot[2]*yt,W}([],function(W,ot,J){var it=ot[0],mt=ot[1],yt=ot[2],Tt=J[0],bt=J[1],Kt=J[2];return W[0]=mt*Kt-yt*bt,W[1]=yt*Tt-it*Kt,W[2]=it*bt-mt*Tt,W}([],rt([],E[N[0]],E[N[1]]),rt([],E[N[2]],E[N[1]]))),k=-((V=C)[0]*(Z=E[N[1]])[0]+V[1]*Z[1]+V[2]*Z[2]);var V,Z;return C.concat(k)});return new mh(E,L)}}class Mu{constructor(o,h){this.min=o,this.max=h,this.center=function(m,v,E){return m[0]=.5*v[0],m[1]=.5*v[1],m[2]=.5*v[2],m}([],function(m,v,E){return m[0]=v[0]+E[0],m[1]=v[1]+E[1],m[2]=v[2]+E[2],m}([],this.min,this.max))}quadrant(o){const h=[o%2==0,o<2],m=et(this.min),v=et(this.max);for(let E=0;E<h.length;E++)m[E]=h[E]?this.min[E]:this.center[E],v[E]=h[E]?this.center[E]:this.max[E];return v[2]=this.max[2],new Mu(m,v)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const h=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];let m=!0;for(let v=0;v<o.planes.length;v++){const E=o.planes[v];let L=0;for(let N=0;N<h.length;N++)l.dot(E,h[N])>=0&&L++;if(L===0)return 0;L!==h.length&&(m=!1)}if(m)return 2;for(let v=0;v<3;v++){let E=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let N=0;N<o.points.length;N++){const C=o.points[N][v]-this.min[v];E=Math.min(E,C),L=Math.max(L,C)}if(L<0||E>this.max[v]-this.min[v])return 0}return 1}}class Gl{constructor(o=0,h=0,m=0,v=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=m,this.right=v}interpolate(o,h,m){return h.top!=null&&o.top!=null&&(this.top=l.number(o.top,h.top,m)),h.bottom!=null&&o.bottom!=null&&(this.bottom=l.number(o.bottom,h.bottom,m)),h.left!=null&&o.left!=null&&(this.left=l.number(o.left,h.left,m)),h.right!=null&&o.right!=null&&(this.right=l.number(o.right,h.right,m)),this}getCenter(o,h){const m=l.clamp((this.left+o-this.right)/2,0,o),v=l.clamp((this.top+h-this.bottom)/2,0,h);return new l.pointGeometry(m,v)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Gl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Cs{constructor(o,h,m,v,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=E===void 0||!!E,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=m==null?0:m,this._maxPitch=v==null?60:v,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Gl,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const o=new Cs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.tileSize=this.tileSize,o.latRange=this.latRange,o.width=this.width,o.height=this.height,o._center=this._center,o.zoom=this.zoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const h=-l.wrap(o,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=function(){var m=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}(),function(m,v,E){var L=v[0],N=v[1],C=v[2],k=v[3],V=Math.sin(E),Z=Math.cos(E);m[0]=L*Z+C*V,m[1]=N*Z+k*V,m[2]=L*-V+C*Z,m[3]=N*-V+k*Z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=l.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,m){this._unmodified=!1,this._edgeInsets.interpolate(o,h,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new l.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const m=this.pointCoordinate(new l.pointGeometry(0,0)),v=this.pointCoordinate(new l.pointGeometry(this.width,0)),E=this.pointCoordinate(new l.pointGeometry(this.width,this.height)),L=this.pointCoordinate(new l.pointGeometry(0,this.height)),N=Math.floor(Math.min(m.x,v.x,E.x,L.x)),C=Math.floor(Math.max(m.x,v.x,E.x,L.x)),k=1;for(let V=N-k;V<=C+k;V++)V!==0&&h.push(new l.UnwrappedTileID(V,o))}return h}coveringTiles(o){let h=this.coveringZoomLevel(o);const m=h;if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const v=l.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,h),L=[E*v.x,E*v.y,0],N=mh.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let C=o.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(C=h);const k=J=>({aabb:new Mu([J*E,0,0],[(J+1)*E,E,0]),zoom:0,x:0,y:0,wrap:J,fullyVisible:!1}),V=[],Z=[],W=h,ot=o.reparseOverscaled?m:h;if(this._renderWorldCopies)for(let J=1;J<=3;J++)V.push(k(-J)),V.push(k(J));for(V.push(k(0));V.length>0;){const J=V.pop(),it=J.x,mt=J.y;let yt=J.fullyVisible;if(!yt){const kt=J.aabb.intersects(N);if(kt===0)continue;yt=kt===2}const Tt=J.aabb.distanceX(L),bt=J.aabb.distanceY(L),Kt=Math.max(Math.abs(Tt),Math.abs(bt)),Ut=3+(1<<W-J.zoom)-2;if(J.zoom===W||Kt>Ut&&J.zoom>=C)Z.push({tileID:new l.OverscaledTileID(J.zoom===W?ot:J.zoom,J.wrap,J.zoom,it,mt),distanceSq:wt([L[0]-.5-it,L[1]-.5-mt])});else for(let kt=0;kt<4;kt++){const se=(it<<1)+kt%2,me=(mt<<1)+(kt>>1);V.push({aabb:J.aabb.quadrant(kt),zoom:J.zoom+1,x:se,y:me,wrap:J.wrap,fullyVisible:yt})}}return Z.sort((J,it)=>J.distanceSq-it.distanceSq).map(J=>J.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=l.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.pointGeometry(l.mercatorXfromLng(o.lng)*this.worldSize,l.mercatorYfromLat(h)*this.worldSize)}unproject(o){return new l.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(o,h){const m=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(o),L=new l.MercatorCoordinate(E.x-(m.x-v.x),E.y-(m.y-v.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o){return this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}locationCoordinate(o){return l.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o.toLngLat()}pointCoordinate(o){const h=[o.x,o.y,0,1],m=[o.x,o.y,1,1];l.transformMat4(h,h,this.pixelMatrixInverse),l.transformMat4(m,m,this.pixelMatrixInverse);const v=h[3],E=m[3],L=h[1]/v,N=m[1]/E,C=h[2]/v,k=m[2]/E,V=C===k?0:(0-C)/(k-C);return new l.MercatorCoordinate(l.number(h[0]/v,m[0]/E,V)/this.worldSize,l.number(L,N,V)/this.worldSize)}coordinatePoint(o){const h=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.transformMat4(h,h,this.pixelMatrix),new l.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){return new l.LngLatBounds().extend(this.pointLocation(new l.pointGeometry(0,0))).extend(this.pointLocation(new l.pointGeometry(this.width,0))).extend(this.pointLocation(new l.pointGeometry(this.width,this.height))).extend(this.pointLocation(new l.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,h=!1){const m=o.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[m])return v[m];const E=o.canonical,L=this.worldSize/this.zoomScale(E.z),N=E.x+Math.pow(2,E.z)*o.wrap,C=l.identity(new Float64Array(16));return l.translate(C,C,[N*L,E.y*L,0]),l.scale(C,C,[L/l.EXTENT,L/l.EXTENT,1]),l.multiply(C,h?this.alignedProjMatrix:this.projMatrix,C),v[m]=new Float32Array(C),v[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,h,m,v,E=-90,L=90,N=-180,C=180;const k=this.size,V=this._unmodified;if(this.latRange){const ot=this.latRange;E=l.mercatorYfromLat(ot[1])*this.worldSize,L=l.mercatorYfromLat(ot[0])*this.worldSize,o=L-E<k.y?k.y/(L-E):0}if(this.lngRange){const ot=this.lngRange;N=l.mercatorXfromLng(ot[0])*this.worldSize,C=l.mercatorXfromLng(ot[1])*this.worldSize,h=C-N<k.x?k.x/(C-N):0}const Z=this.point,W=Math.max(h||0,o||0);if(W)return this.center=this.unproject(new l.pointGeometry(h?(C+N)/2:Z.x,o?(L+E)/2:Z.y)),this.zoom+=this.scaleZoom(W),this._unmodified=V,void(this._constraining=!1);if(this.latRange){const ot=Z.y,J=k.y/2;ot-J<E&&(v=E+J),ot+J>L&&(v=L-J)}if(this.lngRange){const ot=Z.x,J=k.x/2;ot-J<N&&(m=N+J),ot+J>C&&(m=C-J)}m===void 0&&v===void 0||(this.center=this.unproject(new l.pointGeometry(m!==void 0?m:Z.x,v!==void 0?v:Z.y))),this._unmodified=V,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const h=Math.PI/2+this._pitch,m=this._fov*(.5+o.y/this.height),v=Math.sin(m)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-h-m,.01,Math.PI-.01)),E=this.point,L=E.x,N=E.y,C=1.01*(Math.cos(Math.PI/2-this._pitch)*v+this.cameraToCenterDistance),k=this.height/50;let V=new Float64Array(16);l.perspective(V,this._fov,this.width/this.height,k,C),V[8]=2*-o.x/this.width,V[9]=2*o.y/this.height,l.scale(V,V,[1,-1,1]),l.translate(V,V,[0,0,-this.cameraToCenterDistance]),l.rotateX(V,V,this._pitch),l.rotateZ(V,V,this.angle),l.translate(V,V,[-L,-N,0]),this.mercatorMatrix=l.scale([],V,[this.worldSize,this.worldSize,this.worldSize]),l.scale(V,V,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize]),this.projMatrix=V,this.invProjMatrix=l.invert([],this.projMatrix);const Z=this.width%2/2,W=this.height%2/2,ot=Math.cos(this.angle),J=Math.sin(this.angle),it=L-Math.round(L)+ot*Z+J*W,mt=N-Math.round(N)+ot*W+J*Z,yt=new Float64Array(V);if(l.translate(yt,yt,[it>.5?it-1:it,mt>.5?mt-1:mt,0]),this.alignedProjMatrix=yt,V=l.create(),l.scale(V,V,[this.width/2,-this.height/2,1]),l.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=l.create(),l.scale(V,V,[1,-1,1]),l.translate(V,V,[-1,-1,0]),l.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),V=l.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");this.pixelMatrixInverse=V,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new l.pointGeometry(0,0)),h=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.transformMat4(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.pointGeometry(0,o))}getCameraQueryGeometry(o){const h=this.getCameraPoint();if(o.length===1)return[o[0],h];{let m=h.x,v=h.y,E=h.x,L=h.y;for(const N of o)m=Math.min(m,N.x),v=Math.min(v,N.y),E=Math.max(E,N.x),L=Math.max(L,N.y);return[new l.pointGeometry(m,v),new l.pointGeometry(E,v),new l.pointGeometry(E,L),new l.pointGeometry(m,L),new l.pointGeometry(m,v)]}}}class vc{constructor(o){this._hashName=o&&encodeURIComponent(o),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(h,m){let v=!1,E=null;const L=()=>{E=null,v&&(h(),E=setTimeout(L,300),v=!1)};return()=>(v=!0,E||L(),E)}(this._updateHashUnthrottled.bind(this))}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const h=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,v),L=Math.round(h.lng*E)/E,N=Math.round(h.lat*E)/E,C=this._map.getBearing(),k=this._map.getPitch();let V="";if(V+=o?`/${L}/${N}/${m}`:`${m}/${N}/${L}`,(C||k)&&(V+="/"+Math.round(10*C)/10),k&&(V+=`/${Math.round(k)}`),this._hashName){const Z=this._hashName;let W=!1;const ot=window.location.hash.slice(1).split("&").map(J=>{const it=J.split("=")[0];return it===Z?(W=!0,`${it}=${V}`):J}).filter(J=>J);return W||ot.push(`${Z}=${V}`),`#${ot.join("&")}`}return`#${V}`}_getCurrentHash(){const o=window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(h=m)}),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:h,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}}}const xc={linearity:.3,easing:l.bezier(0,0,.3,1)},Ip=l.extend({deceleration:2500,maxSpeed:1400},xc),Ep=l.extend({deceleration:20,maxSpeed:1400},xc),ql=l.extend({deceleration:1e3,maxSpeed:360},xc),oo=l.extend({deceleration:1e3,maxSpeed:90},xc);class mf{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=l.exported.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new l.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)h.zoom+=E.zoomDelta||0,h.bearing+=E.bearingDelta||0,h.pitch+=E.pitchDelta||0,E.panDelta&&h.pan._add(E.panDelta),E.around&&(h.around=E.around),E.pinchAround&&(h.pinchAround=E.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const E=wc(h.pan.mag(),m,l.extend({},Ip,o||{}));v.offset=h.pan.mult(E.amount/h.pan.mag()),v.center=this._map.transform.center,bc(v,E)}if(h.zoom){const E=wc(h.zoom,m,Ep);v.zoom=this._map.transform.zoom+E.amount,bc(v,E)}if(h.bearing){const E=wc(h.bearing,m,ql);v.bearing=this._map.transform.bearing+l.clamp(E.amount,-179,179),bc(v,E)}if(h.pitch){const E=wc(h.pitch,m,oo);v.pitch=this._map.transform.pitch+E.amount,bc(v,E)}if(v.zoom||v.bearing){const E=h.pinchAround===void 0?h.around:h.pinchAround;v.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),l.extend(v,{noMoveStart:!0})}}function bc(y,o){(!y.duration||y.duration<o.duration)&&(y.duration=o.duration,y.easing=o.easing)}function wc(y,o,h){const{maxSpeed:m,linearity:v,deceleration:E}=h,L=l.clamp(y*v/(o/1e3),-m,m),N=Math.abs(L)/(E*v);return{easing:h.easing,duration:1e3*N,amount:L*(N/2)}}class as extends l.Event{constructor(o,h,m,v={}){const E=D.mousePos(h.getCanvasContainer(),m),L=h.unproject(E);super(o,l.extend({point:E,lngLat:L,originalEvent:m},v)),this._defaultPrevented=!1,this.target=h}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Oo extends l.Event{constructor(o,h,m){const v=o==="touchend"?m.changedTouches:m.touches,E=D.touchPos(h.getCanvasContainer(),v),L=E.map(C=>h.unproject(C)),N=E.reduce((C,k,V,Z)=>C.add(k.div(Z.length)),new l.pointGeometry(0,0));super(o,{points:E,point:N,lngLats:L,lngLat:h.unproject(N),originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ng extends l.Event{constructor(o,h,m){super(o,{originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ts{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new ng(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new as(o.type,this._map,o))}mouseup(o){this._map.fire(new as(o.type,this._map,o))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new as(o.type,this._map,o))}dblclick(o){return this._firePreventable(new as(o.type,this._map,o))}mouseover(o){this._map.fire(new as(o.type,this._map,o))}mouseout(o){this._map.fire(new as(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Oo(o.type,this._map,o))}touchmove(o){this._map.fire(new Oo(o.type,this._map,o))}touchend(o){this._map.fire(new Oo(o.type,this._map,o))}touchcancel(o){this._map.fire(new Oo(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Et{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(o){this._map.fire(new as(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new as("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new as(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jt{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(D.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const m=h;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=m,this._box||(this._box=D.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const E=Math.min(v.x,m.x),L=Math.max(v.x,m.x),N=Math.min(v.y,m.y),C=Math.max(v.y,m.y);D.setTransform(this._box,`translate(${E}px,${N}px)`),this._box.style.width=L-E+"px",this._box.style.height=C-N+"px"}mouseupWindow(o,h){if(!this._active||o.button!==0)return;const m=this._startPos,v=h;if(this.reset(),D.suppressClick(),m.x!==v.x||m.y!==v.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:E=>E.fitScreenCoordinates(m,v,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new l.Event(o,{originalEvent:h}))}}function Nt(y,o){const h={};for(let m=0;m<y.length;m++)h[y[m].identifier]=o[m];return h}class Fe{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,h,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const E=new l.pointGeometry(0,0);for(const L of v)E._add(L);return E.div(v.length)}(h),this.touches=Nt(m,h)))}touchmove(o,h,m){if(this.aborted||!this.centroid)return;const v=Nt(m,h);for(const E in this.touches){const L=this.touches[E],N=v[E];(!N||N.dist(L)>30)&&(this.aborted=!0)}}touchend(o,h,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class mn{constructor(o){this.singleTap=new Fe(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,h,m){this.singleTap.touchstart(o,h,m)}touchmove(o,h,m){this.singleTap.touchmove(o,h,m)}touchend(o,h,m){const v=this.singleTap.touchend(o,h,m);if(v){const E=o.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(v)<30;if(E&&L||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class rr{constructor(){this._zoomIn=new mn({numTouches:1,numTaps:2}),this._zoomOut=new mn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,m){this._zoomIn.touchstart(o,h,m),this._zoomOut.touchstart(o,h,m)}touchmove(o,h,m){this._zoomIn.touchmove(o,h,m),this._zoomOut.touchmove(o,h,m)}touchend(o,h,m){const v=this._zoomIn.touchend(o,h,m),E=this._zoomOut.touchend(o,h,m);return v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(v)},{originalEvent:o})}):E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(E)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const gi={0:1,2:2};class Yn{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const m=D.mouseButton(o);this._correctButton(o,m)&&(this._lastPoint=h,this._eventButton=m)}mousemoveWindow(o,h){const m=this._lastPoint;if(m){if(o.preventDefault(),function(v,E){const L=gi[E];return v.buttons===void 0||(v.buttons&L)!==L}(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(m,h)}}mouseupWindow(o){this._lastPoint&&D.mouseButton(o)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cl extends Yn{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Ne extends Yn{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const m=.8*(h.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){o.preventDefault()}}class ko extends Yn{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const m=-.5*(h.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){o.preventDefault()}}class hl{constructor(o){this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.pointGeometry(0,0)}touchstart(o,h,m){return this._calculateTransform(o,h,m)}touchmove(o,h,m){if(this._active&&!(m.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,h,m)}touchend(o,h,m){this._calculateTransform(o,h,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,m){m.length>0&&(this._active=!0);const v=Nt(m,h),E=new l.pointGeometry(0,0),L=new l.pointGeometry(0,0);let N=0;for(const k in v){const V=v[k],Z=this._touches[k];Z&&(E._add(V),L._add(V.sub(Z)),N++,v[k]=V)}if(this._touches=v,N<this._minTouches||!L.mag())return;const C=L.div(N);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(N),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,h,m){return{}}touchstart(o,h,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,m){if(!this._firstTwoTouches)return;o.preventDefault();const[v,E]=this._firstTwoTouches,L=pa(m,h,v),N=pa(m,h,E);if(!L||!N)return;const C=this._aroundCenter?null:L.add(N).div(2);return this._move([L,N],C,o)}touchend(o,h,m){if(!this._firstTwoTouches)return;const[v,E]=this._firstTwoTouches,L=pa(m,h,v),N=pa(m,h,E);L&&N||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function pa(y,o,h){for(let m=0;m<y.length;m++)if(y[m].identifier===h)return o[m]}function be(y,o){return Math.log(y/o)/Math.LN2}class Du extends Xl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(be(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:be(this._distance,m),pinchAround:h}}}function ur(y,o){return 180*y.angleWith(o)/Math.PI}class rg extends Xl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const m=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ur(this._vector,m),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,m=ur(o,this._startVector);return Math.abs(m)<h}}function Nu(y){return Math.abs(y.y)>Math.abs(y.x)}class Ic extends Xl{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(o){this._lastPoints=o,Nu(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,m){const v=o[0].sub(this._lastPoints[0]),E=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(v,E,m.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(v.y+E.y)/2*-.5}}gestureBeginsVertically(o,h,m){if(this._valid!==void 0)return this._valid;const v=o.mag()>=2,E=h.mag()>=2;if(!v&&!E)return;if(!v||!E)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const L=o.y>0==h.y>0;return Nu(o)&&Nu(h)&&L}}const Sp={panStep:100,bearingStep:15,pitchStep:10};class ig{constructor(){const o=Sp;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,m=0,v=0,E=0,L=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),E=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),E=1);break;case 38:o.shiftKey?v=1:(o.preventDefault(),L=-1);break;case 40:o.shiftKey?v=-1:(o.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:N=>{const C=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:og,zoom:h?Math.round(C)+h*(o.shiftKey?2:1):C,bearing:N.getBearing()+m*this._bearingStep,pitch:N.getPitch()+v*this._pitchStep,offset:[-E*this._panStep,-L*this._panStep],center:N.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function og(y){return y*(2-y)}const Zl=4.000244140625;class da{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=l.exported.now(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,h!==0&&h%Zl==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=D.mousePos(this._el,o);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(h)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Zl?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&C!==0&&(C=1/C);const k=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(k*C))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,m=this._startZoom,v=this._easing;let E,L=!1;if(this._type==="wheel"&&m&&v){const N=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),C=v(N);E=l.number(m,h,C),N<1?this._frameId||(this._frameId=!0):L=!0}else E=h,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:E-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=l.ease;if(this._prevEase){const m=this._prevEase,v=(l.exported.now()-m.start)/m.duration,E=m.easing(v+.01)-m.easing(v),L=.27/Math.sqrt(E*E+1e-4)*.01,N=Math.sqrt(.0729-L*L);h=l.bezier(L,N,.25,1)}return this._prevEase={start:l.exported.now(),duration:o,easing:h},h}reset(){this._active=!1}}class Ru{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _h{constructor(){this.reset()}reset(){this._active=!1}dblclick(o,h){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yi{constructor(){this._tap=new mn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,h,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=h[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,h,m))}touchmove(o,h,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=h[0],E=v.y-this._swipePoint.y;return this._swipePoint=v,o.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(o,h,m)}touchend(o,h,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(o,h,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ka{constructor(o,h,m){this._el=o,this._mousePan=h,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _f{constructor(o,h,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zu{constructor(o,h,m,v){this._el=o,this._touchZoom=h,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Yl=y=>y.zoom||y.drag||y.pitch||y.rotate;class Wl extends l.Event{}function ga(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class xo{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mf(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h),l.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,E,L]of this._listeners)D.addEventListener(v,E,v===document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[o,h,m]of this._listeners)D.removeEventListener(o,h,o===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(o){const h=this._map,m=h.getCanvasContainer();this._add("mapEvent",new Ts(h,o));const v=h.boxZoom=new jt(h,o);this._add("boxZoom",v);const E=new rr,L=new _h;h.doubleClickZoom=new Ru(L,E),this._add("tapZoom",E),this._add("clickZoom",L);const N=new Yi;this._add("tapDragZoom",N);const C=h.touchPitch=new Ic;this._add("touchPitch",C);const k=new Ne(o),V=new ko(o);h.dragRotate=new _f(o,k,V),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const Z=new cl(o),W=new hl(o);h.dragPan=new ka(m,Z,W),this._add("mousePan",Z),this._add("touchPan",W,["touchZoom","touchRotate"]);const ot=new rg,J=new Du;h.touchZoomRotate=new zu(m,J,ot,N),this._add("touchRotate",ot,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]);const it=h.scrollZoom=new da(h,this);this._add("scrollZoom",it,["mousePan"]);const mt=h.keyboard=new ig;this._add("keyboard",mt),this._add("blockableMapEvent",new Et(h));for(const yt of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[yt]&&h[yt].enable(o[yt])}_add(o,h,m){this._handlers.push({handlerName:o,handler:h,allowed:m}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Yl(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,h,m){for(const v in o)if(v!==m&&(!h||h.indexOf(v)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const m of o)this._el.contains(m.target)&&h.push(m);return h}handleEvent(o,h){if(o.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const m=o.type==="renderFrame"?void 0:o,v={needsRenderFrame:!1},E={},L={},N=o.touches,C=N?this._getMapTouches(N):void 0,k=C?D.touchPos(this._el,C):D.mousePos(this._el,o);for(const{handlerName:W,handler:ot,allowed:J}of this._handlers){if(!ot.isEnabled())continue;let it;this._blockedByActive(L,J,W)?ot.reset():ot[h||o.type]&&(it=ot[h||o.type](o,k,C),this.mergeHandlerResult(v,E,it,W,m),it&&it.needsRenderFrame&&this._triggerRenderFrame()),(it||ot.isActive())&&(L[W]=ot)}const V={};for(const W in this._previousActiveHandlers)L[W]||(V[W]=m);this._previousActiveHandlers=L,(Object.keys(V).length||ga(v))&&(this._changes.push([v,E,V]),this._triggerRenderFrame()),(Object.keys(L).length||ga(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=v;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(o,h,m,v,E){if(!m)return;l.extend(o,m);const L={handlerName:v,originalEvent:m.originalEvent||E};m.zoomDelta!==void 0&&(h.zoom=L),m.panDelta!==void 0&&(h.drag=L),m.pitchDelta!==void 0&&(h.pitch=L),m.bearingDelta!==void 0&&(h.rotate=L)}_applyChanges(){const o={},h={},m={};for(const[v,E,L]of this._changes)v.panDelta&&(o.panDelta=(o.panDelta||new l.pointGeometry(0,0))._add(v.panDelta)),v.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(o.around=v.around),v.pinchAround!==void 0&&(o.pinchAround=v.pinchAround),v.noInertia&&(o.noInertia=v.noInertia),l.extend(h,E),l.extend(m,L);this._updateMapTransform(o,h,m),this._changes=[]}_updateMapTransform(o,h,m){const v=this._map,E=v.transform;if(!ga(o))return this._fireEvents(h,m,!0);let{panDelta:L,zoomDelta:N,bearingDelta:C,pitchDelta:k,around:V,pinchAround:Z}=o;Z!==void 0&&(V=Z),v._stop(!0),V=V||v.transform.centerPoint;const W=E.pointLocation(L?V.sub(L):V);C&&(E.bearing+=C),k&&(E.pitch+=k),N&&(E.zoom+=N),E.setLocationAtPoint(W,V),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,m,!0)}_fireEvents(o,h,m){const v=Yl(this._eventsInProgress),E=Yl(o),L={};for(const V in o){const{originalEvent:Z}=o[V];this._eventsInProgress[V]||(L[`${V}start`]=Z),this._eventsInProgress[V]=o[V]}!v&&E&&this._fireEvent("movestart",E.originalEvent);for(const V in L)this._fireEvent(V,L[V]);E&&this._fireEvent("move",E.originalEvent);for(const V in o){const{originalEvent:Z}=o[V];this._fireEvent(V,Z)}const N={};let C;for(const V in this._eventsInProgress){const{handlerName:Z,originalEvent:W}=this._eventsInProgress[V];this._handlersById[Z].isActive()||(delete this._eventsInProgress[V],C=h[Z]||W,N[`${V}end`]=C)}for(const V in N)this._fireEvent(V,N[V]);const k=Yl(this._eventsInProgress);if(m&&(v||E)&&!k){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;V?(Z(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:C})):(this._map.fire(new l.Event("moveend",{originalEvent:C})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new l.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Wl("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Sr={extend:(y,...o)=>l.extend(y,...o),run(y){y()},logToElement(y,o=!1,h="log"){const m=window.document.getElementById(h);m&&(o&&(m.innerHTML=""),m.innerHTML+=`<br>${y}`)}};class yh extends l.Evented{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,m){return o=l.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,l.extend({offset:o},h),m)}panTo(o,h,m){return this.easeTo(l.extend({center:o},h),m)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,m){return this.easeTo(l.extend({zoom:o},h),m)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,m){return this.easeTo(l.extend({bearing:o},h),m)}resetNorth(o,h){return this.rotateTo(0,l.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=l.LngLatBounds.convert(o);const m=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,h)}_cameraForBoxAndBearing(o,h,m,v){const E={top:0,bottom:0,right:0,left:0};if(typeof(v=l.extend({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const Ut=v.padding;v.padding={top:Ut,bottom:Ut,right:Ut,left:Ut}}v.padding=l.extend(E,v.padding);const L=this.transform,N=L.padding,C=L.project(l.LngLat.convert(o)),k=L.project(l.LngLat.convert(h)),V=C.rotate(-m*Math.PI/180),Z=k.rotate(-m*Math.PI/180),W=new l.pointGeometry(Math.max(V.x,Z.x),Math.max(V.y,Z.y)),ot=new l.pointGeometry(Math.min(V.x,Z.x),Math.min(V.y,Z.y)),J=W.sub(ot),it=(L.width-(N.left+N.right+v.padding.left+v.padding.right))/J.x,mt=(L.height-(N.top+N.bottom+v.padding.top+v.padding.bottom))/J.y;if(mt<0||it<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const yt=Math.min(L.scaleZoom(L.scale*Math.min(it,mt)),v.maxZoom),Tt=l.pointGeometry.convert(v.offset),bt=new l.pointGeometry((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(m*Math.PI/180),Kt=Tt.add(bt).mult(L.scale/L.zoomScale(yt));return{center:L.unproject(C.add(k).div(2).sub(Kt)),zoom:yt,bearing:m}}fitBounds(o,h,m){return this._fitInternal(this.cameraForBounds(o,h),h,m)}fitScreenCoordinates(o,h,m,v,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.pointGeometry.convert(o)),this.transform.pointLocation(l.pointGeometry.convert(h)),m,v),v,E)}_fitInternal(o,h,m){return o?(delete(h=l.extend(o,h)).padding,h.linear?this.easeTo(h,m):this.flyTo(h,m)):this}jumpTo(o,h){this.stop();const m=this.transform;let v=!1,E=!1,L=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(v=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=l.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(E=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(L=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),this.fire(new l.Event("movestart",h)).fire(new l.Event("move",h)),v&&this.fire(new l.Event("zoomstart",h)).fire(new l.Event("zoom",h)).fire(new l.Event("zoomend",h)),E&&this.fire(new l.Event("rotatestart",h)).fire(new l.Event("rotate",h)).fire(new l.Event("rotateend",h)),L&&this.fire(new l.Event("pitchstart",h)).fire(new l.Event("pitch",h)).fire(new l.Event("pitchend",h)),this.fire(new l.Event("moveend",h))}easeTo(o,h){this._stop(!1,o.easeId),((o=l.extend({offset:[0,0],duration:500,easing:l.ease},o)).animate===!1||!o.essential&&l.exported.prefersReducedMotion)&&(o.duration=0);const m=this.transform,v=this.getZoom(),E=this.getBearing(),L=this.getPitch(),N=this.getPadding(),C="zoom"in o?+o.zoom:v,k="bearing"in o?this._normalizeBearing(o.bearing,E):E,V="pitch"in o?+o.pitch:L,Z="padding"in o?o.padding:m.padding,W=l.pointGeometry.convert(o.offset);let ot=m.centerPoint.add(W);const J=m.pointLocation(ot),it=l.LngLat.convert(o.center||J);this._normalizeCenter(it);const mt=m.project(J),yt=m.project(it).sub(mt),Tt=m.zoomScale(C-v);let bt,Kt;o.around&&(bt=l.LngLat.convert(o.around),Kt=m.locationPoint(bt));const Ut={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||C!==v,this._rotating=this._rotating||E!==k,this._pitching=this._pitching||V!==L,this._padding=!m.isPaddingEqual(Z),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Ut),this._ease(kt=>{if(this._zooming&&(m.zoom=l.number(v,C,kt)),this._rotating&&(m.bearing=l.number(E,k,kt)),this._pitching&&(m.pitch=l.number(L,V,kt)),this._padding&&(m.interpolatePadding(N,Z,kt),ot=m.centerPoint.add(W)),bt)m.setLocationAtPoint(bt,Kt);else{const se=m.zoomScale(m.zoom-v),me=C>v?Math.min(2,Tt):Math.max(.5,Tt),Ht=Math.pow(me,1-kt),Re=m.unproject(mt.add(yt.mult(kt*Ht)).mult(se));m.setLocationAtPoint(m.renderWorldCopies?Re.wrap():Re,ot)}this._fireMoveEvents(h)},kt=>{this._afterEase(h,kt)},o),this}_prepareEase(o,h,m={}){this._moving=!0,h||m.moving||this.fire(new l.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new l.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new l.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new l.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new l.Event("move",o)),this._zooming&&this.fire(new l.Event("zoom",o)),this._rotating&&this.fire(new l.Event("rotate",o)),this._pitching&&this.fire(new l.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId;const m=this._zooming,v=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new l.Event("zoomend",o)),v&&this.fire(new l.Event("rotateend",o)),E&&this.fire(new l.Event("pitchend",o)),this.fire(new l.Event("moveend",o))}flyTo(o,h){if(!o.essential&&l.exported.prefersReducedMotion){const Dn=l.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Dn,h)}this.stop(),o=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},o);const m=this.transform,v=this.getZoom(),E=this.getBearing(),L=this.getPitch(),N=this.getPadding(),C="zoom"in o?l.clamp(+o.zoom,m.minZoom,m.maxZoom):v,k="bearing"in o?this._normalizeBearing(o.bearing,E):E,V="pitch"in o?+o.pitch:L,Z="padding"in o?o.padding:m.padding,W=m.zoomScale(C-v),ot=l.pointGeometry.convert(o.offset);let J=m.centerPoint.add(ot);const it=m.pointLocation(J),mt=l.LngLat.convert(o.center||it);this._normalizeCenter(mt);const yt=m.project(it),Tt=m.project(mt).sub(yt);let bt=o.curve;const Kt=Math.max(m.width,m.height),Ut=Kt/W,kt=Tt.mag();if("minZoom"in o){const Dn=l.clamp(Math.min(o.minZoom,v,C),m.minZoom,m.maxZoom),kr=Kt/m.zoomScale(Dn-v);bt=Math.sqrt(kr/kt*2)}const se=bt*bt;function me(Dn){const kr=(Ut*Ut-Kt*Kt+(Dn?-1:1)*se*se*kt*kt)/(2*(Dn?Ut:Kt)*se*kt);return Math.log(Math.sqrt(kr*kr+1)-kr)}function Ht(Dn){return(Math.exp(Dn)-Math.exp(-Dn))/2}function Re(Dn){return(Math.exp(Dn)+Math.exp(-Dn))/2}const Ie=me(0);let We=function(Dn){return Re(Ie)/Re(Ie+bt*Dn)},Nn=function(Dn){return Kt*((Re(Ie)*(Ht(kr=Ie+bt*Dn)/Re(kr))-Ht(Ie))/se)/kt;var kr},En=(me(1)-Ie)/bt;if(Math.abs(kt)<1e-6||!isFinite(En)){if(Math.abs(Kt-Ut)<1e-6)return this.easeTo(o,h);const Dn=Ut<Kt?-1:1;En=Math.abs(Math.log(Ut/Kt))/bt,Nn=function(){return 0},We=function(kr){return Math.exp(Dn*bt*kr)}}return o.duration="duration"in o?+o.duration:1e3*En/("screenSpeed"in o?+o.screenSpeed/bt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=E!==k,this._pitching=V!==L,this._padding=!m.isPaddingEqual(Z),this._prepareEase(h,!1),this._ease(Dn=>{const kr=Dn*En,hn=1/We(kr);m.zoom=Dn===1?C:v+m.scaleZoom(hn),this._rotating&&(m.bearing=l.number(E,k,Dn)),this._pitching&&(m.pitch=l.number(L,V,Dn)),this._padding&&(m.interpolatePadding(N,Z,Dn),J=m.centerPoint.add(ot));const Tn=Dn===1?mt:m.unproject(yt.add(Tt.mult(Nn(kr))).mult(hn));m.setLocationAtPoint(m.renderWorldCopies?Tn.wrap():Tn,J),this._fireMoveEvents(h)},()=>this._afterEase(h),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,h)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,h,m){m.animate===!1||m.duration===0?(o(1),h()):(this._easeStart=l.exported.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=l.wrap(o,-180,180);const m=Math.abs(o-h);return Math.abs(o-360-h)<m&&(o-=360),Math.abs(o+360-h)<m&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const m=o.lng-h.center.lng;o.lng+=m>180?-360:m<-180?360:0}}class vh{constructor(o={}){this.options=o,l.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const m=this._map._getUIString(`AttributionControl.${h}`);o.title=m,o.setAttribute("aria-label",m)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const E=h[v];if(E.used){const L=E.getSource();L.attribution&&o.indexOf(L.attribution)<0&&o.push(L.attribution)}}o=o.filter(v=>String(v).trim()),o.sort((v,E)=>v.length-E.length),o=o.filter((v,E)=>{for(let L=E+1;L<o.length;L++)if(o[L].indexOf(v)>=0)return!1;return!0});const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Ou{constructor(o={}){this.options=o,l.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl mapboxgl-ctrl");const h=D.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact","mapboxgl-compact"):h.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Ec{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,m=h?this._queue.concat(h):this._queue;for(const v of m)if(v.id===o)return void(v.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const m of h)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const xh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},sg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Xs={showCompass:!0,showZoom:!0,visualizePitch:!1};class bh{constructor(o,h,m=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Ne({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new ko({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(h,"mousedown",this.mousedown),D.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(h,"touchmove",this.touchmove),D.addEventListener(h,"touchend",this.touchend),D.addEventListener(h,"touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),D.disableDrag()}move(o,h){const m=this.map,v=this.mouseRotate.mousemoveWindow(o,h);if(v&&v.bearingDelta&&m.setBearing(m.getBearing()+v.bearingDelta),this.mousePitch){const E=this.mousePitch.mousemoveWindow(o,h);E&&E.pitchDelta&&m.setPitch(m.getPitch()+E.pitchDelta)}}off(){const o=this.element;D.removeEventListener(o,"mousedown",this.mousedown),D.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(o,"touchmove",this.touchmove),D.removeEventListener(o,"touchend",this.touchend),D.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup)}mousedown(o){this.down(l.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),D.mousePos(this.element,o)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)}mousemove(o){this.move(o,D.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Be(y,o,h){if(y=new l.LngLat(y.lng,y.lat),o){const m=new l.LngLat(y.lng-360,y.lat),v=new l.LngLat(y.lng+360,y.lat),E=h.locationPoint(y).distSqr(o);h.locationPoint(m).distSqr(o)<E?y=m:h.locationPoint(v).distSqr(o)<E&&(y=v)}for(;Math.abs(y.lng-h.center.lng)>180;){const m=h.locationPoint(y);if(m.x>=0&&m.y>=0&&m.x<=h.width&&m.y<=h.height)break;y.lng>h.center.lng?y.lng-=360:y.lng+=360}return y}const Le={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mi(y,o,h){const m=y.classList;for(const v in Le)m.remove(`maplibregl-${h}-anchor-${v}`,`mapboxgl-${h}-anchor-${v}`);m.add(`maplibregl-${h}-anchor-${o}`,`mapboxgl-${h}-anchor-${o}`)}class Sc extends l.Evented{constructor(o,h){if(super(),(o instanceof HTMLElement||h)&&(o=l.extend({element:o},h)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=l.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const m=D.createNS("http://www.w3.org/2000/svg","svg"),v=41,E=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${v}px`),m.setAttributeNS(null,"width",`${E}px`),m.setAttributeNS(null,"viewBox",`0 0 ${E} ${v}`);const L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");const N=D.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const C=D.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Tt of k){const bt=D.createNS("http://www.w3.org/2000/svg","ellipse");bt.setAttributeNS(null,"opacity","0.04"),bt.setAttributeNS(null,"cx","10.5"),bt.setAttributeNS(null,"cy","5.80029008"),bt.setAttributeNS(null,"rx",Tt.rx),bt.setAttributeNS(null,"ry",Tt.ry),C.appendChild(bt)}const V=D.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const Z=D.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(Z);const W=D.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");const ot=D.createNS("http://www.w3.org/2000/svg","path");ot.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(ot);const J=D.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const it=D.createNS("http://www.w3.org/2000/svg","g");it.setAttributeNS(null,"transform","translate(8.0, 8.0)");const mt=D.createNS("http://www.w3.org/2000/svg","circle");mt.setAttributeNS(null,"fill","#000000"),mt.setAttributeNS(null,"opacity","0.25"),mt.setAttributeNS(null,"cx","5.5"),mt.setAttributeNS(null,"cy","5.5"),mt.setAttributeNS(null,"r","5.4999962");const yt=D.createNS("http://www.w3.org/2000/svg","circle");yt.setAttributeNS(null,"fill","#FFFFFF"),yt.setAttributeNS(null,"cx","5.5"),yt.setAttributeNS(null,"cy","5.5"),yt.setAttributeNS(null,"r","5.4999962"),it.appendChild(mt),it.appendChild(yt),N.appendChild(C),N.appendChild(V),N.appendChild(W),N.appendChild(J),N.appendChild(it),m.appendChild(N),m.setAttributeNS(null,"height",v*this._scale+"px"),m.setAttributeNS(null,"width",E*this._scale+"px"),this._element.appendChild(m),this._offset=l.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),mi(this._element,this._anchor,"marker"),this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=l.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(o){const h=o.code,m=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,m=this._element;this._popup&&(h===m||m.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}_update(o){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Be(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Le[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${h}`)}getOffset(){return this._offset}setOffset(o){return this._offset=l.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const yf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let _i,jl=0,so=!1;const Cc={maxWidth:100,unit:"metric"};function Hl(y,o,h){const m=h&&h.maxWidth||100,v=y._container.clientHeight/2,E=y.unproject([0,v]),L=y.unproject([m,v]),N=E.distanceTo(L);if(h&&h.unit==="imperial"){const C=3.2808*N;C>5280?ir(o,m,C/5280,y._getUIString("ScaleControl.Miles")):ir(o,m,C,y._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?ir(o,m,N/1852,y._getUIString("ScaleControl.NauticalMiles")):N>=1e3?ir(o,m,N/1e3,y._getUIString("ScaleControl.Kilometers")):ir(o,m,N,y._getUIString("ScaleControl.Meters"))}function ir(y,o,h,m){const v=function(E){const L=Math.pow(10,`${Math.floor(E)}`.length-1);let N=E/L;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(C){const k=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*k)/k}(N),L*N}(h);y.style.width=o*(v/h)+"px",y.innerHTML=`${v}&nbsp;${m}`}const Or={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ku=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fa(y){if(y){if(typeof y=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(y,2)));return{center:new l.pointGeometry(0,0),top:new l.pointGeometry(0,y),"top-left":new l.pointGeometry(o,o),"top-right":new l.pointGeometry(-o,o),bottom:new l.pointGeometry(0,-y),"bottom-left":new l.pointGeometry(o,-o),"bottom-right":new l.pointGeometry(-o,-o),left:new l.pointGeometry(y,0),right:new l.pointGeometry(-y,0)}}if(y instanceof l.pointGeometry||Array.isArray(y)){const o=l.pointGeometry.convert(y);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:l.pointGeometry.convert(y.center||[0,0]),top:l.pointGeometry.convert(y.top||[0,0]),"top-left":l.pointGeometry.convert(y["top-left"]||[0,0]),"top-right":l.pointGeometry.convert(y["top-right"]||[0,0]),bottom:l.pointGeometry.convert(y.bottom||[0,0]),"bottom-left":l.pointGeometry.convert(y["bottom-left"]||[0,0]),"bottom-right":l.pointGeometry.convert(y["bottom-right"]||[0,0]),left:l.pointGeometry.convert(y.left||[0,0]),right:l.pointGeometry.convert(y.right||[0,0])}}return Fa(new l.pointGeometry(0,0))}const ma={supported:x,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends yh{constructor(y){var o;if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(y=l.extend({},sg,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Cs(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Ec,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},xh,y.locale),this._clickTolerance=y.clickTolerance,this._pixelRatio=(o=y.pixelRatio)!==null&&o!==void 0?o:devicePixelRatio,this._requestManager=new G(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new xo(this,y),this._hash=y.hash&&new vc(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,l.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new vh({customAttribution:y.customAttribution})),y.maplibreLogo&&this.addControl(new Ou,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new l.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new l.Event(`${h.dataType}dataloading`,h))}),this.on("dataabort",h=>{this.fire(new l.Event("sourcedataabort",h))})}_getMapId(){return this._mapId}addControl(y,o){if(o===void 0&&(o=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=y.onAdd(this);this._controls.push(y);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(h,m.firstChild):m.appendChild(h),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(y);return o>-1&&this._controls.splice(o,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}resize(y){const o=this._containerDimensions(),h=o[0],m=o[1];this._resizeCanvas(h,m,this.getPixelRatio()),this.transform.resize(h,m),this.painter.resize(h,m,this.getPixelRatio());const v=!this._moving;return v&&(this.stop(),this.fire(new l.Event("movestart",y)).fire(new l.Event("move",y))),this.fire(new l.Event("resize",y)),v&&this.fire(new l.Event("moveend",y)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(y){const[o,h]=this._containerDimensions();this._pixelRatio=y,this._resizeCanvas(o,h,y),this.painter.resize(o,h,y)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(l.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y==null?-2:y)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y==null?22:y)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y==null?0:y)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y==null?60:y)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(l.LngLat.convert(y))}unproject(y){return this.transform.pointLocation(l.pointGeometry.convert(y))}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(y,o,h){if(y==="mouseenter"||y==="mouseover"){let m=!1;return{layer:o,listener:h,delegates:{mousemove:E=>{const L=this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[];L.length?m||(m=!0,h.call(this,new as(y,this,E.originalEvent,{features:L}))):m=!1},mouseout:()=>{m=!1}}}}if(y==="mouseleave"||y==="mouseout"){let m=!1;return{layer:o,listener:h,delegates:{mousemove:L=>{(this.getLayer(o)?this.queryRenderedFeatures(L.point,{layers:[o]}):[]).length?m=!0:m&&(m=!1,h.call(this,new as(y,this,L.originalEvent)))},mouseout:L=>{m&&(m=!1,h.call(this,new as(y,this,L.originalEvent)))}}}}{const m=v=>{const E=this.getLayer(o)?this.queryRenderedFeatures(v.point,{layers:[o]}):[];E.length&&(v.features=E,h.call(this,v),delete v.features)};return{layer:o,listener:h,delegates:{[y]:m}}}}on(y,o,h){if(h===void 0)return super.on(y,o);const m=this._createDelegatedListener(y,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(m);for(const v in m.delegates)this.on(v,m.delegates[v]);return this}once(y,o,h){if(h===void 0)return super.once(y,o);const m=this._createDelegatedListener(y,o,h);for(const v in m.delegates)this.once(v,m.delegates[v]);return this}off(y,o,h){return h===void 0?super.off(y,o):(this._delegatedListeners&&this._delegatedListeners[y]&&(m=>{const v=this._delegatedListeners[y];for(let E=0;E<v.length;E++){const L=v[E];if(L.layer===o&&L.listener===h){for(const N in L.delegates)this.off(N,L.delegates[N]);return v.splice(E,1),this}}})(),this)}queryRenderedFeatures(y,o){if(!this.style)return[];let h;if(o!==void 0||y===void 0||y instanceof l.pointGeometry||Array.isArray(y)||(o=y,y=void 0),o=o||{},(y=y||[[0,0],[this.transform.width,this.transform.height]])instanceof l.pointGeometry||typeof y[0]=="number")h=[l.pointGeometry.convert(y)];else{const m=l.pointGeometry.convert(y[0]),v=l.pointGeometry.convert(y[1]);h=[m,new l.pointGeometry(v.x,m.y),v,new l.pointGeometry(m.x,v.y),m]}return this.style.queryRenderedFeatures(h,o,this.transform)}querySourceFeatures(y,o){return this.style.querySourceFeatures(y,o)}setStyle(y,o){return(o=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(y,o))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const o=this._locale[y];if(o==null)throw new Error(`Missing UI string '${y}'`);return o}_updateStyle(y,o){return this.style&&(this.style.setEventedParent(null),this.style._remove()),y?(this.style=new Ti(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ti(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,o){if(typeof y=="string"){const h=this._requestManager.transformRequest(y,l.ResourceType.Style);l.getJSON(h,(m,v)=>{m?this.fire(new l.ErrorEvent(m)):v&&this._updateDiff(v,o)})}else typeof y=="object"&&this._updateDiff(y,o)}_updateDiff(y,o){try{this.style.setState(y)&&this._update(!0)}catch(h){l.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(y,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(y,o){return this._lazyInitEmptyStyle(),this.style.addSource(y,o),this._update(!0)}isSourceLoaded(y){const o=this.style&&this.style.sourceCaches[y];if(o!==void 0)return o.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${y}'`)))}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const o in y){const h=y[o]._tiles;for(const m in h){const v=h[m];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(y,o,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,o,h)}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,o,{pixelRatio:h=1,sdf:m=!1,stretchX:v,stretchY:E,content:L}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||l.isImageBitmap(o)){const{width:N,height:C,data:k}=l.exported.getImageData(o);this.style.addImage(y,{data:new l.RGBAImage({width:N,height:C},k),pixelRatio:h,stretchX:v,stretchY:E,content:L,sdf:m,version:0})}else{if(o.width===void 0||o.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:C,data:k}=o,V=o;this.style.addImage(y,{data:new l.RGBAImage({width:N,height:C},new Uint8Array(k)),pixelRatio:h,stretchX:v,stretchY:E,content:L,sdf:m,version:0,userImage:V}),V.onAdd&&V.onAdd(this,y)}}}updateImage(y,o){const h=this.style.getImage(y);if(!h)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof HTMLImageElement||l.isImageBitmap(o)?l.exported.getImageData(o):o,{width:v,height:E,data:L}=m;if(v===void 0||E===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||E!==h.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(o instanceof HTMLImageElement||l.isImageBitmap(o));h.data.replace(L,N),this.style.updateImage(y,h)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,o){l.getImage(this._requestManager.transformRequest(y,l.ResourceType.Image),o)}listImages(){return this.style.listImages()}addLayer(y,o){return this._lazyInitEmptyStyle(),this.style.addLayer(y,o),this._update(!0)}moveLayer(y,o){return this.style.moveLayer(y,o),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,o,h){return this.style.setLayerZoomRange(y,o,h),this._update(!0)}setFilter(y,o,h={}){return this.style.setFilter(y,o,h),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,o,h,m={}){return this.style.setPaintProperty(y,o,h,m),this._update(!0)}getPaintProperty(y,o){return this.style.getPaintProperty(y,o)}setLayoutProperty(y,o,h,m={}){return this.style.setLayoutProperty(y,o,h,m),this._update(!0)}getLayoutProperty(y,o){return this.style.getLayoutProperty(y,o)}setLight(y,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,o){return this.style.setFeatureState(y,o),this._update()}removeFeatureState(y,o){return this.style.removeFeatureState(y,o),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,o=0;return this._container&&(y=this._container.clientWidth||400,o=this._container.clientHeight||300),[y,o]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map","mapboxgl-map");const o=this._canvasContainer=D.create("div","maplibregl-canvas-container mapboxgl-canvas-container",y);this._interactive&&o.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions();this._resizeCanvas(h[0],h[1],this.getPixelRatio());const m=this._controlContainer=D.create("div","maplibregl-control-container mapboxgl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{v[E]=D.create("div",`maplibregl-ctrl-${E} mapboxgl-ctrl-${E}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,o,h){this._canvas.width=h*y,this._canvas.height=h*o,this._canvas.style.width=`${y}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const y=l.extend({},x.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);o?(this.painter=new gf(o,this.transform),l.exported$1.testSupport(o)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){let o,h=0;const m=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(o=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,o),h=l.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let v=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,N=l.exported.now();this.style.zoomHistory.update(L,N);const C=new l.EvaluationParameters(L,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=C.crossFadingFactor();k===1&&k===this._crossFadingFactor||(v=!0,this._crossFadingFactor=k),this.style.update(C)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||v)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const L=l.exported.now()-h;m.endQueryEXT(m.TIME_ELAPSED_EXT,o),setTimeout(()=>{const N=m.getQueryObjectEXT(o,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(o),this.fire(new l.Event("gpu-timing-frame",{cpuTime:L,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(L);this.fire(new l.Event("gpu-timing-layer",{layerTimes:N}))},50)}const E=this._sourcesDirty||this._styleDirty||this._placementDirty;return E||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.exported.frame(y=>{l.PerformanceUtils.frame(y),this._frame=null,this._render(y)}))}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}_setCacheLimits(y,o){l.setCacheLimits(y,o)}},NavigationControl:class{constructor(y){this.options=l.extend({},Xs,y),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map.getZoom(),o=y===this._map.getMaxZoom(),h=y===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const y=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=y}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new bh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,o){const h=D.create("button",y,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(y,o){const h=this._map._getUIString(`NavigationControl.${o}`);y.title=h,y.setAttribute("aria-label",h)}},GeolocateControl:class extends l.Evented{constructor(y){super(),this.options=l.extend({},yf,y),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(y){var o;return this._map=y,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,_i!==void 0?o(_i):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(h=>{_i=h.state!=="denied",o(_i)}):(_i=!!window.navigator.geolocation,o(_i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jl=0,so=!1}_isOutOfMapMaxBounds(y){const o=this._map.getMaxBounds(),h=y.coords;return o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",y)),this._finish()}}_updateCamera(y){const o=new l.LngLat(y.coords.longitude,y.coords.latitude),h=y.coords.accuracy,m=this._map.getBearing(),v=l.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),v,{geolocateSource:!0})}_updateMarker(y){if(y){const o=new l.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map._container.clientHeight/2,o=this._map.unproject([0,y]),h=this._map.unproject([1,y]),m=o.distanceTo(h),v=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&so)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Sc(this._dotElement),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Sc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jl--,so=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jl++,jl>1?(y={maximumAge:6e5,timeout:0},so=!0):(y=this.options.positionOptions,so=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:vh,LogoControl:Ou,ScaleControl:class{constructor(y){this.options=l.extend({},Cc,y),l.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Hl(this._map,this._container,this.options)}onAdd(y){return this._map=y,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(y){this.options.unit=y,Hl(this._map,this._container,this.options)}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(y){super(),this.options=l.extend(Object.create(Or),y),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=l.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const o=document.createDocumentFragment(),h=document.createElement("body");let m;for(h.innerHTML=y;m=h.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(y){this._update(y.point)}_onMouseMove(y){this._update(y.point)}_onDrag(y){this._update(y.point)}_update(y){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=D.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(E=>this._container.classList.add(E)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Be(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!y))return;const o=this._pos=this._trackPointer&&y?y:this._map.project(this._lngLat);let h=this.options.anchor;const m=Fa(this.options.offset);if(!h){const E=this._container.offsetWidth,L=this._container.offsetHeight;let N;N=o.y+m.bottom.y<L?["top"]:o.y>this._map.transform.height-L?["bottom"]:[],o.x<E/2?N.push("left"):o.x>this._map.transform.width-E/2&&N.push("right"),h=N.length===0?"bottom":N.join("-")}const v=o.add(m[h]).round();D.setTransform(this._container,`${Le[h]} translate(${v.x}px,${v.y}px)`),mi(this._container,h,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(ku);y&&y.focus()}_onClose(){this.remove()}},Marker:Sc,Style:Ti,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.pointGeometry,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,AJAXError:l.AJAXError,config:l.config,CanvasSource:Hr,GeoJSONSource:Xn,ImageSource:Nr,RasterDEMTileSource:_r,RasterTileSource:pn,VectorTileSource:$e,VideoSource:to,prewarm:function(){Gi().acquire(sa)},clearPrewarmedResources:function(){const y=bs;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(sa),bs=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get workerCount(){return ai.workerCount},set workerCount(y){ai.workerCount=y},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){l.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){l.clearTileCache(y)},workerUrl:"",addProtocol(y,o){l.config.REGISTERED_PROTOCOLS[y]=o},removeProtocol(y){delete l.config.REGISTERED_PROTOCOLS[y]}};return Sr.extend(ma,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),ma});var p=s;return p})})($g);function nE(n){return n}function Xx(n){if(n==null)return nE;var t,e,r=n.scale[0],s=n.scale[1],c=n.translate[0],p=n.translate[1];return function(l,x){x||(t=e=0);var I=2,T=l.length,P=new Array(T);for(P[0]=(t+=l[0])*r+c,P[1]=(e+=l[1])*s+p;I<T;)P[I]=l[I],++I;return P}}function rE(n){var t=Xx(n.transform),e,r=1/0,s=r,c=-r,p=-r;function l(I){I=t(I),I[0]<r&&(r=I[0]),I[0]>c&&(c=I[0]),I[1]<s&&(s=I[1]),I[1]>p&&(p=I[1])}function x(I){switch(I.type){case"GeometryCollection":I.geometries.forEach(x);break;case"Point":l(I.coordinates);break;case"MultiPoint":I.coordinates.forEach(l);break}}n.arcs.forEach(function(I){for(var T=-1,P=I.length,D;++T<P;)D=t(I[T],T),D[0]<r&&(r=D[0]),D[0]>c&&(c=D[0]),D[1]<s&&(s=D[1]),D[1]>p&&(p=D[1])});for(e in n.objects)x(n.objects[e]);return[r,s,c,p]}function iE(n,t){for(var e,r=n.length,s=r-t;s<--r;)e=n[s],n[s++]=n[r],n[r]=e}function oE(n,t){return typeof t=="string"&&(t=n.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(e){return d1(n,e)})}:d1(n,t)}function d1(n,t){var e=t.id,r=t.bbox,s=t.properties==null?{}:t.properties,c=f0(n,t);return e==null&&r==null?{type:"Feature",properties:s,geometry:c}:r==null?{type:"Feature",id:e,properties:s,geometry:c}:{type:"Feature",id:e,bbox:r,properties:s,geometry:c}}function f0(n,t){var e=Xx(n.transform),r=n.arcs;function s(T,P){P.length&&P.pop();for(var D=r[T<0?~T:T],G=0,Y=D.length;G<Y;++G)P.push(e(D[G],G));T<0&&iE(P,Y)}function c(T){return e(T)}function p(T){for(var P=[],D=0,G=T.length;D<G;++D)s(T[D],P);return P.length<2&&P.push(P[0]),P}function l(T){for(var P=p(T);P.length<4;)P.push(P[0]);return P}function x(T){return T.map(l)}function I(T){var P=T.type,D;switch(P){case"GeometryCollection":return{type:P,geometries:T.geometries.map(I)};case"Point":D=c(T.coordinates);break;case"MultiPoint":D=T.coordinates.map(c);break;case"LineString":D=p(T.arcs);break;case"MultiLineString":D=T.arcs.map(p);break;case"Polygon":D=x(T.arcs);break;case"MultiPolygon":D=T.arcs.map(x);break;default:return null}return{type:P,coordinates:D}}return I(t)}function sE(n,t){var e={},r={},s={},c=[],p=-1;t.forEach(function(I,T){var P=n.arcs[I<0?~I:I],D;P.length<3&&!P[1][0]&&!P[1][1]&&(D=t[++p],t[p]=I,t[T]=D)}),t.forEach(function(I){var T=l(I),P=T[0],D=T[1],G,Y;if(G=s[P])if(delete s[G.end],G.push(I),G.end=D,Y=r[D]){delete r[Y.start];var et=Y===G?G:G.concat(Y);r[et.start=G.start]=s[et.end=Y.end]=et}else r[G.start]=s[G.end]=G;else if(G=r[D])if(delete r[G.start],G.unshift(I),G.start=P,Y=s[P]){delete s[Y.end];var at=Y===G?G:Y.concat(G);r[at.start=Y.start]=s[at.end=G.end]=at}else r[G.start]=s[G.end]=G;else G=[I],r[G.start=P]=s[G.end=D]=G});function l(I){var T=n.arcs[I<0?~I:I],P=T[0],D;return n.transform?(D=[0,0],T.forEach(function(G){D[0]+=G[0],D[1]+=G[1]})):D=T[T.length-1],I<0?[D,P]:[P,D]}function x(I,T){for(var P in I){var D=I[P];delete T[D.start],delete D.start,delete D.end,D.forEach(function(G){e[G<0?~G:G]=1}),c.push(D)}}return x(s,r),x(r,s),t.forEach(function(I){e[I<0?~I:I]||c.push([I])}),c}function aE(n){for(var t=-1,e=n.length,r,s=n[e-1],c=0;++t<e;)r=s,s=n[t],c+=r[0]*s[1]-r[1]*s[0];return Math.abs(c)}function lE(n){return f0(n,uE.apply(this,arguments))}function uE(n,t){var e={},r=[],s=[];t.forEach(c);function c(x){switch(x.type){case"GeometryCollection":x.geometries.forEach(c);break;case"Polygon":p(x.arcs);break;case"MultiPolygon":x.arcs.forEach(p);break}}function p(x){x.forEach(function(I){I.forEach(function(T){(e[T=T<0?~T:T]||(e[T]=[])).push(x)})}),r.push(x)}function l(x){return aE(f0(n,{type:"Polygon",arcs:[x]}).coordinates[0])}return r.forEach(function(x){if(!x._){var I=[],T=[x];for(x._=1,s.push(I);x=T.pop();)I.push(x),x.forEach(function(P){P.forEach(function(D){e[D<0?~D:D].forEach(function(G){G._||(G._=1,T.push(G))})})})}}),r.forEach(function(x){delete x._}),{type:"MultiPolygon",arcs:s.map(function(x){var I=[],T;if(x.forEach(function(et){et.forEach(function(at){at.forEach(function(rt){e[rt<0?~rt:rt].length<2&&I.push(rt)})})}),I=sE(n,I),(T=I.length)>1)for(var P=1,D=l(I[0]),G,Y;P<T;++P)(G=l(I[P]))>D&&(Y=I[0],I[0]=I[P],I[P]=Y,D=G);return I}).filter(function(x){return x.length>0})}}var Qs=63710088e-1,Zx={centimeters:Qs*100,centimetres:Qs*100,degrees:Qs/111325,feet:Qs*3.28084,inches:Qs*39.37,kilometers:Qs/1e3,kilometres:Qs/1e3,meters:Qs,metres:Qs,miles:Qs/1609.344,millimeters:Qs*1e3,millimetres:Qs*1e3,nauticalmiles:Qs/1852,radians:1,yards:Qs*1.0936};function Yx(n,t,e){e===void 0&&(e={});var r={type:"Feature"};return(e.id===0||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties=t||{},r.geometry=n,r}function Wx(n,t,e){if(e===void 0&&(e={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!g1(n[0])||!g1(n[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:n};return Yx(r,t,e)}function Kv(n,t){t===void 0&&(t={});var e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=n,e}function cE(n,t){t===void 0&&(t="kilometers");var e=Zx[t];if(!e)throw new Error(t+" units is invalid");return n*e}function hE(n,t){t===void 0&&(t="kilometers");var e=Zx[t];if(!e)throw new Error(t+" units is invalid");return n/e}function g1(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function p0(n,t,e){if(n!==null)for(var r,s,c,p,l,x,I,T=0,P=0,D,G=n.type,Y=G==="FeatureCollection",et=G==="Feature",at=Y?n.features.length:1,rt=0;rt<at;rt++){I=Y?n.features[rt].geometry:et?n.geometry:n,D=I?I.type==="GeometryCollection":!1,l=D?I.geometries.length:1;for(var wt=0;wt<l;wt++){var xt=0,Gt=0;if(p=D?I.geometries[wt]:I,p!==null){x=p.coordinates;var ee=p.type;switch(T=e&&(ee==="Polygon"||ee==="MultiPolygon")?1:0,ee){case null:break;case"Point":if(t(x,P,rt,xt,Gt)===!1)return!1;P++,xt++;break;case"LineString":case"MultiPoint":for(r=0;r<x.length;r++){if(t(x[r],P,rt,xt,Gt)===!1)return!1;P++,ee==="MultiPoint"&&xt++}ee==="LineString"&&xt++;break;case"Polygon":case"MultiLineString":for(r=0;r<x.length;r++){for(s=0;s<x[r].length-T;s++){if(t(x[r][s],P,rt,xt,Gt)===!1)return!1;P++}ee==="MultiLineString"&&xt++,ee==="Polygon"&&Gt++}ee==="Polygon"&&xt++;break;case"MultiPolygon":for(r=0;r<x.length;r++){for(Gt=0,s=0;s<x[r].length;s++){for(c=0;c<x[r][s].length-T;c++){if(t(x[r][s][c],P,rt,xt,Gt)===!1)return!1;P++}Gt++}xt++}break;case"GeometryCollection":for(r=0;r<p.geometries.length;r++)if(p0(p.geometries[r],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m1(n,t){if(n.type==="Feature")t(n,0);else if(n.type==="FeatureCollection")for(var e=0;e<n.features.length&&t(n.features[e],e)!==!1;e++);}function jx(n,t){var e,r,s,c,p,l,x,I,T,P,D=0,G=n.type==="FeatureCollection",Y=n.type==="Feature",et=G?n.features.length:1;for(e=0;e<et;e++){for(l=G?n.features[e].geometry:Y?n.geometry:n,I=G?n.features[e].properties:Y?n.properties:{},T=G?n.features[e].bbox:Y?n.bbox:void 0,P=G?n.features[e].id:Y?n.id:void 0,x=l?l.type==="GeometryCollection":!1,p=x?l.geometries.length:1,s=0;s<p;s++){if(c=x?l.geometries[s]:l,c===null){if(t(null,D,I,T,P)===!1)return!1;continue}switch(c.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(c,D,I,T,P)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<c.geometries.length;r++)if(t(c.geometries[r],D,I,T,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}D++}}function X_(n,t){t===void 0&&(t={});var e=0,r=0,s=0;return p0(n,function(c){e+=c[0],r+=c[1],s++},!0),Wx([e/s,r/s],t.properties)}function cy(n){var t=[1/0,1/0,-1/0,-1/0];return p0(n,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}cy.default=cy;function fE(n,t){t===void 0&&(t={});var e=cy(n),r=(e[0]+e[2])/2,s=(e[1]+e[3])/2;return Wx([r,s],t.properties,t)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var e=Object(this),r=Math.max(Math.min(e.length,9007199254740991),0)||0,s=1 in arguments&&parseInt(Number(arguments[1]),10)||0;s=s<0?Math.max(r+s,0):Math.min(s,r);var c=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(c=c<0?Math.max(r+arguments[2],0):Math.min(c,r);s<c;)e[s]=t,++s;return e},writable:!0});Number.isFinite=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};Number.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(n){return n!==n};Math.trunc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};var Zf=function(){};Zf.prototype.interfaces_=function(){return[]};Zf.prototype.getClass=function(){return Zf};Zf.prototype.equalsWithTolerance=function(t,e,r){return Math.abs(t-e)<=r};var Dr=function(n){function t(e){n.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=new n().stack}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Error),fn=function(){},Hx={MAX_VALUE:{configurable:!0}};fn.isNaN=function(t){return Number.isNaN(t)};fn.doubleToLongBits=function(t){return t};fn.longBitsToDouble=function(t){return t};fn.isInfinite=function(t){return!Number.isFinite(t)};Hx.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(fn,Hx);var Da=function(){},Ay=function(){},bd=function(){};function Na(){}var Ct=function n(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=n.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=n.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},ip={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Ct.prototype.setOrdinate=function(t,e){switch(t){case Ct.X:this.x=e;break;case Ct.Y:this.y=e;break;case Ct.Z:this.z=e;break;default:throw new Dr("Invalid ordinate index: "+t)}};Ct.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];return!(!Zf.equalsWithTolerance(this.x,e.x,r)||!Zf.equalsWithTolerance(this.y,e.y,r))}};Ct.prototype.getOrdinate=function(t){switch(t){case Ct.X:return this.x;case Ct.Y:return this.y;case Ct.Z:return this.z}throw new Dr("Invalid ordinate index: "+t)};Ct.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||fn.isNaN(this.z))&&fn.isNaN(t.z)};Ct.prototype.equals=function(t){return t instanceof Ct?this.equals2D(t):!1};Ct.prototype.equalInZ=function(t,e){return Zf.equalsWithTolerance(this.z,t.z,e)};Ct.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0};Ct.prototype.clone=function(){};Ct.prototype.copy=function(){return new Ct(this)};Ct.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};Ct.prototype.distance3D=function(t){var e=this.x-t.x,r=this.y-t.y,s=this.z-t.z;return Math.sqrt(e*e+r*r+s*s)};Ct.prototype.distance=function(t){var e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)};Ct.prototype.hashCode=function(){var t=17;return t=37*t+Ct.hashCode(this.x),t=37*t+Ct.hashCode(this.y),t};Ct.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};Ct.prototype.interfaces_=function(){return[Da,Ay,Na]};Ct.prototype.getClass=function(){return Ct};Ct.hashCode=function(){if(arguments.length===1){var t=arguments[0],e=fn.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}};ip.DimensionalComparator.get=function(){return qc};ip.serialVersionUID.get=function(){return 6683108902428367e3};ip.NULL_ORDINATE.get=function(){return fn.NaN};ip.X.get=function(){return 0};ip.Y.get=function(){return 1};ip.Z.get=function(){return 2};Object.defineProperties(Ct,ip);var qc=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new Dr("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}};qc.prototype.compare=function(t,e){var r=t,s=e,c=qc.compare(r.x,s.x);if(c!==0)return c;var p=qc.compare(r.y,s.y);if(p!==0)return p;if(this._dimensionsToTest<=2)return 0;var l=qc.compare(r.z,s.z);return l};qc.prototype.interfaces_=function(){return[bd]};qc.prototype.getClass=function(){return qc};qc.compare=function(t,e){return t<e?-1:t>e?1:fn.isNaN(t)?fn.isNaN(e)?0:-1:fn.isNaN(e)?1:0};var wd=function(){};wd.prototype.create=function(){};wd.prototype.interfaces_=function(){return[]};wd.prototype.getClass=function(){return wd};var Pt=function(){},Em={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Pt.prototype.interfaces_=function(){return[]};Pt.prototype.getClass=function(){return Pt};Pt.toLocationSymbol=function(t){switch(t){case Pt.EXTERIOR:return"e";case Pt.BOUNDARY:return"b";case Pt.INTERIOR:return"i";case Pt.NONE:return"-"}throw new Dr("Unknown location value: "+t)};Em.INTERIOR.get=function(){return 0};Em.BOUNDARY.get=function(){return 1};Em.EXTERIOR.get=function(){return 2};Em.NONE.get=function(){return-1};Object.defineProperties(Pt,Em);var nn=function(n,t){return n.interfaces_&&n.interfaces_().indexOf(t)>-1},ea=function(){},Kx={LOG_10:{configurable:!0}};ea.prototype.interfaces_=function(){return[]};ea.prototype.getClass=function(){return ea};ea.log10=function(t){var e=Math.log(t);return fn.isInfinite(e)||fn.isNaN(e)?e:e/ea.LOG_10};ea.min=function(t,e,r,s){var c=t;return e<c&&(c=e),r<c&&(c=r),s<c&&(c=s),c};ea.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],c=arguments[1],p=arguments[2];return s<c?c:s>p?p:s}};ea.wrap=function(t,e){return t<0?e- -t%e:t%e};ea.max=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],r=arguments[2],s=t;return e>s&&(s=e),r>s&&(s=r),s}else if(arguments.length===4){var c=arguments[0],p=arguments[1],l=arguments[2],x=arguments[3],I=c;return p>I&&(I=p),l>I&&(I=l),x>I&&(I=x),I}};ea.average=function(t,e){return(t+e)/2};Kx.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(ea,Kx);var Fl=function(t){this.str=t};Fl.prototype.append=function(t){this.str+=t};Fl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)};Fl.prototype.toString=function(t){return this.str};var Al=function(t){this.value=t};Al.prototype.intValue=function(){return this.value};Al.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};Al.isNaN=function(t){return Number.isNaN(t)};var lm=function(){};lm.isWhitespace=function(t){return t<=32&&t>=0||t===127};lm.toUpperCase=function(t){return t.toUpperCase()};var Ot=function n(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof n){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var r=arguments[0];n.call(this,n.parse(r))}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s,c)}},nl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ot.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};Ot.prototype.extractSignificantDigits=function(t,e){var r=this.abs(),s=Ot.magnitude(r._hi),c=Ot.TEN.pow(s);r=r.divide(c),r.gt(Ot.TEN)?(r=r.divide(Ot.TEN),s+=1):r.lt(Ot.ONE)&&(r=r.multiply(Ot.TEN),s-=1);for(var p=s+1,l=new Fl,x=Ot.MAX_PRINT_DIGITS-1,I=0;I<=x;I++){t&&I===p&&l.append(".");var T=Math.trunc(r._hi);if(T<0)break;var P=!1,D=0;T>9?(P=!0,D="9"):D="0"+T,l.append(D),r=r.subtract(Ot.valueOf(T)).multiply(Ot.TEN),P&&r.selfAdd(Ot.TEN);var G=!0,Y=Ot.magnitude(r._hi);if(Y<0&&Math.abs(Y)>=x-I&&(G=!1),!G)break}return e[0]=s,l.toString()};Ot.prototype.sqr=function(){return this.multiply(this)};Ot.prototype.doubleValue=function(){return this._hi+this._lo};Ot.prototype.subtract=function(){if(arguments[0]instanceof Ot){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}};Ot.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};Ot.prototype.isZero=function(){return this._hi===0&&this._lo===0};Ot.prototype.selfSubtract=function(){if(arguments[0]instanceof Ot){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}};Ot.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Ot.prototype.min=function(t){return this.le(t)?this:t};Ot.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Ot){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c=null,p=null,l=null,x=null,I=null,T=null,P=null,D=null;return I=this._hi/r,T=Ot.SPLIT*I,c=T-I,D=Ot.SPLIT*r,c=T-c,p=I-c,l=D-r,P=I*r,l=D-l,x=r-l,D=c*l-P+c*x+p*l+p*x,T=(this._hi-P-D+this._lo-I*s)/r,D=I+T,this._hi=D,this._lo=I-D+T,this}};Ot.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Ot.prototype.divide=function(){if(arguments[0]instanceof Ot){var t=arguments[0],e=null,r=null,s=null,c=null,p=null,l=null,x=null,I=null;p=this._hi/t._hi,l=Ot.SPLIT*p,e=l-p,I=Ot.SPLIT*t._hi,e=l-e,r=p-e,s=I-t._hi,x=p*t._hi,s=I-s,c=t._hi-s,I=e*s-x+e*c+r*s+r*c,l=(this._hi-x-I+this._lo-p*t._lo)/t._hi,I=p+l;var T=I,P=p-I+l;return new Ot(T,P)}else if(typeof arguments[0]=="number"){var D=arguments[0];return fn.isNaN(D)?Ot.createNaN():Ot.copy(this).selfDivide(D,0)}};Ot.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};Ot.prototype.pow=function(t){if(t===0)return Ot.valueOf(1);var e=new Ot(this),r=Ot.valueOf(1),s=Math.abs(t);if(s>1)for(;s>0;)s%2===1&&r.selfMultiply(e),s/=2,s>0&&(e=e.sqr());else r=e;return t<0?r.reciprocal():r};Ot.prototype.ceil=function(){if(this.isNaN())return Ot.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Ot(t,e)};Ot.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0};Ot.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};Ot.prototype.setValue=function(){if(arguments[0]instanceof Ot){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}};Ot.prototype.max=function(t){return this.ge(t)?this:t};Ot.prototype.sqrt=function(){if(this.isZero())return Ot.valueOf(0);if(this.isNegative())return Ot.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,r=Ot.valueOf(e),s=this.subtract(r.sqr()),c=s._hi*(t*.5);return r.add(c)};Ot.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Ot){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0],r=null,s=null,c=null,p=null,l=null,x=null;return c=this._hi+e,l=c-this._hi,p=c-l,p=e-l+(this._hi-p),x=p+this._lo,r=c+x,s=x+(c-r),this._hi=r+s,this._lo=s+(r-this._hi),this}}else if(arguments.length===2){var I=arguments[0],T=arguments[1],P=null,D=null,G=null,Y=null,et=null,at=null,rt=null,wt=null;et=this._hi+I,G=this._lo+T,rt=et-this._hi,wt=G-this._lo,at=et-rt,Y=G-wt,at=I-rt+(this._hi-at),Y=T-wt+(this._lo-Y),rt=at+G,P=et+rt,D=rt+(et-P),rt=Y+D;var xt=P+rt,Gt=rt+(P-xt);return this._hi=xt,this._lo=Gt,this}};Ot.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Ot){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c=null,p=null,l=null,x=null,I=null,T=null;I=Ot.SPLIT*this._hi,c=I-this._hi,T=Ot.SPLIT*r,c=I-c,p=this._hi-c,l=T-r,I=this._hi*r,l=T-l,x=r-l,T=c*l-I+c*x+p*l+p*x+(this._hi*s+this._lo*r);var P=I+T;c=I-P;var D=T+c;return this._hi=P,this._lo=D,this}};Ot.prototype.selfSqr=function(){return this.selfMultiply(this)};Ot.prototype.floor=function(){if(this.isNaN())return Ot.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Ot(t,e)};Ot.prototype.negate=function(){return this.isNaN()?this:new Ot(-this._hi,-this._lo)};Ot.prototype.clone=function(){};Ot.prototype.multiply=function(){if(arguments[0]instanceof Ot){var t=arguments[0];return t.isNaN()?Ot.createNaN():Ot.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return fn.isNaN(e)?Ot.createNaN():Ot.copy(this).selfMultiply(e,0)}};Ot.prototype.isNaN=function(){return fn.isNaN(this._hi)};Ot.prototype.intValue=function(){return Math.trunc(this._hi)};Ot.prototype.toString=function(){var t=Ot.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};Ot.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!0,e),s=e[0]+1,c=r;if(r.charAt(0)===".")c="0"+r;else if(s<0)c="0."+Ot.stringOfChar("0",-s)+r;else if(r.indexOf(".")===-1){var p=s-r.length,l=Ot.stringOfChar("0",p);c=r+l+".0"}return this.isNegative()?"-"+c:c};Ot.prototype.reciprocal=function(){var t=null,e=null,r=null,s=null,c=null,p=null,l=null,x=null;c=1/this._hi,p=Ot.SPLIT*c,t=p-c,x=Ot.SPLIT*this._hi,t=p-t,e=c-t,r=x-this._hi,l=c*this._hi,r=x-r,s=this._hi-r,x=t*r-l+t*s+e*r+e*s,p=(1-l-x-c*this._lo)/this._hi;var I=c+p,T=c-I+p;return new Ot(I,T)};Ot.prototype.toSciNotation=function(){if(this.isZero())return Ot.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!1,e),s=Ot.SCI_NOT_EXPONENT_CHAR+e[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var c="";r.length>1&&(c=r.substring(1));var p=r.charAt(0)+"."+c;return this.isNegative()?"-"+p+s:p+s};Ot.prototype.abs=function(){return this.isNaN()?Ot.NaN:this.isNegative()?this.negate():new Ot(this)};Ot.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Ot.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};Ot.prototype.add=function(){if(arguments[0]instanceof Ot){var t=arguments[0];return Ot.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return Ot.copy(this).selfAdd(e)}};Ot.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Ot){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this._hi=r,this._lo=s}};Ot.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};Ot.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Ot.prototype.trunc=function(){return this.isNaN()?Ot.NaN:this.isPositive()?this.floor():this.ceil()};Ot.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Ot.prototype.interfaces_=function(){return[Na,Da,Ay]};Ot.prototype.getClass=function(){return Ot};Ot.sqr=function(t){return Ot.valueOf(t).selfMultiply(t)};Ot.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return Ot.parse(t)}else if(typeof arguments[0]=="number"){var e=arguments[0];return new Ot(e)}};Ot.sqrt=function(t){return Ot.valueOf(t).sqrt()};Ot.parse=function(t){for(var e=0,r=t.length;lm.isWhitespace(t.charAt(e));)e++;var s=!1;if(e<r){var c=t.charAt(e);(c==="-"||c==="+")&&(e++,c==="-"&&(s=!0))}for(var p=new Ot,l=0,x=0,I=0;!(e>=r);){var T=t.charAt(e);if(e++,lm.isDigit(T)){var P=T-"0";p.selfMultiply(Ot.TEN),p.selfAdd(P),l++;continue}if(T==="."){x=l;continue}if(T==="e"||T==="E"){var D=t.substring(e);try{I=Al.parseInt(D)}catch(rt){throw rt instanceof Error?new Error("Invalid exponent "+D+" in string "+t):rt}finally{}break}throw new Error("Unexpected character '"+T+"' at position "+e+" in string "+t)}var G=p,Y=l-x-I;if(Y===0)G=p;else if(Y>0){var et=Ot.TEN.pow(Y);G=p.divide(et)}else if(Y<0){var at=Ot.TEN.pow(-Y);G=p.multiply(at)}return s?G.negate():G};Ot.createNaN=function(){return new Ot(fn.NaN,fn.NaN)};Ot.copy=function(t){return new Ot(t)};Ot.magnitude=function(t){var e=Math.abs(t),r=Math.log(e)/Math.log(10),s=Math.trunc(Math.floor(r)),c=Math.pow(10,s);return c*10<=e&&(s+=1),s};Ot.stringOfChar=function(t,e){for(var r=new Fl,s=0;s<e;s++)r.append(t);return r.toString()};nl.PI.get=function(){return new Ot(3.141592653589793,12246467991473532e-32)};nl.TWO_PI.get=function(){return new Ot(6.283185307179586,24492935982947064e-32)};nl.PI_2.get=function(){return new Ot(1.5707963267948966,6123233995736766e-32)};nl.E.get=function(){return new Ot(2.718281828459045,14456468917292502e-32)};nl.NaN.get=function(){return new Ot(fn.NaN,fn.NaN)};nl.EPS.get=function(){return 123259516440783e-46};nl.SPLIT.get=function(){return 134217729};nl.MAX_PRINT_DIGITS.get=function(){return 32};nl.TEN.get=function(){return Ot.valueOf(10)};nl.ONE.get=function(){return Ot.valueOf(1)};nl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};nl.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Ot,nl);var gs=function(){},Jx={DP_SAFE_EPSILON:{configurable:!0}};gs.prototype.interfaces_=function(){return[]};gs.prototype.getClass=function(){return gs};gs.orientationIndex=function(t,e,r){var s=gs.orientationIndexFilter(t,e,r);if(s<=1)return s;var c=Ot.valueOf(e.x).selfAdd(-t.x),p=Ot.valueOf(e.y).selfAdd(-t.y),l=Ot.valueOf(r.x).selfAdd(-e.x),x=Ot.valueOf(r.y).selfAdd(-e.y);return c.selfMultiply(x).selfSubtract(p.selfMultiply(l)).signum()};gs.signOfDet2x2=function(t,e,r,s){var c=t.multiply(s).selfSubtract(e.multiply(r));return c.signum()};gs.intersection=function(t,e,r,s){var c=Ot.valueOf(s.y).selfSubtract(r.y).selfMultiply(Ot.valueOf(e.x).selfSubtract(t.x)),p=Ot.valueOf(s.x).selfSubtract(r.x).selfMultiply(Ot.valueOf(e.y).selfSubtract(t.y)),l=c.subtract(p),x=Ot.valueOf(s.x).selfSubtract(r.x).selfMultiply(Ot.valueOf(t.y).selfSubtract(r.y)),I=Ot.valueOf(s.y).selfSubtract(r.y).selfMultiply(Ot.valueOf(t.x).selfSubtract(r.x)),T=x.subtract(I),P=T.selfDivide(l).doubleValue(),D=Ot.valueOf(t.x).selfAdd(Ot.valueOf(e.x).selfSubtract(t.x).selfMultiply(P)).doubleValue(),G=Ot.valueOf(e.x).selfSubtract(t.x).selfMultiply(Ot.valueOf(t.y).selfSubtract(r.y)),Y=Ot.valueOf(e.y).selfSubtract(t.y).selfMultiply(Ot.valueOf(t.x).selfSubtract(r.x)),et=G.subtract(Y),at=et.selfDivide(l).doubleValue(),rt=Ot.valueOf(r.y).selfAdd(Ot.valueOf(s.y).selfSubtract(r.y).selfMultiply(at)).doubleValue();return new Ct(D,rt)};gs.orientationIndexFilter=function(t,e,r){var s=null,c=(t.x-r.x)*(e.y-r.y),p=(t.y-r.y)*(e.x-r.x),l=c-p;if(c>0){if(p<=0)return gs.signum(l);s=c+p}else if(c<0){if(p>=0)return gs.signum(l);s=-c-p}else return gs.signum(l);var x=gs.DP_SAFE_EPSILON*s;return l>=x||-l>=x?gs.signum(l):2};gs.signum=function(t){return t>0?1:t<0?-1:0};Jx.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(gs,Jx);var Fn=function(){},Sm={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Sm.X.get=function(){return 0};Sm.Y.get=function(){return 1};Sm.Z.get=function(){return 2};Sm.M.get=function(){return 3};Fn.prototype.setOrdinate=function(t,e,r){};Fn.prototype.size=function(){};Fn.prototype.getOrdinate=function(t,e){};Fn.prototype.getCoordinate=function(){};Fn.prototype.getCoordinateCopy=function(t){};Fn.prototype.getDimension=function(){};Fn.prototype.getX=function(t){};Fn.prototype.clone=function(){};Fn.prototype.expandEnvelope=function(t){};Fn.prototype.copy=function(){};Fn.prototype.getY=function(t){};Fn.prototype.toCoordinateArray=function(){};Fn.prototype.interfaces_=function(){return[Ay]};Fn.prototype.getClass=function(){return Fn};Object.defineProperties(Fn,Sm);var Qx=function(){},jd=function(n){function t(){n.call(this,"Projective point not representable on the Cartesian plane.")}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Qx),po=function(){};po.arraycopy=function(t,e,r,s,c){for(var p=0,l=e;l<e+c;l++)r[s+p]=t[l],p++};po.getProperty=function(t){return{"line.separator":`
`}[t]};var Xa=function n(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1];this.x=e,this.y=r,this.w=1}else if(arguments[0]instanceof n&&arguments[1]instanceof n){var s=arguments[0],c=arguments[1];this.x=s.y*c.w-c.y*s.w,this.y=c.x*s.w-s.x*c.w,this.w=s.x*c.y-c.x*s.y}else if(arguments[0]instanceof Ct&&arguments[1]instanceof Ct){var p=arguments[0],l=arguments[1];this.x=p.y-l.y,this.y=l.x-p.x,this.w=p.x*l.y-l.x*p.y}}else if(arguments.length===3){var x=arguments[0],I=arguments[1],T=arguments[2];this.x=x,this.y=I,this.w=T}else if(arguments.length===4){var P=arguments[0],D=arguments[1],G=arguments[2],Y=arguments[3],et=P.y-D.y,at=D.x-P.x,rt=P.x*D.y-D.x*P.y,wt=G.y-Y.y,xt=Y.x-G.x,Gt=G.x*Y.y-Y.x*G.y;this.x=at*Gt-xt*rt,this.y=wt*rt-et*Gt,this.w=et*xt-wt*at}};Xa.prototype.getY=function(){var t=this.y/this.w;if(fn.isNaN(t)||fn.isInfinite(t))throw new jd;return t};Xa.prototype.getX=function(){var t=this.x/this.w;if(fn.isNaN(t)||fn.isInfinite(t))throw new jd;return t};Xa.prototype.getCoordinate=function(){var t=new Ct;return t.x=this.getX(),t.y=this.getY(),t};Xa.prototype.interfaces_=function(){return[]};Xa.prototype.getClass=function(){return Xa};Xa.intersection=function(t,e,r,s){var c=t.y-e.y,p=e.x-t.x,l=t.x*e.y-e.x*t.y,x=r.y-s.y,I=s.x-r.x,T=r.x*s.y-s.x*r.y,P=p*T-I*l,D=x*l-c*T,G=c*I-x*p,Y=P/G,et=D/G;if(fn.isNaN(Y)||fn.isInfinite(Y)||fn.isNaN(et)||fn.isInfinite(et))throw new jd;return new Ct(Y,et)};var Xe=function n(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Ct){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof n){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r.x,s.x,r.y,s.y)}else if(arguments.length===4){var c=arguments[0],p=arguments[1],l=arguments[2],x=arguments[3];this.init(c,p,l,x)}},$x={serialVersionUID:{configurable:!0}};Xe.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Xe.prototype.equals=function(t){if(!(t instanceof Xe))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()};Xe.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Xe;var e=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,s=this._maxx<t._maxx?this._maxx:t._maxx,c=this._maxy<t._maxy?this._maxy:t._maxy;return new Xe(e,s,r,c)};Xe.prototype.isNull=function(){return this._maxx<this._minx};Xe.prototype.getMaxX=function(){return this._maxx};Xe.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Ct){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof Xe){var e=arguments[0];return this.isNull()||e.isNull()?!1:e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&s>=this._miny&&s<=this._maxy}};Xe.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Xe){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof Ct){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||s>this._maxy||s<this._miny)}};Xe.prototype.getMinY=function(){return this._miny};Xe.prototype.getMinX=function(){return this._minx};Xe.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Ct){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Xe){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=s,this._maxy=s):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),s<this._miny&&(this._miny=s),s>this._maxy&&(this._maxy=s))}};Xe.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e};Xe.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Xe.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0};Xe.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)};Xe.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Xe.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};Xe.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};Xe.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e};Xe.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Xe.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Xe){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof Ct){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.covers(r,s)}};Xe.prototype.centre=function(){return this.isNull()?null:new Ct((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Xe.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Ct){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Xe){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r.x,s.x,r.y,s.y)}else if(arguments.length===4){var c=arguments[0],p=arguments[1],l=arguments[2],x=arguments[3];c<p?(this._minx=c,this._maxx=p):(this._minx=p,this._maxx=c),l<x?(this._miny=l,this._maxy=x):(this._miny=x,this._maxy=l)}};Xe.prototype.getMaxY=function(){return this._maxy};Xe.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),e===0?r:r===0?e:Math.sqrt(e*e+r*r)};Xe.prototype.hashCode=function(){var t=17;return t=37*t+Ct.hashCode(this._minx),t=37*t+Ct.hashCode(this._maxx),t=37*t+Ct.hashCode(this._miny),t=37*t+Ct.hashCode(this._maxy),t};Xe.prototype.interfaces_=function(){return[Da,Na]};Xe.prototype.getClass=function(){return Xe};Xe.intersects=function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],r=arguments[2];return r.x>=(t.x<e.x?t.x:e.x)&&r.x<=(t.x>e.x?t.x:e.x)&&r.y>=(t.y<e.y?t.y:e.y)&&r.y<=(t.y>e.y?t.y:e.y)}else if(arguments.length===4){var s=arguments[0],c=arguments[1],p=arguments[2],l=arguments[3],x=Math.min(p.x,l.x),I=Math.max(p.x,l.x),T=Math.min(s.x,c.x),P=Math.max(s.x,c.x);return!(T>I||P<x||(x=Math.min(p.y,l.y),I=Math.max(p.y,l.y),T=Math.min(s.y,c.y),P=Math.max(s.y,c.y),T>I)||P<x)}};$x.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(Xe,$x);var wl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Py=function(t){this.geometryFactory=t||new Pn};Py.prototype.read=function(t){var e,r,s;t=t.replace(/[\n\r]/g," ");var c=wl.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(c=wl.emptyTypeStr.exec(t),c[2]=void 0),c&&(r=c[1].toLowerCase(),s=c[2],pd[r]&&(e=pd[r].apply(this,[s]))),e===void 0)throw new Error("Could not parse WKT "+t);return e};Py.prototype.write=function(t){return this.extractGeometry(t)};Py.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Hu[e])return null;var r=e.toUpperCase(),s;return t.isEmpty()?s=r+" EMPTY":s=r+"("+Hu[e].apply(this,[t])+")",s};var Hu={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Hu.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=this,r=[],s=0,c=t._geometries.length;s<c;++s)r.push("("+Hu.point.apply(e,[t._geometries[s]])+")");return r.join(",")},linestring:function(t){for(var e=this,r=[],s=0,c=t._points._coordinates.length;s<c;++s)r.push(Hu.coordinate.apply(e,[t._points._coordinates[s]]));return r.join(",")},linearring:function(t){for(var e=this,r=[],s=0,c=t._points._coordinates.length;s<c;++s)r.push(Hu.coordinate.apply(e,[t._points._coordinates[s]]));return r.join(",")},multilinestring:function(t){for(var e=this,r=[],s=0,c=t._geometries.length;s<c;++s)r.push("("+Hu.linestring.apply(e,[t._geometries[s]])+")");return r.join(",")},polygon:function(t){var e=this,r=[];r.push("("+Hu.linestring.apply(this,[t._shell])+")");for(var s=0,c=t._holes.length;s<c;++s)r.push("("+Hu.linestring.apply(e,[t._holes[s]])+")");return r.join(",")},multipolygon:function(t){for(var e=this,r=[],s=0,c=t._geometries.length;s<c;++s)r.push("("+Hu.polygon.apply(e,[t._geometries[s]])+")");return r.join(",")},geometrycollection:function(t){for(var e=this,r=[],s=0,c=t._geometries.length;s<c;++s)r.push(e.extractGeometry(t._geometries[s]));return r.join(",")}},pd={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var e=t.trim().split(wl.spaces);return this.geometryFactory.createPoint(new Ct(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,s=t.trim().split(","),c=[],p=0,l=s.length;p<l;++p)r=s[p].replace(wl.trimParens,"$1"),c.push(pd.point.apply(e,[r]));return this.geometryFactory.createMultiPoint(c)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var e=t.trim().split(","),r=[],s,c=0,p=e.length;c<p;++c)s=e[c].trim().split(wl.spaces),r.push(new Ct(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var e=t.trim().split(","),r=[],s,c=0,p=e.length;c<p;++c)s=e[c].trim().split(wl.spaces),r.push(new Ct(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,s=t.trim().split(wl.parenComma),c=[],p=0,l=s.length;p<l;++p)r=s[p].replace(wl.trimParens,"$1"),c.push(pd.linestring.apply(e,[r]));return this.geometryFactory.createMultiLineString(c)},polygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,s,c,p=t.trim().split(wl.parenComma),l,x=[],I=0,T=p.length;I<T;++I)r=p[I].replace(wl.trimParens,"$1"),s=pd.linestring.apply(e,[r]),c=e.geometryFactory.createLinearRing(s._points),I===0?l=c:x.push(c);return this.geometryFactory.createPolygon(l,x)},multipolygon:function(t){var e=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,s=t.trim().split(wl.doubleParenComma),c=[],p=0,l=s.length;p<l;++p)r=s[p].replace(wl.trimParens,"$1"),c.push(pd.polygon.apply(e,[r]));return this.geometryFactory.createMultiPolygon(c)},geometrycollection:function(t){var e=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),s=[],c=0,p=r.length;c<p;++c)s.push(e.read(r[c]));return this.geometryFactory.createGeometryCollection(s)}},Ya=function(t){this.parser=new Py(t)};Ya.prototype.write=function(t){return this.parser.write(t)};Ya.toLineString=function(t,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var ec=function(n){function t(e){n.call(this,e),this.name="RuntimeException",this.message=e,this.stack=new n().stack}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Error),hy=function(n){function t(){if(n.call(this),arguments.length===0)n.call(this);else if(arguments.length===1){var e=arguments[0];n.call(this,e)}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ec),xn=function(){};xn.prototype.interfaces_=function(){return[]};xn.prototype.getClass=function(){return xn};xn.shouldNeverReachHere=function(){if(arguments.length===0)xn.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new hy("Should never reach here"+(t!==null?": "+t:""))}};xn.isTrue=function(){var t,e;if(arguments.length===1)t=arguments[0],xn.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],e=arguments[1],!t))throw e===null?new hy:new hy(e)};xn.equals=function(){var t,e,r;if(arguments.length===2)t=arguments[0],e=arguments[1],xn.equals(t,e,null);else if(arguments.length===3&&(t=arguments[0],e=arguments[1],r=arguments[2],!e.equals(t)))throw new hy("Expected "+t+" but encountered "+e+(r!==null?": "+r:""))};var Wr=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Ct,this._intPt[1]=new Ct,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},op={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Wr.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]};Wr.prototype.getTopologySummary=function(){var t=new Fl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};Wr.prototype.computeIntersection=function(t,e,r,s){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=r,this._inputLines[1][1]=s,this._result=this.computeIntersect(t,e,r,s)};Wr.prototype.getIntersectionNum=function(){return this._result};Wr.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],e=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);e>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};Wr.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};Wr.prototype.setPrecisionModel=function(t){this._precisionModel=t};Wr.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var e=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[e][0])||t._intPt[r].equals2D(t._inputLines[e][1])))return!0;return!1}};Wr.prototype.getIntersection=function(t){return this._intPt[t]};Wr.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};Wr.prototype.hasIntersection=function(){return this._result!==Wr.NO_INTERSECTION};Wr.prototype.getEdgeDistance=function(t,e){var r=Wr.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1]);return r};Wr.prototype.isCollinear=function(){return this._result===Wr.COLLINEAR_INTERSECTION};Wr.prototype.toString=function(){return Ya.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ya.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};Wr.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]};Wr.prototype.isIntersection=function(t){for(var e=this,r=0;r<this._result;r++)if(e._intPt[r].equals2D(t))return!0;return!1};Wr.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]};Wr.prototype.interfaces_=function(){return[]};Wr.prototype.getClass=function(){return Wr};Wr.computeEdgeDistance=function(t,e,r){var s=Math.abs(r.x-e.x),c=Math.abs(r.y-e.y),p=-1;if(t.equals(e))p=0;else if(t.equals(r))s>c?p=s:p=c;else{var l=Math.abs(t.x-e.x),x=Math.abs(t.y-e.y);s>c?p=l:p=x,p===0&&!t.equals(e)&&(p=Math.max(l,x))}return xn.isTrue(!(p===0&&!t.equals(e)),"Bad distance calculation"),p};Wr.nonRobustComputeEdgeDistance=function(t,e,r){var s=t.x-e.x,c=t.y-e.y,p=Math.sqrt(s*s+c*c);return xn.isTrue(!(p===0&&!t.equals(e)),"Invalid distance calculation"),p};op.DONT_INTERSECT.get=function(){return 0};op.DO_INTERSECT.get=function(){return 1};op.COLLINEAR.get=function(){return 2};op.NO_INTERSECTION.get=function(){return 0};op.POINT_INTERSECTION.get=function(){return 1};op.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Wr,op);var $h=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var s=new Xe(this._inputLines[0][0],this._inputLines[0][1]),c=new Xe(this._inputLines[1][0],this._inputLines[1][1]);return s.contains(r)&&c.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];if(this._isProper=!1,Xe.intersects(s,c,r)&&Te.orientationIndex(s,c,r)===0&&Te.orientationIndex(c,s,r)===0)return this._isProper=!0,(r.equals(s)||r.equals(c))&&(this._isProper=!1),this._result=n.POINT_INTERSECTION,null;this._result=n.NO_INTERSECTION}else return n.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,s,c,p,l){l.x=this.smallestInAbsValue(r.x,s.x,c.x,p.x),l.y=this.smallestInAbsValue(r.y,s.y,c.y,p.y),r.x-=l.x,r.y-=l.y,s.x-=l.x,s.y-=l.y,c.x-=l.x,c.y-=l.y,p.x-=l.x,p.y-=l.y},t.prototype.safeHCoordinateIntersection=function(r,s,c,p){var l=null;try{l=Xa.intersection(r,s,c,p)}catch(x){if(x instanceof jd)l=t.nearestEndpoint(r,s,c,p);else throw x}finally{}return l},t.prototype.intersection=function(r,s,c,p){var l=this.intersectionWithNormalization(r,s,c,p);return this.isInSegmentEnvelopes(l)||(l=new Ct(t.nearestEndpoint(r,s,c,p))),this._precisionModel!==null&&this._precisionModel.makePrecise(l),l},t.prototype.smallestInAbsValue=function(r,s,c,p){var l=r,x=Math.abs(l);return Math.abs(s)<x&&(l=s,x=Math.abs(s)),Math.abs(c)<x&&(l=c,x=Math.abs(c)),Math.abs(p)<x&&(l=p),l},t.prototype.checkDD=function(r,s,c,p,l){var x=gs.intersection(r,s,c,p),I=this.isInSegmentEnvelopes(x);po.out.println("DD in env = "+I+"  --------------------- "+x),l.distance(x)>1e-4&&po.out.println("Distance = "+l.distance(x))},t.prototype.intersectionWithNormalization=function(r,s,c,p){var l=new Ct(r),x=new Ct(s),I=new Ct(c),T=new Ct(p),P=new Ct;this.normalizeToEnvCentre(l,x,I,T,P);var D=this.safeHCoordinateIntersection(l,x,I,T);return D.x+=P.x,D.y+=P.y,D},t.prototype.computeCollinearIntersection=function(r,s,c,p){var l=Xe.intersects(r,s,c),x=Xe.intersects(r,s,p),I=Xe.intersects(c,p,r),T=Xe.intersects(c,p,s);return l&&x?(this._intPt[0]=c,this._intPt[1]=p,n.COLLINEAR_INTERSECTION):I&&T?(this._intPt[0]=r,this._intPt[1]=s,n.COLLINEAR_INTERSECTION):l&&I?(this._intPt[0]=c,this._intPt[1]=r,c.equals(r)&&!x&&!T?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):l&&T?(this._intPt[0]=c,this._intPt[1]=s,c.equals(s)&&!x&&!I?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):x&&I?(this._intPt[0]=p,this._intPt[1]=r,p.equals(r)&&!l&&!T?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):x&&T?(this._intPt[0]=p,this._intPt[1]=s,p.equals(s)&&!l&&!I?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):n.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,s,c,p,l){var x=r.x<s.x?r.x:s.x,I=r.y<s.y?r.y:s.y,T=r.x>s.x?r.x:s.x,P=r.y>s.y?r.y:s.y,D=c.x<p.x?c.x:p.x,G=c.y<p.y?c.y:p.y,Y=c.x>p.x?c.x:p.x,et=c.y>p.y?c.y:p.y,at=x>D?x:D,rt=T<Y?T:Y,wt=I>G?I:G,xt=P<et?P:et,Gt=(at+rt)/2,ee=(wt+xt)/2;l.x=Gt,l.y=ee,r.x-=l.x,r.y-=l.y,s.x-=l.x,s.y-=l.y,c.x-=l.x,c.y-=l.y,p.x-=l.x,p.y-=l.y},t.prototype.computeIntersect=function(r,s,c,p){if(this._isProper=!1,!Xe.intersects(r,s,c,p))return n.NO_INTERSECTION;var l=Te.orientationIndex(r,s,c),x=Te.orientationIndex(r,s,p);if(l>0&&x>0||l<0&&x<0)return n.NO_INTERSECTION;var I=Te.orientationIndex(c,p,r),T=Te.orientationIndex(c,p,s);if(I>0&&T>0||I<0&&T<0)return n.NO_INTERSECTION;var P=l===0&&x===0&&I===0&&T===0;return P?this.computeCollinearIntersection(r,s,c,p):(l===0||x===0||I===0||T===0?(this._isProper=!1,r.equals2D(c)||r.equals2D(p)?this._intPt[0]=r:s.equals2D(c)||s.equals2D(p)?this._intPt[0]=s:l===0?this._intPt[0]=new Ct(c):x===0?this._intPt[0]=new Ct(p):I===0?this._intPt[0]=new Ct(r):T===0&&(this._intPt[0]=new Ct(s))):(this._isProper=!0,this._intPt[0]=this.intersection(r,s,c,p)),n.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,s,c,p){var l=r,x=Te.distancePointLine(r,c,p),I=Te.distancePointLine(s,c,p);return I<x&&(x=I,l=s),I=Te.distancePointLine(c,r,s),I<x&&(x=I,l=c),I=Te.distancePointLine(p,r,s),I<x&&(x=I,l=p),l},t}(Wr),Yf=function(){};Yf.prototype.interfaces_=function(){return[]};Yf.prototype.getClass=function(){return Yf};Yf.orientationIndex=function(t,e,r){var s=e.x-t.x,c=e.y-t.y,p=r.x-e.x,l=r.y-e.y;return Yf.signOfDet2x2(s,c,p,l)};Yf.signOfDet2x2=function(t,e,r,s){var c=null,p=null,l=null;if(c=1,t===0||s===0)return e===0||r===0?0:e>0?r>0?-c:c:r>0?c:-c;if(e===0||r===0)return s>0?t>0?c:-c:t>0?-c:c;if(e>0?s>0?e<=s||(c=-c,p=t,t=r,r=p,p=e,e=s,s=p):e<=-s?(c=-c,r=-r,s=-s):(p=t,t=-r,r=p,p=e,e=-s,s=p):s>0?-e<=s?(c=-c,t=-t,e=-e):(p=-t,t=r,r=p,p=-e,e=s,s=p):e>=s?(t=-t,e=-e,r=-r,s=-s):(c=-c,p=-t,t=-r,r=p,p=-e,e=-s,s=p),t>0)if(r>0){if(!(t<=r))return c}else return c;else{if(r>0)return-c;if(t>=r)c=-c,t=-t,r=-r;else return-c}for(;;){if(l=Math.floor(r/t),r=r-l*t,s=s-l*e,s<0)return-c;if(s>e)return c;if(t>r+r){if(e<s+s)return c}else{if(e>s+s)return-c;r=t-r,s=e-s,c=-c}if(s===0)return r===0?0:-c;if(r===0||(l=Math.floor(t/r),t=t-l*r,e=e-l*s,e<0))return c;if(e>s)return-c;if(r>t+t){if(s<e+e)return-c}else{if(s>e+e)return c;t=r-t,e=s-e,c=-c}if(e===0)return t===0?0:c;if(t===0)return-c}};var Cl=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Cl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var r=t.x,s=e.x;return r>s&&(r=e.x,s=t.x),this._p.x>=r&&this._p.x<=s&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var c=t.x-this._p.x,p=t.y-this._p.y,l=e.x-this._p.x,x=e.y-this._p.y,I=Yf.signOfDet2x2(c,p,l,x);if(I===0)return this._isPointOnSegment=!0,null;x<p&&(I=-I),I>0&&this._crossingCount++}};Cl.prototype.isPointInPolygon=function(){return this.getLocation()!==Pt.EXTERIOR};Cl.prototype.getLocation=function(){return this._isPointOnSegment?Pt.BOUNDARY:this._crossingCount%2===1?Pt.INTERIOR:Pt.EXTERIOR};Cl.prototype.isOnSegment=function(){return this._isPointOnSegment};Cl.prototype.interfaces_=function(){return[]};Cl.prototype.getClass=function(){return Cl};Cl.locatePointInRing=function(){if(arguments[0]instanceof Ct&&nn(arguments[1],Fn)){for(var t=arguments[0],e=arguments[1],r=new Cl(t),s=new Ct,c=new Ct,p=1;p<e.size();p++)if(e.getCoordinate(p,s),e.getCoordinate(p-1,c),r.countSegment(s,c),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof Ct&&arguments[1]instanceof Array){for(var l=arguments[0],x=arguments[1],I=new Cl(l),T=1;T<x.length;T++){var P=x[T],D=x[T-1];if(I.countSegment(P,D),I.isOnSegment())return I.getLocation()}return I.getLocation()}};var Te=function(){},sp={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Te.prototype.interfaces_=function(){return[]};Te.prototype.getClass=function(){return Te};Te.orientationIndex=function(t,e,r){return gs.orientationIndex(t,e,r)};Te.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,r=t[0].x,s=1;s<t.length-1;s++){var c=t[s].x-r,p=t[s+1].y,l=t[s-1].y;e+=c*(l-p)}return e/2}else if(nn(arguments[0],Fn)){var x=arguments[0],I=x.size();if(I<3)return 0;var T=new Ct,P=new Ct,D=new Ct;x.getCoordinate(0,P),x.getCoordinate(1,D);var G=P.x;D.x-=G;for(var Y=0,et=1;et<I-1;et++)T.y=P.y,P.x=D.x,P.y=D.y,x.getCoordinate(et+1,D),D.x-=G,Y+=P.x*(T.y-D.y);return Y/2}};Te.distanceLineLine=function(t,e,r,s){if(t.equals(e))return Te.distancePointLine(t,r,s);if(r.equals(s))return Te.distancePointLine(s,t,e);var c=!1;if(!Xe.intersects(t,e,r,s))c=!0;else{var p=(e.x-t.x)*(s.y-r.y)-(e.y-t.y)*(s.x-r.x);if(p===0)c=!0;else{var l=(t.y-r.y)*(s.x-r.x)-(t.x-r.x)*(s.y-r.y),x=(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y),I=x/p,T=l/p;(T<0||T>1||I<0||I>1)&&(c=!0)}}return c?ea.min(Te.distancePointLine(t,r,s),Te.distancePointLine(e,r,s),Te.distancePointLine(r,t,e),Te.distancePointLine(s,t,e)):0};Te.isPointInRing=function(t,e){return Te.locatePointInRing(t,e)!==Pt.EXTERIOR};Te.computeLength=function(t){var e=t.size();if(e<=1)return 0;var r=0,s=new Ct;t.getCoordinate(0,s);for(var c=s.x,p=s.y,l=1;l<e;l++){t.getCoordinate(l,s);var x=s.x,I=s.y,T=x-c,P=I-p;r+=Math.sqrt(T*T+P*P),c=x,p=I}return r};Te.isCCW=function(t){var e=t.length-1;if(e<3)throw new Dr("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],s=0,c=1;c<=e;c++){var p=t[c];p.y>r.y&&(r=p,s=c)}var l=s;do l=l-1,l<0&&(l=e);while(t[l].equals2D(r)&&l!==s);var x=s;do x=(x+1)%e;while(t[x].equals2D(r)&&x!==s);var I=t[l],T=t[x];if(I.equals2D(r)||T.equals2D(r)||I.equals2D(T))return!1;var P=Te.computeOrientation(I,r,T),D=!1;return P===0?D=I.x>T.x:D=P>0,D};Te.locatePointInRing=function(t,e){return Cl.locatePointInRing(t,e)};Te.distancePointLinePerpendicular=function(t,e,r){var s=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),c=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/s;return Math.abs(c)*Math.sqrt(s)};Te.computeOrientation=function(t,e,r){return Te.orientationIndex(t,e,r)};Te.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(e.length===0)throw new Dr("Line array must contain at least one vertex");for(var r=t.distance(e[0]),s=0;s<e.length-1;s++){var c=Te.distancePointLine(t,e[s],e[s+1]);c<r&&(r=c)}return r}else if(arguments.length===3){var p=arguments[0],l=arguments[1],x=arguments[2];if(l.x===x.x&&l.y===x.y)return p.distance(l);var I=(x.x-l.x)*(x.x-l.x)+(x.y-l.y)*(x.y-l.y),T=((p.x-l.x)*(x.x-l.x)+(p.y-l.y)*(x.y-l.y))/I;if(T<=0)return p.distance(l);if(T>=1)return p.distance(x);var P=((l.y-p.y)*(x.x-l.x)-(l.x-p.x)*(x.y-l.y))/I;return Math.abs(P)*Math.sqrt(I)}};Te.isOnLine=function(t,e){for(var r=new $h,s=1;s<e.length;s++){var c=e[s-1],p=e[s];if(r.computeIntersection(t,c,p),r.hasIntersection())return!0}return!1};sp.CLOCKWISE.get=function(){return-1};sp.RIGHT.get=function(){return Te.CLOCKWISE};sp.COUNTERCLOCKWISE.get=function(){return 1};sp.LEFT.get=function(){return Te.COUNTERCLOCKWISE};sp.COLLINEAR.get=function(){return 0};sp.STRAIGHT.get=function(){return Te.COLLINEAR};Object.defineProperties(Te,sp);var nc=function(){};nc.prototype.filter=function(t){};nc.prototype.interfaces_=function(){return[]};nc.prototype.getClass=function(){return nc};var Qe=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Eu={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Qe.prototype.isGeometryCollection=function(){return this.getSortIndex()===Qe.SORTINDEX_GEOMETRYCOLLECTION};Qe.prototype.getFactory=function(){return this._factory};Qe.prototype.getGeometryN=function(t){return this};Qe.prototype.getArea=function(){return 0};Qe.prototype.isRectangle=function(){return!1};Qe.prototype.equals=function(){if(arguments[0]instanceof Qe){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof Qe))return!1;var r=e;return this.equalsExact(r)}};Qe.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Qe.prototype.geometryChanged=function(){this.apply(Qe.geometryChangedFilter)};Qe.prototype.geometryChangedAction=function(){this._envelope=null};Qe.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Qe.prototype.getLength=function(){return 0};Qe.prototype.getNumGeometries=function(){return 1};Qe.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,s)}};Qe.prototype.getUserData=function(){return this._userData};Qe.prototype.getSRID=function(){return this._SRID};Qe.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Qe.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Qe.SORTINDEX_GEOMETRYCOLLECTION)throw new Dr("This method does not support GeometryCollection arguments")};Qe.prototype.equal=function(t,e,r){return r===0?t.equals(e):t.distance(e)<=r};Qe.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Qe.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Qe.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Xe(this._envelope)};Qe.prototype.setSRID=function(t){this._SRID=t};Qe.prototype.setUserData=function(t){this._userData=t};Qe.prototype.compare=function(t,e){for(var r=t.iterator(),s=e.iterator();r.hasNext()&&s.hasNext();){var c=r.next(),p=s.next(),l=c.compareTo(p);if(l!==0)return l}return r.hasNext()?1:s.hasNext()?-1:0};Qe.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Qe.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Qe.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Qe.SORTINDEX_MULTIPOINT||this.getSortIndex()===Qe.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Qe.SORTINDEX_MULTIPOLYGON};Qe.prototype.interfaces_=function(){return[Ay,Da,Na]};Qe.prototype.getClass=function(){return Qe};Qe.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1};Qe.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1};Eu.serialVersionUID.get=function(){return 8763622679187377e3};Eu.SORTINDEX_POINT.get=function(){return 0};Eu.SORTINDEX_MULTIPOINT.get=function(){return 1};Eu.SORTINDEX_LINESTRING.get=function(){return 2};Eu.SORTINDEX_LINEARRING.get=function(){return 3};Eu.SORTINDEX_MULTILINESTRING.get=function(){return 4};Eu.SORTINDEX_POLYGON.get=function(){return 5};Eu.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Eu.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Eu.geometryChangedFilter.get=function(){return d0};Object.defineProperties(Qe,Eu);var d0=function(){};d0.interfaces_=function(){return[nc]};d0.filter=function(t){t.geometryChangedAction()};var gu=function(){};gu.prototype.filter=function(t){};gu.prototype.interfaces_=function(){return[]};gu.prototype.getClass=function(){return gu};var Pa=function(){},ac={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Pa.prototype.isInBoundary=function(t){};Pa.prototype.interfaces_=function(){return[]};Pa.prototype.getClass=function(){return Pa};ac.Mod2BoundaryNodeRule.get=function(){return Id};ac.EndPointBoundaryNodeRule.get=function(){return Ed};ac.MultiValentEndPointBoundaryNodeRule.get=function(){return Sd};ac.MonoValentEndPointBoundaryNodeRule.get=function(){return Cd};ac.MOD2_BOUNDARY_RULE.get=function(){return new Id};ac.ENDPOINT_BOUNDARY_RULE.get=function(){return new Ed};ac.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Sd};ac.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Cd};ac.OGC_SFS_BOUNDARY_RULE.get=function(){return Pa.MOD2_BOUNDARY_RULE};Object.defineProperties(Pa,ac);var Id=function(){};Id.prototype.isInBoundary=function(t){return t%2===1};Id.prototype.interfaces_=function(){return[Pa]};Id.prototype.getClass=function(){return Id};var Ed=function(){};Ed.prototype.isInBoundary=function(t){return t>0};Ed.prototype.interfaces_=function(){return[Pa]};Ed.prototype.getClass=function(){return Ed};var Sd=function(){};Sd.prototype.isInBoundary=function(t){return t>1};Sd.prototype.interfaces_=function(){return[Pa]};Sd.prototype.getClass=function(){return Sd};var Cd=function(){};Cd.prototype.isInBoundary=function(t){return t===1};Cd.prototype.interfaces_=function(){return[Pa]};Cd.prototype.getClass=function(){return Cd};var Di=function(){};Di.prototype.add=function(){};Di.prototype.addAll=function(){};Di.prototype.isEmpty=function(){};Di.prototype.iterator=function(){};Di.prototype.size=function(){};Di.prototype.toArray=function(){};Di.prototype.remove=function(){};function g0(n){this.message=n||""}g0.prototype=new Error;g0.prototype.name="IndexOutOfBoundsException";var Hd=function(){};Hd.prototype.hasNext=function(){};Hd.prototype.next=function(){};Hd.prototype.remove=function(){};var Za=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Di);function Kd(n){this.message=n||""}Kd.prototype=new Error;Kd.prototype.name="NoSuchElementException";var ve=function(n){function t(){n.call(this),this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[n,Di]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var s=this,c=r.iterator();c.hasNext();)s.add(c.next());return!0},t.prototype.set=function(r,s){var c=this.array_[r];return this.array_[r]=s,c},t.prototype.iterator=function(){return new pE(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new g0;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,s=[],c=0,p=this.array_.length;c<p;c++)s.push(r.array_[c]);return s},t.prototype.remove=function(r){for(var s=this,c=!1,p=0,l=this.array_.length;p<l;p++)if(s.array_[p]===r){s.array_.splice(p,1),c=!0;break}return c},t}(Za),pE=function(n){function t(e){n.call(this),this.arrayList_=e,this.position_=0}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Kd;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(Hd),Cm=function(n){function t(){if(n.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.ensureCapacity(s.length),this.add(s,c)}}}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(s){return this.get(s)},t.prototype.addAll=function(){var s=this;if(arguments.length===2){for(var c=arguments[0],p=arguments[1],l=!1,x=c.iterator();x.hasNext();)s.add(x.next(),p),l=!0;return l}else return n.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var s=this,c=n.prototype.clone.call(this),p=0;p<this.size();p++)c.add(p,s.get(p).copy());return c},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var s=this;if(arguments.length===1){var c=arguments[0];n.prototype.add.call(this,c)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],l=arguments[1];return this.add(p,l,!0),!0}else if(arguments[0]instanceof Ct&&typeof arguments[1]=="boolean"){var x=arguments[0],I=arguments[1];if(!I&&this.size()>=1){var T=this.get(this.size()-1);if(T.equals2D(x))return null}n.prototype.add.call(this,x)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var P=arguments[0],D=arguments[1];return this.add(P,D),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var G=arguments[0],Y=arguments[1],et=arguments[2];if(et)for(var at=0;at<G.length;at++)s.add(G[at],Y);else for(var rt=G.length-1;rt>=0;rt--)s.add(G[rt],Y);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Ct){var wt=arguments[0],xt=arguments[1],Gt=arguments[2];if(!Gt){var ee=this.size();if(ee>0){if(wt>0){var $t=this.get(wt-1);if($t.equals2D(xt))return null}if(wt<ee){var Zt=this.get(wt);if(Zt.equals2D(xt))return null}}}n.prototype.add.call(this,wt,xt)}}else if(arguments.length===4){var Mt=arguments[0],It=arguments[1],Wt=arguments[2],ft=arguments[3],re=1;Wt>ft&&(re=-1);for(var Yt=Wt;Yt!==ft;Yt+=re)s.add(Mt[Yt],It);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new Ct(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(ve),Ln=function(){},Ly={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Ly.ForwardComparator.get=function(){return um};Ly.BidirectionalComparator.get=function(){return Td};Ly.coordArrayType.get=function(){return new Array(0).fill(null)};Ln.prototype.interfaces_=function(){return[]};Ln.prototype.getClass=function(){return Ln};Ln.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};Ln.ptNotInList=function(t,e){for(var r=0;r<t.length;r++){var s=t[r];if(Ln.indexOf(s,e)<0)return s}return null};Ln.scroll=function(t,e){var r=Ln.indexOf(e,t);if(r<0)return null;var s=new Array(t.length).fill(null);po.arraycopy(t,r,s,0,t.length-r),po.arraycopy(t,0,s,t.length-r,r),po.arraycopy(s,0,t,0,t.length)};Ln.equals=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(e[r]))return!1;return!0}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(s===c)return!0;if(s===null||c===null||s.length!==c.length)return!1;for(var l=0;l<s.length;l++)if(p.compare(s[l],c[l])!==0)return!1;return!0}};Ln.intersection=function(t,e){for(var r=new Cm,s=0;s<t.length;s++)e.intersects(t[s])&&r.add(t[s],!0);return r.toCoordinateArray()};Ln.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1};Ln.removeRepeatedPoints=function(t){if(!Ln.hasRepeatedPoints(t))return t;var e=new Cm(t,!1);return e.toCoordinateArray()};Ln.reverse=function(t){for(var e=t.length-1,r=Math.trunc(e/2),s=0;s<=r;s++){var c=t[s];t[s]=t[e-s],t[e-s]=c}};Ln.removeNull=function(t){for(var e=0,r=0;r<t.length;r++)t[r]!==null&&e++;var s=new Array(e).fill(null);if(e===0)return s;for(var c=0,p=0;p<t.length;p++)t[p]!==null&&(s[c++]=t[p]);return s};Ln.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),r=0;r<t.length;r++)e[r]=new Ct(t[r]);return e}else if(arguments.length===5)for(var s=arguments[0],c=arguments[1],p=arguments[2],l=arguments[3],x=arguments[4],I=0;I<x;I++)p[l+I]=new Ct(s[c+I])};Ln.isEqualReversed=function(t,e){for(var r=0;r<t.length;r++){var s=t[r],c=e[t.length-r-1];if(s.compareTo(c)!==0)return!1}return!0};Ln.envelope=function(t){for(var e=new Xe,r=0;r<t.length;r++)e.expandToInclude(t[r]);return e};Ln.toCoordinateArray=function(t){return t.toArray(Ln.coordArrayType)};Ln.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]};Ln.indexOf=function(t,e){for(var r=0;r<e.length;r++)if(t.equals(e[r]))return r;return-1};Ln.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var r=t.length-1-e,s=t[e].compareTo(t[r]);if(s!==0)return s}return 1};Ln.compare=function(t,e){for(var r=0;r<t.length&&r<e.length;){var s=t[r].compareTo(e[r]);if(s!==0)return s;r++}return r<e.length?-1:r<t.length?1:0};Ln.minCoordinate=function(t){for(var e=null,r=0;r<t.length;r++)(e===null||e.compareTo(t[r])>0)&&(e=t[r]);return e};Ln.extract=function(t,e,r){e=ea.clamp(e,0,t.length),r=ea.clamp(r,-1,t.length);var s=r-e+1;r<0&&(s=0),e>=t.length&&(s=0),r<e&&(s=0);var c=new Array(s).fill(null);if(s===0)return c;for(var p=0,l=e;l<=r;l++)c[p++]=t[l];return c};Object.defineProperties(Ln,Ly);var um=function(){};um.prototype.compare=function(t,e){var r=t,s=e;return Ln.compare(r,s)};um.prototype.interfaces_=function(){return[bd]};um.prototype.getClass=function(){return um};var Td=function(){};Td.prototype.compare=function(t,e){var r=t,s=e;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;var c=Ln.compare(r,s),p=Ln.isEqualReversed(r,s);return p?0:c};Td.prototype.OLDcompare=function(t,e){var r=t,s=e;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;for(var c=Ln.increasingDirection(r),p=Ln.increasingDirection(s),l=c>0?0:r.length-1,x=p>0?0:r.length-1,I=0;I<r.length;I++){var T=r[l].compareTo(s[x]);if(T!==0)return T;l+=c,x+=p}return 0};Td.prototype.interfaces_=function(){return[bd]};Td.prototype.getClass=function(){return Td};var ap=function(){};ap.prototype.get=function(){};ap.prototype.put=function(){};ap.prototype.size=function(){};ap.prototype.values=function(){};ap.prototype.entrySet=function(){};var dE=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(ap);function Tm(n){this.message=n||""}Tm.prototype=new Error;Tm.prototype.name="OperationNotSupported";function My(){}My.prototype=new Di;My.prototype.contains=function(){};var m0=function(n){function t(){n.call(this),this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var s=this,c=0,p=this.array_.length;c<p;c++){var l=s.array_[c];if(l===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var s=this,c=r.iterator();c.hasNext();)s.add(c.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,s=[],c=0,p=this.array_.length;c<p;c++)s.push(r.array_[c]);return s},t.prototype.iterator=function(){return new gE(this)},t}(My),gE=function(n){function t(e){n.call(this),this.hashSet_=e,this.position_=0}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Kd;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new Tm},t}(Hd),Ju=0,Fh=1;function _1(n){return n===null?Ju:n.color}function vr(n){return n===null?null:n.parent}function ju(n,t){n!==null&&(n.color=t)}function kv(n){return n===null?null:n.left}function y1(n){return n===null?null:n.right}function Ao(){this.root_=null,this.size_=0}Ao.prototype=new dE;Ao.prototype.get=function(n){for(var t=this.root_;t!==null;){var e=n.compareTo(t.key);if(e<0)t=t.left;else if(e>0)t=t.right;else return t.value}return null};Ao.prototype.put=function(n,t){if(this.root_===null)return this.root_={key:n,value:t,left:null,right:null,parent:null,color:Ju,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var e=this.root_,r,s;do if(r=e,s=n.compareTo(e.key),s<0)e=e.left;else if(s>0)e=e.right;else{var c=e.value;return e.value=t,c}while(e!==null);var p={key:n,left:null,right:null,value:t,parent:r,color:Ju,getValue:function(){return this.value},getKey:function(){return this.key}};return s<0?r.left=p:r.right=p,this.fixAfterInsertion(p),this.size_++,null};Ao.prototype.fixAfterInsertion=function(n){var t=this;for(n.color=Fh;n!=null&&n!==this.root_&&n.parent.color===Fh;)if(vr(n)===kv(vr(vr(n)))){var e=y1(vr(vr(n)));_1(e)===Fh?(ju(vr(n),Ju),ju(e,Ju),ju(vr(vr(n)),Fh),n=vr(vr(n))):(n===y1(vr(n))&&(n=vr(n),t.rotateLeft(n)),ju(vr(n),Ju),ju(vr(vr(n)),Fh),t.rotateRight(vr(vr(n))))}else{var r=kv(vr(vr(n)));_1(r)===Fh?(ju(vr(n),Ju),ju(r,Ju),ju(vr(vr(n)),Fh),n=vr(vr(n))):(n===kv(vr(n))&&(n=vr(n),t.rotateRight(n)),ju(vr(n),Ju),ju(vr(vr(n)),Fh),t.rotateLeft(vr(vr(n))))}this.root_.color=Ju};Ao.prototype.values=function(){var n=new ve,t=this.getFirstEntry();if(t!==null)for(n.add(t.value);(t=Ao.successor(t))!==null;)n.add(t.value);return n};Ao.prototype.entrySet=function(){var n=new m0,t=this.getFirstEntry();if(t!==null)for(n.add(t);(t=Ao.successor(t))!==null;)n.add(t);return n};Ao.prototype.rotateLeft=function(n){if(n!=null){var t=n.right;n.right=t.left,t.left!=null&&(t.left.parent=n),t.parent=n.parent,n.parent===null?this.root_=t:n.parent.left===n?n.parent.left=t:n.parent.right=t,t.left=n,n.parent=t}};Ao.prototype.rotateRight=function(n){if(n!=null){var t=n.left;n.left=t.right,t.right!=null&&(t.right.parent=n),t.parent=n.parent,n.parent===null?this.root_=t:n.parent.right===n?n.parent.right=t:n.parent.left=t,t.right=n,n.parent=t}};Ao.prototype.getFirstEntry=function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n};Ao.successor=function(n){if(n===null)return null;if(n.right!==null){for(var t=n.right;t.left!==null;)t=t.left;return t}else{for(var e=n.parent,r=n;e!==null&&r===e.right;)r=e,e=e.parent;return e}};Ao.prototype.size=function(){return this.size_};var cm=function(){};cm.prototype.interfaces_=function(){return[]};cm.prototype.getClass=function(){return cm};function tb(){}tb.prototype=new My;function Pl(){this.array_=[],arguments[0]instanceof Di&&this.addAll(arguments[0])}Pl.prototype=new tb;Pl.prototype.contains=function(n){for(var t=this,e=0,r=this.array_.length;e<r;e++){var s=t.array_[e];if(s.compareTo(n)===0)return!0}return!1};Pl.prototype.add=function(n){var t=this;if(this.contains(n))return!1;for(var e=0,r=this.array_.length;e<r;e++){var s=t.array_[e];if(s.compareTo(n)===1)return t.array_.splice(e,0,n),!0}return this.array_.push(n),!0};Pl.prototype.addAll=function(n){for(var t=this,e=n.iterator();e.hasNext();)t.add(e.next());return!0};Pl.prototype.remove=function(n){throw new Tm};Pl.prototype.size=function(){return this.array_.length};Pl.prototype.isEmpty=function(){return this.array_.length===0};Pl.prototype.toArray=function(){for(var n=this,t=[],e=0,r=this.array_.length;e<r;e++)t.push(n.array_[e]);return t};Pl.prototype.iterator=function(){return new Dy(this)};var Dy=function(n){this.treeSet_=n,this.position_=0};Dy.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Kd;return this.treeSet_.array_[this.position_++]};Dy.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};Dy.prototype.remove=function(){throw new Tm};var Vh=function(){};Vh.sort=function(){var t=arguments[0],e,r,s,c;if(arguments.length===1)c=function(l,x){return l.compareTo(x)},t.sort(c);else if(arguments.length===2)s=arguments[1],c=function(l,x){return s.compare(l,x)},t.sort(c);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var p=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),e=0;e<p.length;e++)t.push(p[e])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),s=arguments[3],c=function(l,x){return s.compare(l,x)},r.sort(c),p=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),e=0;e<p.length;e++)t.push(p[e])};Vh.asList=function(t){for(var e=new ve,r=0,s=t.length;r<s;r++)e.add(t[r]);return e};var jn=function(){},rl={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};rl.P.get=function(){return 0};rl.L.get=function(){return 1};rl.A.get=function(){return 2};rl.FALSE.get=function(){return-1};rl.TRUE.get=function(){return-2};rl.DONTCARE.get=function(){return-3};rl.SYM_FALSE.get=function(){return"F"};rl.SYM_TRUE.get=function(){return"T"};rl.SYM_DONTCARE.get=function(){return"*"};rl.SYM_P.get=function(){return"0"};rl.SYM_L.get=function(){return"1"};rl.SYM_A.get=function(){return"2"};jn.prototype.interfaces_=function(){return[]};jn.prototype.getClass=function(){return jn};jn.toDimensionSymbol=function(t){switch(t){case jn.FALSE:return jn.SYM_FALSE;case jn.TRUE:return jn.SYM_TRUE;case jn.DONTCARE:return jn.SYM_DONTCARE;case jn.P:return jn.SYM_P;case jn.L:return jn.SYM_L;case jn.A:return jn.SYM_A}throw new Dr("Unknown dimension value: "+t)};jn.toDimensionValue=function(t){switch(lm.toUpperCase(t)){case jn.SYM_FALSE:return jn.FALSE;case jn.SYM_TRUE:return jn.TRUE;case jn.SYM_DONTCARE:return jn.DONTCARE;case jn.SYM_P:return jn.P;case jn.SYM_L:return jn.L;case jn.SYM_A:return jn.A}throw new Dr("Unknown dimension symbol: "+t)};Object.defineProperties(jn,rl);var Ll=function(){};Ll.prototype.filter=function(t){};Ll.prototype.interfaces_=function(){return[]};Ll.prototype.getClass=function(){return Ll};var Wa=function(){};Wa.prototype.filter=function(t,e){};Wa.prototype.isDone=function(){};Wa.prototype.isGeometryChanged=function(){};Wa.prototype.interfaces_=function(){return[]};Wa.prototype.getClass=function(){return Wa};var Jo=function(n){function t(r,s){if(n.call(this,s),this._geometries=r||[],n.hasNullElements(this._geometries))throw new Dr("geometries must not contain null elements")}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var s=this,c=new Xe,p=0;p<this._geometries.length;p++)c.expandToInclude(s._geometries[p].getEnvelopeInternal());return c},t.prototype.getGeometryN=function(s){return this._geometries[s]},t.prototype.getSortIndex=function(){return n.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var s=this,c=new Array(this.getNumPoints()).fill(null),p=-1,l=0;l<this._geometries.length;l++)for(var x=s._geometries[l].getCoordinates(),I=0;I<x.length;I++)p++,c[p]=x[I];return c},t.prototype.getArea=function(){for(var s=this,c=0,p=0;p<this._geometries.length;p++)c+=s._geometries[p].getArea();return c},t.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var c=arguments[0],p=arguments[1];if(!this.isEquivalentClass(c))return!1;var l=c;if(this._geometries.length!==l._geometries.length)return!1;for(var x=0;x<this._geometries.length;x++)if(!s._geometries[x].equalsExact(l._geometries[x],p))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var s=this,c=0;c<this._geometries.length;c++)s._geometries[c].normalize();Vh.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var s=this,c=jn.FALSE,p=0;p<this._geometries.length;p++)c=Math.max(c,s._geometries[p].getBoundaryDimension());return c},t.prototype.getDimension=function(){for(var s=this,c=jn.FALSE,p=0;p<this._geometries.length;p++)c=Math.max(c,s._geometries[p].getDimension());return c},t.prototype.getLength=function(){for(var s=this,c=0,p=0;p<this._geometries.length;p++)c+=s._geometries[p].getLength();return c},t.prototype.getNumPoints=function(){for(var s=this,c=0,p=0;p<this._geometries.length;p++)c+=s._geometries[p].getNumPoints();return c},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var s=this,c=this._geometries.length,p=new Array(c).fill(null),l=0;l<this._geometries.length;l++)p[l]=s._geometries[l].reverse();return this.getFactory().createGeometryCollection(p)},t.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){var c=arguments[0],p=new Pl(Vh.asList(this._geometries)),l=new Pl(Vh.asList(c._geometries));return this.compare(p,l)}else if(arguments.length===2){for(var x=arguments[0],I=arguments[1],T=x,P=this.getNumGeometries(),D=T.getNumGeometries(),G=0;G<P&&G<D;){var Y=s.getGeometryN(G),et=T.getGeometryN(G),at=Y.compareToSameClass(et,I);if(at!==0)return at;G++}return G<P?1:G<D?-1:0}},t.prototype.apply=function(){var s=this;if(nn(arguments[0],gu))for(var c=arguments[0],p=0;p<this._geometries.length;p++)s._geometries[p].apply(c);else if(nn(arguments[0],Wa)){var l=arguments[0];if(this._geometries.length===0)return null;for(var x=0;x<this._geometries.length&&(s._geometries[x].apply(l),!l.isDone());x++);l.isGeometryChanged()&&this.geometryChanged()}else if(nn(arguments[0],Ll)){var I=arguments[0];I.filter(this);for(var T=0;T<this._geometries.length;T++)s._geometries[T].apply(I)}else if(nn(arguments[0],nc)){var P=arguments[0];P.filter(this);for(var D=0;D<this._geometries.length;D++)s._geometries[D].apply(P)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),xn.shouldNeverReachHere(),null},t.prototype.clone=function(){var s=this,c=n.prototype.clone.call(this);c._geometries=new Array(this._geometries.length).fill(null);for(var p=0;p<this._geometries.length;p++)c._geometries[p]=s._geometries[p].clone();return c},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var s=this,c=new Array(this._geometries.length).fill(null),p=0;p<c.length;p++)c[p]=s._geometries[p].copy();return new t(c,this._factory)},t.prototype.isEmpty=function(){for(var s=this,c=0;c<this._geometries.length;c++)if(!s._geometries[c].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,e),t}(Qe),Xh=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Qe.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.isEquivalentClass(s)?n.prototype.equalsExact.call(this,s,c):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?jn.FALSE:0},t.prototype.isClosed=function(){var s=this;if(this.isEmpty())return!1;for(var c=0;c<this._geometries.length;c++)if(!s._geometries[c].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var s=this,c=this._geometries.length,p=new Array(c).fill(null),l=0;l<this._geometries.length;l++)p[c-1-l]=s._geometries[l].reverse();return this.getFactory().createMultiLineString(p)},t.prototype.getBoundary=function(){return new Ca(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var s=this,c=new Array(this._geometries.length).fill(null),p=0;p<c.length;p++)c[p]=s._geometries[p].copy();return new t(c,this._factory)},t.prototype.interfaces_=function(){return[cm]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,e),t}(Jo),Ca=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],e=Pa.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=s}};Ca.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return e.length===1?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)};Ca.prototype.getBoundary=function(){return this._geom instanceof ni?this.boundaryLineString(this._geom):this._geom instanceof Xh?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Ca.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var e=this._bnRule.isInBoundary(2);return e?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Ca.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Ca.prototype.computeBoundaryCoordinates=function(t){var e=this,r=new ve;this._endpointMap=new Ao;for(var s=0;s<t.getNumGeometries();s++){var c=t.getGeometryN(s);c.getNumPoints()!==0&&(e.addEndpoint(c.getCoordinateN(0)),e.addEndpoint(c.getCoordinateN(c.getNumPoints()-1)))}for(var p=this._endpointMap.entrySet().iterator();p.hasNext();){var l=p.next(),x=l.getValue(),I=x.count;e._bnRule.isInBoundary(I)&&r.add(l.getKey())}return Ln.toCoordinateArray(r)};Ca.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);e===null&&(e=new fy,this._endpointMap.put(t,e)),e.count++};Ca.prototype.interfaces_=function(){return[]};Ca.prototype.getClass=function(){return Ca};Ca.getBoundary=function(){if(arguments.length===1){var t=arguments[0],e=new Ca(t);return e.getBoundary()}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c=new Ca(r,s);return c.getBoundary()}};var fy=function(){this.count=null};fy.prototype.interfaces_=function(){return[]};fy.prototype.getClass=function(){return fy};function mE(){}function _E(){}var yE=function(){};function vE(){}function xE(){}function bE(){}var Ta=function(){},_0={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Ta.prototype.interfaces_=function(){return[]};Ta.prototype.getClass=function(){return Ta};Ta.chars=function(t,e){for(var r=new Array(e).fill(null),s=0;s<e;s++)r[s]=t;return String(r)};Ta.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],e=new vE,r=new mE;return t.printStackTrace(r),e.toString()}else if(arguments.length===2){var s=arguments[0],c=arguments[1],p="";new _E(Ta.getStackTrace(s));for(var l=new bE,x=0;x<c;x++)try{p+=l.readLine()+Ta.NEWLINE}catch(I){if(I instanceof xE)xn.shouldNeverReachHere();else throw I}finally{}return p}};Ta.split=function(t,e){for(var r=e.length,s=new ve,c=""+t,p=c.indexOf(e);p>=0;){var l=c.substring(0,p);s.add(l),c=c.substring(p+r),p=c.indexOf(e)}c.length>0&&s.add(c);for(var x=new Array(s.size()).fill(null),I=0;I<x.length;I++)x[I]=s.get(I);return x};Ta.toString=function(){if(arguments.length===1){var t=arguments[0];return Ta.SIMPLE_ORDINATE_FORMAT.format(t)}};Ta.spaces=function(t){return Ta.chars(" ",t)};_0.NEWLINE.get=function(){return po.getProperty("line.separator")};_0.SIMPLE_ORDINATE_FORMAT.get=function(){return new yE};Object.defineProperties(Ta,_0);var hi=function(){};hi.prototype.interfaces_=function(){return[]};hi.prototype.getClass=function(){return hi};hi.copyCoord=function(t,e,r,s){for(var c=Math.min(t.getDimension(),r.getDimension()),p=0;p<c;p++)r.setOrdinate(s,p,t.getOrdinate(e,p))};hi.isRing=function(t){var e=t.size();return e===0?!0:e<=3?!1:t.getOrdinate(0,Fn.X)===t.getOrdinate(e-1,Fn.X)&&t.getOrdinate(0,Fn.Y)===t.getOrdinate(e-1,Fn.Y)};hi.isEqual=function(t,e){var r=t.size(),s=e.size();if(r!==s)return!1;for(var c=Math.min(t.getDimension(),e.getDimension()),p=0;p<r;p++)for(var l=0;l<c;l++){var x=t.getOrdinate(p,l),I=e.getOrdinate(p,l);if(t.getOrdinate(p,l)!==e.getOrdinate(p,l)&&!(fn.isNaN(x)&&fn.isNaN(I)))return!1}return!0};hi.extend=function(t,e,r){var s=t.create(r,e.getDimension()),c=e.size();if(hi.copy(e,0,s,0,c),c>0)for(var p=c;p<r;p++)hi.copy(e,c-1,s,p,1);return s};hi.reverse=function(t){for(var e=t.size()-1,r=Math.trunc(e/2),s=0;s<=r;s++)hi.swap(t,s,e-s)};hi.swap=function(t,e,r){if(e===r)return null;for(var s=0;s<t.getDimension();s++){var c=t.getOrdinate(e,s);t.setOrdinate(e,s,t.getOrdinate(r,s)),t.setOrdinate(r,s,c)}};hi.copy=function(t,e,r,s,c){for(var p=0;p<c;p++)hi.copyCoord(t,e+p,r,s+p)};hi.toString=function(){if(arguments.length===1){var t=arguments[0],e=t.size();if(e===0)return"()";var r=t.getDimension(),s=new Fl;s.append("(");for(var c=0;c<e;c++){c>0&&s.append(" ");for(var p=0;p<r;p++)p>0&&s.append(","),s.append(Ta.toString(t.getOrdinate(c,p)))}return s.append(")"),s.toString()}};hi.ensureValidRing=function(t,e){var r=e.size();if(r===0)return e;if(r<=3)return hi.createClosedRing(t,e,4);var s=e.getOrdinate(0,Fn.X)===e.getOrdinate(r-1,Fn.X)&&e.getOrdinate(0,Fn.Y)===e.getOrdinate(r-1,Fn.Y);return s?e:hi.createClosedRing(t,e,r+1)};hi.createClosedRing=function(t,e,r){var s=t.create(r,e.getDimension()),c=e.size();hi.copy(e,0,s,0,c);for(var p=c;p<r;p++)hi.copy(e,0,s,p,1);return s};var ni=function(n){function t(r,s){n.call(this,s),this._points=null,this.init(r)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Xe:this._points.expandEnvelope(new Xe)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return n.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var c=arguments[0],p=arguments[1];if(!this.isEquivalentClass(c))return!1;var l=c;if(this._points.size()!==l._points.size())return!1;for(var x=0;x<this._points.size();x++)if(!s.equal(s._points.getCoordinate(x),l._points.getCoordinate(x),p))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var s=this,c=0;c<Math.trunc(this._points.size()/2);c++){var p=s._points.size()-1-c;if(!s._points.getCoordinate(c).equals(s._points.getCoordinate(p)))return s._points.getCoordinate(c).compareTo(s._points.getCoordinate(p))>0&&hi.reverse(s._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?jn.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return Te.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var s=this._points.copy();hi.reverse(s);var c=this.getFactory().createLineString(s);return c},t.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){for(var c=arguments[0],p=c,l=0,x=0;l<this._points.size()&&x<p._points.size();){var I=s._points.getCoordinate(l).compareTo(p._points.getCoordinate(x));if(I!==0)return I;l++,x++}return l<this._points.size()?1:x<p._points.size()?-1:0}else if(arguments.length===2){var T=arguments[0],P=arguments[1],D=T;return P.compare(this._points,D._points)}},t.prototype.apply=function(){var s=this;if(nn(arguments[0],gu))for(var c=arguments[0],p=0;p<this._points.size();p++)c.filter(s._points.getCoordinate(p));else if(nn(arguments[0],Wa)){var l=arguments[0];if(this._points.size()===0)return null;for(var x=0;x<this._points.size()&&(l.filter(s._points,x),!l.isDone());x++);l.isGeometryChanged()&&this.geometryChanged()}else if(nn(arguments[0],Ll)){var I=arguments[0];I.filter(this)}else if(nn(arguments[0],nc)){var T=arguments[0];T.filter(this)}},t.prototype.getBoundary=function(){return new Ca(this).getBoundary()},t.prototype.isEquivalentClass=function(s){return s instanceof t},t.prototype.clone=function(){var s=n.prototype.clone.call(this);return s._points=this._points.clone(),s},t.prototype.getCoordinateN=function(s){return this._points.getCoordinate(s)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(s){if(s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),s.size()===1)throw new Dr("Invalid number of points in LineString (found "+s.size()+" - must be 0 or >= 2)");this._points=s},t.prototype.isCoordinate=function(s){for(var c=this,p=0;p<this._points.size();p++)if(c._points.getCoordinate(p).equals(s))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(s){return this.getFactory().createPoint(this._points.getCoordinate(s))},t.prototype.interfaces_=function(){return[cm]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,e),t}(Qe),hm=function(){};hm.prototype.interfaces_=function(){return[]};hm.prototype.getClass=function(){return hm};var Rs=function(n){function t(r,s){n.call(this,s),this._coordinates=r||null,this.init(this._coordinates)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Xe;var s=new Xe;return s.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),s},t.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.isEquivalentClass(s)?this.isEmpty()&&s.isEmpty()?!0:this.isEmpty()!==s.isEmpty()?!1:this.equal(s.getCoordinate(),this.getCoordinate(),c):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return jn.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var s=arguments[0],c=s;return this.getCoordinate().compareTo(c.getCoordinate())}else if(arguments.length===2){var p=arguments[0],l=arguments[1],x=p;return l.compare(this._coordinates,x._coordinates)}},t.prototype.apply=function(){if(nn(arguments[0],gu)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this.getCoordinate())}else if(nn(arguments[0],Wa)){var c=arguments[0];if(this.isEmpty())return null;c.filter(this._coordinates,0),c.isGeometryChanged()&&this.geometryChanged()}else if(nn(arguments[0],Ll)){var p=arguments[0];p.filter(this)}else if(nn(arguments[0],nc)){var l=arguments[0];l.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var s=n.prototype.clone.call(this);return s._coordinates=this._coordinates.clone(),s},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(s){s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),xn.isTrue(s.size()<=1),this._coordinates=s},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[hm]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,e),t}(Qe),Yc=function(){};Yc.prototype.interfaces_=function(){return[]};Yc.prototype.getClass=function(){return Yc};var Oi=function(n){function t(r,s,c){if(n.call(this,c),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),s===null&&(s=[]),n.hasNullElements(s))throw new Dr("holes must not contain null elements");if(r.isEmpty()&&n.hasNonEmptyElements(s))throw new Dr("shell is empty but holes are not");this._shell=r,this._holes=s}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return n.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var s=this;if(this.isEmpty())return[];for(var c=new Array(this.getNumPoints()).fill(null),p=-1,l=this._shell.getCoordinates(),x=0;x<l.length;x++)p++,c[p]=l[x];for(var I=0;I<this._holes.length;I++)for(var T=s._holes[I].getCoordinates(),P=0;P<T.length;P++)p++,c[p]=T[P];return c},t.prototype.getArea=function(){var s=this,c=0;c+=Math.abs(Te.signedArea(this._shell.getCoordinateSequence()));for(var p=0;p<this._holes.length;p++)c-=Math.abs(Te.signedArea(s._holes[p].getCoordinateSequence()));return c},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var s=this._shell.getCoordinateSequence(),c=this.getEnvelopeInternal(),p=0;p<5;p++){var l=s.getX(p);if(!(l===c.getMinX()||l===c.getMaxX()))return!1;var x=s.getY(p);if(!(x===c.getMinY()||x===c.getMaxY()))return!1}for(var I=s.getX(0),T=s.getY(0),P=1;P<=4;P++){var D=s.getX(P),G=s.getY(P),Y=D!==I,et=G!==T;if(Y===et)return!1;I=D,T=G}return!0},t.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var c=arguments[0],p=arguments[1];if(!this.isEquivalentClass(c))return!1;var l=c,x=this._shell,I=l._shell;if(!x.equalsExact(I,p)||this._holes.length!==l._holes.length)return!1;for(var T=0;T<this._holes.length;T++)if(!s._holes[T].equalsExact(l._holes[T],p))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var s=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var c=0;c<this._holes.length;c++)s.normalize(s._holes[c],!1);Vh.sort(this._holes)}else if(arguments.length===2){var p=arguments[0],l=arguments[1];if(p.isEmpty())return null;var x=new Array(p.getCoordinates().length-1).fill(null);po.arraycopy(p.getCoordinates(),0,x,0,x.length);var I=Ln.minCoordinate(p.getCoordinates());Ln.scroll(x,I),po.arraycopy(x,0,p.getCoordinates(),0,x.length),p.getCoordinates()[x.length]=x[0],Te.isCCW(p.getCoordinates())===l&&Ln.reverse(p.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var s=this,c=0;c+=this._shell.getLength();for(var p=0;p<this._holes.length;p++)c+=s._holes[p].getLength();return c},t.prototype.getNumPoints=function(){for(var s=this,c=this._shell.getNumPoints(),p=0;p<this._holes.length;p++)c+=s._holes[p].getNumPoints();return c},t.prototype.reverse=function(){var s=this,c=this.copy();c._shell=this._shell.copy().reverse(),c._holes=new Array(this._holes.length).fill(null);for(var p=0;p<this._holes.length;p++)c._holes[p]=s._holes[p].copy().reverse();return c},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){var c=arguments[0],p=this._shell,l=c._shell;return p.compareToSameClass(l)}else if(arguments.length===2){var x=arguments[0],I=arguments[1],T=x,P=this._shell,D=T._shell,G=P.compareToSameClass(D,I);if(G!==0)return G;for(var Y=this.getNumInteriorRing(),et=T.getNumInteriorRing(),at=0;at<Y&&at<et;){var rt=s.getInteriorRingN(at),wt=T.getInteriorRingN(at),xt=rt.compareToSameClass(wt,I);if(xt!==0)return xt;at++}return at<Y?1:at<et?-1:0}},t.prototype.apply=function(s){var c=this;if(nn(s,gu)){this._shell.apply(s);for(var p=0;p<this._holes.length;p++)c._holes[p].apply(s)}else if(nn(s,Wa)){if(this._shell.apply(s),!s.isDone())for(var l=0;l<this._holes.length&&(c._holes[l].apply(s),!s.isDone());l++);s.isGeometryChanged()&&this.geometryChanged()}else if(nn(s,Ll))s.filter(this);else if(nn(s,nc)){s.filter(this),this._shell.apply(s);for(var x=0;x<this._holes.length;x++)c._holes[x].apply(s)}},t.prototype.getBoundary=function(){var s=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var c=new Array(this._holes.length+1).fill(null);c[0]=this._shell;for(var p=0;p<this._holes.length;p++)c[p+1]=s._holes[p];return c.length<=1?this.getFactory().createLinearRing(c[0].getCoordinateSequence()):this.getFactory().createMultiLineString(c)},t.prototype.clone=function(){var s=this,c=n.prototype.clone.call(this);c._shell=this._shell.clone(),c._holes=new Array(this._holes.length).fill(null);for(var p=0;p<this._holes.length;p++)c._holes[p]=s._holes[p].clone();return c},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var s=this,c=this._shell.copy(),p=new Array(this._holes.length).fill(null),l=0;l<p.length;l++)p[l]=s._holes[l].copy();return new t(c,p,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(s){return this._holes[s]},t.prototype.interfaces_=function(){return[Yc]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,e),t}(Qe),Ad=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Qe.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.isEquivalentClass(s)?n.prototype.equalsExact.call(this,s,c):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var s=arguments[0];return this._geometries[s].getCoordinate()}else return n.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return jn.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var s=this,c=new Array(this._geometries.length).fill(null),p=0;p<c.length;p++)c[p]=s._geometries[p].copy();return new t(c,this._factory)},t.prototype.interfaces_=function(){return[hm]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,e),t}(Jo),mu=function(n){function t(r,s){r instanceof Ct&&s instanceof Pn&&(r=s.getCoordinateSequenceFactory().create(r)),n.call(this,r,s),this.validateConstruction()}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Qe.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return jn.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var s=this._points.copy();hi.reverse(s);var c=this.getFactory().createLinearRing(s);return c},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new Dr("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new Dr("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(ni),pu=function(n){function t(){n.apply(this,arguments)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Qe.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.isEquivalentClass(s)?n.prototype.equalsExact.call(this,s,c):!1}else return n.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var s=this,c=this._geometries.length,p=new Array(c).fill(null),l=0;l<this._geometries.length;l++)p[l]=s._geometries[l].reverse();return this.getFactory().createMultiPolygon(p)},t.prototype.getBoundary=function(){var s=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var c=new ve,p=0;p<this._geometries.length;p++)for(var l=s._geometries[p],x=l.getBoundary(),I=0;I<x.getNumGeometries();I++)c.add(x.getGeometryN(I));var T=new Array(c.size()).fill(null);return this.getFactory().createMultiLineString(c.toArray(T))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var s=this,c=new Array(this._geometries.length).fill(null),p=0;p<c.length;p++)c[p]=s._geometries[p].copy();return new t(c,this._factory)},t.prototype.interfaces_=function(){return[Yc]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,e),t}(Jo),La=function(t){this._factory=t||null,this._isUserDataCopied=!1},Ny={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};La.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};La.prototype.edit=function(t,e){if(t===null)return null;var r=this.editInternal(t,e);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};La.prototype.editInternal=function(t,e){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Jo?this.editGeometryCollection(t,e):t instanceof Oi?this.editPolygon(t,e):t instanceof Rs?e.edit(t,this._factory):t instanceof ni?e.edit(t,this._factory):(xn.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};La.prototype.editGeometryCollection=function(t,e){for(var r=this,s=e.edit(t,this._factory),c=new ve,p=0;p<s.getNumGeometries();p++){var l=r.edit(s.getGeometryN(p),e);l===null||l.isEmpty()||c.add(l)}return s.getClass()===Ad?this._factory.createMultiPoint(c.toArray([])):s.getClass()===Xh?this._factory.createMultiLineString(c.toArray([])):s.getClass()===pu?this._factory.createMultiPolygon(c.toArray([])):this._factory.createGeometryCollection(c.toArray([]))};La.prototype.editPolygon=function(t,e){var r=this,s=e.edit(t,this._factory);if(s===null&&(s=this._factory.createPolygon(null)),s.isEmpty())return s;var c=this.edit(s.getExteriorRing(),e);if(c===null||c.isEmpty())return this._factory.createPolygon();for(var p=new ve,l=0;l<s.getNumInteriorRing();l++){var x=r.edit(s.getInteriorRingN(l),e);x===null||x.isEmpty()||p.add(x)}return this._factory.createPolygon(c,p.toArray([]))};La.prototype.interfaces_=function(){return[]};La.prototype.getClass=function(){return La};La.GeometryEditorOperation=function(){};Ny.NoOpGeometryOperation.get=function(){return fm};Ny.CoordinateOperation.get=function(){return pm};Ny.CoordinateSequenceOperation.get=function(){return dm};Object.defineProperties(La,Ny);var fm=function(){};fm.prototype.edit=function(t,e){return t};fm.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};fm.prototype.getClass=function(){return fm};var pm=function(){};pm.prototype.edit=function(t,e){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof mu?e.createLinearRing(r):t instanceof ni?e.createLineString(r):t instanceof Rs?r.length>0?e.createPoint(r[0]):e.createPoint():t};pm.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};pm.prototype.getClass=function(){return pm};var dm=function(){};dm.prototype.edit=function(t,e){return t instanceof mu?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof ni?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Rs?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t};dm.prototype.interfaces_=function(){return[La.GeometryEditorOperation]};dm.prototype.getClass=function(){return dm};var ui=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var r=0;r<e;r++)t._coordinates[r]=new Ct}else if(nn(arguments[0],Fn)){var s=arguments[0];if(s===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=s.getDimension(),this._coordinates=new Array(s.size()).fill(null);for(var c=0;c<this._coordinates.length;c++)t._coordinates[c]=s.getCoordinateCopy(c)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var p=arguments[0],l=arguments[1];this._coordinates=p,this._dimension=l,p===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var x=arguments[0],I=arguments[1];this._coordinates=new Array(x).fill(null),this._dimension=I;for(var T=0;T<x;T++)t._coordinates[T]=new Ct}}},eb={serialVersionUID:{configurable:!0}};ui.prototype.setOrdinate=function(t,e,r){switch(e){case Fn.X:this._coordinates[t].x=r;break;case Fn.Y:this._coordinates[t].y=r;break;case Fn.Z:this._coordinates[t].z=r;break;default:throw new Dr("invalid ordinateIndex")}};ui.prototype.size=function(){return this._coordinates.length};ui.prototype.getOrdinate=function(t,e){switch(e){case Fn.X:return this._coordinates[t].x;case Fn.Y:return this._coordinates[t].y;case Fn.Z:return this._coordinates[t].z}return fn.NaN};ui.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var e=arguments[0],r=arguments[1];r.x=this._coordinates[e].x,r.y=this._coordinates[e].y,r.z=this._coordinates[e].z}};ui.prototype.getCoordinateCopy=function(t){return new Ct(this._coordinates[t])};ui.prototype.getDimension=function(){return this._dimension};ui.prototype.getX=function(t){return this._coordinates[t].x};ui.prototype.clone=function(){for(var t=this,e=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)e[r]=t._coordinates[r].clone();return new ui(e,this._dimension)};ui.prototype.expandEnvelope=function(t){for(var e=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(e._coordinates[r]);return t};ui.prototype.copy=function(){for(var t=this,e=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)e[r]=t._coordinates[r].copy();return new ui(e,this._dimension)};ui.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var e=new Fl(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)e.append(", "),e.append(t._coordinates[r]);return e.append(")"),e.toString()}else return"()"};ui.prototype.getY=function(t){return this._coordinates[t].y};ui.prototype.toCoordinateArray=function(){return this._coordinates};ui.prototype.interfaces_=function(){return[Fn,Na]};ui.prototype.getClass=function(){return ui};eb.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(ui,eb);var _u=function(){},y0={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};_u.prototype.readResolve=function(){return _u.instance()};_u.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new ui(t)}else if(nn(arguments[0],Fn)){var e=arguments[0];return new ui(e)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return s>3&&(s=3),s<2?new ui(r):new ui(r,s)}};_u.prototype.interfaces_=function(){return[wd,Na]};_u.prototype.getClass=function(){return _u};_u.instance=function(){return _u.instanceObject};y0.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};y0.instanceObject.get=function(){return new _u};Object.defineProperties(_u,y0);var nb=function(n){function t(){n.call(this),this.map_=new Map}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,s){return this.map_.set(r,s),s},t.prototype.values=function(){for(var r=new ve,s=this.map_.values(),c=s.next();!c.done;)r.add(c.value),c=s.next();return r},t.prototype.entrySet=function(){var r=new m0;return this.map_.entries().forEach(function(s){return r.add(s)}),r},t.prototype.size=function(){return this.map_.size()},t}(ap),Kn=function n(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=n.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ml){var t=arguments[0];this._modelType=t,t===n.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=n.FIXED,this.setScale(e)}else if(arguments[0]instanceof n){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},v0={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Kn.prototype.equals=function(t){if(!(t instanceof Kn))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale};Kn.prototype.compareTo=function(t){var e=t,r=this.getMaximumSignificantDigits(),s=e.getMaximumSignificantDigits();return new Al(r).compareTo(new Al(s))};Kn.prototype.getScale=function(){return this._scale};Kn.prototype.isFloating=function(){return this._modelType===Kn.FLOATING||this._modelType===Kn.FLOATING_SINGLE};Kn.prototype.getType=function(){return this._modelType};Kn.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Kn.FLOATING?t="Floating":this._modelType===Kn.FLOATING_SINGLE?t="Floating-Single":this._modelType===Kn.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};Kn.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(fn.isNaN(t))return t;if(this._modelType===Kn.FLOATING_SINGLE){var e=t;return e}return this._modelType===Kn.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof Ct){var r=arguments[0];if(this._modelType===Kn.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Kn.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Kn.FLOATING?t=16:this._modelType===Kn.FLOATING_SINGLE?t=6:this._modelType===Kn.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};Kn.prototype.setScale=function(t){this._scale=Math.abs(t)};Kn.prototype.interfaces_=function(){return[Na,Da]};Kn.prototype.getClass=function(){return Kn};Kn.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e};v0.serialVersionUID.get=function(){return 7777263578777804e3};v0.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Kn,v0);var Ml=function n(t){this._name=t||null,n.nameToTypeMap.put(t,this)},x0={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ml.prototype.readResolve=function(){return Ml.nameToTypeMap.get(this._name)};Ml.prototype.toString=function(){return this._name};Ml.prototype.interfaces_=function(){return[Na]};Ml.prototype.getClass=function(){return Ml};x0.serialVersionUID.get=function(){return-552860263173159e4};x0.nameToTypeMap.get=function(){return new nb};Object.defineProperties(Ml,x0);Kn.Type=Ml;Kn.FIXED=new Ml("FIXED");Kn.FLOATING=new Ml("FLOATING");Kn.FLOATING_SINGLE=new Ml("FLOATING SINGLE");var Pn=function n(){this._precisionModel=new Kn,this._SRID=0,this._coordinateSequenceFactory=n.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?nn(arguments[0],wd)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Kn&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},rb={serialVersionUID:{configurable:!0}};Pn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Ct(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Ct(t.getMinX(),t.getMinY()),new Ct(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Ct(t.getMinX(),t.getMinY()),new Ct(t.getMinX(),t.getMaxY()),new Ct(t.getMaxX(),t.getMaxY()),new Ct(t.getMaxX(),t.getMinY()),new Ct(t.getMinX(),t.getMinY())]),null)};Pn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new ni(this.getCoordinateSequenceFactory().create(t),this);if(nn(t,Fn))return new ni(t,this)}else return new ni(this.getCoordinateSequenceFactory().create([]),this)};Pn.prototype.createMultiLineString=function(){if(arguments.length===0)return new Xh(null,this);if(arguments.length===1){var t=arguments[0];return new Xh(t,this)}};Pn.prototype.buildGeometry=function(t){for(var e=null,r=!1,s=!1,c=t.iterator();c.hasNext();){var p=c.next(),l=p.getClass();e===null&&(e=l),l!==e&&(r=!0),p.isGeometryCollectionOrDerived()&&(s=!0)}if(e===null)return this.createGeometryCollection();if(r||s)return this.createGeometryCollection(Pn.toGeometryArray(t));var x=t.iterator().next(),I=t.size()>1;if(I){if(x instanceof Oi)return this.createMultiPolygon(Pn.toPolygonArray(t));if(x instanceof ni)return this.createMultiLineString(Pn.toLineStringArray(t));if(x instanceof Rs)return this.createMultiPoint(Pn.toPointArray(t));xn.shouldNeverReachHere("Unhandled class: "+x.getClass().getName())}return x};Pn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};Pn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Ct){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(nn(arguments[0],Fn)){var e=arguments[0];return new Rs(e,this)}}};Pn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};Pn.prototype.createPolygon=function(){if(arguments.length===0)return new Oi(null,null,this);if(arguments.length===1){if(nn(arguments[0],Fn)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof mu){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return new Oi(s,c,this)}};Pn.prototype.getSRID=function(){return this._SRID};Pn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Jo(null,this);if(arguments.length===1){var t=arguments[0];return new Jo(t,this)}};Pn.prototype.createGeometry=function(t){var e=new La(this);return e.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};Pn.prototype.getPrecisionModel=function(){return this._precisionModel};Pn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(nn(arguments[0],Fn)){var e=arguments[0];return new mu(e,this)}}};Pn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new pu(null,this);if(arguments.length===1){var t=arguments[0];return new pu(t,this)}};Pn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new Ad(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Ad(e,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(nn(arguments[0],Fn)){var s=arguments[0];if(s===null)return this.createMultiPoint(new Array(0).fill(null));for(var c=new Array(s.size()).fill(null),p=0;p<s.size();p++){var l=t.getCoordinateSequenceFactory().create(1,s.getDimension());hi.copy(s,p,l,0,1),c[p]=t.createPoint(l)}return this.createMultiPoint(c)}}};Pn.prototype.interfaces_=function(){return[Na]};Pn.prototype.getClass=function(){return Pn};Pn.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toGeometryArray=function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.getDefaultCoordinateSequenceFactory=function(){return _u.instance()};Pn.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)};Pn.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)};rb.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(Pn,rb);var wE=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ry=function(t){this.geometryFactory=t||new Pn};Ry.prototype.read=function(t){var e;typeof t=="string"?e=JSON.parse(t):e=t;var r=e.type;if(!El[r])throw new Error("Unknown GeoJSON type: "+e.type);return wE.indexOf(r)!==-1?El[r].apply(this,[e.coordinates]):r==="GeometryCollection"?El[r].apply(this,[e.geometries]):El[r].apply(this,[e])};Ry.prototype.write=function(t){var e=t.getGeometryType();if(!Ku[e])throw new Error("Geometry is not supported");return Ku[e].apply(this,[t])};var El={Feature:function(n){var t={};for(var e in n)t[e]=n[e];if(n.geometry){var r=n.geometry.type;if(!El[r])throw new Error("Unknown GeoJSON type: "+n.type);t.geometry=this.read(n.geometry)}return n.bbox&&(t.bbox=El.bbox.apply(this,[n.bbox])),t},FeatureCollection:function(n){var t=this,e={};if(n.features){e.features=[];for(var r=0;r<n.features.length;++r)e.features.push(t.read(n.features[r]))}return n.bbox&&(e.bbox=this.parse.bbox.apply(this,[n.bbox])),e},coordinates:function(n){for(var t=[],e=0;e<n.length;++e){var r=n[e];t.push(new Ct(r[0],r[1]))}return t},bbox:function(n){return this.geometryFactory.createLinearRing([new Ct(n[0],n[1]),new Ct(n[2],n[1]),new Ct(n[2],n[3]),new Ct(n[0],n[3]),new Ct(n[0],n[1])])},Point:function(n){var t=new Ct(n[0],n[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(n){for(var t=this,e=[],r=0;r<n.length;++r)e.push(El.Point.apply(t,[n[r]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(n){var t=El.coordinates.apply(this,[n]);return this.geometryFactory.createLineString(t)},MultiLineString:function(n){for(var t=this,e=[],r=0;r<n.length;++r)e.push(El.LineString.apply(t,[n[r]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(n){for(var t=this,e=El.coordinates.apply(this,[n[0]]),r=this.geometryFactory.createLinearRing(e),s=[],c=1;c<n.length;++c){var p=n[c],l=El.coordinates.apply(t,[p]),x=t.geometryFactory.createLinearRing(l);s.push(x)}return this.geometryFactory.createPolygon(r,s)},MultiPolygon:function(n){for(var t=this,e=[],r=0;r<n.length;++r){var s=n[r];e.push(El.Polygon.apply(t,[s]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(n){for(var t=this,e=[],r=0;r<n.length;++r){var s=n[r];e.push(t.read(s))}return this.geometryFactory.createGeometryCollection(e)}},Ku={coordinate:function(n){return[n.x,n.y]},Point:function(n){var t=Ku.coordinate.apply(this,[n.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(n){for(var t=this,e=[],r=0;r<n._geometries.length;++r){var s=n._geometries[r],c=Ku.Point.apply(t,[s]);e.push(c.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(n){for(var t=this,e=[],r=n.getCoordinates(),s=0;s<r.length;++s){var c=r[s];e.push(Ku.coordinate.apply(t,[c]))}return{type:"LineString",coordinates:e}},MultiLineString:function(n){for(var t=this,e=[],r=0;r<n._geometries.length;++r){var s=n._geometries[r],c=Ku.LineString.apply(t,[s]);e.push(c.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(n){var t=this,e=[],r=Ku.LineString.apply(this,[n._shell]);e.push(r.coordinates);for(var s=0;s<n._holes.length;++s){var c=n._holes[s],p=Ku.LineString.apply(t,[c]);e.push(p.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(n){for(var t=this,e=[],r=0;r<n._geometries.length;++r){var s=n._geometries[r],c=Ku.Polygon.apply(t,[s]);e.push(c.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(n){for(var t=this,e=[],r=0;r<n._geometries.length;++r){var s=n._geometries[r],c=s.getGeometryType();e.push(Ku[c].apply(t,[s]))}return{type:"GeometryCollection",geometries:e}}},b0=function(t){this.geometryFactory=t||new Pn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ry(this.geometryFactory)};b0.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Kn.FIXED&&this.reducePrecision(e),e};b0.prototype.reducePrecision=function(t){var e=this,r,s;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,s=t.points.length;r<s;r++)e.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,s=t.geometries.length;r<s;r++)e.reducePrecision(t.geometries[r])};var ib=function(){this.parser=new Ry(this.geometryFactory)};ib.prototype.write=function(t){return this.parser.write(t)};var pe=function(){},zy={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};pe.prototype.interfaces_=function(){return[]};pe.prototype.getClass=function(){return pe};pe.opposite=function(t){return t===pe.LEFT?pe.RIGHT:t===pe.RIGHT?pe.LEFT:t};zy.ON.get=function(){return 0};zy.LEFT.get=function(){return 1};zy.RIGHT.get=function(){return 2};Object.defineProperties(pe,zy);function Oy(n){this.message=n||""}Oy.prototype=new Error;Oy.prototype.name="EmptyStackException";function Bl(){this.array_=[]}Bl.prototype=new Za;Bl.prototype.add=function(n){return this.array_.push(n),!0};Bl.prototype.get=function(n){if(n<0||n>=this.size())throw new Error;return this.array_[n]};Bl.prototype.push=function(n){return this.array_.push(n),n};Bl.prototype.pop=function(n){if(this.array_.length===0)throw new Oy;return this.array_.pop()};Bl.prototype.peek=function(){if(this.array_.length===0)throw new Oy;return this.array_[this.array_.length-1]};Bl.prototype.empty=function(){return this.array_.length===0};Bl.prototype.isEmpty=function(){return this.empty()};Bl.prototype.search=function(n){return this.array_.indexOf(n)};Bl.prototype.size=function(){return this.array_.length};Bl.prototype.toArray=function(){for(var n=this,t=[],e=0,r=this.array_.length;e<r;e++)t.push(n.array_[e]);return t};var Dl=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Dl.prototype.getCoordinate=function(){return this._minCoord};Dl.prototype.getRightmostSide=function(t,e){var r=this.getRightmostSideOfSegment(t,e);return r<0&&(r=this.getRightmostSideOfSegment(t,e-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};Dl.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();xn.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],r=t[this._minIndex+1],s=Te.computeOrientation(this._minCoord,r,e),c=!1;(e.y<this._minCoord.y&&r.y<this._minCoord.y&&s===Te.COUNTERCLOCKWISE||e.y>this._minCoord.y&&r.y>this._minCoord.y&&s===Te.CLOCKWISE)&&(c=!0),c&&(this._minIndex=this._minIndex-1)};Dl.prototype.getRightmostSideOfSegment=function(t,e){var r=t.getEdge(),s=r.getCoordinates();if(e<0||e+1>=s.length||s[e].y===s[e+1].y)return-1;var c=pe.LEFT;return s[e].y<s[e+1].y&&(c=pe.RIGHT),c};Dl.prototype.getEdge=function(){return this._orientedDe};Dl.prototype.checkForRightmostCoordinate=function(t){for(var e=this,r=t.getEdge().getCoordinates(),s=0;s<r.length-1;s++)(e._minCoord===null||r[s].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=s,e._minCoord=r[s])};Dl.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),e=t.getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Dl.prototype.findEdge=function(t){for(var e=this,r=t.iterator();r.hasNext();){var s=r.next();!s.isForward()||e.checkForRightmostCoordinate(s)}xn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var c=this.getRightmostSide(this._minDe,this._minIndex);c===pe.LEFT&&(this._orientedDe=this._minDe.getSym())};Dl.prototype.interfaces_=function(){return[]};Dl.prototype.getClass=function(){return Dl};var rc=function(n){function t(e,r){n.call(this,t.msgWithCoord(e,r)),this.pt=r?new Ct(r):null,this.name="TopologyException"}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,s){return s?r:r+" [ "+s+" ]"},t}(ec),ky=function(){this.array_=[]};ky.prototype.addLast=function(t){this.array_.push(t)};ky.prototype.removeFirst=function(){return this.array_.shift()};ky.prototype.isEmpty=function(){return this.array_.length===0};var Qo=function(){this._finder=null,this._dirEdgeList=new ve,this._nodes=new ve,this._rightMostCoord=null,this._env=null,this._finder=new Dl};Qo.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.setVisited(!1)}};Qo.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Qo.prototype.computeNodeDepth=function(t){for(var e=this,r=null,s=t.getEdges().iterator();s.hasNext();){var c=s.next();if(c.isVisited()||c.getSym().isVisited()){r=c;break}}if(r===null)throw new rc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var p=t.getEdges().iterator();p.hasNext();){var l=p.next();l.setVisited(!0),e.copySymDepths(l)}};Qo.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(pe.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)};Qo.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};Qo.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(pe.RIGHT)>=1&&e.getDepth(pe.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}};Qo.prototype.computeDepths=function(t){var e=this,r=new m0,s=new ky,c=t.getNode();for(s.addLast(c),r.add(c),t.setVisited(!0);!s.isEmpty();){var p=s.removeFirst();r.add(p),e.computeNodeDepth(p);for(var l=p.getEdges().iterator();l.hasNext();){var x=l.next(),I=x.getSym();if(!I.isVisited()){var T=I.getNode();r.contains(T)||(s.addLast(T),r.add(T))}}}};Qo.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0};Qo.prototype.getEnvelope=function(){if(this._env===null){for(var t=new Xe,e=this._dirEdgeList.iterator();e.hasNext();)for(var r=e.next(),s=r.getEdge().getCoordinates(),c=0;c<s.length-1;c++)t.expandToInclude(s[c]);this._env=t}return this._env};Qo.prototype.addReachable=function(t){var e=this,r=new Bl;for(r.add(t);!r.empty();){var s=r.pop();e.add(s,r)}};Qo.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(pe.LEFT,t.getDepth(pe.RIGHT)),e.setDepth(pe.RIGHT,t.getDepth(pe.LEFT))};Qo.prototype.add=function(t,e){var r=this;t.setVisited(!0),this._nodes.add(t);for(var s=t.getEdges().iterator();s.hasNext();){var c=s.next();r._dirEdgeList.add(c);var p=c.getSym(),l=p.getNode();l.isVisited()||e.push(l)}};Qo.prototype.getNodes=function(){return this._nodes};Qo.prototype.getDirectedEdges=function(){return this._dirEdgeList};Qo.prototype.interfaces_=function(){return[Da]};Qo.prototype.getClass=function(){return Qo};var xr=function n(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[pe.ON]=r}else if(arguments[0]instanceof n){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var c=0;c<this.location.length;c++)t.location[c]=s.location[c]}}else if(arguments.length===3){var p=arguments[0],l=arguments[1],x=arguments[2];this.init(3),this.location[pe.ON]=p,this.location[pe.LEFT]=l,this.location[pe.RIGHT]=x}};xr.prototype.setAllLocations=function(t){for(var e=this,r=0;r<this.location.length;r++)e.location[r]=t};xr.prototype.isNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]!==Pt.NONE)return!1;return!0};xr.prototype.setAllLocationsIfNull=function(t){for(var e=this,r=0;r<this.location.length;r++)e.location[r]===Pt.NONE&&(e.location[r]=t)};xr.prototype.isLine=function(){return this.location.length===1};xr.prototype.merge=function(t){var e=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[pe.ON]=this.location[pe.ON],r[pe.LEFT]=Pt.NONE,r[pe.RIGHT]=Pt.NONE,this.location=r}for(var s=0;s<this.location.length;s++)e.location[s]===Pt.NONE&&s<t.location.length&&(e.location[s]=t.location[s])};xr.prototype.getLocations=function(){return this.location};xr.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[pe.LEFT];this.location[pe.LEFT]=this.location[pe.RIGHT],this.location[pe.RIGHT]=t};xr.prototype.toString=function(){var t=new Fl;return this.location.length>1&&t.append(Pt.toLocationSymbol(this.location[pe.LEFT])),t.append(Pt.toLocationSymbol(this.location[pe.ON])),this.location.length>1&&t.append(Pt.toLocationSymbol(this.location[pe.RIGHT])),t.toString()};xr.prototype.setLocations=function(t,e,r){this.location[pe.ON]=t,this.location[pe.LEFT]=e,this.location[pe.RIGHT]=r};xr.prototype.get=function(t){return t<this.location.length?this.location[t]:Pt.NONE};xr.prototype.isArea=function(){return this.location.length>1};xr.prototype.isAnyNull=function(){for(var t=this,e=0;e<this.location.length;e++)if(t.location[e]===Pt.NONE)return!0;return!1};xr.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(pe.ON,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.location[e]=r}};xr.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Pt.NONE)};xr.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]};xr.prototype.allPositionsEqual=function(t){for(var e=this,r=0;r<this.location.length;r++)if(e.location[r]!==t)return!1;return!0};xr.prototype.interfaces_=function(){return[]};xr.prototype.getClass=function(){return xr};var sr=function n(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new xr(t),this.elt[1]=new xr(t)}else if(arguments[0]instanceof n){var e=arguments[0];this.elt[0]=new xr(e.elt[0]),this.elt[1]=new xr(e.elt[1])}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.elt[0]=new xr(Pt.NONE),this.elt[1]=new xr(Pt.NONE),this.elt[r].setLocation(s)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],l=arguments[2];this.elt[0]=new xr(c,p,l),this.elt[1]=new xr(c,p,l)}else if(arguments.length===4){var x=arguments[0],I=arguments[1],T=arguments[2],P=arguments[3];this.elt[0]=new xr(Pt.NONE,Pt.NONE,Pt.NONE),this.elt[1]=new xr(Pt.NONE,Pt.NONE,Pt.NONE),this.elt[x].setLocations(I,T,P)}};sr.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};sr.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)};sr.prototype.isNull=function(t){return this.elt[t].isNull()};sr.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.elt[e].setAllLocationsIfNull(r)}};sr.prototype.isLine=function(t){return this.elt[t].isLine()};sr.prototype.merge=function(t){for(var e=this,r=0;r<2;r++)e.elt[r]===null&&t.elt[r]!==null?e.elt[r]=new xr(t.elt[r]):e.elt[r].merge(t.elt[r])};sr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};sr.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(pe.ON)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];return this.elt[e].get(r)}};sr.prototype.toString=function(){var t=new Fl;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};sr.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};sr.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};sr.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(pe.ON,e)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this.elt[r].setLocation(s,c)}};sr.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)};sr.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)};sr.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new xr(this.elt[t].location[0]))};sr.prototype.interfaces_=function(){return[]};sr.prototype.getClass=function(){return sr};sr.toLineLabel=function(t){for(var e=new sr(Pt.NONE),r=0;r<2;r++)e.setLocation(r,t.getLocation(r));return e};var Ei=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new ve,this._pts=new ve,this._label=new sr(Pt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ve,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Ei.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var e=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)e[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Te.isCCW(this._ring.getCoordinates())};Ei.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};Ei.prototype.computePoints=function(t){var e=this;this._startDe=t;var r=t,s=!0;do{if(r===null)throw new rc("Found null DirectedEdge");if(r.getEdgeRing()===e)throw new rc("Directed Edge visited twice during ring-building at "+r.getCoordinate());e._edges.add(r);var c=r.getLabel();xn.isTrue(c.isArea()),e.mergeLabel(c),e.addPoints(r.getEdge(),r.isForward(),s),s=!1,e.setEdgeRing(r,e),r=e.getNext(r)}while(r!==this._startDe)};Ei.prototype.getLinearRing=function(){return this._ring};Ei.prototype.getCoordinate=function(t){return this._pts.get(t)};Ei.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var r=e.getNode(),s=r.getEdges().getOutgoingDegree(t);s>t._maxNodeDegree&&(t._maxNodeDegree=s),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2};Ei.prototype.addPoints=function(t,e,r){var s=this,c=t.getCoordinates();if(e){var p=1;r&&(p=0);for(var l=p;l<c.length;l++)s._pts.add(c[l])}else{var x=c.length-2;r&&(x=c.length-1);for(var I=x;I>=0;I--)s._pts.add(c[I])}};Ei.prototype.isHole=function(){return this._isHole};Ei.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};Ei.prototype.containsPoint=function(t){var e=this.getLinearRing(),r=e.getEnvelopeInternal();if(!r.contains(t)||!Te.isPointInRing(t,e.getCoordinates()))return!1;for(var s=this._holes.iterator();s.hasNext();){var c=s.next();if(c.containsPoint(t))return!1}return!0};Ei.prototype.addHole=function(t){this._holes.add(t)};Ei.prototype.isShell=function(){return this._shell===null};Ei.prototype.getLabel=function(){return this._label};Ei.prototype.getEdges=function(){return this._edges};Ei.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};Ei.prototype.getShell=function(){return this._shell};Ei.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var e=arguments[0],r=arguments[1],s=e.getLocation(r,pe.RIGHT);if(s===Pt.NONE)return null;if(this._label.getLocation(r)===Pt.NONE)return this._label.setLocation(r,s),null}};Ei.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};Ei.prototype.toPolygon=function(t){for(var e=this,r=new Array(this._holes.size()).fill(null),s=0;s<this._holes.size();s++)r[s]=e._holes.get(s).getLinearRing();var c=t.createPolygon(this.getLinearRing(),r);return c};Ei.prototype.interfaces_=function(){return[]};Ei.prototype.getClass=function(){return Ei};var IE=function(n){function t(){var e=arguments[0],r=arguments[1];n.call(this,e,r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,s){r.setMinEdgeRing(s)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ei),EE=function(n){function t(){var e=arguments[0],r=arguments[1];n.call(this,e,r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,s=new ve,c=this._startDe;do{if(c.getMinEdgeRing()===null){var p=new IE(c,r._geometryFactory);s.add(p)}c=c.getNext()}while(c!==this._startDe);return s},t.prototype.setEdgeRing=function(r,s){r.setEdgeRing(s)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,s=this._startDe;do{var c=s.getNode();c.getEdges().linkMinimalDirectedEdges(r),s=s.getNext()}while(s!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ei),na=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};na.prototype.setVisited=function(t){this._isVisited=t};na.prototype.setInResult=function(t){this._isInResult=t};na.prototype.isCovered=function(){return this._isCovered};na.prototype.isCoveredSet=function(){return this._isCoveredSet};na.prototype.setLabel=function(t){this._label=t};na.prototype.getLabel=function(){return this._label};na.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};na.prototype.updateIM=function(t){xn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};na.prototype.isInResult=function(){return this._isInResult};na.prototype.isVisited=function(){return this._isVisited};na.prototype.interfaces_=function(){return[]};na.prototype.getClass=function(){return na};var Fy=function(n){function t(){n.call(this),this._coord=null,this._edges=null;var e=arguments[0],r=arguments[1];this._coord=e,this._edges=r,this._label=new sr(0,Pt.NONE)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var s=r.next();if(s.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,s){var c=Pt.NONE;if(c=this._label.getLocation(s),!r.isNull(s)){var p=r.getLocation(s);c!==Pt.BOUNDARY&&(c=p)}return c},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];this._label===null?this._label=new sr(r,s):this._label.setLocation(r,s)}else return n.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var s=arguments[0];this.mergeLabel(s._label)}else if(arguments[0]instanceof sr)for(var c=arguments[0],p=0;p<2;p++){var l=r.computeMergedLocation(c,p),x=r._label.getLocation(p);x===Pt.NONE&&r._label.setLocation(p,l)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var s=Pt.NONE;this._label!==null&&(s=this._label.getLocation(r));var c=null;switch(s){case Pt.BOUNDARY:c=Pt.INTERIOR;break;case Pt.INTERIOR:c=Pt.BOUNDARY;break;default:c=Pt.BOUNDARY;break}this._label.setLocation(r,c)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(na),Nl=function(){this.nodeMap=new Ao,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Nl.prototype.find=function(t){return this.nodeMap.get(t)};Nl.prototype.addNode=function(){if(arguments[0]instanceof Ct){var t=arguments[0],e=this.nodeMap.get(t);return e===null&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}else if(arguments[0]instanceof Fy){var r=arguments[0],s=this.nodeMap.get(r.getCoordinate());return s===null?(this.nodeMap.put(r.getCoordinate(),r),r):(s.mergeLabel(r),s)}};Nl.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){var r=e.next();r.print(t)}};Nl.prototype.iterator=function(){return this.nodeMap.values().iterator()};Nl.prototype.values=function(){return this.nodeMap.values()};Nl.prototype.getBoundaryNodes=function(t){for(var e=new ve,r=this.iterator();r.hasNext();){var s=r.next();s.getLabel().getLocation(t)===Pt.BOUNDARY&&e.add(s)}return e};Nl.prototype.add=function(t){var e=t.getCoordinate(),r=this.addNode(e);r.add(t)};Nl.prototype.interfaces_=function(){return[]};Nl.prototype.getClass=function(){return Nl};var dr=function(){},Am={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};dr.prototype.interfaces_=function(){return[]};dr.prototype.getClass=function(){return dr};dr.isNorthern=function(t){return t===dr.NE||t===dr.NW};dr.isOpposite=function(t,e){if(t===e)return!1;var r=(t-e+4)%4;return r===2};dr.commonHalfPlane=function(t,e){if(t===e)return t;var r=(t-e+4)%4;if(r===2)return-1;var s=t<e?t:e,c=t>e?t:e;return s===0&&c===3?3:s};dr.isInHalfPlane=function(t,e){return e===dr.SE?t===dr.SE||t===dr.SW:t===e||t===e+1};dr.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Dr("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?dr.NE:dr.SE:e>=0?dr.NW:dr.SW}else if(arguments[0]instanceof Ct&&arguments[1]instanceof Ct){var r=arguments[0],s=arguments[1];if(s.x===r.x&&s.y===r.y)throw new Dr("Cannot compute the quadrant for two identical points "+r);return s.x>=r.x?s.y>=r.y?dr.NE:dr.SE:s.y>=r.y?dr.NW:dr.SW}};Am.NE.get=function(){return 0};Am.NW.get=function(){return 1};Am.SW.get=function(){return 2};Am.SE.get=function(){return 3};Object.defineProperties(dr,Am);var Po=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],r=arguments[1],s=arguments[2],c=null;this._edge=e,this.init(r,s),this._label=c}else if(arguments.length===4){var p=arguments[0],l=arguments[1],x=arguments[2],I=arguments[3];this._edge=p,this.init(l,x),this._label=I}};Po.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Te.computeOrientation(t._p0,t._p1,this._p1)};Po.prototype.getDy=function(){return this._dy};Po.prototype.getCoordinate=function(){return this._p0};Po.prototype.setNode=function(t){this._node=t};Po.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),s=r.lastIndexOf("."),c=r.substring(s+1);t.print("  "+c+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)};Po.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)};Po.prototype.getDirectedCoordinate=function(){return this._p1};Po.prototype.getDx=function(){return this._dx};Po.prototype.getLabel=function(){return this._label};Po.prototype.getEdge=function(){return this._edge};Po.prototype.getQuadrant=function(){return this._quadrant};Po.prototype.getNode=function(){return this._node};Po.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),r=e.lastIndexOf("."),s=e.substring(r+1);return"  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Po.prototype.computeLabel=function(t){};Po.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=dr.quadrant(this._dx,this._dy),xn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Po.prototype.interfaces_=function(){return[Da]};Po.prototype.getClass=function(){return Po};var Jv=function(n){function t(){var e=arguments[0],r=arguments[1];if(n.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var s=e.getNumPoints()-1;this.init(e.getCoordinate(s),e.getCoordinate(s-1))}this.computeDirectedLabel()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new sr(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,s){if(this._depth[r]!==-999&&this._depth[r]!==s)throw new rc("assigned depths do not match",this.getCoordinate());this._depth[r]=s},t.prototype.isInteriorAreaEdge=function(){for(var r=this,s=!0,c=0;c<2;c++)r._label.isArea(c)&&r._label.getLocation(c,pe.LEFT)===Pt.INTERIOR&&r._label.getLocation(c,pe.RIGHT)===Pt.INTERIOR||(s=!1);return s},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){n.prototype.print.call(this,r),r.print(" "+this._depth[pe.LEFT]+"/"+this._depth[pe.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),s=!this._label.isArea(0)||this._label.allPositionsEqual(0,Pt.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,Pt.EXTERIOR);return r&&s&&c},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,s){var c=this.getEdge().getDepthDelta();this._isForward||(c=-c);var p=1;r===pe.LEFT&&(p=-1);var l=pe.opposite(r),x=c*p,I=s+x;this.setDepth(r,s),this.setDepth(l,I)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,s){return r===Pt.EXTERIOR&&s===Pt.INTERIOR?1:r===Pt.INTERIOR&&s===Pt.EXTERIOR?-1:0},t}(Po),Pd=function(){};Pd.prototype.createNode=function(t){return new Fy(t,null)};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};var jr=function(){if(this._edges=new ve,this._nodes=null,this._edgeEndList=new ve,arguments.length===0)this._nodes=new Nl(new Pd);else if(arguments.length===1){var t=arguments[0];this._nodes=new Nl(t)}};jr.prototype.printEdges=function(t){var e=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var s=e._edges.get(r);s.print(t),s.eiList.print(t)}};jr.prototype.find=function(t){return this._nodes.find(t)};jr.prototype.addNode=function(){if(arguments[0]instanceof Fy){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof Ct){var e=arguments[0];return this._nodes.addNode(e)}};jr.prototype.getNodeIterator=function(){return this._nodes.iterator()};jr.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkResultDirectedEdges()}};jr.prototype.debugPrintln=function(t){po.out.println(t)};jr.prototype.isBoundaryNode=function(t,e){var r=this._nodes.find(e);if(r===null)return!1;var s=r.getLabel();return s!==null&&s.getLocation(t)===Pt.BOUNDARY};jr.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkAllDirectedEdges()}};jr.prototype.matchInSameDirection=function(t,e,r,s){return t.equals(r)?Te.computeOrientation(t,e,s)===Te.COLLINEAR&&dr.quadrant(t,e)===dr.quadrant(r,s):!1};jr.prototype.getEdgeEnds=function(){return this._edgeEndList};jr.prototype.debugPrint=function(t){po.out.print(t)};jr.prototype.getEdgeIterator=function(){return this._edges.iterator()};jr.prototype.findEdgeInSameDirection=function(t,e){for(var r=this,s=0;s<this._edges.size();s++){var c=r._edges.get(s),p=c.getCoordinates();if(r.matchInSameDirection(t,e,p[0],p[1])||r.matchInSameDirection(t,e,p[p.length-1],p[p.length-2]))return c}return null};jr.prototype.insertEdge=function(t){this._edges.add(t)};jr.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var r=e.next();if(r.getEdge()===t)return r}return null};jr.prototype.addEdges=function(t){for(var e=this,r=t.iterator();r.hasNext();){var s=r.next();e._edges.add(s);var c=new Jv(s,!0),p=new Jv(s,!1);c.setSym(p),p.setSym(c),e.add(c),e.add(p)}};jr.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};jr.prototype.getNodes=function(){return this._nodes.values()};jr.prototype.findEdge=function(t,e){for(var r=this,s=0;s<this._edges.size();s++){var c=r._edges.get(s),p=c.getCoordinates();if(t.equals(p[0])&&e.equals(p[1]))return c}return null};jr.prototype.interfaces_=function(){return[]};jr.prototype.getClass=function(){return jr};jr.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){var r=e.next();r.getEdges().linkResultDirectedEdges()}};var zs=function(){this._geometryFactory=null,this._shellList=new ve;var t=arguments[0];this._geometryFactory=t};zs.prototype.sortShellsAndHoles=function(t,e,r){for(var s=t.iterator();s.hasNext();){var c=s.next();c.isHole()?r.add(c):e.add(c)}};zs.prototype.computePolygons=function(t){for(var e=this,r=new ve,s=t.iterator();s.hasNext();){var c=s.next(),p=c.toPolygon(e._geometryFactory);r.add(p)}return r};zs.prototype.placeFreeHoles=function(t,e){for(var r=this,s=e.iterator();s.hasNext();){var c=s.next();if(c.getShell()===null){var p=r.findEdgeRingContaining(c,t);if(p===null)throw new rc("unable to assign hole to a shell",c.getCoordinate(0));c.setShell(p)}}};zs.prototype.buildMinimalEdgeRings=function(t,e,r){for(var s=this,c=new ve,p=t.iterator();p.hasNext();){var l=p.next();if(l.getMaxNodeDegree()>2){l.linkDirectedEdgesForMinimalEdgeRings();var x=l.buildMinimalRings(),I=s.findShell(x);I!==null?(s.placePolygonHoles(I,x),e.add(I)):r.addAll(x)}else c.add(l)}return c};zs.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){var r=e.next();if(r.containsPoint(t))return!0}return!1};zs.prototype.buildMaximalEdgeRings=function(t){for(var e=this,r=new ve,s=t.iterator();s.hasNext();){var c=s.next();if(c.isInResult()&&c.getLabel().isArea()&&c.getEdgeRing()===null){var p=new EE(c,e._geometryFactory);r.add(p),p.setInResult()}}return r};zs.prototype.placePolygonHoles=function(t,e){for(var r=e.iterator();r.hasNext();){var s=r.next();s.isHole()&&s.setShell(t)}};zs.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};zs.prototype.findEdgeRingContaining=function(t,e){for(var r=t.getLinearRing(),s=r.getEnvelopeInternal(),c=r.getCoordinateN(0),p=null,l=null,x=e.iterator();x.hasNext();){var I=x.next(),T=I.getLinearRing(),P=T.getEnvelopeInternal();p!==null&&(l=p.getLinearRing().getEnvelopeInternal());var D=!1;P.contains(s)&&Te.isPointInRing(c,T.getCoordinates())&&(D=!0),D&&(p===null||l.contains(P))&&(p=I)}return p};zs.prototype.findShell=function(t){for(var e=0,r=null,s=t.iterator();s.hasNext();){var c=s.next();c.isHole()||(r=c,e++)}return xn.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),r};zs.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],r=arguments[1];jr.linkResultDirectedEdges(r);var s=this.buildMaximalEdgeRings(e),c=new ve,p=this.buildMinimalEdgeRings(s,this._shellList,c);this.sortShellsAndHoles(p,this._shellList,c),this.placeFreeHoles(this._shellList,c)}};zs.prototype.interfaces_=function(){return[]};zs.prototype.getClass=function(){return zs};var Ld=function(){};Ld.prototype.getBounds=function(){};Ld.prototype.interfaces_=function(){return[]};Ld.prototype.getClass=function(){return Ld};var ja=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};ja.prototype.getItem=function(){return this._item};ja.prototype.getBounds=function(){return this._bounds};ja.prototype.interfaces_=function(){return[Ld,Na]};ja.prototype.getClass=function(){return ja};var ic=function(){this._size=null,this._items=null,this._size=0,this._items=new ve,this._items.add(null)};ic.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};ic.prototype.size=function(){return this._size};ic.prototype.reorder=function(t){for(var e=this,r=null,s=this._items.get(t);t*2<=this._size&&(r=t*2,r!==e._size&&e._items.get(r+1).compareTo(e._items.get(r))<0&&r++,e._items.get(r).compareTo(s)<0);t=r)e._items.set(t,e._items.get(r));this._items.set(t,s)};ic.prototype.clear=function(){this._size=0,this._items.clear()};ic.prototype.isEmpty=function(){return this._size===0};ic.prototype.add=function(t){var e=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)e._items.set(r,e._items.get(Math.trunc(r/2)));this._items.set(r,t)};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};var Wc=function(){};Wc.prototype.visitItem=function(t){};Wc.prototype.interfaces_=function(){return[]};Wc.prototype.getClass=function(){return Wc};var Wf=function(){};Wf.prototype.insert=function(t,e){};Wf.prototype.remove=function(t,e){};Wf.prototype.query=function(){};Wf.prototype.interfaces_=function(){return[]};Wf.prototype.getClass=function(){return Wf};var zi=function(){if(this._childBoundables=new ve,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},ob={serialVersionUID:{configurable:!0}};zi.prototype.getLevel=function(){return this._level};zi.prototype.size=function(){return this._childBoundables.size()};zi.prototype.getChildBoundables=function(){return this._childBoundables};zi.prototype.addChildBoundable=function(t){xn.isTrue(this._bounds===null),this._childBoundables.add(t)};zi.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};zi.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};zi.prototype.interfaces_=function(){return[Ld,Na]};zi.prototype.getClass=function(){return zi};ob.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(zi,ob);var Ha=function(){};Ha.reverseOrder=function(){return{compare:function(e,r){return r.compareTo(e)}}};Ha.min=function(t){return Ha.sort(t),t.get(0)};Ha.sort=function(t,e){var r=t.toArray();e?Vh.sort(r,e):Vh.sort(r);for(var s=t.iterator(),c=0,p=r.length;c<p;c++)s.next(),s.set(r[c])};Ha.singletonList=function(t){var e=new ve;return e.add(t),e};var wi=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=r,this._distance=this.distance()};wi.prototype.expandToQueue=function(t,e){var r=wi.isComposite(this._boundable1),s=wi.isComposite(this._boundable2);if(r&&s)return wi.area(this._boundable1)>wi.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(r)return this.expand(this._boundable1,this._boundable2,t,e),null;if(s)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Dr("neither boundable is composite")};wi.prototype.isLeaves=function(){return!(wi.isComposite(this._boundable1)||wi.isComposite(this._boundable2))};wi.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0};wi.prototype.expand=function(t,e,r,s){for(var c=this,p=t.getChildBoundables(),l=p.iterator();l.hasNext();){var x=l.next(),I=new wi(x,e,c._itemDistance);I.getDistance()<s&&r.add(I)}};wi.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};wi.prototype.getDistance=function(){return this._distance};wi.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};wi.prototype.interfaces_=function(){return[Da]};wi.prototype.getClass=function(){return wi};wi.area=function(t){return t.getBounds().getArea()};wi.isComposite=function(t){return t instanceof zi};var Ji=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new ve,this._nodeCapacity=null,arguments.length===0){var t=n.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var e=arguments[0];xn.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}},By={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ji.prototype.getNodeCapacity=function(){return this._nodeCapacity};Ji.prototype.lastNode=function(t){return t.get(t.size()-1)};Ji.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=arguments[0],r=0,s=e.getChildBoundables().iterator();s.hasNext();){var c=s.next();c instanceof zi?r+=t.size(c):c instanceof ja&&(r+=1)}return r}};Ji.prototype.removeItem=function(t,e){for(var r=null,s=t.getChildBoundables().iterator();s.hasNext();){var c=s.next();c instanceof ja&&c.getItem()===e&&(r=c)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};Ji.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new ve:e}else if(arguments.length===1){for(var r=arguments[0],s=new ve,c=r.getChildBoundables().iterator();c.hasNext();){var p=c.next();if(p instanceof zi){var l=t.itemsTree(p);l!==null&&s.add(l)}else p instanceof ja?s.add(p.getItem()):xn.shouldNeverReachHere()}return s.size()<=0?null:s}};Ji.prototype.insert=function(t,e){xn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ja(t,e))};Ji.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var e=arguments[0],r=new ve;return this.boundablesAtLevel(e,this._root,r),r}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(xn.isTrue(s>-2),c.getLevel()===s)return p.add(c),null;for(var l=c.getChildBoundables().iterator();l.hasNext();){var x=l.next();x instanceof zi?t.boundablesAtLevel(s,x,p):(xn.isTrue(x instanceof ja),s===-1&&p.add(x))}return null}};Ji.prototype.query=function(){var t=this;if(arguments.length===1){var e=arguments[0];this.build();var r=new ve;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,r),r}else if(arguments.length===2){var s=arguments[0],c=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),s)&&this.query(s,this._root,c)}else if(arguments.length===3){if(nn(arguments[2],Wc)&&arguments[0]instanceof Object&&arguments[1]instanceof zi)for(var p=arguments[0],l=arguments[1],x=arguments[2],I=l.getChildBoundables(),T=0;T<I.size();T++){var P=I.get(T);!t.getIntersectsOp().intersects(P.getBounds(),p)||(P instanceof zi?t.query(p,P,x):P instanceof ja?x.visitItem(P.getItem()):xn.shouldNeverReachHere())}else if(nn(arguments[2],Za)&&arguments[0]instanceof Object&&arguments[1]instanceof zi)for(var D=arguments[0],G=arguments[1],Y=arguments[2],et=G.getChildBoundables(),at=0;at<et.size();at++){var rt=et.get(at);!t.getIntersectsOp().intersects(rt.getBounds(),D)||(rt instanceof zi?t.query(D,rt,Y):rt instanceof ja?Y.add(rt.getItem()):xn.shouldNeverReachHere())}}};Ji.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Ji.prototype.getRoot=function(){return this.build(),this._root};Ji.prototype.remove=function(){var t=this;if(arguments.length===2){var e=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),e)?this.remove(e,this._root,r):!1}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2],l=this.removeItem(c,p);if(l)return!0;for(var x=null,I=c.getChildBoundables().iterator();I.hasNext();){var T=I.next();if(!!t.getIntersectsOp().intersects(T.getBounds(),s)&&T instanceof zi&&(l=t.remove(s,T,p),l)){x=T;break}}return x!==null&&x.getChildBoundables().isEmpty()&&c.getChildBoundables().remove(x),l}};Ji.prototype.createHigherLevels=function(t,e){xn.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,e+1);return r.size()===1?r.get(0):this.createHigherLevels(r,e+1)};Ji.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=arguments[0],r=0,s=e.getChildBoundables().iterator();s.hasNext();){var c=s.next();if(c instanceof zi){var p=t.depth(c);p>r&&(r=p)}}return r+1}};Ji.prototype.createParentBoundables=function(t,e){var r=this;xn.isTrue(!t.isEmpty());var s=new ve;s.add(this.createNode(e));var c=new ve(t);Ha.sort(c,this.getComparator());for(var p=c.iterator();p.hasNext();){var l=p.next();r.lastNode(s).getChildBoundables().size()===r.getNodeCapacity()&&s.add(r.createNode(e)),r.lastNode(s).addChildBoundable(l)}return s};Ji.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Ji.prototype.interfaces_=function(){return[Na]};Ji.prototype.getClass=function(){return Ji};Ji.compareDoubles=function(t,e){return t>e?1:t<e?-1:0};By.IntersectsOp.get=function(){return SE};By.serialVersionUID.get=function(){return-3886435814360241e3};By.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Ji,By);var SE=function(){},Md=function(){};Md.prototype.distance=function(t,e){};Md.prototype.interfaces_=function(){return[]};Md.prototype.getClass=function(){return Md};var sb=function(n){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,n.call(this,r)}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(s,c){var p=this;xn.isTrue(s.length>0);for(var l=new ve,x=0;x<s.length;x++)l.addAll(p.createParentBoundablesFromVerticalSlice(s[x],c));return l},t.prototype.createNode=function(s){return new v1(s)},t.prototype.size=function(){return arguments.length===0?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];if(s.isNull())return null;n.prototype.insert.call(this,s,c)}else return n.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(s,c){for(var p=Math.trunc(Math.ceil(s.size()/c)),l=new Array(c).fill(null),x=s.iterator(),I=0;I<c;I++){l[I]=new ve;for(var T=0;x.hasNext()&&T<p;){var P=x.next();l[I].add(P),T++}}return l},t.prototype.query=function(){if(arguments.length===1){var s=arguments[0];return n.prototype.query.call(this,s)}else if(arguments.length===2){var c=arguments[0],p=arguments[1];n.prototype.query.call(this,c,p)}else if(arguments.length===3){if(nn(arguments[2],Wc)&&arguments[0]instanceof Object&&arguments[1]instanceof zi){var l=arguments[0],x=arguments[1],I=arguments[2];n.prototype.query.call(this,l,x,I)}else if(nn(arguments[2],Za)&&arguments[0]instanceof Object&&arguments[1]instanceof zi){var T=arguments[0],P=arguments[1],D=arguments[2];n.prototype.query.call(this,T,P,D)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(s,c){return n.prototype.createParentBoundables.call(this,s,c)},t.prototype.remove=function(){if(arguments.length===2){var s=arguments[0],c=arguments[1];return n.prototype.remove.call(this,s,c)}else return n.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(s,c){xn.isTrue(!s.isEmpty());var p=Math.trunc(Math.ceil(s.size()/this.getNodeCapacity())),l=new ve(s);Ha.sort(l,t.xComparator);var x=this.verticalSlices(l,Math.trunc(Math.ceil(Math.sqrt(p))));return this.createParentBoundablesFromVerticalSlices(x,c)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(nn(arguments[0],Md)){var s=arguments[0],c=new wi(this.getRoot(),this.getRoot(),s);return this.nearestNeighbour(c)}else if(arguments[0]instanceof wi){var p=arguments[0];return this.nearestNeighbour(p,fn.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&nn(arguments[1],Md)){var l=arguments[0],x=arguments[1],I=new wi(this.getRoot(),l.getRoot(),x);return this.nearestNeighbour(I)}else if(arguments[0]instanceof wi&&typeof arguments[1]=="number"){var T=arguments[0],P=arguments[1],D=P,G=null,Y=new ic;for(Y.add(T);!Y.isEmpty()&&D>0;){var et=Y.poll(),at=et.getDistance();if(at>=D)break;et.isLeaves()?(D=at,G=et):et.expandToQueue(Y,D)}return[G.getBoundable(0).getItem(),G.getBoundable(1).getItem()]}}else if(arguments.length===3){var rt=arguments[0],wt=arguments[1],xt=arguments[2],Gt=new ja(rt,wt),ee=new wi(this.getRoot(),Gt,xt);return this.nearestNeighbour(ee)[0]}},t.prototype.interfaces_=function(){return[Wf,Na]},t.prototype.getClass=function(){return t},t.centreX=function(s){return t.avg(s.getMinX(),s.getMaxX())},t.avg=function(s,c){return(s+c)/2},t.centreY=function(s){return t.avg(s.getMinY(),s.getMaxY())},e.STRtreeNode.get=function(){return v1},e.serialVersionUID.get=function(){return 0x39920f7d5f261e0},e.xComparator.get=function(){return{interfaces_:function(){return[bd]},compare:function(r,s){return n.compareDoubles(t.centreX(r.getBounds()),t.centreX(s.getBounds()))}}},e.yComparator.get=function(){return{interfaces_:function(){return[bd]},compare:function(r,s){return n.compareDoubles(t.centreY(r.getBounds()),t.centreY(s.getBounds()))}}},e.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},intersects:function(r,s){return r.intersects(s)}}},e.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,e),t}(Ji),v1=function(n){function t(){var e=arguments[0];n.call(this,e)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,s=this.getChildBoundables().iterator();s.hasNext();){var c=s.next();r===null?r=new Xe(c.getBounds()):r.expandToInclude(c.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(zi),ds=function(){};ds.prototype.interfaces_=function(){return[]};ds.prototype.getClass=function(){return ds};ds.relativeSign=function(t,e){return t<e?-1:t>e?1:0};ds.compare=function(t,e,r){if(e.equals2D(r))return 0;var s=ds.relativeSign(e.x,r.x),c=ds.relativeSign(e.y,r.y);switch(t){case 0:return ds.compareValue(s,c);case 1:return ds.compareValue(c,s);case 2:return ds.compareValue(c,-s);case 3:return ds.compareValue(-s,c);case 4:return ds.compareValue(-s,-c);case 5:return ds.compareValue(-c,-s);case 6:return ds.compareValue(-c,s);case 7:return ds.compareValue(s,-c)}return xn.shouldNeverReachHere("invalid octant value"),0};ds.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var jc=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],r=arguments[2],s=arguments[3];this._segString=t,this.coord=new Ct(e),this.segmentIndex=r,this._segmentOctant=s,this._isInterior=!e.equals2D(t.getCoordinate(r))};jc.prototype.getCoordinate=function(){return this.coord};jc.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};jc.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ds.compare(this._segmentOctant,this.coord,e.coord)};jc.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};jc.prototype.isInterior=function(){return this._isInterior};jc.prototype.interfaces_=function(){return[Da]};jc.prototype.getClass=function(){return jc};var $o=function(){this._nodeMap=new Ao,this._edge=null;var t=arguments[0];this._edge=t};$o.prototype.getSplitCoordinates=function(){var t=this,e=new Cm;this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var c=r.next();t.addEdgeCoordinates(s,c,e),s=c}return e.toCoordinateArray()};$o.prototype.addCollapsedNodes=function(){var t=this,e=new ve;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var r=e.iterator();r.hasNext();){var s=r.next().intValue();t.add(t._edge.getCoordinate(s),s)}};$o.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var r=e.next();r.print(t)}};$o.prototype.findCollapsesFromExistingVertices=function(t){for(var e=this,r=0;r<this._edge.size()-2;r++){var s=e._edge.getCoordinate(r),c=e._edge.getCoordinate(r+2);s.equals2D(c)&&t.add(new Al(r+1))}};$o.prototype.addEdgeCoordinates=function(t,e,r){var s=this,c=this._edge.getCoordinate(e.segmentIndex),p=e.isInterior()||!e.coord.equals2D(c);r.add(new Ct(t.coord),!1);for(var l=t.segmentIndex+1;l<=e.segmentIndex;l++)r.add(s._edge.getCoordinate(l));p&&r.add(new Ct(e.coord))};$o.prototype.iterator=function(){return this._nodeMap.values().iterator()};$o.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),s=r.next();r.hasNext();){var c=r.next(),p=e.createSplitEdge(s,c);t.add(p),s=c}};$o.prototype.findCollapseIndex=function(t,e,r){if(!t.coord.equals2D(e.coord))return!1;var s=e.segmentIndex-t.segmentIndex;return e.isInterior()||s--,s===1?(r[0]=t.segmentIndex+1,!0):!1};$o.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=this,r=new Array(1).fill(null),s=this.iterator(),c=s.next();s.hasNext();){var p=s.next(),l=e.findCollapseIndex(c,p,r);l&&t.add(new Al(r[0])),c=p}};$o.prototype.getEdge=function(){return this._edge};$o.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};$o.prototype.createSplitEdge=function(t,e){var r=this,s=e.segmentIndex-t.segmentIndex+2,c=this._edge.getCoordinate(e.segmentIndex),p=e.isInterior()||!e.coord.equals2D(c);p||s--;var l=new Array(s).fill(null),x=0;l[x++]=new Ct(t.coord);for(var I=t.segmentIndex+1;I<=e.segmentIndex;I++)l[x++]=r._edge.getCoordinate(I);return p&&(l[x]=new Ct(e.coord)),new fi(l,this._edge.getData())};$o.prototype.add=function(t,e){var r=new jc(this._edge,t,e,this._edge.getSegmentOctant(e)),s=this._nodeMap.get(r);return s!==null?(xn.isTrue(s.coord.equals2D(t),"Found equal nodes with different coordinates"),s):(this._nodeMap.put(r,r),r)};$o.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),r=t.get(0),s=r.getCoordinate(0);if(!s.equals2D(e[0]))throw new ec("bad split edge start point at "+s);var c=t.get(t.size()-1),p=c.getCoordinates(),l=p[p.length-1];if(!l.equals2D(e[e.length-1]))throw new ec("bad split edge end point at "+l)};$o.prototype.interfaces_=function(){return[]};$o.prototype.getClass=function(){return $o};var jf=function(){};jf.prototype.interfaces_=function(){return[]};jf.prototype.getClass=function(){return jf};jf.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new Dr("Cannot compute the octant for point ( "+t+", "+e+" )");var r=Math.abs(t),s=Math.abs(e);return t>=0?e>=0?r>=s?0:1:r>=s?7:6:e>=0?r>=s?3:2:r>=s?4:5}else if(arguments[0]instanceof Ct&&arguments[1]instanceof Ct){var c=arguments[0],p=arguments[1],l=p.x-c.x,x=p.y-c.y;if(l===0&&x===0)throw new Dr("Cannot compute the octant for two identical points "+c);return jf.octant(l,x)}};var yu=function(){};yu.prototype.getCoordinates=function(){};yu.prototype.size=function(){};yu.prototype.getCoordinate=function(t){};yu.prototype.isClosed=function(){};yu.prototype.setData=function(t){};yu.prototype.getData=function(){};yu.prototype.interfaces_=function(){return[]};yu.prototype.getClass=function(){return yu};var gm=function(){};gm.prototype.addIntersection=function(t,e){};gm.prototype.interfaces_=function(){return[yu]};gm.prototype.getClass=function(){return gm};var fi=function(){this._nodeList=new $o(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};fi.prototype.getCoordinates=function(){return this._pts};fi.prototype.size=function(){return this._pts.length};fi.prototype.getCoordinate=function(t){return this._pts[t]};fi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};fi.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};fi.prototype.setData=function(t){this._data=t};fi.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:jf.octant(t,e)};fi.prototype.getData=function(){return this._data};fi.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var r=arguments[0],s=arguments[1],c=arguments[3],p=new Ct(r.getIntersection(c));this.addIntersection(p,s)}};fi.prototype.toString=function(){return Ya.toLineString(new ui(this._pts))};fi.prototype.getNodeList=function(){return this._nodeList};fi.prototype.addIntersectionNode=function(t,e){var r=e,s=r+1;if(s<this._pts.length){var c=this._pts[s];t.equals2D(c)&&(r=s)}var p=this._nodeList.add(t,r);return p};fi.prototype.addIntersections=function(t,e,r){for(var s=this,c=0;c<t.getIntersectionNum();c++)s.addIntersection(t,e,r,c)};fi.prototype.interfaces_=function(){return[gm]};fi.prototype.getClass=function(){return fi};fi.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],e=new ve;return fi.getNodedSubstrings(t,e),e}else if(arguments.length===2)for(var r=arguments[0],s=arguments[1],c=r.iterator();c.hasNext();){var p=c.next();p.getNodeList().addSplitEdges(s)}};var Ze=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Ct,this.p1=new Ct;else if(arguments.length===1){var t=arguments[0];this.p0=new Ct(t.p0),this.p1=new Ct(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var e=arguments[0],r=arguments[1],s=arguments[2],c=arguments[3];this.p0=new Ct(e,r),this.p1=new Ct(s,c)}},ab={serialVersionUID:{configurable:!0}};Ze.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Ze.prototype.orientationIndex=function(){if(arguments[0]instanceof Ze){var t=arguments[0],e=Te.orientationIndex(this.p0,this.p1,t.p0),r=Te.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&r>=0||e<=0&&r<=0?Math.max(e,r):0}else if(arguments[0]instanceof Ct){var s=arguments[0];return Te.orientationIndex(this.p0,this.p1,s)}};Ze.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};Ze.prototype.isVertical=function(){return this.p0.x===this.p1.x};Ze.prototype.equals=function(t){if(!(t instanceof Ze))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)};Ze.prototype.intersection=function(t){var e=new $h;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null};Ze.prototype.project=function(){if(arguments[0]instanceof Ct){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Ct(t);var e=this.projectionFactor(t),r=new Ct;return r.x=this.p0.x+e*(this.p1.x-this.p0.x),r.y=this.p0.y+e*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof Ze){var s=arguments[0],c=this.projectionFactor(s.p0),p=this.projectionFactor(s.p1);if(c>=1&&p>=1||c<=0&&p<=0)return null;var l=this.project(s.p0);c<0&&(l=this.p0),c>1&&(l=this.p1);var x=this.project(s.p1);return p<0&&(x=this.p0),p>1&&(x=this.p1),new Ze(l,x)}};Ze.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};Ze.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Ze.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};Ze.prototype.distancePerpendicular=function(t){return Te.distancePointLinePerpendicular(t,this.p0,this.p1)};Ze.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};Ze.prototype.midPoint=function(){return Ze.midPoint(this.p0,this.p1)};Ze.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,s=e*e+r*r;if(s<=0)return fn.NaN;var c=((t.x-this.p0.x)*e+(t.y-this.p0.y)*r)/s;return c};Ze.prototype.closestPoints=function(t){var e=this.intersection(t);if(e!==null)return[e,e];var r=new Array(2).fill(null),s=fn.MAX_VALUE,c=null,p=this.closestPoint(t.p0);s=p.distance(t.p0),r[0]=p,r[1]=t.p0;var l=this.closestPoint(t.p1);c=l.distance(t.p1),c<s&&(s=c,r[0]=l,r[1]=t.p1);var x=t.closestPoint(this.p0);c=x.distance(this.p0),c<s&&(s=c,r[0]=this.p0,r[1]=x);var I=t.closestPoint(this.p1);return c=I.distance(this.p1),c<s&&(s=c,r[0]=this.p1,r[1]=I),r};Ze.prototype.closestPoint=function(t){var e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);var r=this.p0.distance(t),s=this.p1.distance(t);return r<s?this.p0:this.p1};Ze.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Ze.prototype.getLength=function(){return this.p0.distance(this.p1)};Ze.prototype.compareTo=function(t){var e=t,r=this.p0.compareTo(e.p0);return r!==0?r:this.p1.compareTo(e.p1)};Ze.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};Ze.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};Ze.prototype.lineIntersection=function(t){try{var e=Xa.intersection(this.p0,this.p1,t.p0,t.p1);return e}catch(r){if(!(r instanceof jd))throw r}finally{}return null};Ze.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};Ze.prototype.pointAlongOffset=function(t,e){var r=this.p0.x+t*(this.p1.x-this.p0.x),s=this.p0.y+t*(this.p1.y-this.p0.y),c=this.p1.x-this.p0.x,p=this.p1.y-this.p0.y,l=Math.sqrt(c*c+p*p),x=0,I=0;if(e!==0){if(l<=0)throw new Error("Cannot compute offset from zero-length line segment");x=e*c/l,I=e*p/l}var T=r-I,P=s+x,D=new Ct(T,P);return D};Ze.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=r.x,this.p1.y=r.y}};Ze.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||fn.isNaN(e))&&(e=1),e};Ze.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Ze.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Ze.prototype.distance=function(){if(arguments[0]instanceof Ze){var t=arguments[0];return Te.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof Ct){var e=arguments[0];return Te.distancePointLine(e,this.p0,this.p1)}};Ze.prototype.pointAlong=function(t){var e=new Ct;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e};Ze.prototype.hashCode=function(){var t=fn.doubleToLongBits(this.p0.x);t^=fn.doubleToLongBits(this.p0.y)*31;var e=Math.trunc(t)^Math.trunc(t>>32),r=fn.doubleToLongBits(this.p1.x);r^=fn.doubleToLongBits(this.p1.y)*31;var s=Math.trunc(r)^Math.trunc(r>>32);return e^s};Ze.prototype.interfaces_=function(){return[Da,Na]};Ze.prototype.getClass=function(){return Ze};Ze.midPoint=function(t,e){return new Ct((t.x+e.x)/2,(t.y+e.y)/2)};ab.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Ze,ab);var mm=function(){this.tempEnv1=new Xe,this.tempEnv2=new Xe,this._overlapSeg1=new Ze,this._overlapSeg2=new Ze};mm.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],e=arguments[1],r=arguments[2],s=arguments[3];t.getLineSegment(e,this._overlapSeg1),r.getLineSegment(s,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};mm.prototype.interfaces_=function(){return[]};mm.prototype.getClass=function(){return mm};var Os=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],r=arguments[2],s=arguments[3];this._pts=t,this._start=e,this._end=r,this._context=s};Os.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]};Os.prototype.computeSelect=function(t,e,r,s){var c=this._pts[e],p=this._pts[r];if(s.tempEnv1.init(c,p),r-e===1)return s.select(this,e),null;if(!t.intersects(s.tempEnv1))return null;var l=Math.trunc((e+r)/2);e<l&&this.computeSelect(t,e,l,s),l<r&&this.computeSelect(t,l,r,s)};Os.prototype.getCoordinates=function(){for(var t=this,e=new Array(this._end-this._start+1).fill(null),r=0,s=this._start;s<=this._end;s++)e[r++]=t._pts[s];return e};Os.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)};Os.prototype.setId=function(t){this._id=t};Os.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)};Os.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Xe(t,e)}return this._env};Os.prototype.getEndIndex=function(){return this._end};Os.prototype.getStartIndex=function(){return this._start};Os.prototype.getContext=function(){return this._context};Os.prototype.getId=function(){return this._id};Os.prototype.computeOverlapsInternal=function(t,e,r,s,c,p){var l=this._pts[t],x=this._pts[e],I=r._pts[s],T=r._pts[c];if(e-t===1&&c-s===1)return p.overlap(this,t,r,s),null;if(p.tempEnv1.init(l,x),p.tempEnv2.init(I,T),!p.tempEnv1.intersects(p.tempEnv2))return null;var P=Math.trunc((t+e)/2),D=Math.trunc((s+c)/2);t<P&&(s<D&&this.computeOverlapsInternal(t,P,r,s,D,p),D<c&&this.computeOverlapsInternal(t,P,r,D,c,p)),P<e&&(s<D&&this.computeOverlapsInternal(P,e,r,s,D,p),D<c&&this.computeOverlapsInternal(P,e,r,D,c,p))};Os.prototype.interfaces_=function(){return[]};Os.prototype.getClass=function(){return Os};var Tl=function(){};Tl.prototype.interfaces_=function(){return[]};Tl.prototype.getClass=function(){return Tl};Tl.getChainStartIndices=function(t){var e=0,r=new ve;r.add(new Al(e));do{var s=Tl.findChainEnd(t,e);r.add(new Al(s)),e=s}while(e<t.length-1);var c=Tl.toIntArray(r);return c};Tl.findChainEnd=function(t,e){for(var r=e;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var s=dr.quadrant(t[r],t[r+1]),c=e+1;c<t.length;){if(!t[c-1].equals2D(t[c])){var p=dr.quadrant(t[c-1],t[c]);if(p!==s)break}c++}return c-1};Tl.getChains=function(){if(arguments.length===1){var t=arguments[0];return Tl.getChains(t,null)}else if(arguments.length===2){for(var e=arguments[0],r=arguments[1],s=new ve,c=Tl.getChainStartIndices(e),p=0;p<c.length-1;p++){var l=new Os(e,c[p],c[p+1],r);s.add(l)}return s}};Tl.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e};var Zh=function(){};Zh.prototype.computeNodes=function(t){};Zh.prototype.getNodedSubstrings=function(){};Zh.prototype.interfaces_=function(){return[]};Zh.prototype.getClass=function(){return Zh};var _m=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};_m.prototype.setSegmentIntersector=function(t){this._segInt=t};_m.prototype.interfaces_=function(){return[Zh]};_m.prototype.getClass=function(){return _m};var w0=function(n){function t(r){r?n.call(this,r):n.call(this),this._monoChains=new ve,this._index=new sb,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return fi.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(s){for(var c=this,p=Tl.getChains(s.getCoordinates(),s),l=p.iterator();l.hasNext();){var x=l.next();x.setId(c._idCounter++),c._index.insert(x.getEnvelope(),x),c._monoChains.add(x)}},t.prototype.computeNodes=function(s){var c=this;this._nodedSegStrings=s;for(var p=s.iterator();p.hasNext();)c.add(p.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var s=this,c=new x1(this._segInt),p=this._monoChains.iterator();p.hasNext();)for(var l=p.next(),x=s._index.query(l.getEnvelope()),I=x.iterator();I.hasNext();){var T=I.next();if(T.getId()>l.getId()&&(l.computeOverlaps(T,c),s._nOverlaps++),s._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.SegmentOverlapAction.get=function(){return x1},Object.defineProperties(t,e),t}(_m),x1=function(n){function t(){n.call(this),this._si=null;var e=arguments[0];this._si=e}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],s=arguments[1],c=arguments[2],p=arguments[3],l=r.getContext(),x=c.getContext();this._si.processIntersections(l,s,x,p)}else return n.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(mm),Hn=function n(){if(this._quadrantSegments=n.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=n.CAP_ROUND,this._joinStyle=n.JOIN_ROUND,this._mitreLimit=n.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=n.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(r)}else if(arguments.length===4){var s=arguments[0],c=arguments[1],p=arguments[2],l=arguments[3];this.setQuadrantSegments(s),this.setEndCapStyle(c),this.setJoinStyle(p),this.setMitreLimit(l)}}},lc={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Hn.prototype.getEndCapStyle=function(){return this._endCapStyle};Hn.prototype.isSingleSided=function(){return this._isSingleSided};Hn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=Hn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Hn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Hn.JOIN_ROUND&&(this._quadrantSegments=Hn.DEFAULT_QUADRANT_SEGMENTS)};Hn.prototype.getJoinStyle=function(){return this._joinStyle};Hn.prototype.setJoinStyle=function(t){this._joinStyle=t};Hn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};Hn.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Hn.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Hn.prototype.setEndCapStyle=function(t){this._endCapStyle=t};Hn.prototype.getMitreLimit=function(){return this._mitreLimit};Hn.prototype.setMitreLimit=function(t){this._mitreLimit=t};Hn.prototype.setSingleSided=function(t){this._isSingleSided=t};Hn.prototype.interfaces_=function(){return[]};Hn.prototype.getClass=function(){return Hn};Hn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)};lc.CAP_ROUND.get=function(){return 1};lc.CAP_FLAT.get=function(){return 2};lc.CAP_SQUARE.get=function(){return 3};lc.JOIN_ROUND.get=function(){return 1};lc.JOIN_MITRE.get=function(){return 2};lc.JOIN_BEVEL.get=function(){return 3};lc.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};lc.DEFAULT_MITRE_LIMIT.get=function(){return 5};lc.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Hn,lc);var ii=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Te.COUNTERCLOCKWISE,this._inputLine=t||null},Pm={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ii.prototype.isDeletable=function(t,e,r,s){var c=this._inputLine[t],p=this._inputLine[e],l=this._inputLine[r];return!this.isConcave(c,p,l)||!this.isShallow(c,p,l,s)?!1:this.isShallowSampled(c,p,t,r,s)};ii.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,r=this.findNextNonDeletedIndex(e),s=this.findNextNonDeletedIndex(r),c=!1;s<this._inputLine.length;){var p=!1;t.isDeletable(e,r,s,t._distanceTol)&&(t._isDeleted[r]=ii.DELETE,p=!0,c=!0),p?e=s:e=r,r=t.findNextNonDeletedIndex(e),s=t.findNextNonDeletedIndex(r)}return c};ii.prototype.isShallowConcavity=function(t,e,r,s){var c=Te.computeOrientation(t,e,r),p=c===this._angleOrientation;if(!p)return!1;var l=Te.distancePointLine(e,t,r);return l<s};ii.prototype.isShallowSampled=function(t,e,r,s,c){var p=this,l=Math.trunc((s-r)/ii.NUM_PTS_TO_CHECK);l<=0&&(l=1);for(var x=r;x<s;x+=l)if(!p.isShallow(t,e,p._inputLine[x],c))return!1;return!0};ii.prototype.isConcave=function(t,e,r){var s=Te.computeOrientation(t,e,r),c=s===this._angleOrientation;return c};ii.prototype.simplify=function(t){var e=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Te.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=e.deleteShallowConcavities();while(r);return this.collapseLine()};ii.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===ii.DELETE;)e++;return e};ii.prototype.isShallow=function(t,e,r,s){var c=Te.distancePointLine(e,t,r);return c<s};ii.prototype.collapseLine=function(){for(var t=this,e=new Cm,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==ii.DELETE&&e.add(t._inputLine[r]);return e.toCoordinateArray()};ii.prototype.interfaces_=function(){return[]};ii.prototype.getClass=function(){return ii};ii.simplify=function(t,e){var r=new ii(t);return r.simplify(e)};Pm.INIT.get=function(){return 0};Pm.DELETE.get=function(){return 1};Pm.KEEP.get=function(){return 1};Pm.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(ii,Pm);var ra=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ve},lb={COORDINATE_ARRAY_TYPE:{configurable:!0}};ra.prototype.getCoordinates=function(){var t=this._ptList.toArray(ra.COORDINATE_ARRAY_TYPE);return t};ra.prototype.setPrecisionModel=function(t){this._precisionModel=t};ra.prototype.addPt=function(t){var e=new Ct(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)};ra.prototype.revere=function(){};ra.prototype.addPts=function(t,e){var r=this;if(e)for(var s=0;s<t.length;s++)r.addPt(t[s]);else for(var c=t.length-1;c>=0;c--)r.addPt(t[c])};ra.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1),r=t.distance(e);return r<this._minimimVertexDistance};ra.prototype.toString=function(){var t=new Pn,e=t.createLineString(this.getCoordinates());return e.toString()};ra.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new Ct(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)};ra.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};ra.prototype.interfaces_=function(){return[]};ra.prototype.getClass=function(){return ra};lb.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(ra,lb);var On=function(){},lp={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};On.prototype.interfaces_=function(){return[]};On.prototype.getClass=function(){return On};On.toDegrees=function(t){return t*180/Math.PI};On.normalize=function(t){for(;t>Math.PI;)t-=On.PI_TIMES_2;for(;t<=-Math.PI;)t+=On.PI_TIMES_2;return t};On.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var e=arguments[0],r=arguments[1],s=r.x-e.x,c=r.y-e.y;return Math.atan2(c,s)}};On.isAcute=function(t,e,r){var s=t.x-e.x,c=t.y-e.y,p=r.x-e.x,l=r.y-e.y,x=s*p+c*l;return x>0};On.isObtuse=function(t,e,r){var s=t.x-e.x,c=t.y-e.y,p=r.x-e.x,l=r.y-e.y,x=s*p+c*l;return x<0};On.interiorAngle=function(t,e,r){var s=On.angle(e,t),c=On.angle(e,r);return Math.abs(c-s)};On.normalizePositive=function(t){if(t<0){for(;t<0;)t+=On.PI_TIMES_2;t>=On.PI_TIMES_2&&(t=0)}else{for(;t>=On.PI_TIMES_2;)t-=On.PI_TIMES_2;t<0&&(t=0)}return t};On.angleBetween=function(t,e,r){var s=On.angle(e,t),c=On.angle(e,r);return On.diff(s,c)};On.diff=function(t,e){var r=null;return t<e?r=e-t:r=t-e,r>Math.PI&&(r=2*Math.PI-r),r};On.toRadians=function(t){return t*Math.PI/180};On.getTurn=function(t,e){var r=Math.sin(e-t);return r>0?On.COUNTERCLOCKWISE:r<0?On.CLOCKWISE:On.NONE};On.angleBetweenOriented=function(t,e,r){var s=On.angle(e,t),c=On.angle(e,r),p=c-s;return p<=-Math.PI?p+On.PI_TIMES_2:p>Math.PI?p-On.PI_TIMES_2:p};lp.PI_TIMES_2.get=function(){return 2*Math.PI};lp.PI_OVER_2.get=function(){return Math.PI/2};lp.PI_OVER_4.get=function(){return Math.PI/4};lp.COUNTERCLOCKWISE.get=function(){return Te.COUNTERCLOCKWISE};lp.CLOCKWISE.get=function(){return Te.CLOCKWISE};lp.NONE.get=function(){return Te.COLLINEAR};Object.defineProperties(On,lp);var Pr=function n(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Ze,this._seg1=new Ze,this._offset0=new Ze,this._offset1=new Ze,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new $h,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Hn.JOIN_ROUND&&(this._closingSegLengthFactor=n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Lm={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Pr.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=Te.computeOrientation(this._s0,this._s1,this._s2),s=r===Te.CLOCKWISE&&this._side===pe.LEFT||r===Te.COUNTERCLOCKWISE&&this._side===pe.RIGHT;r===0?this.addCollinear(e):s?this.addOutsideTurn(r,e):this.addInsideTurn(r,e)};Pr.prototype.addLineEndCap=function(t,e){var r=new Ze(t,e),s=new Ze;this.computeOffsetSegment(r,pe.LEFT,this._distance,s);var c=new Ze;this.computeOffsetSegment(r,pe.RIGHT,this._distance,c);var p=e.x-t.x,l=e.y-t.y,x=Math.atan2(l,p);switch(this._bufParams.getEndCapStyle()){case Hn.CAP_ROUND:this._segList.addPt(s.p1),this.addFilletArc(e,x+Math.PI/2,x-Math.PI/2,Te.CLOCKWISE,this._distance),this._segList.addPt(c.p1);break;case Hn.CAP_FLAT:this._segList.addPt(s.p1),this._segList.addPt(c.p1);break;case Hn.CAP_SQUARE:var I=new Ct;I.x=Math.abs(this._distance)*Math.cos(x),I.y=Math.abs(this._distance)*Math.sin(x);var T=new Ct(s.p1.x+I.x,s.p1.y+I.y),P=new Ct(c.p1.x+I.x,c.p1.y+I.y);this._segList.addPt(T),this._segList.addPt(P);break}};Pr.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};Pr.prototype.addMitreJoin=function(t,e,r,s){var c=!0,p=null;try{p=Xa.intersection(e.p0,e.p1,r.p0,r.p1);var l=s<=0?1:p.distance(t)/Math.abs(s);l>this._bufParams.getMitreLimit()&&(c=!1)}catch(x){if(x instanceof jd)p=new Ct(0,0),c=!1;else throw x}finally{}c?this._segList.addPt(p):this.addLimitedMitreJoin(e,r,s,this._bufParams.getMitreLimit())};Pr.prototype.addFilletCorner=function(t,e,r,s,c){var p=e.x-t.x,l=e.y-t.y,x=Math.atan2(l,p),I=r.x-t.x,T=r.y-t.y,P=Math.atan2(T,I);s===Te.CLOCKWISE?x<=P&&(x+=2*Math.PI):x>=P&&(x-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,x,P,s,c),this._segList.addPt(r)};Pr.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Pr.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Hn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Hn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};Pr.prototype.createSquare=function(t){this._segList.addPt(new Ct(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Ct(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Ct(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Ct(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};Pr.prototype.addSegments=function(t,e){this._segList.addPts(t,e)};Pr.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Pr.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Pr.prototype.initSideSegments=function(t,e,r){this._s1=t,this._s2=e,this._side=r,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};Pr.prototype.addLimitedMitreJoin=function(t,e,r,s){var c=this._seg0.p1,p=On.angle(c,this._seg0.p0),l=On.angleBetweenOriented(this._seg0.p0,c,this._seg1.p1),x=l/2,I=On.normalize(p+x),T=On.normalize(I+Math.PI),P=s*r,D=P*Math.abs(Math.sin(x)),G=r-D,Y=c.x+P*Math.cos(T),et=c.y+P*Math.sin(T),at=new Ct(Y,et),rt=new Ze(c,at),wt=rt.pointAlongOffset(1,G),xt=rt.pointAlongOffset(1,-G);this._side===pe.LEFT?(this._segList.addPt(wt),this._segList.addPt(xt)):(this._segList.addPt(xt),this._segList.addPt(wt))};Pr.prototype.computeOffsetSegment=function(t,e,r,s){var c=e===pe.LEFT?1:-1,p=t.p1.x-t.p0.x,l=t.p1.y-t.p0.y,x=Math.sqrt(p*p+l*l),I=c*r*p/x,T=c*r*l/x;s.p0.x=t.p0.x-T,s.p0.y=t.p0.y+I,s.p1.x=t.p1.x-T,s.p1.y=t.p1.y+I};Pr.prototype.addFilletArc=function(t,e,r,s,c){var p=this,l=s===Te.CLOCKWISE?-1:1,x=Math.abs(e-r),I=Math.trunc(x/this._filletAngleQuantum+.5);if(I<1)return null;for(var T=0,P=x/I,D=T,G=new Ct;D<x;){var Y=e+l*D;G.x=t.x+c*Math.cos(Y),G.y=t.y+c*Math.sin(Y),p._segList.addPt(G),D+=P}};Pr.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Pr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new Ct((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var s=new Ct((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(s)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Pr.prototype.createCircle=function(t){var e=new Ct(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Pr.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)};Pr.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ra,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Pr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Pr.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var e=this._li.getIntersectionNum();e>=2&&(this._bufParams.getJoinStyle()===Hn.JOIN_BEVEL||this._bufParams.getJoinStyle()===Hn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Te.CLOCKWISE,this._distance))};Pr.prototype.closeRing=function(){this._segList.closeRing()};Pr.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Pr.prototype.interfaces_=function(){return[]};Pr.prototype.getClass=function(){return Pr};Lm.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};Lm.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};Lm.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};Lm.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Pr,Lm);var ms=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};ms.prototype.getOffsetCurve=function(t,e){if(this._distance=e,e===0)return null;var r=e<0,s=Math.abs(e),c=this.getSegGen(s);t.length<=1?this.computePointCurve(t[0],c):this.computeOffsetCurve(t,r,c);var p=c.getCoordinates();return r&&Ln.reverse(p),p};ms.prototype.computeSingleSidedBufferCurve=function(t,e,r){var s=this.simplifyTolerance(this._distance);if(e){r.addSegments(t,!0);var c=ii.simplify(t,-s),p=c.length-1;r.initSideSegments(c[p],c[p-1],pe.LEFT),r.addFirstSegment();for(var l=p-2;l>=0;l--)r.addNextSegment(c[l],!0)}else{r.addSegments(t,!1);var x=ii.simplify(t,s),I=x.length-1;r.initSideSegments(x[0],x[1],pe.LEFT),r.addFirstSegment();for(var T=2;T<=I;T++)r.addNextSegment(x[T],!0)}r.addLastSegment(),r.closeRing()};ms.prototype.computeRingBufferCurve=function(t,e,r){var s=this.simplifyTolerance(this._distance);e===pe.RIGHT&&(s=-s);var c=ii.simplify(t,s),p=c.length-1;r.initSideSegments(c[p-1],c[0],e);for(var l=1;l<=p;l++){var x=l!==1;r.addNextSegment(c[l],x)}r.closeRing()};ms.prototype.computeLineBufferCurve=function(t,e){var r=this.simplifyTolerance(this._distance),s=ii.simplify(t,r),c=s.length-1;e.initSideSegments(s[0],s[1],pe.LEFT);for(var p=2;p<=c;p++)e.addNextSegment(s[p],!0);e.addLastSegment(),e.addLineEndCap(s[c-1],s[c]);var l=ii.simplify(t,-r),x=l.length-1;e.initSideSegments(l[x],l[x-1],pe.LEFT);for(var I=x-2;I>=0;I--)e.addNextSegment(l[I],!0);e.addLastSegment(),e.addLineEndCap(l[1],l[0]),e.closeRing()};ms.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Hn.CAP_ROUND:e.createCircle(t);break;case Hn.CAP_SQUARE:e.createSquare(t);break}};ms.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided()||e===0)return null;var r=Math.abs(e),s=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],s);else if(this._bufParams.isSingleSided()){var c=e<0;this.computeSingleSidedBufferCurve(t,c,s)}else this.computeLineBufferCurve(t,s);var p=s.getCoordinates();return p};ms.prototype.getBufferParameters=function(){return this._bufParams};ms.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};ms.prototype.getRingCurve=function(t,e,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return ms.copyCoordinates(t);var s=this.getSegGen(r);return this.computeRingBufferCurve(t,e,s),s.getCoordinates()};ms.prototype.computeOffsetCurve=function(t,e,r){var s=this.simplifyTolerance(this._distance);if(e){var c=ii.simplify(t,-s),p=c.length-1;r.initSideSegments(c[p],c[p-1],pe.LEFT),r.addFirstSegment();for(var l=p-2;l>=0;l--)r.addNextSegment(c[l],!0)}else{var x=ii.simplify(t,s),I=x.length-1;r.initSideSegments(x[0],x[1],pe.LEFT),r.addFirstSegment();for(var T=2;T<=I;T++)r.addNextSegment(x[T],!0)}r.addLastSegment()};ms.prototype.getSegGen=function(t){return new Pr(this._precisionModel,this._bufParams,t)};ms.prototype.interfaces_=function(){return[]};ms.prototype.getClass=function(){return ms};ms.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),r=0;r<e.length;r++)e[r]=new Ct(t[r]);return e};var Hf=function(){this._subgraphs=null,this._seg=new Ze,this._cga=new Te;var t=arguments[0];this._subgraphs=t},ub={DepthSegment:{configurable:!0}};Hf.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],r=new ve,s=this._subgraphs.iterator();s.hasNext();){var c=s.next(),p=c.getEnvelope();e.y<p.getMinY()||e.y>p.getMaxY()||t.findStabbedSegments(e,c.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(nn(arguments[2],Za)&&arguments[0]instanceof Ct&&arguments[1]instanceof Jv)for(var l=arguments[0],x=arguments[1],I=arguments[2],T=x.getEdge().getCoordinates(),P=0;P<T.length-1;P++){t._seg.p0=T[P],t._seg.p1=T[P+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var D=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(D<l.x)&&!t._seg.isHorizontal()&&!(l.y<t._seg.p0.y||l.y>t._seg.p1.y)&&Te.computeOrientation(t._seg.p0,t._seg.p1,l)!==Te.RIGHT){var G=x.getDepth(pe.LEFT);t._seg.p0.equals(T[P])||(G=x.getDepth(pe.RIGHT));var Y=new Yh(t._seg,G);I.add(Y)}}else if(nn(arguments[2],Za)&&arguments[0]instanceof Ct&&nn(arguments[1],Za))for(var et=arguments[0],at=arguments[1],rt=arguments[2],wt=at.iterator();wt.hasNext();){var xt=wt.next();!xt.isForward()||t.findStabbedSegments(et,xt,rt)}}};Hf.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);if(e.size()===0)return 0;var r=Ha.min(e);return r._leftDepth};Hf.prototype.interfaces_=function(){return[]};Hf.prototype.getClass=function(){return Hf};ub.DepthSegment.get=function(){return Yh};Object.defineProperties(Hf,ub);var Yh=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Ze(t),this._leftDepth=e};Yh.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(e._upwardSeg);return r!==0||(r=-1*e._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(e._upwardSeg)};Yh.prototype.compareX=function(t,e){var r=t.p0.compareTo(e.p0);return r!==0?r:t.p1.compareTo(e.p1)};Yh.prototype.toString=function(){return this._upwardSeg.toString()};Yh.prototype.interfaces_=function(){return[Da]};Yh.prototype.getClass=function(){return Yh};var Jn=function(t,e,r){this.p0=t||null,this.p1=e||null,this.p2=r||null};Jn.prototype.area=function(){return Jn.area(this.p0,this.p1,this.p2)};Jn.prototype.signedArea=function(){return Jn.signedArea(this.p0,this.p1,this.p2)};Jn.prototype.interpolateZ=function(t){if(t===null)throw new Dr("Supplied point is null.");return Jn.interpolateZ(t,this.p0,this.p1,this.p2)};Jn.prototype.longestSideLength=function(){return Jn.longestSideLength(this.p0,this.p1,this.p2)};Jn.prototype.isAcute=function(){return Jn.isAcute(this.p0,this.p1,this.p2)};Jn.prototype.circumcentre=function(){return Jn.circumcentre(this.p0,this.p1,this.p2)};Jn.prototype.area3D=function(){return Jn.area3D(this.p0,this.p1,this.p2)};Jn.prototype.centroid=function(){return Jn.centroid(this.p0,this.p1,this.p2)};Jn.prototype.inCentre=function(){return Jn.inCentre(this.p0,this.p1,this.p2)};Jn.prototype.interfaces_=function(){return[]};Jn.prototype.getClass=function(){return Jn};Jn.area=function(t,e,r){return Math.abs(((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2)};Jn.signedArea=function(t,e,r){return((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2};Jn.det=function(t,e,r,s){return t*s-e*r};Jn.interpolateZ=function(t,e,r,s){var c=e.x,p=e.y,l=r.x-c,x=s.x-c,I=r.y-p,T=s.y-p,P=l*T-x*I,D=t.x-c,G=t.y-p,Y=(T*D-x*G)/P,et=(-I*D+l*G)/P,at=e.z+Y*(r.z-e.z)+et*(s.z-e.z);return at};Jn.longestSideLength=function(t,e,r){var s=t.distance(e),c=e.distance(r),p=r.distance(t),l=s;return c>l&&(l=c),p>l&&(l=p),l};Jn.isAcute=function(t,e,r){return!(!On.isAcute(t,e,r)||!On.isAcute(e,r,t)||!On.isAcute(r,t,e))};Jn.circumcentre=function(t,e,r){var s=r.x,c=r.y,p=t.x-s,l=t.y-c,x=e.x-s,I=e.y-c,T=2*Jn.det(p,l,x,I),P=Jn.det(l,p*p+l*l,I,x*x+I*I),D=Jn.det(p,p*p+l*l,x,x*x+I*I),G=s-P/T,Y=c+D/T;return new Ct(G,Y)};Jn.perpendicularBisector=function(t,e){var r=e.x-t.x,s=e.y-t.y,c=new Xa(t.x+r/2,t.y+s/2,1),p=new Xa(t.x-s+r/2,t.y+r+s/2,1);return new Xa(c,p)};Jn.angleBisector=function(t,e,r){var s=e.distance(t),c=e.distance(r),p=s/(s+c),l=r.x-t.x,x=r.y-t.y,I=new Ct(t.x+p*l,t.y+p*x);return I};Jn.area3D=function(t,e,r){var s=e.x-t.x,c=e.y-t.y,p=e.z-t.z,l=r.x-t.x,x=r.y-t.y,I=r.z-t.z,T=c*I-p*x,P=p*l-s*I,D=s*x-c*l,G=T*T+P*P+D*D,Y=Math.sqrt(G)/2;return Y};Jn.centroid=function(t,e,r){var s=(t.x+e.x+r.x)/3,c=(t.y+e.y+r.y)/3;return new Ct(s,c)};Jn.inCentre=function(t,e,r){var s=e.distance(r),c=t.distance(r),p=t.distance(e),l=s+c+p,x=(s*t.x+c*e.x+p*r.x)/l,I=(s*t.y+c*e.y+p*r.y)/l;return new Ct(x,I)};var Ma=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ve;var t=arguments[0],e=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=r};Ma.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),r=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(r,Pt.EXTERIOR,Pt.INTERIOR)};Ma.prototype.addPolygon=function(t){var e=this,r=this._distance,s=pe.LEFT;this._distance<0&&(r=-this._distance,s=pe.RIGHT);var c=t.getExteriorRing(),p=Ln.removeRepeatedPoints(c.getCoordinates());if(this._distance<0&&this.isErodedCompletely(c,this._distance)||this._distance<=0&&p.length<3)return null;this.addPolygonRing(p,r,s,Pt.EXTERIOR,Pt.INTERIOR);for(var l=0;l<t.getNumInteriorRing();l++){var x=t.getInteriorRingN(l),I=Ln.removeRepeatedPoints(x.getCoordinates());e._distance>0&&e.isErodedCompletely(x,-e._distance)||e.addPolygonRing(I,r,pe.opposite(s),Pt.INTERIOR,Pt.EXTERIOR)}};Ma.prototype.isTriangleErodedCompletely=function(t,e){var r=new Jn(t[0],t[1],t[2]),s=r.inCentre(),c=Te.distancePointLine(s,r.p0,r.p1);return c<Math.abs(e)};Ma.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Ln.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(r,Pt.EXTERIOR,Pt.INTERIOR)};Ma.prototype.addCurve=function(t,e,r){if(t===null||t.length<2)return null;var s=new fi(t,new sr(0,Pt.BOUNDARY,e,r));this._curveList.add(s)};Ma.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Ma.prototype.addPolygonRing=function(t,e,r,s,c){if(e===0&&t.length<mu.MINIMUM_VALID_SIZE)return null;var p=s,l=c;t.length>=mu.MINIMUM_VALID_SIZE&&Te.isCCW(t)&&(p=c,l=s,r=pe.opposite(r));var x=this._curveBuilder.getRingCurve(t,r,e);this.addCurve(x,p,l)};Ma.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Oi?this.addPolygon(t):t instanceof ni?this.addLineString(t):t instanceof Rs?this.addPoint(t):t instanceof Ad?this.addCollection(t):t instanceof Xh?this.addCollection(t):t instanceof pu?this.addCollection(t):t instanceof Jo&&this.addCollection(t)};Ma.prototype.isErodedCompletely=function(t,e){var r=t.getCoordinates();if(r.length<4)return e<0;if(r.length===4)return this.isTriangleErodedCompletely(r,e);var s=t.getEnvelopeInternal(),c=Math.min(s.getHeight(),s.getWidth());return e<0&&2*Math.abs(e)>c};Ma.prototype.addCollection=function(t){for(var e=this,r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r);e.add(s)}};Ma.prototype.interfaces_=function(){return[]};Ma.prototype.getClass=function(){return Ma};var Dd=function(){};Dd.prototype.locate=function(t){};Dd.prototype.interfaces_=function(){return[]};Dd.prototype.getClass=function(){return Dd};var du=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};du.prototype.next=function(){if(this._atStart)return this._atStart=!1,du.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Kd;var t=this._parent.getGeometryN(this._index++);return t instanceof Jo?(this._subcollectionIterator=new du(t),this._subcollectionIterator.next()):t};du.prototype.remove=function(){throw new Error(this.getClass().getName())};du.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};du.prototype.interfaces_=function(){return[Hd]};du.prototype.getClass=function(){return du};du.isAtomic=function(t){return!(t instanceof Jo)};var ta=function(){this._geom=null;var t=arguments[0];this._geom=t};ta.prototype.locate=function(t){return ta.locate(t,this._geom)};ta.prototype.interfaces_=function(){return[Dd]};ta.prototype.getClass=function(){return ta};ta.isPointInRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Te.isPointInRing(t,e.getCoordinates()):!1};ta.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var r=e.getExteriorRing();if(!ta.isPointInRing(t,r))return!1;for(var s=0;s<e.getNumInteriorRing();s++){var c=e.getInteriorRingN(s);if(ta.isPointInRing(t,c))return!1}return!0};ta.containsPoint=function(t,e){if(e instanceof Oi)return ta.containsPointInPolygon(t,e);if(e instanceof Jo)for(var r=new du(e);r.hasNext();){var s=r.next();if(s!==e&&ta.containsPoint(t,s))return!0}return!1};ta.locate=function(t,e){return e.isEmpty()?Pt.EXTERIOR:ta.containsPoint(t,e)?Pt.INTERIOR:Pt.EXTERIOR};var Lo=function(){this._edgeMap=new Ao,this._edgeList=null,this._ptInAreaLocation=[Pt.NONE,Pt.NONE]};Lo.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),r=e-1;return e===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};Lo.prototype.propagateSideLabels=function(t){for(var e=Pt.NONE,r=this.iterator();r.hasNext();){var s=r.next(),c=s.getLabel();c.isArea(t)&&c.getLocation(t,pe.LEFT)!==Pt.NONE&&(e=c.getLocation(t,pe.LEFT))}if(e===Pt.NONE)return null;for(var p=e,l=this.iterator();l.hasNext();){var x=l.next(),I=x.getLabel();if(I.getLocation(t,pe.ON)===Pt.NONE&&I.setLocation(t,pe.ON,p),I.isArea(t)){var T=I.getLocation(t,pe.LEFT),P=I.getLocation(t,pe.RIGHT);if(P!==Pt.NONE){if(P!==p)throw new rc("side location conflict",x.getCoordinate());T===Pt.NONE&&xn.shouldNeverReachHere("found single null side (at "+x.getCoordinate()+")"),p=T}else xn.isTrue(I.getLocation(t,pe.LEFT)===Pt.NONE,"found single null side"),I.setLocation(t,pe.RIGHT,p),I.setLocation(t,pe.LEFT,p)}}};Lo.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var e=t.next();return e.getCoordinate()};Lo.prototype.print=function(t){po.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var r=e.next();r.print(t)}};Lo.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Lo.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var r=e.size()-1,s=e.get(r).getLabel(),c=s.getLocation(t,pe.LEFT);xn.isTrue(c!==Pt.NONE,"Found unlabelled area edge");for(var p=c,l=this.iterator();l.hasNext();){var x=l.next(),I=x.getLabel();xn.isTrue(I.isArea(t),"Found non-area edge");var T=I.getLocation(t,pe.LEFT),P=I.getLocation(t,pe.RIGHT);if(T===P||P!==p)return!1;p=T}return!0};Lo.prototype.findIndex=function(t){var e=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var s=e._edgeList.get(r);if(s===t)return r}return-1};Lo.prototype.iterator=function(){return this.getEdges().iterator()};Lo.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new ve(this._edgeMap.values())),this._edgeList};Lo.prototype.getLocation=function(t,e,r){return this._ptInAreaLocation[t]===Pt.NONE&&(this._ptInAreaLocation[t]=ta.locate(e,r[t].getGeometry())),this._ptInAreaLocation[t]};Lo.prototype.toString=function(){var t=new Fl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var e=this.iterator();e.hasNext();){var r=e.next();t.append(r),t.append(`
`)}return t.toString()};Lo.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){var r=e.next();r.computeLabel(t)}};Lo.prototype.computeLabelling=function(t){var e=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],s=this.iterator();s.hasNext();)for(var c=s.next(),p=c.getLabel(),l=0;l<2;l++)p.isLine(l)&&p.getLocation(l)===Pt.BOUNDARY&&(r[l]=!0);for(var x=this.iterator();x.hasNext();)for(var I=x.next(),T=I.getLabel(),P=0;P<2;P++)if(T.isAnyNull(P)){var D=Pt.NONE;if(r[P])D=Pt.EXTERIOR;else{var G=I.getCoordinate();D=e.getLocation(P,G,t)}T.setAllLocationsIfNull(P,D)}};Lo.prototype.getDegree=function(){return this._edgeMap.size()};Lo.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null};Lo.prototype.interfaces_=function(){return[]};Lo.prototype.getClass=function(){return Lo};var CE=function(n){function t(){n.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var s=null,c=null,p=this._SCANNING_FOR_INCOMING,l=0;l<this._resultAreaEdgeList.size();l++){var x=r._resultAreaEdgeList.get(l),I=x.getSym();if(!!x.getLabel().isArea())switch(s===null&&x.isInResult()&&(s=x),p){case r._SCANNING_FOR_INCOMING:if(!I.isInResult())continue;c=I,p=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!x.isInResult())continue;c.setNext(x),p=r._SCANNING_FOR_INCOMING;break}}if(p===this._LINKING_TO_OUTGOING){if(s===null)throw new rc("no outgoing dirEdge found",this.getCoordinate());xn.isTrue(s.isInResult(),"unable to link last incoming dirEdge"),c.setNext(s)}},t.prototype.insert=function(r){var s=r;this.insertEdgeEnd(s,s)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),s=r.size();if(s<1)return null;var c=r.get(0);if(s===1)return c;var p=r.get(s-1),l=c.getQuadrant(),x=p.getQuadrant();return dr.isNorthern(l)&&dr.isNorthern(x)?c:!dr.isNorthern(l)&&!dr.isNorthern(x)?p:c.getDy()!==0?c:p.getDy()!==0?p:(xn.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){po.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var s=this.iterator();s.hasNext();){var c=s.next();r.print("out "),c.print(r),r.println(),r.print("in "),c.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ve;for(var s=this.iterator();s.hasNext();){var c=s.next();(c.isInResult()||c.getSym().isInResult())&&r._resultAreaEdgeList.add(c)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var s=this.iterator();s.hasNext();){var c=s.next(),p=c.getLabel();p.setAllLocationsIfNull(0,r.getLocation(0)),p.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var s=null,c=null,p=this._edgeList.size()-1;p>=0;p--){var l=r._edgeList.get(p),x=l.getSym();c===null&&(c=x),s!==null&&x.setNext(s),s=l}c.setNext(s)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var s=arguments[0],c=this.findIndex(s),p=s.getDepth(pe.LEFT),l=s.getDepth(pe.RIGHT),x=this.computeDepths(c+1,this._edgeList.size(),p),I=this.computeDepths(0,c,x);if(I!==l)throw new rc("depth mismatch at "+s.getCoordinate())}else if(arguments.length===3){for(var T=arguments[0],P=arguments[1],D=arguments[2],G=D,Y=T;Y<P;Y++){var et=r._edgeList.get(Y);et.setEdgeDepths(pe.RIGHT,G),G=et.getDepth(pe.LEFT)}return G}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var s=r.next(),c=s.getLabel();c.merge(s.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var s=this,c=null,p=null,l=this._SCANNING_FOR_INCOMING,x=this._resultAreaEdgeList.size()-1;x>=0;x--){var I=s._resultAreaEdgeList.get(x),T=I.getSym();switch(c===null&&I.getEdgeRing()===r&&(c=I),l){case s._SCANNING_FOR_INCOMING:if(T.getEdgeRing()!==r)continue;p=T,l=s._LINKING_TO_OUTGOING;break;case s._LINKING_TO_OUTGOING:if(I.getEdgeRing()!==r)continue;p.setNextMin(I),l=s._SCANNING_FOR_INCOMING;break}}l===this._LINKING_TO_OUTGOING&&(xn.isTrue(c!==null,"found null for first outgoing dirEdge"),xn.isTrue(c.getEdgeRing()===r,"unable to link last incoming dirEdge"),p.setNextMin(c))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,s=this.iterator();s.hasNext();){var c=s.next();c.isInResult()&&r++}return r}else if(arguments.length===1){for(var p=arguments[0],l=0,x=this.iterator();x.hasNext();){var I=x.next();I.getEdgeRing()===p&&l++}return l}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=Pt.NONE,s=this.iterator();s.hasNext();){var c=s.next(),p=c.getSym();if(!c.isLineEdge()){if(c.isInResult()){r=Pt.INTERIOR;break}if(p.isInResult()){r=Pt.EXTERIOR;break}}}if(r===Pt.NONE)return null;for(var l=r,x=this.iterator();x.hasNext();){var I=x.next(),T=I.getSym();I.isLineEdge()?I.getEdge().setCovered(l===Pt.INTERIOR):(I.isInResult()&&(l=Pt.EXTERIOR),T.isInResult()&&(l=Pt.INTERIOR))}},t.prototype.computeLabelling=function(r){var s=this;n.prototype.computeLabelling.call(this,r),this._label=new sr(Pt.NONE);for(var c=this.iterator();c.hasNext();)for(var p=c.next(),l=p.getEdge(),x=l.getLabel(),I=0;I<2;I++){var T=x.getLocation(I);(T===Pt.INTERIOR||T===Pt.BOUNDARY)&&s._label.setLocation(I,Pt.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Lo),cb=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new Fy(r,new CE)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Pd),Hc=function n(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=n.orientation(t)};Hc.prototype.compareTo=function(t){var e=t,r=Hc.compareOriented(this._pts,this._orientation,e._pts,e._orientation);return r};Hc.prototype.interfaces_=function(){return[Da]};Hc.prototype.getClass=function(){return Hc};Hc.orientation=function(t){return Ln.increasingDirection(t)===1};Hc.compareOriented=function(t,e,r,s){for(var c=e?1:-1,p=s?1:-1,l=e?t.length:-1,x=s?r.length:-1,I=e?0:t.length-1,T=s?0:r.length-1;;){var P=t[I].compareTo(r[T]);if(P!==0)return P;I+=c,T+=p;var D=I===l,G=T===x;if(D&&!G)return-1;if(!D&&G)return 1;if(D&&G)return 0}};var Ka=function(){this._edges=new ve,this._ocaMap=new Ao};Ka.prototype.print=function(t){var e=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var s=e._edges.get(r);r>0&&t.print(","),t.print("(");for(var c=s.getCoordinates(),p=0;p<c.length;p++)p>0&&t.print(","),t.print(c[p].x+" "+c[p].y);t.println(")")}t.print(")  ")};Ka.prototype.addAll=function(t){for(var e=this,r=t.iterator();r.hasNext();)e.add(r.next())};Ka.prototype.findEdgeIndex=function(t){for(var e=this,r=0;r<this._edges.size();r++)if(e._edges.get(r).equals(t))return r;return-1};Ka.prototype.iterator=function(){return this._edges.iterator()};Ka.prototype.getEdges=function(){return this._edges};Ka.prototype.get=function(t){return this._edges.get(t)};Ka.prototype.findEqualEdge=function(t){var e=new Hc(t.getCoordinates()),r=this._ocaMap.get(e);return r};Ka.prototype.add=function(t){this._edges.add(t);var e=new Hc(t.getCoordinates());this._ocaMap.put(e,t)};Ka.prototype.interfaces_=function(){return[]};Ka.prototype.getClass=function(){return Ka};var Wh=function(){};Wh.prototype.processIntersections=function(t,e,r,s){};Wh.prototype.isDone=function(){};Wh.prototype.interfaces_=function(){return[]};Wh.prototype.getClass=function(){return Wh};var ia=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};ia.prototype.isTrivialIntersection=function(t,e,r,s){if(t===r&&this._li.getIntersectionNum()===1){if(ia.isAdjacentSegments(e,s))return!0;if(t.isClosed()){var c=t.size()-1;if(e===0&&s===c||s===0&&e===c)return!0}}return!1};ia.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ia.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ia.prototype.getLineIntersector=function(){return this._li};ia.prototype.hasProperIntersection=function(){return this._hasProper};ia.prototype.processIntersections=function(t,e,r,s){if(t===r&&e===s)return null;this.numTests++;var c=t.getCoordinates()[e],p=t.getCoordinates()[e+1],l=r.getCoordinates()[s],x=r.getCoordinates()[s+1];this._li.computeIntersection(c,p,l,x),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,r,s)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),r.addIntersections(this._li,s,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};ia.prototype.hasIntersection=function(){return this._hasIntersection};ia.prototype.isDone=function(){return!1};ia.prototype.hasInteriorIntersection=function(){return this._hasInterior};ia.prototype.interfaces_=function(){return[Wh]};ia.prototype.getClass=function(){return ia};ia.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var Rl=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],r=arguments[2];this.coord=new Ct(t),this.segmentIndex=e,this.dist=r};Rl.prototype.getSegmentIndex=function(){return this.segmentIndex};Rl.prototype.getCoordinate=function(){return this.coord};Rl.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};Rl.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)};Rl.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};Rl.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Rl.prototype.getDistance=function(){return this.dist};Rl.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0};Rl.prototype.interfaces_=function(){return[Da]};Rl.prototype.getClass=function(){return Rl};var vu=function(){this._nodeMap=new Ao,this.edge=null;var t=arguments[0];this.edge=t};vu.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){var r=e.next();r.print(t)}};vu.prototype.iterator=function(){return this._nodeMap.values().iterator()};vu.prototype.addSplitEdges=function(t){var e=this;this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var c=r.next(),p=e.createSplitEdge(s,c);t.add(p),s=c}};vu.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};vu.prototype.createSplitEdge=function(t,e){var r=this,s=e.segmentIndex-t.segmentIndex+2,c=this.edge.pts[e.segmentIndex],p=e.dist>0||!e.coord.equals2D(c);p||s--;var l=new Array(s).fill(null),x=0;l[x++]=new Ct(t.coord);for(var I=t.segmentIndex+1;I<=e.segmentIndex;I++)l[x++]=r.edge.pts[I];return p&&(l[x]=e.coord),new py(l,new sr(this.edge._label))};vu.prototype.add=function(t,e,r){var s=new Rl(t,e,r),c=this._nodeMap.get(s);return c!==null?c:(this._nodeMap.put(s,s),s)};vu.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){var r=e.next();if(r.coord.equals(t))return!0}return!1};vu.prototype.interfaces_=function(){return[]};vu.prototype.getClass=function(){return vu};var jh=function(){};jh.prototype.getChainStartIndices=function(t){var e=this,r=0,s=new ve;s.add(new Al(r));do{var c=e.findChainEnd(t,r);s.add(new Al(c)),r=c}while(r<t.length-1);var p=jh.toIntArray(s);return p};jh.prototype.findChainEnd=function(t,e){for(var r=dr.quadrant(t[e],t[e+1]),s=e+1;s<t.length;){var c=dr.quadrant(t[s-1],t[s]);if(c!==r)break;s++}return s-1};jh.prototype.interfaces_=function(){return[]};jh.prototype.getClass=function(){return jh};jh.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e};var oc=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Xe,this.env2=new Xe;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new jh;this.startIndex=e.getChainStartIndices(this.pts)};oc.prototype.getCoordinates=function(){return this.pts};oc.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e>r?e:r};oc.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e<r?e:r};oc.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],e=arguments[1],r=arguments[2],s=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[r],e.startIndex[r+1],s)}else if(arguments.length===6){var c=arguments[0],p=arguments[1],l=arguments[2],x=arguments[3],I=arguments[4],T=arguments[5],P=this.pts[c],D=this.pts[p],G=l.pts[x],Y=l.pts[I];if(p-c===1&&I-x===1)return T.addIntersections(this.e,c,l.e,x),null;if(this.env1.init(P,D),this.env2.init(G,Y),!this.env1.intersects(this.env2))return null;var et=Math.trunc((c+p)/2),at=Math.trunc((x+I)/2);c<et&&(x<at&&this.computeIntersectsForChain(c,et,l,x,at,T),at<I&&this.computeIntersectsForChain(c,et,l,at,I,T)),et<p&&(x<at&&this.computeIntersectsForChain(et,p,l,x,at,T),at<I&&this.computeIntersectsForChain(et,p,l,at,I,T))}};oc.prototype.getStartIndexes=function(){return this.startIndex};oc.prototype.computeIntersects=function(t,e){for(var r=this,s=0;s<this.startIndex.length-1;s++)for(var c=0;c<t.startIndex.length-1;c++)r.computeIntersectsForChain(s,t,c,e)};oc.prototype.interfaces_=function(){return[]};oc.prototype.getClass=function(){return oc};var fo=function n(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var r=0;r<3;r++)t._depth[e][r]=n.NULL_VALUE},hb={NULL_VALUE:{configurable:!0}};fo.prototype.getDepth=function(t,e){return this._depth[t][e]};fo.prototype.setDepth=function(t,e,r){this._depth[t][e]=r};fo.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var e=0;e<2;e++)for(var r=0;r<3;r++)if(t._depth[e][r]!==fo.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var s=arguments[0];return this._depth[s][1]===fo.NULL_VALUE}else if(arguments.length===2){var c=arguments[0],p=arguments[1];return this._depth[c][p]===fo.NULL_VALUE}};fo.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var r=t._depth[e][1];t._depth[e][2]<r&&(r=t._depth[e][2]),r<0&&(r=0);for(var s=1;s<3;s++){var c=0;t._depth[e][s]>r&&(c=1),t._depth[e][s]=c}}};fo.prototype.getDelta=function(t){return this._depth[t][pe.RIGHT]-this._depth[t][pe.LEFT]};fo.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Pt.EXTERIOR:Pt.INTERIOR};fo.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};fo.prototype.add=function(){var t=this;if(arguments.length===1)for(var e=arguments[0],r=0;r<2;r++)for(var s=1;s<3;s++){var c=e.getLocation(r,s);(c===Pt.EXTERIOR||c===Pt.INTERIOR)&&(t.isNull(r,s)?t._depth[r][s]=fo.depthAtLocation(c):t._depth[r][s]+=fo.depthAtLocation(c))}else if(arguments.length===3){var p=arguments[0],l=arguments[1],x=arguments[2];x===Pt.INTERIOR&&this._depth[p][l]++}};fo.prototype.interfaces_=function(){return[]};fo.prototype.getClass=function(){return fo};fo.depthAtLocation=function(t){return t===Pt.EXTERIOR?0:t===Pt.INTERIOR?1:fo.NULL_VALUE};hb.NULL_VALUE.get=function(){return-1};Object.defineProperties(fo,hb);var py=function(n){function t(){if(n.call(this),this.pts=null,this._env=null,this.eiList=new vu(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new fo,this._depthDelta=0,arguments.length===1){var e=arguments[0];t.call(this,e,null)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.pts=r,this._label=s}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var s=new t(r,sr.toLineLabel(this._label));return s},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var s=this;if(!(r instanceof t))return!1;var c=r;if(this.pts.length!==c.pts.length)return!1;for(var p=!0,l=!0,x=this.pts.length,I=0;I<this.pts.length;I++)if(s.pts[I].equals2D(c.pts[I])||(p=!1),s.pts[I].equals2D(c.pts[--x])||(l=!1),!p&&!l)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var s=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var c=0;c<this.pts.length;c++)c>0&&r.print(","),r.print(s.pts[c].x+" "+s.pts[c].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var s=this;r.print("edge "+this._name+": ");for(var c=this.pts.length-1;c>=0;c--)r.print(s.pts[c]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new oc(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new Xe;for(var s=0;s<this.pts.length;s++)r._env.expandToInclude(r.pts[s])}return this._env},t.prototype.addIntersection=function(r,s,c,p){var l=new Ct(r.getIntersection(p)),x=s,I=r.getEdgeDistance(c,p),T=x+1;if(T<this.pts.length){var P=this.pts[T];l.equals2D(P)&&(x=T,I=0)}this.eiList.add(l,x,I)},t.prototype.toString=function(){var r=this,s=new Fl;s.append("edge "+this._name+": "),s.append("LINESTRING (");for(var c=0;c<this.pts.length;c++)c>0&&s.append(","),s.append(r.pts[c].x+" "+r.pts[c].y);return s.append(")  "+this._label+" "+this._depthDelta),s.toString()},t.prototype.isPointwiseEqual=function(r){var s=this;if(this.pts.length!==r.pts.length)return!1;for(var c=0;c<this.pts.length;c++)if(!s.pts[c].equals2D(r.pts[c]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,s,c){for(var p=this,l=0;l<r.getIntersectionNum();l++)p.addIntersection(r,s,c,l)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];s.setAtLeastIfValid(r.getLocation(0,pe.ON),r.getLocation(1,pe.ON),1),r.isArea()&&(s.setAtLeastIfValid(r.getLocation(0,pe.LEFT),r.getLocation(1,pe.LEFT),2),s.setAtLeastIfValid(r.getLocation(0,pe.RIGHT),r.getLocation(1,pe.RIGHT),2))}else return n.prototype.updateIM.apply(this,arguments)},t}(na),Ko=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ka,this._bufParams=t||null};Ko.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};Ko.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var r=e.getLabel(),s=t.getLabel();e.isPointwiseEqual(t)||(s=new sr(t.getLabel()),s.flip()),r.merge(s);var c=Ko.depthDelta(s),p=e.getDepthDelta(),l=p+c;e.setDepthDelta(l)}else this._edgeList.add(t),t.setDepthDelta(Ko.depthDelta(t.getLabel()))};Ko.prototype.buildSubgraphs=function(t,e){for(var r=new ve,s=t.iterator();s.hasNext();){var c=s.next(),p=c.getRightmostCoordinate(),l=new Hf(r),x=l.getDepth(p);c.computeDepth(x),c.findResultEdges(),r.add(c),e.add(c.getDirectedEdges(),c.getNodes())}};Ko.prototype.createSubgraphs=function(t){for(var e=new ve,r=t.getNodes().iterator();r.hasNext();){var s=r.next();if(!s.isVisited()){var c=new Qo;c.create(s),e.add(c)}}return Ha.sort(e,Ha.reverseOrder()),e};Ko.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};Ko.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new w0,r=new $h;return r.setPrecisionModel(t),e.setSegmentIntersector(new ia(r)),e};Ko.prototype.buffer=function(t,e){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var s=new ms(r,this._bufParams),c=new Ma(t,e,s),p=c.getCurves();if(p.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(p,r),this._graph=new jr(new cb),this._graph.addEdges(this._edgeList.getEdges());var l=this.createSubgraphs(this._graph),x=new zs(this._geomFact);this.buildSubgraphs(l,x);var I=x.getPolygons();if(I.size()<=0)return this.createEmptyResultGeometry();var T=this._geomFact.buildGeometry(I);return T};Ko.prototype.computeNodedEdges=function(t,e){var r=this,s=this.getNoder(e);s.computeNodes(t);for(var c=s.getNodedSubstrings(),p=c.iterator();p.hasNext();){var l=p.next(),x=l.getCoordinates();if(!(x.length===2&&x[0].equals2D(x[1]))){var I=l.getData(),T=new py(l.getCoordinates(),new sr(I));r.insertUniqueEdge(T)}}};Ko.prototype.setNoder=function(t){this._workingNoder=t};Ko.prototype.interfaces_=function(){return[]};Ko.prototype.getClass=function(){return Ko};Ko.depthDelta=function(t){var e=t.getLocation(0,pe.LEFT),r=t.getLocation(0,pe.RIGHT);return e===Pt.INTERIOR&&r===Pt.EXTERIOR?1:e===Pt.EXTERIOR&&r===Pt.INTERIOR?-1:0};Ko.convertSegStrings=function(t){for(var e=new Pn,r=new ve;t.hasNext();){var s=t.next(),c=e.createLineString(s.getCoordinates());r.add(c)}return e.buildGeometry(r)};var Kc=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],s=arguments[1],c=arguments[2],p=arguments[3];this._noder=r,this._scaleFactor=s,this._offsetX=c,this._offsetY=p,this._isScaled=!this.isIntegerPrecision()}};Kc.prototype.rescale=function(){var t=this;if(nn(arguments[0],Di))for(var e=arguments[0],r=e.iterator();r.hasNext();){var s=r.next();t.rescale(s.getCoordinates())}else if(arguments[0]instanceof Array){for(var c=arguments[0],p=0;p<c.length;p++)c[p].x=c[p].x/t._scaleFactor+t._offsetX,c[p].y=c[p].y/t._scaleFactor+t._offsetY;c.length===2&&c[0].equals2D(c[1])&&po.out.println(c)}};Kc.prototype.scale=function(){var t=this;if(nn(arguments[0],Di)){for(var e=arguments[0],r=new ve,s=e.iterator();s.hasNext();){var c=s.next();r.add(new fi(t.scale(c.getCoordinates()),c.getData()))}return r}else if(arguments[0]instanceof Array){for(var p=arguments[0],l=new Array(p.length).fill(null),x=0;x<p.length;x++)l[x]=new Ct(Math.round((p[x].x-t._offsetX)*t._scaleFactor),Math.round((p[x].y-t._offsetY)*t._scaleFactor),p[x].z);var I=Ln.removeRepeatedPoints(l);return I}};Kc.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Kc.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Kc.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)};Kc.prototype.interfaces_=function(){return[Zh]};Kc.prototype.getClass=function(){return Kc};var zl=function(){this._li=new $h,this._segStrings=null;var t=arguments[0];this._segStrings=t},fb={fact:{configurable:!0}};zl.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var r=e.next(),s=r.getCoordinates();t.checkEndPtVertexIntersections(s[0],t._segStrings),t.checkEndPtVertexIntersections(s[s.length-1],t._segStrings)}else if(arguments.length===2){for(var c=arguments[0],p=arguments[1],l=p.iterator();l.hasNext();)for(var x=l.next(),I=x.getCoordinates(),T=1;T<I.length-1;T++)if(I[T].equals(c))throw new ec("found endpt/interior pt intersection at index "+T+" :pt "+c)}};zl.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var r=e.next(),s=this._segStrings.iterator();s.hasNext();){var c=s.next();t.checkInteriorIntersections(r,c)}else if(arguments.length===2)for(var p=arguments[0],l=arguments[1],x=p.getCoordinates(),I=l.getCoordinates(),T=0;T<x.length-1;T++)for(var P=0;P<I.length-1;P++)t.checkInteriorIntersections(p,T,l,P);else if(arguments.length===4){var D=arguments[0],G=arguments[1],Y=arguments[2],et=arguments[3];if(D===Y&&G===et)return null;var at=D.getCoordinates()[G],rt=D.getCoordinates()[G+1],wt=Y.getCoordinates()[et],xt=Y.getCoordinates()[et+1];if(this._li.computeIntersection(at,rt,wt,xt),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,at,rt)||this.hasInteriorIntersection(this._li,wt,xt)))throw new ec("found non-noded intersection at "+at+"-"+rt+" and "+wt+"-"+xt)}};zl.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};zl.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var r=e.next();t.checkCollapses(r)}else if(arguments.length===1)for(var s=arguments[0],c=s.getCoordinates(),p=0;p<c.length-2;p++)t.checkCollapse(c[p],c[p+1],c[p+2])};zl.prototype.hasInteriorIntersection=function(t,e,r){for(var s=0;s<t.getIntersectionNum();s++){var c=t.getIntersection(s);if(!(c.equals(e)||c.equals(r)))return!0}return!1};zl.prototype.checkCollapse=function(t,e,r){if(t.equals(r))throw new ec("found non-noded collapse at "+zl.fact.createLineString([t,e,r]))};zl.prototype.interfaces_=function(){return[]};zl.prototype.getClass=function(){return zl};fb.fact.get=function(){return new Pn};Object.defineProperties(zl,fb);var _s=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=r,e<=0)throw new Dr("Scale factor must be non-zero");e!==1&&(this._pt=new Ct(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Ct,this._p1Scaled=new Ct),this.initCorners(this._pt)},pb={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};_s.prototype.intersectsScaled=function(t,e){var r=Math.min(t.x,e.x),s=Math.max(t.x,e.x),c=Math.min(t.y,e.y),p=Math.max(t.y,e.y),l=this._maxx<r||this._minx>s||this._maxy<c||this._miny>p;if(l)return!1;var x=this.intersectsToleranceSquare(t,e);return xn.isTrue(!(l&&x),"Found bad envelope test"),x};_s.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new Ct(this._maxx,this._maxy),this._corner[1]=new Ct(this._minx,this._maxy),this._corner[2]=new Ct(this._minx,this._miny),this._corner[3]=new Ct(this._maxx,this._miny)};_s.prototype.intersects=function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};_s.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};_s.prototype.getCoordinate=function(){return this._originalPt};_s.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)};_s.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=_s.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Xe(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};_s.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))};_s.prototype.intersectsToleranceSquare=function(t,e){var r=!1,s=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(s=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper())||r&&s||t.equals(this._pt)||e.equals(this._pt))};_s.prototype.addSnappedNode=function(t,e){var r=t.getCoordinate(e),s=t.getCoordinate(e+1);return this.intersects(r,s)?(t.addIntersection(this.getCoordinate(),e),!0):!1};_s.prototype.interfaces_=function(){return[]};_s.prototype.getClass=function(){return _s};pb.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(_s,pb);var ym=function(){this.tempEnv1=new Xe,this.selectedSegment=new Ze};ym.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}}};ym.prototype.interfaces_=function(){return[]};ym.prototype.getClass=function(){return ym};var Nd=function(){this._index=null;var t=arguments[0];this._index=t},db={HotPixelSnapAction:{configurable:!0}};Nd.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var e=arguments[0],r=arguments[1],s=arguments[2],c=e.getSafeEnvelope(),p=new gb(e,r,s);return this._index.query(c,{interfaces_:function(){return[Wc]},visitItem:function(l){var x=l;x.select(c,p)}}),p.isNodeAdded()}};Nd.prototype.interfaces_=function(){return[]};Nd.prototype.getClass=function(){return Nd};db.HotPixelSnapAction.get=function(){return gb};Object.defineProperties(Nd,db);var gb=function(n){function t(){n.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],r=arguments[1],s=arguments[2];this._hotPixel=e,this._parentEdge=r,this._hotPixelVertexIndex=s}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1],c=r.getContext();if(this._parentEdge!==null&&c===this._parentEdge&&s===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(c,s)}else return n.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ym),Kf=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new ve};Kf.prototype.processIntersections=function(t,e,r,s){var c=this;if(t===r&&e===s)return null;var p=t.getCoordinates()[e],l=t.getCoordinates()[e+1],x=r.getCoordinates()[s],I=r.getCoordinates()[s+1];if(this._li.computeIntersection(p,l,x,I),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var T=0;T<this._li.getIntersectionNum();T++)c._interiorIntersections.add(c._li.getIntersection(T));t.addIntersections(this._li,e,0),r.addIntersections(this._li,s,1)}};Kf.prototype.isDone=function(){return!1};Kf.prototype.getInteriorIntersections=function(){return this._interiorIntersections};Kf.prototype.interfaces_=function(){return[Wh]};Kf.prototype.getClass=function(){return Kf};var xu=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new $h,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};xu.prototype.checkCorrectness=function(t){var e=fi.getNodedSubstrings(t),r=new zl(e);try{r.checkValid()}catch(s){if(s instanceof Qx)s.printStackTrace();else throw s}finally{}};xu.prototype.getNodedSubstrings=function(){return fi.getNodedSubstrings(this._nodedSegStrings)};xu.prototype.snapRound=function(t,e){var r=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};xu.prototype.findInteriorIntersections=function(t,e){var r=new Kf(e);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};xu.prototype.computeVertexSnaps=function(){var t=this;if(nn(arguments[0],Di))for(var e=arguments[0],r=e.iterator();r.hasNext();){var s=r.next();t.computeVertexSnaps(s)}else if(arguments[0]instanceof fi)for(var c=arguments[0],p=c.getCoordinates(),l=0;l<p.length;l++){var x=new _s(p[l],t._scaleFactor,t._li),I=t._pointSnapper.snap(x,c,l);I&&c.addIntersection(p[l],l)}};xu.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new w0,this._pointSnapper=new Nd(this._noder.getIndex()),this.snapRound(t,this._li)};xu.prototype.computeIntersectionSnaps=function(t){for(var e=this,r=t.iterator();r.hasNext();){var s=r.next(),c=new _s(s,e._scaleFactor,e._li);e._pointSnapper.snap(c)}};xu.prototype.interfaces_=function(){return[Zh]};xu.prototype.getClass=function(){return xu};var ho=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Hn,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this._argGeom=e,this._bufParams=r}},Jd={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ho.prototype.bufferFixedPrecision=function(t){var e=new Kc(new xu(new Kn(1)),t.getScale()),r=new Ko(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(e),this._resultGeometry=r.buffer(this._argGeom,this._distance)};ho.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var e=ho.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(p){if(p instanceof rc)t._saveException=p;else throw p}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],s=ho.precisionScaleFactor(this._argGeom,this._distance,r),c=new Kn(s);this.bufferFixedPrecision(c)}};ho.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Kn.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};ho.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};ho.prototype.bufferOriginalPrecision=function(){try{var t=new Ko(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(e instanceof ec)this._saveException=e;else throw e}finally{}};ho.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};ho.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};ho.prototype.interfaces_=function(){return[]};ho.prototype.getClass=function(){return ho};ho.bufferOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],r=new ho(t),s=r.getResultGeometry(e);return s}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Qe&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1],l=arguments[2],x=new ho(c);x.setQuadrantSegments(l);var I=x.getResultGeometry(p);return I}else if(arguments[2]instanceof Hn&&arguments[0]instanceof Qe&&typeof arguments[1]=="number"){var T=arguments[0],P=arguments[1],D=arguments[2],G=new ho(T,D),Y=G.getResultGeometry(P);return Y}}else if(arguments.length===4){var et=arguments[0],at=arguments[1],rt=arguments[2],wt=arguments[3],xt=new ho(et);xt.setQuadrantSegments(rt),xt.setEndCapStyle(wt);var Gt=xt.getResultGeometry(at);return Gt}};ho.precisionScaleFactor=function(t,e,r){var s=t.getEnvelopeInternal(),c=ea.max(Math.abs(s.getMaxX()),Math.abs(s.getMaxY()),Math.abs(s.getMinX()),Math.abs(s.getMinY())),p=e>0?e:0,l=c+2*p,x=Math.trunc(Math.log(l)/Math.log(10)+1),I=r-x,T=Math.pow(10,I);return T};Jd.CAP_ROUND.get=function(){return Hn.CAP_ROUND};Jd.CAP_BUTT.get=function(){return Hn.CAP_FLAT};Jd.CAP_FLAT.get=function(){return Hn.CAP_FLAT};Jd.CAP_SQUARE.get=function(){return Hn.CAP_SQUARE};Jd.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(ho,Jd);var Wo=function(){this._pt=[new Ct,new Ct],this._distance=fn.NaN,this._isNull=!0};Wo.prototype.getCoordinates=function(){return this._pt};Wo.prototype.getCoordinate=function(t){return this._pt[t]};Wo.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var s=e.distance(r);s<this._distance&&this.initialize(e,r,s)}};Wo.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(s),this._distance=c,this._isNull=!1}};Wo.prototype.getDistance=function(){return this._distance};Wo.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var s=e.distance(r);s>this._distance&&this.initialize(e,r,s)}};Wo.prototype.interfaces_=function(){return[]};Wo.prototype.getClass=function(){return Wo};var uu=function(){};uu.prototype.interfaces_=function(){return[]};uu.prototype.getClass=function(){return uu};uu.computeDistance=function(){if(arguments[2]instanceof Wo&&arguments[0]instanceof ni&&arguments[1]instanceof Ct)for(var t=arguments[0],e=arguments[1],r=arguments[2],s=t.getCoordinates(),c=new Ze,p=0;p<s.length-1;p++){c.setCoordinates(s[p],s[p+1]);var l=c.closestPoint(e);r.setMinimum(l,e)}else if(arguments[2]instanceof Wo&&arguments[0]instanceof Oi&&arguments[1]instanceof Ct){var x=arguments[0],I=arguments[1],T=arguments[2];uu.computeDistance(x.getExteriorRing(),I,T);for(var P=0;P<x.getNumInteriorRing();P++)uu.computeDistance(x.getInteriorRingN(P),I,T)}else if(arguments[2]instanceof Wo&&arguments[0]instanceof Qe&&arguments[1]instanceof Ct){var D=arguments[0],G=arguments[1],Y=arguments[2];if(D instanceof ni)uu.computeDistance(D,G,Y);else if(D instanceof Oi)uu.computeDistance(D,G,Y);else if(D instanceof Jo)for(var et=D,at=0;at<et.getNumGeometries();at++){var rt=et.getGeometryN(at);uu.computeDistance(rt,G,Y)}else Y.setMinimum(D.getCoordinate(),G)}else if(arguments[2]instanceof Wo&&arguments[0]instanceof Ze&&arguments[1]instanceof Ct){var wt=arguments[0],xt=arguments[1],Gt=arguments[2],ee=wt.closestPoint(xt);Gt.setMinimum(ee,xt)}};var Hh=function(t){this._maxPtDist=new Wo,this._inputGeom=t||null},I0={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Hh.prototype.computeMaxMidpointDistance=function(t){var e=new Jc(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};Hh.prototype.computeMaxVertexDistance=function(t){var e=new Jf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())};Hh.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};Hh.prototype.getDistancePoints=function(){return this._maxPtDist};Hh.prototype.interfaces_=function(){return[]};Hh.prototype.getClass=function(){return Hh};I0.MaxPointDistanceFilter.get=function(){return Jf};I0.MaxMidpointDistanceFilter.get=function(){return Jc};Object.defineProperties(Hh,I0);var Jf=function(t){this._maxPtDist=new Wo,this._minPtDist=new Wo,this._geom=t||null};Jf.prototype.filter=function(t){this._minPtDist.initialize(),uu.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Jf.prototype.getMaxPointDistance=function(){return this._maxPtDist};Jf.prototype.interfaces_=function(){return[gu]};Jf.prototype.getClass=function(){return Jf};var Jc=function(t){this._maxPtDist=new Wo,this._minPtDist=new Wo,this._geom=t||null};Jc.prototype.filter=function(t,e){if(e===0)return null;var r=t.getCoordinate(e-1),s=t.getCoordinate(e),c=new Ct((r.x+s.x)/2,(r.y+s.y)/2);this._minPtDist.initialize(),uu.computeDistance(this._geom,c,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Jc.prototype.isDone=function(){return!1};Jc.prototype.isGeometryChanged=function(){return!1};Jc.prototype.getMaxPointDistance=function(){return this._maxPtDist};Jc.prototype.interfaces_=function(){return[Wa]};Jc.prototype.getClass=function(){return Jc};var tc=function(t){this._comps=t||null};tc.prototype.filter=function(t){t instanceof Oi&&this._comps.add(t)};tc.prototype.interfaces_=function(){return[Ll]};tc.prototype.getClass=function(){return tc};tc.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return tc.getPolygons(t,new ve)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];return e instanceof Oi?r.add(e):e instanceof Jo&&e.apply(new tc(r)),r}};var co=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this._lines=e,this._isForcedToLineString=r}};co.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof mu){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof ni&&this._lines.add(t)};co.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};co.prototype.interfaces_=function(){return[nc]};co.prototype.getClass=function(){return co};co.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(co.getLines(t))}else if(arguments.length===2){var e=arguments[0],r=arguments[1];return e.getFactory().buildGeometry(co.getLines(e,r))}};co.getLines=function(){if(arguments.length===1){var t=arguments[0];return co.getLines(t,!1)}else if(arguments.length===2){if(nn(arguments[0],Di)&&nn(arguments[1],Di)){for(var e=arguments[0],r=arguments[1],s=e.iterator();s.hasNext();){var c=s.next();co.getLines(c,r)}return r}else if(arguments[0]instanceof Qe&&typeof arguments[1]=="boolean"){var p=arguments[0],l=arguments[1],x=new ve;return p.apply(new co(x,l)),x}else if(arguments[0]instanceof Qe&&nn(arguments[1],Di)){var I=arguments[0],T=arguments[1];return I instanceof ni?T.add(I):I.apply(new co(T)),T}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&nn(arguments[0],Di)&&nn(arguments[1],Di)){for(var P=arguments[0],D=arguments[1],G=arguments[2],Y=P.iterator();Y.hasNext();){var et=Y.next();co.getLines(et,D,G)}return D}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Qe&&nn(arguments[1],Di)){var at=arguments[0],rt=arguments[1],wt=arguments[2];return at.apply(new co(rt,wt)),rt}}};var Ja=function(){if(this._boundaryRule=Pa.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new Dr("Rule must be non-null");this._boundaryRule=t}}};Ja.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof Ct&&arguments[1]instanceof Oi){var e=arguments[0],r=arguments[1];if(r.isEmpty())return Pt.EXTERIOR;var s=r.getExteriorRing(),c=this.locateInPolygonRing(e,s);if(c===Pt.EXTERIOR)return Pt.EXTERIOR;if(c===Pt.BOUNDARY)return Pt.BOUNDARY;for(var p=0;p<r.getNumInteriorRing();p++){var l=r.getInteriorRingN(p),x=t.locateInPolygonRing(e,l);if(x===Pt.INTERIOR)return Pt.EXTERIOR;if(x===Pt.BOUNDARY)return Pt.BOUNDARY}return Pt.INTERIOR}else if(arguments[0]instanceof Ct&&arguments[1]instanceof ni){var I=arguments[0],T=arguments[1];if(!T.getEnvelopeInternal().intersects(I))return Pt.EXTERIOR;var P=T.getCoordinates();return!T.isClosed()&&(I.equals(P[0])||I.equals(P[P.length-1]))?Pt.BOUNDARY:Te.isOnLine(I,P)?Pt.INTERIOR:Pt.EXTERIOR}else if(arguments[0]instanceof Ct&&arguments[1]instanceof Rs){var D=arguments[0],G=arguments[1],Y=G.getCoordinate();return Y.equals2D(D)?Pt.INTERIOR:Pt.EXTERIOR}};Ja.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Te.locatePointInRing(t,e.getCoordinates()):Pt.EXTERIOR};Ja.prototype.intersects=function(t,e){return this.locate(t,e)!==Pt.EXTERIOR};Ja.prototype.updateLocationInfo=function(t){t===Pt.INTERIOR&&(this._isIn=!0),t===Pt.BOUNDARY&&this._numBoundaries++};Ja.prototype.computeLocation=function(t,e){var r=this;if(e instanceof Rs&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof ni)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Oi)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Xh)for(var s=e,c=0;c<s.getNumGeometries();c++){var p=s.getGeometryN(c);r.updateLocationInfo(r.locateInternal(t,p))}else if(e instanceof pu)for(var l=e,x=0;x<l.getNumGeometries();x++){var I=l.getGeometryN(x);r.updateLocationInfo(r.locateInternal(t,I))}else if(e instanceof Jo)for(var T=new du(e);T.hasNext();){var P=T.next();P!==e&&r.computeLocation(t,P)}};Ja.prototype.locate=function(t,e){return e.isEmpty()?Pt.EXTERIOR:e instanceof ni?this.locateInternal(t,e):e instanceof Oi?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Pt.BOUNDARY:this._numBoundaries>0||this._isIn?Pt.INTERIOR:Pt.EXTERIOR)};Ja.prototype.interfaces_=function(){return[]};Ja.prototype.getClass=function(){return Ja};var jo=function n(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],e=arguments[1];n.call(this,t,n.INSIDE_AREA,e)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._component=r,this._segIndex=s,this._pt=c}},mb={INSIDE_AREA:{configurable:!0}};jo.prototype.isInsideArea=function(){return this._segIndex===jo.INSIDE_AREA};jo.prototype.getCoordinate=function(){return this._pt};jo.prototype.getGeometryComponent=function(){return this._component};jo.prototype.getSegmentIndex=function(){return this._segIndex};jo.prototype.interfaces_=function(){return[]};jo.prototype.getClass=function(){return jo};mb.INSIDE_AREA.get=function(){return-1};Object.defineProperties(jo,mb);var Xc=function(t){this._pts=t||null};Xc.prototype.filter=function(t){t instanceof Rs&&this._pts.add(t)};Xc.prototype.interfaces_=function(){return[Ll]};Xc.prototype.getClass=function(){return Xc};Xc.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof Rs?Ha.singletonList(t):Xc.getPoints(t,new ve)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];return e instanceof Rs?r.add(e):e instanceof Jo&&e.apply(new Xc(r)),r}};var Qf=function(){this._locations=null;var t=arguments[0];this._locations=t};Qf.prototype.filter=function(t){(t instanceof Rs||t instanceof ni||t instanceof Oi)&&this._locations.add(new jo(t,0,t.getCoordinate()))};Qf.prototype.interfaces_=function(){return[Ll]};Qf.prototype.getClass=function(){return Qf};Qf.getLocations=function(t){var e=new ve;return t.apply(new Qf(e)),e};var go=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Ja,this._minDistanceLocation=null,this._minDistance=fn.MAX_VALUE,arguments.length===2){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=s,this._terminateDistance=c}};go.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c=1-r,p=tc.getPolygons(this._geom[r]);if(p.size()>0){var l=Qf.getLocations(this._geom[c]);if(this.computeContainmentDistance(l,p,s),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[c]=s[0],this._minDistanceLocation[r]=s[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&nn(arguments[0],Za)&&nn(arguments[1],Za)){for(var x=arguments[0],I=arguments[1],T=arguments[2],P=0;P<x.size();P++)for(var D=x.get(P),G=0;G<I.size();G++)if(t.computeContainmentDistance(D,I.get(G),T),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof jo&&arguments[1]instanceof Oi){var Y=arguments[0],et=arguments[1],at=arguments[2],rt=Y.getCoordinate();if(Pt.EXTERIOR!==this._ptLocator.locate(rt,et))return this._minDistance=0,at[0]=Y,at[1]=new jo(et,rt),null}}};go.prototype.computeMinDistanceLinesPoints=function(t,e,r){for(var s=this,c=0;c<t.size();c++)for(var p=t.get(c),l=0;l<e.size();l++){var x=e.get(l);if(s.computeMinDistance(p,x,r),s._minDistance<=s._terminateDistance)return null}};go.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=co.getLines(this._geom[0]),r=co.getLines(this._geom[1]),s=Xc.getPoints(this._geom[0]),c=Xc.getPoints(this._geom[1]);if(this.computeMinDistanceLines(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,c,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,s,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(s,c,t),this.updateMinDistance(t,!1)};go.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};go.prototype.updateMinDistance=function(t,e){if(t[0]===null)return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};go.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};go.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof ni&&arguments[1]instanceof Rs){var e=arguments[0],r=arguments[1],s=arguments[2];if(e.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var c=e.getCoordinates(),p=r.getCoordinate(),l=0;l<c.length-1;l++){var x=Te.distancePointLine(p,c[l],c[l+1]);if(x<t._minDistance){t._minDistance=x;var I=new Ze(c[l],c[l+1]),T=I.closestPoint(p);s[0]=new jo(e,l,T),s[1]=new jo(r,0,p)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof ni&&arguments[1]instanceof ni){var P=arguments[0],D=arguments[1],G=arguments[2];if(P.getEnvelopeInternal().distance(D.getEnvelopeInternal())>this._minDistance)return null;for(var Y=P.getCoordinates(),et=D.getCoordinates(),at=0;at<Y.length-1;at++)for(var rt=0;rt<et.length-1;rt++){var wt=Te.distanceLineLine(Y[at],Y[at+1],et[rt],et[rt+1]);if(wt<t._minDistance){t._minDistance=wt;var xt=new Ze(Y[at],Y[at+1]),Gt=new Ze(et[rt],et[rt+1]),ee=xt.closestPoints(Gt);G[0]=new jo(P,at,ee[0]),G[1]=new jo(D,rt,ee[1])}if(t._minDistance<=t._terminateDistance)return null}}}};go.prototype.computeMinDistancePoints=function(t,e,r){for(var s=this,c=0;c<t.size();c++)for(var p=t.get(c),l=0;l<e.size();l++){var x=e.get(l),I=p.getCoordinate().distance(x.getCoordinate());if(I<s._minDistance&&(s._minDistance=I,r[0]=new jo(p,0,p.getCoordinate()),r[1]=new jo(x,0,x.getCoordinate())),s._minDistance<=s._terminateDistance)return null}};go.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Dr("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};go.prototype.computeMinDistanceLines=function(t,e,r){for(var s=this,c=0;c<t.size();c++)for(var p=t.get(c),l=0;l<e.size();l++){var x=e.get(l);if(s.computeMinDistance(p,x,r),s._minDistance<=s._terminateDistance)return null}};go.prototype.interfaces_=function(){return[]};go.prototype.getClass=function(){return go};go.distance=function(t,e){var r=new go(t,e);return r.distance()};go.isWithinDistance=function(t,e,r){var s=new go(t,e,r);return s.distance()<=r};go.nearestPoints=function(t,e){var r=new go(t,e);return r.nearestPoints()};var Co=function(){this._pt=[new Ct,new Ct],this._distance=fn.NaN,this._isNull=!0};Co.prototype.getCoordinates=function(){return this._pt};Co.prototype.getCoordinate=function(t){return this._pt[t]};Co.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var s=e.distance(r);s<this._distance&&this.initialize(e,r,s)}};Co.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(s),this._distance=c,this._isNull=!1}};Co.prototype.toString=function(){return Ya.toLineString(this._pt[0],this._pt[1])};Co.prototype.getDistance=function(){return this._distance};Co.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var s=e.distance(r);s>this._distance&&this.initialize(e,r,s)}};Co.prototype.interfaces_=function(){return[]};Co.prototype.getClass=function(){return Co};var Sl=function(){};Sl.prototype.interfaces_=function(){return[]};Sl.prototype.getClass=function(){return Sl};Sl.computeDistance=function(){if(arguments[2]instanceof Co&&arguments[0]instanceof ni&&arguments[1]instanceof Ct)for(var t=arguments[0],e=arguments[1],r=arguments[2],s=new Ze,c=t.getCoordinates(),p=0;p<c.length-1;p++){s.setCoordinates(c[p],c[p+1]);var l=s.closestPoint(e);r.setMinimum(l,e)}else if(arguments[2]instanceof Co&&arguments[0]instanceof Oi&&arguments[1]instanceof Ct){var x=arguments[0],I=arguments[1],T=arguments[2];Sl.computeDistance(x.getExteriorRing(),I,T);for(var P=0;P<x.getNumInteriorRing();P++)Sl.computeDistance(x.getInteriorRingN(P),I,T)}else if(arguments[2]instanceof Co&&arguments[0]instanceof Qe&&arguments[1]instanceof Ct){var D=arguments[0],G=arguments[1],Y=arguments[2];if(D instanceof ni)Sl.computeDistance(D,G,Y);else if(D instanceof Oi)Sl.computeDistance(D,G,Y);else if(D instanceof Jo)for(var et=D,at=0;at<et.getNumGeometries();at++){var rt=et.getGeometryN(at);Sl.computeDistance(rt,G,Y)}else Y.setMinimum(D.getCoordinate(),G)}else if(arguments[2]instanceof Co&&arguments[0]instanceof Ze&&arguments[1]instanceof Ct){var wt=arguments[0],xt=arguments[1],Gt=arguments[2],ee=wt.closestPoint(xt);Gt.setMinimum(ee,xt)}};var Aa=function(){this._g0=null,this._g1=null,this._ptDist=new Co,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},E0={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Aa.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Aa.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Dr("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};Aa.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)};Aa.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Aa.prototype.computeOrientedDistance=function(t,e,r){var s=new $f(e);if(t.apply(s),r.setMaximum(s.getMaxPointDistance()),this._densifyFrac>0){var c=new Qc(e,this._densifyFrac);t.apply(c),r.setMaximum(c.getMaxPointDistance())}};Aa.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};Aa.distance=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],r=new Aa(t,e);return r.distance()}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2],l=new Aa(s,c);return l.setDensifyFraction(p),l.distance()}};E0.MaxPointDistanceFilter.get=function(){return $f};E0.MaxDensifiedByFractionDistanceFilter.get=function(){return Qc};Object.defineProperties(Aa,E0);var $f=function(){this._maxPtDist=new Co,this._minPtDist=new Co,this._euclideanDist=new Sl,this._geom=null;var t=arguments[0];this._geom=t};$f.prototype.filter=function(t){this._minPtDist.initialize(),Sl.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};$f.prototype.getMaxPointDistance=function(){return this._maxPtDist};$f.prototype.interfaces_=function(){return[gu]};$f.prototype.getClass=function(){return $f};var Qc=function(){this._maxPtDist=new Co,this._minPtDist=new Co,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Qc.prototype.filter=function(t,e){var r=this;if(e===0)return null;for(var s=t.getCoordinate(e-1),c=t.getCoordinate(e),p=(c.x-s.x)/this._numSubSegs,l=(c.y-s.y)/this._numSubSegs,x=0;x<this._numSubSegs;x++){var I=s.x+x*p,T=s.y+x*l,P=new Ct(I,T);r._minPtDist.initialize(),Sl.computeDistance(r._geom,P,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Qc.prototype.isDone=function(){return!1};Qc.prototype.isGeometryChanged=function(){return!1};Qc.prototype.getMaxPointDistance=function(){return this._maxPtDist};Qc.prototype.interfaces_=function(){return[Wa]};Qc.prototype.getClass=function(){return Qc};var Ns=function(t,e,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=r||null},S0={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Ns.prototype.checkMaximumDistance=function(t,e,r){var s=new Aa(e,t);if(s.setDensifyFraction(.25),this._maxDistanceFound=s.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var c=s.getCoordinates();this._errorLocation=c[1],this._errorIndicator=t.getFactory().createLineString(c),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ya.toLineString(c[0],c[1])+")"}};Ns.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Ns.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Ns.VERBOSE&&po.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};Ns.prototype.checkNegativeValid=function(){if(!(this._input instanceof Oi||this._input instanceof pu||this._input instanceof Jo))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};Ns.prototype.getErrorIndicator=function(){return this._errorIndicator};Ns.prototype.checkMinimumDistance=function(t,e,r){var s=new go(t,e,r);if(this._minDistanceFound=s.distance(),this._minDistanceFound<r){this._isValid=!1;var c=s.nearestPoints();this._errorLocation=s.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(c),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ya.toLineString(c[0],c[1])+" )"}};Ns.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};Ns.prototype.getErrorLocation=function(){return this._errorLocation};Ns.prototype.getPolygonLines=function(t){for(var e=new ve,r=new co(e),s=tc.getPolygons(t),c=s.iterator();c.hasNext();){var p=c.next();p.apply(r)}return t.getFactory().buildGeometry(e)};Ns.prototype.getErrorMessage=function(){return this._errMsg};Ns.prototype.interfaces_=function(){return[]};Ns.prototype.getClass=function(){return Ns};S0.VERBOSE.get=function(){return!1};S0.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Ns,S0);var mo=function(t,e,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=r||null},C0={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};mo.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};mo.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*mo.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var e=new Xe(this._input.getEnvelopeInternal());e.expandBy(this._distance);var r=new Xe(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};mo.prototype.checkDistance=function(){var t=new Ns(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};mo.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};mo.prototype.checkPolygonal=function(){this._result instanceof Oi||this._result instanceof pu||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};mo.prototype.getErrorIndicator=function(){return this._errorIndicator};mo.prototype.getErrorLocation=function(){return this._errorLocation};mo.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};mo.prototype.report=function(t){if(!mo.VERBOSE)return null;po.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};mo.prototype.getErrorMessage=function(){return this._errorMsg};mo.prototype.interfaces_=function(){return[]};mo.prototype.getClass=function(){return mo};mo.isValidMsg=function(t,e,r){var s=new mo(t,e,r);return s.isValid()?null:s.getErrorMessage()};mo.isValid=function(t,e,r){var s=new mo(t,e,r);return!!s.isValid()};C0.VERBOSE.get=function(){return!1};C0.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(mo,C0);var Ol=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Ol.prototype.getCoordinates=function(){return this._pts};Ol.prototype.size=function(){return this._pts.length};Ol.prototype.getCoordinate=function(t){return this._pts[t]};Ol.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Ol.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:jf.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Ol.prototype.setData=function(t){this._data=t};Ol.prototype.getData=function(){return this._data};Ol.prototype.toString=function(){return Ya.toLineString(new ui(this._pts))};Ol.prototype.interfaces_=function(){return[yu]};Ol.prototype.getClass=function(){return Ol};var Qi=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new ve,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Qi.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Qi.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};Qi.prototype.getIntersectionSegments=function(){return this._intSegments};Qi.prototype.count=function(){return this._intersectionCount};Qi.prototype.getIntersections=function(){return this._intersections};Qi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Qi.prototype.setKeepIntersections=function(t){this._keepIntersections=t};Qi.prototype.processIntersections=function(t,e,r,s){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&e===s)return null;if(this._isCheckEndSegmentsOnly){var c=this.isEndSegment(t,e)||this.isEndSegment(r,s);if(!c)return null}var p=t.getCoordinates()[e],l=t.getCoordinates()[e+1],x=r.getCoordinates()[s],I=r.getCoordinates()[s+1];this._li.computeIntersection(p,l,x,I),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=p,this._intSegments[1]=l,this._intSegments[2]=x,this._intSegments[3]=I,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Qi.prototype.isEndSegment=function(t,e){return e===0||e>=t.size()-2};Qi.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Qi.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Qi.prototype.interfaces_=function(){return[Wh]};Qi.prototype.getClass=function(){return Qi};Qi.createAllIntersectionsFinder=function(t){var e=new Qi(t);return e.setFindAllIntersections(!0),e};Qi.createAnyIntersectionFinder=function(t){return new Qi(t)};Qi.createIntersectionCounter=function(t){var e=new Qi(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Qa=function(){this._li=new $h,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Qa.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};Qa.prototype.getIntersections=function(){return this._segInt.getIntersections()};Qa.prototype.isValid=function(){return this.execute(),this._isValid};Qa.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Qa.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Qi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new w0;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};Qa.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new rc(this.getErrorMessage(),this._segInt.getInteriorIntersection())};Qa.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ya.toLineString(t[0],t[1])+" and "+Ya.toLineString(t[2],t[3])};Qa.prototype.interfaces_=function(){return[]};Qa.prototype.getClass=function(){return Qa};Qa.computeIntersections=function(t){var e=new Qa(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Kh=function n(){this._nv=null;var t=arguments[0];this._nv=new Qa(n.toSegmentStrings(t))};Kh.prototype.checkValid=function(){this._nv.checkValid()};Kh.prototype.interfaces_=function(){return[]};Kh.prototype.getClass=function(){return Kh};Kh.toSegmentStrings=function(t){for(var e=new ve,r=t.iterator();r.hasNext();){var s=r.next();e.add(new Ol(s.getCoordinates(),s))}return e};Kh.checkValid=function(t){var e=new Kh(t);e.checkValid()};var tp=function(t){this._mapOp=t};tp.prototype.map=function(t){for(var e=this,r=new ve,s=0;s<t.getNumGeometries();s++){var c=e._mapOp.map(t.getGeometryN(s));c.isEmpty()||r.add(c)}return t.getFactory().createGeometryCollection(Pn.toGeometryArray(r))};tp.prototype.interfaces_=function(){return[]};tp.prototype.getClass=function(){return tp};tp.map=function(t,e){var r=new tp(e);return r.map(t)};var kl=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new ve,this._resultLineList=new ve;var t=arguments[0],e=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=r};kl.prototype.collectLines=function(t){for(var e=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var s=r.next();e.collectLineEdge(s,t,e._lineEdgesList),e.collectBoundaryTouchEdge(s,t,e._lineEdgesList)}};kl.prototype.labelIsolatedLine=function(t,e){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,r)};kl.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};kl.prototype.collectLineEdge=function(t,e,r){var s=t.getLabel(),c=t.getEdge();t.isLineEdge()&&!t.isVisited()&&vn.isResultOfOp(s,e)&&!c.isCovered()&&(r.add(c),t.setVisitedEdge(!0))};kl.prototype.findCoveredLineEdges=function(){for(var t=this,e=this._op.getGraph().getNodes().iterator();e.hasNext();){var r=e.next();r.getEdges().findCoveredLineEdges()}for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var c=s.next(),p=c.getEdge();if(c.isLineEdge()&&!p.isCoveredSet()){var l=t._op.isCoveredByA(c.getCoordinate());p.setCovered(l)}}};kl.prototype.labelIsolatedLines=function(t){for(var e=this,r=t.iterator();r.hasNext();){var s=r.next(),c=s.getLabel();s.isIsolated()&&(c.isNull(0)?e.labelIsolatedLine(s,0):e.labelIsolatedLine(s,1))}};kl.prototype.buildLines=function(t){for(var e=this,r=this._lineEdgesList.iterator();r.hasNext();){var s=r.next(),c=e._geometryFactory.createLineString(s.getCoordinates());e._resultLineList.add(c),s.setInResult(!0)}};kl.prototype.collectBoundaryTouchEdge=function(t,e,r){var s=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;xn.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),vn.isResultOfOp(s,e)&&e===vn.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};kl.prototype.interfaces_=function(){return[]};kl.prototype.getClass=function(){return kl};var ep=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new ve;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};ep.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var r=this._geometryFactory.createPoint(e);this._resultPointList.add(r)}};ep.prototype.extractNonCoveredResultNodes=function(t){for(var e=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var s=r.next();if(!s.isInResult()&&!s.isIncidentEdgeInResult()&&(s.getEdges().getDegree()===0||t===vn.INTERSECTION)){var c=s.getLabel();vn.isResultOfOp(c,t)&&e.filterCoveredNodeToPoint(s)}}};ep.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};ep.prototype.interfaces_=function(){return[]};ep.prototype.getClass=function(){return ep};var ys=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};ys.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};ys.prototype.transformPolygon=function(t,e){var r=this,s=!0,c=this.transformLinearRing(t.getExteriorRing(),t);(c===null||!(c instanceof mu)||c.isEmpty())&&(s=!1);for(var p=new ve,l=0;l<t.getNumInteriorRing();l++){var x=r.transformLinearRing(t.getInteriorRingN(l),t);x===null||x.isEmpty()||(x instanceof mu||(s=!1),p.add(x))}if(s)return this._factory.createPolygon(c,p.toArray([]));var I=new ve;return c!==null&&I.add(c),I.addAll(p),this._factory.buildGeometry(I)};ys.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};ys.prototype.getInputGeometry=function(){return this._inputGeom};ys.prototype.transformMultiLineString=function(t,e){for(var r=this,s=new ve,c=0;c<t.getNumGeometries();c++){var p=r.transformLineString(t.getGeometryN(c),t);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};ys.prototype.transformCoordinates=function(t,e){return this.copy(t)};ys.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};ys.prototype.transformMultiPoint=function(t,e){for(var r=this,s=new ve,c=0;c<t.getNumGeometries();c++){var p=r.transformPoint(t.getGeometryN(c),t);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};ys.prototype.transformMultiPolygon=function(t,e){for(var r=this,s=new ve,c=0;c<t.getNumGeometries();c++){var p=r.transformPolygon(t.getGeometryN(c),t);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};ys.prototype.copy=function(t){return t.copy()};ys.prototype.transformGeometryCollection=function(t,e){for(var r=this,s=new ve,c=0;c<t.getNumGeometries();c++){var p=r.transform(t.getGeometryN(c));p!==null&&(r._pruneEmptyGeometry&&p.isEmpty()||s.add(p))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Pn.toGeometryArray(s)):this._factory.buildGeometry(s)};ys.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Rs)return this.transformPoint(t,null);if(t instanceof Ad)return this.transformMultiPoint(t,null);if(t instanceof mu)return this.transformLinearRing(t,null);if(t instanceof ni)return this.transformLineString(t,null);if(t instanceof Xh)return this.transformMultiLineString(t,null);if(t instanceof Oi)return this.transformPolygon(t,null);if(t instanceof pu)return this.transformMultiPolygon(t,null);if(t instanceof Jo)return this.transformGeometryCollection(t,null);throw new Dr("Unknown Geometry subtype: "+t.getClass().getName())};ys.prototype.transformLinearRing=function(t,e){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var s=r.size();return s>0&&s<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};ys.prototype.interfaces_=function(){return[]};ys.prototype.getClass=function(){return ys};var bu=function n(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Ze,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof ni&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];n.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1];this._srcPts=r,this._isClosed=n.isClosed(r),this._snapTolerance=s}};bu.prototype.snapVertices=function(t,e){for(var r=this,s=this._isClosed?t.size()-1:t.size(),c=0;c<s;c++){var p=t.get(c),l=r.findSnapForVertex(p,e);l!==null&&(t.set(c,new Ct(l)),c===0&&r._isClosed&&t.set(t.size()-1,new Ct(l)))}};bu.prototype.findSnapForVertex=function(t,e){for(var r=this,s=0;s<e.length;s++){if(t.equals2D(e[s]))return null;if(t.distance(e[s])<r._snapTolerance)return e[s]}return null};bu.prototype.snapTo=function(t){var e=new Cm(this._srcPts);this.snapVertices(e,t),this.snapSegments(e,t);var r=e.toCoordinateArray();return r};bu.prototype.snapSegments=function(t,e){var r=this;if(e.length===0)return null;var s=e.length;e[0].equals2D(e[e.length-1])&&(s=e.length-1);for(var c=0;c<s;c++){var p=e[c],l=r.findSegmentIndexToSnap(p,t);l>=0&&t.add(l+1,new Ct(p),!1)}};bu.prototype.findSegmentIndexToSnap=function(t,e){for(var r=this,s=fn.MAX_VALUE,c=-1,p=0;p<e.size()-1;p++){if(r._seg.p0=e.get(p),r._seg.p1=e.get(p+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var l=r._seg.distance(t);l<r._snapTolerance&&l<s&&(s=l,c=p)}return c};bu.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};bu.prototype.interfaces_=function(){return[]};bu.prototype.getClass=function(){return bu};bu.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var ci=function(t){this._srcGeom=t||null},_b={SNAP_PRECISION_FACTOR:{configurable:!0}};ci.prototype.snapTo=function(t,e){var r=this.extractTargetCoordinates(t),s=new yb(e,r);return s.transform(this._srcGeom)};ci.prototype.snapToSelf=function(t,e){var r=this.extractTargetCoordinates(this._srcGeom),s=new yb(t,r,!0),c=s.transform(this._srcGeom),p=c;return e&&nn(p,Yc)&&(p=c.buffer(0)),p};ci.prototype.computeSnapTolerance=function(t){var e=this.computeMinimumSegmentLength(t),r=e/10;return r};ci.prototype.extractTargetCoordinates=function(t){for(var e=new Pl,r=t.getCoordinates(),s=0;s<r.length;s++)e.add(r[s]);return e.toArray(new Array(0).fill(null))};ci.prototype.computeMinimumSegmentLength=function(t){for(var e=fn.MAX_VALUE,r=0;r<t.length-1;r++){var s=t[r].distance(t[r+1]);s<e&&(e=s)}return e};ci.prototype.interfaces_=function(){return[]};ci.prototype.getClass=function(){return ci};ci.snap=function(t,e,r){var s=new Array(2).fill(null),c=new ci(t);s[0]=c.snapTo(e,r);var p=new ci(e);return s[1]=p.snapTo(s[0],r),s};ci.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],e=ci.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===Kn.FIXED){var s=1/r.getScale()*2/1.415;s>e&&(e=s)}return e}else if(arguments.length===2){var c=arguments[0],p=arguments[1];return Math.min(ci.computeOverlaySnapTolerance(c),ci.computeOverlaySnapTolerance(p))}};ci.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal(),r=Math.min(e.getHeight(),e.getWidth()),s=r*ci.SNAP_PRECISION_FACTOR;return s};ci.snapToSelf=function(t,e,r){var s=new ci(t);return s.snapToSelf(e,r)};_b.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(ci,_b);var yb=function(n){function t(e,r,s){n.call(this),this._snapTolerance=e||null,this._snapPts=r||null,this._isSelfSnap=s!==void 0?s:!1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,s){var c=new bu(r,this._snapTolerance);return c.setAllowSnappingToSourceVertices(this._isSelfSnap),c.snapTo(s)},t.prototype.transformCoordinates=function(r,s){var c=r.toCoordinateArray(),p=this.snapLine(c,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(p)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ys),Yo=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Yo.prototype.getCommon=function(){return fn.longBitsToDouble(this._commonBits)};Yo.prototype.add=function(t){var e=fn.doubleToLongBits(t);if(this._isFirst)return this._commonBits=e,this._commonSignExp=Yo.signExpBits(this._commonBits),this._isFirst=!1,null;var r=Yo.signExpBits(e);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Yo.numCommonMostSigMantissaBits(this._commonBits,e),this._commonBits=Yo.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};Yo.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],e=fn.longBitsToDouble(t),r=fn.toBinaryString(t),s="0000000000000000000000000000000000000000000000000000000000000000"+r,c=s.substring(s.length-64),p=c.substring(0,1)+"  "+c.substring(1,12)+"(exp) "+c.substring(12)+" [ "+e+" ]";return p}};Yo.prototype.interfaces_=function(){return[]};Yo.prototype.getClass=function(){return Yo};Yo.getBit=function(t,e){var r=1<<e;return(t&r)!==0?1:0};Yo.signExpBits=function(t){return t>>52};Yo.zeroLowerBits=function(t,e){var r=(1<<e)-1,s=~r,c=t&s;return c};Yo.numCommonMostSigMantissaBits=function(t,e){for(var r=0,s=52;s>=0;s--){if(Yo.getBit(t,s)!==Yo.getBit(e,s))return r;r++}return 52};var $c=function(){this._commonCoord=null,this._ccFilter=new np},T0={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};$c.prototype.addCommonBits=function(t){var e=new th(this._commonCoord);t.apply(e),t.geometryChanged()};$c.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var e=new Ct(this._commonCoord);e.x=-e.x,e.y=-e.y;var r=new th(e);return t.apply(r),t.geometryChanged(),t};$c.prototype.getCommonCoordinate=function(){return this._commonCoord};$c.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};$c.prototype.interfaces_=function(){return[]};$c.prototype.getClass=function(){return $c};T0.CommonCoordinateFilter.get=function(){return np};T0.Translater.get=function(){return th};Object.defineProperties($c,T0);var np=function(){this._commonBitsX=new Yo,this._commonBitsY=new Yo};np.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};np.prototype.getCommonCoordinate=function(){return new Ct(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};np.prototype.interfaces_=function(){return[gu]};np.prototype.getClass=function(){return np};var th=function(){this.trans=null;var t=arguments[0];this.trans=t};th.prototype.filter=function(t,e){var r=t.getOrdinate(e,0)+this.trans.x,s=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,r),t.setOrdinate(e,1,s)};th.prototype.isDone=function(){return!1};th.prototype.isGeometryChanged=function(){return!0};th.prototype.interfaces_=function(){return[Wa]};th.prototype.getClass=function(){return th};var $i=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};$i.prototype.selfSnap=function(t){var e=new ci(t),r=e.snapTo(t,this._snapTolerance);return r};$i.prototype.removeCommonBits=function(t){this._cbr=new $c,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e};$i.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};$i.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),r=vn.overlayOp(e[0],e[1],t);return this.prepareResult(r)};$i.prototype.checkValid=function(t){t.isValid()||po.out.println("Snapped geometry is invalid")};$i.prototype.computeSnapTolerance=function(){this._snapTolerance=ci.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};$i.prototype.snap=function(t){var e=this.removeCommonBits(t),r=ci.snap(e[0],e[1],this._snapTolerance);return r};$i.prototype.interfaces_=function(){return[]};$i.prototype.getClass=function(){return $i};$i.overlayOp=function(t,e,r){var s=new $i(t,e);return s.getResultGeometry(r)};$i.union=function(t,e){return $i.overlayOp(t,e,vn.UNION)};$i.intersection=function(t,e){return $i.overlayOp(t,e,vn.INTERSECTION)};$i.symDifference=function(t,e){return $i.overlayOp(t,e,vn.SYMDIFFERENCE)};$i.difference=function(t,e){return $i.overlayOp(t,e,vn.DIFFERENCE)};var ts=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};ts.prototype.getResultGeometry=function(t){var e=null,r=!1,s=null;try{e=vn.overlayOp(this._geom[0],this._geom[1],t);var c=!0;c&&(r=!0)}catch(p){if(p instanceof ec)s=p;else throw p}finally{}if(!r)try{e=$i.overlayOp(this._geom[0],this._geom[1],t)}catch(p){throw p instanceof ec?s:p}finally{}return e};ts.prototype.interfaces_=function(){return[]};ts.prototype.getClass=function(){return ts};ts.overlayOp=function(t,e,r){var s=new ts(t,e);return s.getResultGeometry(r)};ts.union=function(t,e){return ts.overlayOp(t,e,vn.UNION)};ts.intersection=function(t,e){return ts.overlayOp(t,e,vn.INTERSECTION)};ts.symDifference=function(t,e){return ts.overlayOp(t,e,vn.SYMDIFFERENCE)};ts.difference=function(t,e){return ts.overlayOp(t,e,vn.DIFFERENCE)};var vm=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};vm.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)};vm.prototype.interfaces_=function(){return[]};vm.prototype.getClass=function(){return vm};var ks=function n(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],e=arguments[1];this._eventType=n.DELETE,this._xValue=t,this._insertEvent=e}else if(arguments.length===3){var r=arguments[0],s=arguments[1],c=arguments[2];this._eventType=n.INSERT,this._label=r,this._xValue=s,this._obj=c}},A0={INSERT:{configurable:!0},DELETE:{configurable:!0}};ks.prototype.isDelete=function(){return this._eventType===ks.DELETE};ks.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};ks.prototype.getObject=function(){return this._obj};ks.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0};ks.prototype.getInsertEvent=function(){return this._insertEvent};ks.prototype.isInsert=function(){return this._eventType===ks.INSERT};ks.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};ks.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};ks.prototype.interfaces_=function(){return[Da]};ks.prototype.getClass=function(){return ks};A0.INSERT.get=function(){return 1};A0.DELETE.get=function(){return 2};Object.defineProperties(ks,A0);var dy=function(){};dy.prototype.interfaces_=function(){return[]};dy.prototype.getClass=function(){return dy};var _o=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],r=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=r};_o.prototype.isTrivialIntersection=function(t,e,r,s){if(t===r&&this._li.getIntersectionNum()===1){if(_o.isAdjacentSegments(e,s))return!0;if(t.isClosed()){var c=t.getNumPoints()-1;if(e===0&&s===c||s===0&&e===c)return!0}}return!1};_o.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};_o.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};_o.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};_o.prototype.isBoundaryPointInternal=function(t,e){for(var r=e.iterator();r.hasNext();){var s=r.next(),c=s.getCoordinate();if(t.isIntersection(c))return!0}return!1};_o.prototype.hasProperIntersection=function(){return this._hasProper};_o.prototype.hasIntersection=function(){return this._hasIntersection};_o.prototype.isDone=function(){return this._isDone};_o.prototype.isBoundaryPoint=function(t,e){return e===null?!1:!!(this.isBoundaryPointInternal(t,e[0])||this.isBoundaryPointInternal(t,e[1]))};_o.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e};_o.prototype.addIntersections=function(t,e,r,s){if(t===r&&e===s)return null;this.numTests++;var c=t.getCoordinates()[e],p=t.getCoordinates()[e+1],l=r.getCoordinates()[s],x=r.getCoordinates()[s+1];this._li.computeIntersection(c,p,l,x),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,r,s)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,e,0),r.addIntersections(this._li,s,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};_o.prototype.interfaces_=function(){return[]};_o.prototype.getClass=function(){return _o};_o.isAdjacentSegments=function(t,e){return Math.abs(t-e)===1};var TE=function(n){function t(){n.call(this),this.events=new ve,this.nOverlaps=null}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;Ha.sort(this.events);for(var s=0;s<this.events.size();s++){var c=r.events.get(s);c.isDelete()&&c.getInsertEvent().setDeleteEventIndex(s)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var s=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var c=0;c<this.events.size();c++){var p=r.events.get(c);if(p.isInsert()&&r.processOverlaps(c,p.getDeleteEventIndex(),p,s),s.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof _o&&nn(arguments[0],Za)&&nn(arguments[1],Za)){var l=arguments[0],x=arguments[1],I=arguments[2];this.addEdges(l,l),this.addEdges(x,x),this.computeIntersections(I)}else if(typeof arguments[2]=="boolean"&&nn(arguments[0],Za)&&arguments[1]instanceof _o){var T=arguments[0],P=arguments[1],D=arguments[2];D?this.addEdges(T,null):this.addEdges(T),this.computeIntersections(P)}}},t.prototype.addEdge=function(r,s){for(var c=this,p=r.getMonotoneChainEdge(),l=p.getStartIndexes(),x=0;x<l.length-1;x++){var I=new vm(p,x),T=new ks(s,p.getMinX(x),I);c.events.add(T),c.events.add(new ks(p.getMaxX(x),T))}},t.prototype.processOverlaps=function(r,s,c,p){for(var l=this,x=c.getObject(),I=r;I<s;I++){var T=l.events.get(I);if(T.isInsert()){var P=T.getObject();c.isSameLabel(T)||(x.computeIntersections(P,p),l.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var s=arguments[0],c=s.iterator();c.hasNext();){var p=c.next();r.addEdge(p,p)}else if(arguments.length===2)for(var l=arguments[0],x=arguments[1],I=l.iterator();I.hasNext();){var T=I.next();r.addEdge(T,x)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(dy),wu=function(){this._min=fn.POSITIVE_INFINITY,this._max=fn.NEGATIVE_INFINITY},vb={NodeComparator:{configurable:!0}};wu.prototype.getMin=function(){return this._min};wu.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)};wu.prototype.getMax=function(){return this._max};wu.prototype.toString=function(){return Ya.toLineString(new Ct(this._min,0),new Ct(this._max,0))};wu.prototype.interfaces_=function(){return[]};wu.prototype.getClass=function(){return wu};vb.NodeComparator.get=function(){return xm};Object.defineProperties(wu,vb);var xm=function(){};xm.prototype.compare=function(t,e){var r=t,s=e,c=(r._min+r._max)/2,p=(s._min+s._max)/2;return c<p?-1:c>p?1:0};xm.prototype.interfaces_=function(){return[bd]};xm.prototype.getClass=function(){return xm};var AE=function(n){function t(){n.call(this),this._item=null;var e=arguments[0],r=arguments[1],s=arguments[2];this._min=e,this._max=r,this._item=s}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.query=function(r,s,c){if(!this.intersects(r,s))return null;c.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(wu),PE=function(n){function t(){n.call(this),this._node1=null,this._node2=null;var e=arguments[0],r=arguments[1];this._node1=e,this._node2=r,this.buildExtent(this._node1,this._node2)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,s){this._min=Math.min(r._min,s._min),this._max=Math.max(r._max,s._max)},t.prototype.query=function(r,s,c){if(!this.intersects(r,s))return null;this._node1!==null&&this._node1.query(r,s,c),this._node2!==null&&this._node2.query(r,s,c)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(wu),Iu=function(){this._leaves=new ve,this._root=null,this._level=0};Iu.prototype.buildTree=function(){var t=this;Ha.sort(this._leaves,new wu.NodeComparator);for(var e=this._leaves,r=null,s=new ve;;){if(t.buildLevel(e,s),s.size()===1)return s.get(0);r=e,e=s,s=r}};Iu.prototype.insert=function(t,e,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new AE(t,e,r))};Iu.prototype.query=function(t,e,r){this.init(),this._root.query(t,e,r)};Iu.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Iu.prototype.printNode=function(t){po.out.println(Ya.toLineString(new Ct(t._min,this._level),new Ct(t._max,this._level)))};Iu.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Iu.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var r=0;r<t.size();r+=2){var s=t.get(r),c=r+1<t.size()?t.get(r):null;if(c===null)e.add(s);else{var p=new PE(t.get(r),t.get(r+1));e.add(p)}}};Iu.prototype.interfaces_=function(){return[]};Iu.prototype.getClass=function(){return Iu};var Rd=function(){this._items=new ve};Rd.prototype.visitItem=function(t){this._items.add(t)};Rd.prototype.getItems=function(){return this._items};Rd.prototype.interfaces_=function(){return[Wc]};Rd.prototype.getClass=function(){return Rd};var zd=function(){this._index=null;var t=arguments[0];if(!nn(t,Yc))throw new Dr("Argument must be Polygonal");this._index=new Jh(t)},P0={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};zd.prototype.locate=function(t){var e=new Cl(t),r=new Od(e);return this._index.query(t.y,t.y,r),e.getLocation()};zd.prototype.interfaces_=function(){return[Dd]};zd.prototype.getClass=function(){return zd};P0.SegmentVisitor.get=function(){return Od};P0.IntervalIndexedGeometry.get=function(){return Jh};Object.defineProperties(zd,P0);var Od=function(){this._counter=null;var t=arguments[0];this._counter=t};Od.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))};Od.prototype.interfaces_=function(){return[Wc]};Od.prototype.getClass=function(){return Od};var Jh=function(){this._index=new Iu;var t=arguments[0];this.init(t)};Jh.prototype.init=function(t){for(var e=this,r=co.getLines(t),s=r.iterator();s.hasNext();){var c=s.next(),p=c.getCoordinates();e.addLine(p)}};Jh.prototype.addLine=function(t){for(var e=this,r=1;r<t.length;r++){var s=new Ze(t[r-1],t[r]),c=Math.min(s.p0.y,s.p1.y),p=Math.max(s.p0.y,s.p1.y);e._index.insert(c,p,s)}};Jh.prototype.query=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],r=new Rd;return this._index.query(t,e,r),r.getItems()}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];this._index.query(s,c,p)}};Jh.prototype.interfaces_=function(){return[]};Jh.prototype.getClass=function(){return Jh};var Jg=function(n){function t(){if(n.call(this),this._parentGeom=null,this._lineEdgeMap=new nb,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Ja,arguments.length===2){var e=arguments[0],r=arguments[1],s=Pa.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=r,this._boundaryNodeRule=s,r!==null&&this.add(r)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],l=arguments[2];this._argIndex=c,this._parentGeom=p,this._boundaryNodeRule=l,p!==null&&this.add(p)}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,s){var c=this._nodes.addNode(s),p=c.getLabel(),l=1,x=Pt.NONE;x=p.getLocation(r,pe.ON),x===Pt.BOUNDARY&&l++;var I=t.determineBoundary(this._boundaryNodeRule,l);p.setLocation(r,I)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.computeSelfNodes(r,s,!1)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],l=arguments[2],x=new _o(c,!0,!1);x.setIsDoneIfProperInt(l);var I=this.createEdgeSetIntersector(),T=this._parentGeom instanceof mu||this._parentGeom instanceof Oi||this._parentGeom instanceof pu,P=p||!T;return I.computeIntersections(this._edges,x,P),this.addSelfIntersectionNodes(this._argIndex),x}},t.prototype.computeSplitEdges=function(r){for(var s=this._edges.iterator();s.hasNext();){var c=s.next();c.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,s,c){var p=new _o(s,c,!0);p.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var l=this.createEdgeSetIntersector();return l.computeIntersections(this._edges,r._edges,p),p},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof Rs){var r=arguments[0],s=r.getCoordinate();this.insertPoint(this._argIndex,s,Pt.INTERIOR)}else if(arguments[0]instanceof Ct){var c=arguments[0];this.insertPoint(this._argIndex,c,Pt.INTERIOR)}},t.prototype.addPolygon=function(r){var s=this;this.addPolygonRing(r.getExteriorRing(),Pt.EXTERIOR,Pt.INTERIOR);for(var c=0;c<r.getNumInteriorRing();c++){var p=r.getInteriorRingN(c);s.addPolygonRing(p,Pt.INTERIOR,Pt.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var s=r.getCoordinates();this.insertPoint(this._argIndex,s[0],Pt.BOUNDARY),this.insertPoint(this._argIndex,s[s.length-1],Pt.BOUNDARY)},t.prototype.addLineString=function(r){var s=Ln.removeRepeatedPoints(r.getCoordinates());if(s.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var c=new py(s,new sr(this._argIndex,Pt.INTERIOR));this._lineEdgeMap.put(r,c),this.insertEdge(c),xn.isTrue(s.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,s[0]),this.insertBoundaryPoint(this._argIndex,s[s.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),s=new Array(r.size()).fill(null),c=0,p=r.iterator();p.hasNext();){var l=p.next();s[c++]=l.getCoordinate().copy()}return s},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,s,c){if(this.isBoundaryNode(r,s))return null;c===Pt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,s):this.insertPoint(r,s,c)},t.prototype.addPolygonRing=function(r,s,c){if(r.isEmpty())return null;var p=Ln.removeRepeatedPoints(r.getCoordinates());if(p.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=p[0],null;var l=s,x=c;Te.isCCW(p)&&(l=c,x=s);var I=new py(p,new sr(this._argIndex,Pt.BOUNDARY,l,x));this._lineEdgeMap.put(r,I),this.insertEdge(I),this.insertPoint(this._argIndex,p[0],Pt.BOUNDARY)},t.prototype.insertPoint=function(r,s,c){var p=this._nodes.addNode(s),l=p.getLabel();l===null?p._label=new sr(r,c):l.setLocation(r,c)},t.prototype.createEdgeSetIntersector=function(){return new TE},t.prototype.addSelfIntersectionNodes=function(r){for(var s=this,c=this._edges.iterator();c.hasNext();)for(var p=c.next(),l=p.getLabel().getLocation(r),x=p.eiList.iterator();x.hasNext();){var I=x.next();s.addSelfIntersectionNode(r,I.coord,l)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof pu&&(this._useBoundaryDeterminationRule=!1),r instanceof Oi)this.addPolygon(r);else if(r instanceof ni)this.addLineString(r);else if(r instanceof Rs)this.addPoint(r);else if(r instanceof Ad)this.addCollection(r);else if(r instanceof Xh)this.addCollection(r);else if(r instanceof pu)this.addCollection(r);else if(r instanceof Jo)this.addCollection(r);else throw new Error(r.getClass().getName())}else return n.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var s=this,c=0;c<r.getNumGeometries();c++){var p=r.getGeometryN(c);s.add(p)}},t.prototype.locate=function(r){return nn(this._parentGeom,Yc)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new zd(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return n.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,s){return r.isInBoundary(s)?Pt.BOUNDARY:Pt.INTERIOR},t}(jr),kd=function(){if(this._li=new $h,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Jg(0,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1],s=Pa.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Jg(0,e,s),this._arg[1]=new Jg(1,r,s)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],l=arguments[2];c.getPrecisionModel().compareTo(p.getPrecisionModel())>=0?this.setComputationPrecision(c.getPrecisionModel()):this.setComputationPrecision(p.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Jg(0,c,l),this._arg[1]=new Jg(1,p,l)}};kd.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};kd.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};kd.prototype.interfaces_=function(){return[]};kd.prototype.getClass=function(){return kd};var Gh=function(){};Gh.prototype.interfaces_=function(){return[]};Gh.prototype.getClass=function(){return Gh};Gh.map=function(){if(arguments[0]instanceof Qe&&nn(arguments[1],Gh.MapOp)){for(var t=arguments[0],e=arguments[1],r=new ve,s=0;s<t.getNumGeometries();s++){var c=e.map(t.getGeometryN(s));c!==null&&r.add(c)}return t.getFactory().buildGeometry(r)}else if(nn(arguments[0],Di)&&nn(arguments[1],Gh.MapOp)){for(var p=arguments[0],l=arguments[1],x=new ve,I=p.iterator();I.hasNext();){var T=I.next(),P=l.map(T);P!==null&&x.add(P)}return x}};Gh.MapOp=function(){};var vn=function(n){function t(){var e=arguments[0],r=arguments[1];n.call(this,e,r),this._ptLocator=new Ja,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ka,this._resultPolyList=new ve,this._resultLineList=new ve,this._resultPointList=new ve,this._graph=new jr(new cb),this._geomFact=e.getFactory()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var s=this._edgeList.findEqualEdge(r);if(s!==null){var c=s.getLabel(),p=r.getLabel();s.isPointwiseEqual(r)||(p=new sr(r.getLabel()),p.flip());var l=s.getDepth();l.isNull()&&l.add(c),l.add(p),c.merge(p)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var s=r.next(),c=s.getSym();s.isInResult()&&c.isInResult()&&(s.setInResult(!1),c.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,s,c,p){var l=new ve;return l.addAll(r),l.addAll(s),l.addAll(c),l.isEmpty()?t.createEmptyResult(p,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(l)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next();s.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,s){for(var c=this,p=s.iterator();p.hasNext();){var l=p.next(),x=c._ptLocator.locate(r,l);if(x!==Pt.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new ve,s=this._edgeList.iterator();s.hasNext();){var c=s.next();c.isCollapsed()&&(s.remove(),r.add(c.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next(),c=s.getEdges().getLabel();s.getLabel().merge(c)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var s=this,c=r.iterator();c.hasNext();){var p=c.next();s.insertUniqueEdge(p)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var s=new ve;this._arg[0].computeSplitEdges(s),this._arg[1].computeSplitEdges(s),this.insertUniqueEdges(s),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Kh.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var c=new zs(this._geomFact);c.add(this._graph),this._resultPolyList=c.getPolygons();var p=new kl(this,this._geomFact,this._ptLocator);this._resultLineList=p.build(r);var l=new ep(this,this._geomFact,this._ptLocator);this._resultPointList=l.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,s){var c=this._ptLocator.locate(r.getCoordinate(),this._arg[s].getGeometry());r.getLabel().setLocation(s,c)},t.prototype.copyPoints=function(r){for(var s=this,c=this._arg[r].getNodeIterator();c.hasNext();){var p=c.next(),l=s._graph.addNode(p.getCoordinate());l.setLabel(r,p.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var s=this._graph.getEdgeEnds().iterator();s.hasNext();){var c=s.next(),p=c.getLabel();p.isArea()&&!c.isInteriorAreaEdge()&&t.isResultOfOp(p.getLocation(0,pe.RIGHT),p.getLocation(1,pe.RIGHT),r)&&c.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var s=r.next(),c=s.getLabel(),p=s.getDepth();if(!p.isNull()){p.normalize();for(var l=0;l<2;l++)!c.isNull(l)&&c.isArea()&&!p.isNull(l)&&(p.getDelta(l)===0?c.toLine(l):(xn.isTrue(!p.isNull(l,pe.LEFT),"depth of LEFT side has not been initialized"),c.setLocation(l,pe.LEFT,p.getLocation(l,pe.LEFT)),xn.isTrue(!p.isNull(l,pe.RIGHT),"depth of RIGHT side has not been initialized"),c.setLocation(l,pe.RIGHT,p.getLocation(l,pe.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,s=this._graph.getNodes().iterator();s.hasNext();){var c=s.next();c.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,s=this._graph.getNodes().iterator();s.hasNext();){var c=s.next(),p=c.getLabel();c.isIsolated()&&(p.isNull(0)?r.labelIncompleteNode(c,0):r.labelIncompleteNode(c,1)),c.getEdges().updateLabelling(p)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(kd);vn.overlayOp=function(n,t,e){var r=new vn(n,t),s=r.getResultGeometry(e);return s};vn.intersection=function(n,t){if(n.isEmpty()||t.isEmpty())return vn.createEmptyResult(vn.INTERSECTION,n,t,n.getFactory());if(n.isGeometryCollection()){var e=t;return tp.map(n,{interfaces_:function(){return[Gh.MapOp]},map:function(r){return r.intersection(e)}})}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),ts.overlayOp(n,t,vn.INTERSECTION)};vn.symDifference=function(n,t){if(n.isEmpty()||t.isEmpty()){if(n.isEmpty()&&t.isEmpty())return vn.createEmptyResult(vn.SYMDIFFERENCE,n,t,n.getFactory());if(n.isEmpty())return t.copy();if(t.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),ts.overlayOp(n,t,vn.SYMDIFFERENCE)};vn.resultDimension=function(n,t,e){var r=t.getDimension(),s=e.getDimension(),c=-1;switch(n){case vn.INTERSECTION:c=Math.min(r,s);break;case vn.UNION:c=Math.max(r,s);break;case vn.DIFFERENCE:c=r;break;case vn.SYMDIFFERENCE:c=Math.max(r,s);break}return c};vn.createEmptyResult=function(n,t,e,r){var s=null;switch(vn.resultDimension(n,t,e)){case-1:s=r.createGeometryCollection(new Array(0).fill(null));break;case 0:s=r.createPoint();break;case 1:s=r.createLineString();break;case 2:s=r.createPolygon();break}return s};vn.difference=function(n,t){return n.isEmpty()?vn.createEmptyResult(vn.DIFFERENCE,n,t,n.getFactory()):t.isEmpty()?n.copy():(n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(t),ts.overlayOp(n,t,vn.DIFFERENCE))};vn.isResultOfOp=function(){if(arguments.length===2){var n=arguments[0],t=arguments[1],e=n.getLocation(0),r=n.getLocation(1);return vn.isResultOfOp(e,r,t)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];switch(s===Pt.BOUNDARY&&(s=Pt.INTERIOR),c===Pt.BOUNDARY&&(c=Pt.INTERIOR),p){case vn.INTERSECTION:return s===Pt.INTERIOR&&c===Pt.INTERIOR;case vn.UNION:return s===Pt.INTERIOR||c===Pt.INTERIOR;case vn.DIFFERENCE:return s===Pt.INTERIOR&&c!==Pt.INTERIOR;case vn.SYMDIFFERENCE:return s===Pt.INTERIOR&&c!==Pt.INTERIOR||s!==Pt.INTERIOR&&c===Pt.INTERIOR}return!1}};vn.INTERSECTION=1;vn.UNION=2;vn.DIFFERENCE=3;vn.SYMDIFFERENCE=4;var Zc=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Ja,this._seg=new Ze;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Zc.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,r=0;r<this._linework.getNumGeometries();r++)for(var s=e._linework.getGeometryN(r),c=s.getCoordinateSequence(),p=0;p<c.size()-1;p++){c.getCoordinate(p,e._seg.p0),c.getCoordinate(p+1,e._seg.p1);var l=e._seg.distance(t);if(l<=e._boundaryDistanceTolerance)return!0}return!1};Zc.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Pt.BOUNDARY:this._ptLocator.locate(t,this._g)};Zc.prototype.extractLinework=function(t){var e=new Fd;t.apply(e);var r=e.getLinework(),s=Pn.toLineStringArray(r);return t.getFactory().createMultiLineString(s)};Zc.prototype.interfaces_=function(){return[]};Zc.prototype.getClass=function(){return Zc};var Fd=function(){this._linework=null,this._linework=new ve};Fd.prototype.getLinework=function(){return this._linework};Fd.prototype.filter=function(t){var e=this;if(t instanceof Oi){var r=t;this._linework.add(r.getExteriorRing());for(var s=0;s<r.getNumInteriorRing();s++)e._linework.add(r.getInteriorRingN(s))}};Fd.prototype.interfaces_=function(){return[Ll]};Fd.prototype.getClass=function(){return Fd};var Qh=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Qh.prototype.extractPoints=function(t,e,r){for(var s=this,c=t.getCoordinates(),p=0;p<c.length-1;p++)s.computeOffsetPoints(c[p],c[p+1],e,r)};Qh.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e};Qh.prototype.getPoints=function(t){for(var e=this,r=new ve,s=co.getLines(this._g),c=s.iterator();c.hasNext();){var p=c.next();e.extractPoints(p,t,r)}return r};Qh.prototype.computeOffsetPoints=function(t,e,r,s){var c=e.x-t.x,p=e.y-t.y,l=Math.sqrt(c*c+p*p),x=r*c/l,I=r*p/l,T=(e.x+t.x)/2,P=(e.y+t.y)/2;if(this._doLeft){var D=new Ct(T-I,P+x);s.add(D)}if(this._doRight){var G=new Ct(T+I,P-x);s.add(G)}};Qh.prototype.interfaces_=function(){return[]};Qh.prototype.getClass=function(){return Qh};var oa=function n(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=n.TOLERANCE,this._testCoords=new ve;var t=arguments[0],e=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=n.computeBoundaryDistanceTolerance(t,e),this._geom=[t,e,r],this._locFinder=[new Zc(this._geom[0],this._boundaryDistanceTolerance),new Zc(this._geom[1],this._boundaryDistanceTolerance),new Zc(this._geom[2],this._boundaryDistanceTolerance)]},xb={TOLERANCE:{configurable:!0}};oa.prototype.reportResult=function(t,e,r){po.out.println("Overlay result invalid - A:"+Pt.toLocationSymbol(e[0])+" B:"+Pt.toLocationSymbol(e[1])+" expected:"+(r?"i":"e")+" actual:"+Pt.toLocationSymbol(e[2]))};oa.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e};oa.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var e=arguments[0],r=0;r<this._testCoords.size();r++){var s=t._testCoords.get(r);if(!t.checkValid(e,s))return t._invalidLocation=s,!1}return!0}else if(arguments.length===2){var c=arguments[0],p=arguments[1];return this._location[0]=this._locFinder[0].getLocation(p),this._location[1]=this._locFinder[1].getLocation(p),this._location[2]=this._locFinder[2].getLocation(p),oa.hasLocation(this._location,Pt.BOUNDARY)?!0:this.isValidResult(c,this._location)}};oa.prototype.addTestPts=function(t){var e=new Qh(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))};oa.prototype.isValidResult=function(t,e){var r=vn.isResultOfOp(e[0],e[1],t),s=e[2]===Pt.INTERIOR,c=!(r^s);return c||this.reportResult(t,e,r),c};oa.prototype.getInvalidLocation=function(){return this._invalidLocation};oa.prototype.interfaces_=function(){return[]};oa.prototype.getClass=function(){return oa};oa.hasLocation=function(t,e){for(var r=0;r<3;r++)if(t[r]===e)return!0;return!1};oa.computeBoundaryDistanceTolerance=function(t,e){return Math.min(ci.computeSizeBasedSnapTolerance(t),ci.computeSizeBasedSnapTolerance(e))};oa.isValid=function(t,e,r,s){var c=new oa(t,e,s);return c.isValid(r)};xb.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(oa,xb);var $s=function n(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=n.extractFactory(t),this._inputGeoms=t};$s.prototype.extractElements=function(t,e){var r=this;if(t===null)return null;for(var s=0;s<t.getNumGeometries();s++){var c=t.getGeometryN(s);r._skipEmpty&&c.isEmpty()||e.add(c)}};$s.prototype.combine=function(){for(var t=this,e=new ve,r=this._inputGeoms.iterator();r.hasNext();){var s=r.next();t.extractElements(s,e)}return e.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)};$s.prototype.interfaces_=function(){return[]};$s.prototype.getClass=function(){return $s};$s.combine=function(){if(arguments.length===1){var t=arguments[0],e=new $s(t);return e.combine()}else if(arguments.length===2){var r=arguments[0],s=arguments[1],c=new $s($s.createList(r,s));return c.combine()}else if(arguments.length===3){var p=arguments[0],l=arguments[1],x=arguments[2],I=new $s($s.createList(p,l,x));return I.combine()}};$s.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};$s.createList=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],r=new ve;return r.add(t),r.add(e),r}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2],l=new ve;return l.add(s),l.add(c),l.add(p),l}};var Ii=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new ve)},bb={STRTREE_NODE_CAPACITY:{configurable:!0}};Ii.prototype.reduceToGeometries=function(t){for(var e=this,r=new ve,s=t.iterator();s.hasNext();){var c=s.next(),p=null;nn(c,Za)?p=e.unionTree(c):c instanceof Qe&&(p=c),r.add(p)}return r};Ii.prototype.extractByEnvelope=function(t,e,r){for(var s=new ve,c=0;c<e.getNumGeometries();c++){var p=e.getGeometryN(c);p.getEnvelopeInternal().intersects(t)?s.add(p):r.add(p)}return this._geomFactory.buildGeometry(s)};Ii.prototype.unionOptimized=function(t,e){var r=t.getEnvelopeInternal(),s=e.getEnvelopeInternal();if(!r.intersects(s)){var c=$s.combine(t,e);return c}if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var p=r.intersection(s);return this.unionUsingEnvelopeIntersection(t,e,p)};Ii.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sb(Ii.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var r=e.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var s=t.itemsTree(),c=this.unionTree(s);return c};Ii.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var e=arguments[0],r=arguments[1],s=arguments[2];if(s-r<=1){var c=Ii.getGeometry(e,r);return this.unionSafe(c,null)}else{if(s-r===2)return this.unionSafe(Ii.getGeometry(e,r),Ii.getGeometry(e,r+1));var p=Math.trunc((s+r)/2),l=this.binaryUnion(e,r,p),x=this.binaryUnion(e,p,s);return this.unionSafe(l,x)}}};Ii.prototype.repeatedUnion=function(t){for(var e=null,r=t.iterator();r.hasNext();){var s=r.next();e===null?e=s.copy():e=e.union(s)}return e};Ii.prototype.unionSafe=function(t,e){return t===null&&e===null?null:t===null?e.copy():e===null?t.copy():this.unionOptimized(t,e)};Ii.prototype.unionActual=function(t,e){return Ii.restrictToPolygons(t.union(e))};Ii.prototype.unionTree=function(t){var e=this.reduceToGeometries(t),r=this.binaryUnion(e);return r};Ii.prototype.unionUsingEnvelopeIntersection=function(t,e,r){var s=new ve,c=this.extractByEnvelope(r,t,s),p=this.extractByEnvelope(r,e,s),l=this.unionActual(c,p);s.add(l);var x=$s.combine(s);return x};Ii.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],e=t.get(0).getFactory(),r=e.buildGeometry(t),s=r.buffer(0);return s}else if(arguments.length===2){var c=arguments[0],p=arguments[1],l=c.getFactory(),x=l.createGeometryCollection([c,p]),I=x.buffer(0);return I}};Ii.prototype.interfaces_=function(){return[]};Ii.prototype.getClass=function(){return Ii};Ii.restrictToPolygons=function(t){if(nn(t,Yc))return t;var e=tc.getPolygons(t);return e.size()===1?e.get(0):t.getFactory().createMultiPolygon(Pn.toPolygonArray(e))};Ii.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)};Ii.union=function(t){var e=new Ii(t);return e.union()};bb.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(Ii,bb);var gy=function(){};gy.prototype.interfaces_=function(){return[]};gy.prototype.getClass=function(){return gy};gy.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return vn.createEmptyResult(vn.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.overlayOp(t,e,vn.UNION)};function tf(){return new my}function my(){this.reset()}my.prototype={constructor:my,reset:function(){this.s=this.t=0},add:function(n){b1(Z_,n,this.t),b1(this,Z_.s,this.s),this.s?this.t+=Z_.t:this.s=Z_.t},valueOf:function(){return this.s}};var Z_=new my;function b1(n,t,e){var r=n.s=t+e,s=r-t,c=r-s;n.t=t-c+(e-s)}var ei=1e-6,mr=Math.PI,Qu=mr/2,w1=mr/4,sc=mr*2,Bh=180/mr,Il=mr/180,Ho=Math.abs,LE=Math.atan,Bd=Math.atan2,Ni=Math.cos,Ri=Math.sin,Qd=Math.sqrt;function wb(n){return n>1?0:n<-1?mr:Math.acos(n)}function rp(n){return n>1?Qu:n<-1?-Qu:Math.asin(n)}function tm(){}function _y(n,t){n&&E1.hasOwnProperty(n.type)&&E1[n.type](n,t)}var I1={Feature:function(n,t){_y(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,s=e.length;++r<s;)_y(e[r].geometry,t)}},E1={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,s=e.length;++r<s;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){Qv(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,s=e.length;++r<s;)Qv(e[r],t,0)},Polygon:function(n,t){S1(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,s=e.length;++r<s;)S1(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,s=e.length;++r<s;)_y(e[r],t)}};function Qv(n,t,e){var r=-1,s=n.length-e,c;for(t.lineStart();++r<s;)c=n[r],t.point(c[0],c[1],c[2]);t.lineEnd()}function S1(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)Qv(n[e],t,1);t.polygonEnd()}function ME(n,t){n&&I1.hasOwnProperty(n.type)?I1[n.type](n,t):_y(n,t)}tf();tf();function $v(n){return[Bd(n[1],n[0]),rp(n[2])]}function Ud(n){var t=n[0],e=n[1],r=Ni(e);return[r*Ni(t),r*Ri(t),Ri(e)]}function Y_(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function yy(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Fv(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function W_(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function t0(n){var t=Qd(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}tf();function Ib(n,t){function e(r,s){return r=n(r,s),t(r[0],r[1])}return n.invert&&t.invert&&(e.invert=function(r,s){return r=t.invert(r,s),r&&n.invert(r[0],r[1])}),e}function e0(n,t){return[n>mr?n-sc:n<-mr?n+sc:n,t]}e0.invert=e0;function DE(n,t,e){return(n%=sc)?t||e?Ib(T1(n),A1(t,e)):T1(n):t||e?A1(t,e):e0}function C1(n){return function(t,e){return t+=n,[t>mr?t-sc:t<-mr?t+sc:t,e]}}function T1(n){var t=C1(n);return t.invert=C1(-n),t}function A1(n,t){var e=Ni(n),r=Ri(n),s=Ni(t),c=Ri(t);function p(l,x){var I=Ni(x),T=Ni(l)*I,P=Ri(l)*I,D=Ri(x),G=D*e+T*r;return[Bd(P*s-G*c,T*e-D*r),rp(G*s+P*c)]}return p.invert=function(l,x){var I=Ni(x),T=Ni(l)*I,P=Ri(l)*I,D=Ri(x),G=D*s-P*c;return[Bd(P*s+D*c,T*e+G*r),rp(G*e-T*r)]},p}function NE(n,t,e,r,s,c){if(!!e){var p=Ni(t),l=Ri(t),x=r*e;s==null?(s=t+r*sc,c=t-x/2):(s=P1(p,s),c=P1(p,c),(r>0?s<c:s>c)&&(s+=r*sc));for(var I,T=s;r>0?T>c:T<c;T-=x)I=$v([p,-l*Ni(T),-l*Ri(T)]),n.point(I[0],I[1])}}function P1(n,t){t=Ud(t),t[0]-=n,t0(t);var e=wb(-t[1]);return((-t[2]<0?-e:e)+sc-ei)%sc}function Eb(){var n=[],t;return{point:function(e,r){t.push([e,r])},lineStart:function(){n.push(t=[])},lineEnd:tm,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function RE(n,t,e,r,s,c){var p=n[0],l=n[1],x=t[0],I=t[1],T=0,P=1,D=x-p,G=I-l,Y;if(Y=e-p,!(!D&&Y>0)){if(Y/=D,D<0){if(Y<T)return;Y<P&&(P=Y)}else if(D>0){if(Y>P)return;Y>T&&(T=Y)}if(Y=s-p,!(!D&&Y<0)){if(Y/=D,D<0){if(Y>P)return;Y>T&&(T=Y)}else if(D>0){if(Y<T)return;Y<P&&(P=Y)}if(Y=r-l,!(!G&&Y>0)){if(Y/=G,G<0){if(Y<T)return;Y<P&&(P=Y)}else if(G>0){if(Y>P)return;Y>T&&(T=Y)}if(Y=c-l,!(!G&&Y<0)){if(Y/=G,G<0){if(Y>P)return;Y>T&&(T=Y)}else if(G>0){if(Y<T)return;Y<P&&(P=Y)}return T>0&&(n[0]=p+T*D,n[1]=l+T*G),P<1&&(t[0]=p+P*D,t[1]=l+P*G),!0}}}}}function ry(n,t){return Ho(n[0]-t[0])<ei&&Ho(n[1]-t[1])<ei}function j_(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Sb(n,t,e,r,s){var c=[],p=[],l,x;if(n.forEach(function(Y){if(!((et=Y.length-1)<=0)){var et,at=Y[0],rt=Y[et],wt;if(ry(at,rt)){for(s.lineStart(),l=0;l<et;++l)s.point((at=Y[l])[0],at[1]);s.lineEnd();return}c.push(wt=new j_(at,Y,null,!0)),p.push(wt.o=new j_(at,null,wt,!1)),c.push(wt=new j_(rt,Y,null,!1)),p.push(wt.o=new j_(rt,null,wt,!0))}}),!!c.length){for(p.sort(t),L1(c),L1(p),l=0,x=p.length;l<x;++l)p[l].e=e=!e;for(var I=c[0],T,P;;){for(var D=I,G=!0;D.v;)if((D=D.n)===I)return;T=D.z,s.lineStart();do{if(D.v=D.o.v=!0,D.e){if(G)for(l=0,x=T.length;l<x;++l)s.point((P=T[l])[0],P[1]);else r(D.x,D.n.x,1,s);D=D.n}else{if(G)for(T=D.p.z,l=T.length-1;l>=0;--l)s.point((P=T[l])[0],P[1]);else r(D.x,D.p.x,-1,s);D=D.p}D=D.o,T=D.z,G=!G}while(!D.v);s.lineEnd()}}}function L1(n){if(!!(t=n.length)){for(var t,e=0,r=n[0],s;++e<t;)r.n=s=n[e],s.p=r,r=s;r.n=s=n[0],s.p=r}}function Cb(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function zE(n){return n.length===1&&(n=OE(n)),{left:function(t,e,r,s){for(r==null&&(r=0),s==null&&(s=t.length);r<s;){var c=r+s>>>1;n(t[c],e)<0?r=c+1:s=c}return r},right:function(t,e,r,s){for(r==null&&(r=0),s==null&&(s=t.length);r<s;){var c=r+s>>>1;n(t[c],e)>0?s=c:r=c+1}return r}}}function OE(n){return function(t,e){return Cb(n(t),e)}}zE(Cb);function Tb(n){for(var t=n.length,e,r=-1,s=0,c,p;++r<t;)s+=n[r].length;for(c=new Array(s);--t>=0;)for(p=n[t],e=p.length;--e>=0;)c[--s]=p[e];return c}var em=1e9,H_=-em;function kE(n,t,e,r){function s(I,T){return n<=I&&I<=e&&t<=T&&T<=r}function c(I,T,P,D){var G=0,Y=0;if(I==null||(G=p(I,P))!==(Y=p(T,P))||x(I,T)<0^P>0)do D.point(G===0||G===3?n:e,G>1?r:t);while((G=(G+P+4)%4)!==Y);else D.point(T[0],T[1])}function p(I,T){return Ho(I[0]-n)<ei?T>0?0:3:Ho(I[0]-e)<ei?T>0?2:1:Ho(I[1]-t)<ei?T>0?1:0:T>0?3:2}function l(I,T){return x(I.x,T.x)}function x(I,T){var P=p(I,1),D=p(T,1);return P!==D?P-D:P===0?T[1]-I[1]:P===1?I[0]-T[0]:P===2?I[1]-T[1]:T[0]-I[0]}return function(I){var T=I,P=Eb(),D,G,Y,et,at,rt,wt,xt,Gt,ee,$t,Zt={point:Mt,lineStart:re,lineEnd:Yt,polygonStart:Wt,polygonEnd:ft};function Mt(Oe,Jt){s(Oe,Jt)&&T.point(Oe,Jt)}function It(){for(var Oe=0,Jt=0,$e=G.length;Jt<$e;++Jt)for(var pn=G[Jt],Cn=1,_r=pn.length,Xn=pn[0],oi,Nr,to=Xn[0],Hr=Xn[1];Cn<_r;++Cn)oi=to,Nr=Hr,Xn=pn[Cn],to=Xn[0],Hr=Xn[1],Nr<=r?Hr>r&&(to-oi)*(r-Nr)>(Hr-Nr)*(n-oi)&&++Oe:Hr<=r&&(to-oi)*(r-Nr)<(Hr-Nr)*(n-oi)&&--Oe;return Oe}function Wt(){T=P,D=[],G=[],$t=!0}function ft(){var Oe=It(),Jt=$t&&Oe,$e=(D=Tb(D)).length;(Jt||$e)&&(I.polygonStart(),Jt&&(I.lineStart(),c(null,null,1,I),I.lineEnd()),$e&&Sb(D,l,Oe,c,I),I.polygonEnd()),T=I,D=G=Y=null}function re(){Zt.point=Ft,G&&G.push(Y=[]),ee=!0,Gt=!1,wt=xt=NaN}function Yt(){D&&(Ft(et,at),rt&&Gt&&P.rejoin(),D.push(P.result())),Zt.point=Mt,Gt&&T.lineEnd()}function Ft(Oe,Jt){var $e=s(Oe,Jt);if(G&&Y.push([Oe,Jt]),ee)et=Oe,at=Jt,rt=$e,ee=!1,$e&&(T.lineStart(),T.point(Oe,Jt));else if($e&&Gt)T.point(Oe,Jt);else{var pn=[wt=Math.max(H_,Math.min(em,wt)),xt=Math.max(H_,Math.min(em,xt))],Cn=[Oe=Math.max(H_,Math.min(em,Oe)),Jt=Math.max(H_,Math.min(em,Jt))];RE(pn,Cn,n,t,e,r)?(Gt||(T.lineStart(),T.point(pn[0],pn[1])),T.point(Cn[0],Cn[1]),$e||T.lineEnd(),$t=!1):$e&&(T.lineStart(),T.point(Oe,Jt),$t=!1)}wt=Oe,xt=Jt,Gt=$e}return Zt}}var Bv=tf();function FE(n,t){var e=t[0],r=t[1],s=[Ri(e),-Ni(e),0],c=0,p=0;Bv.reset();for(var l=0,x=n.length;l<x;++l)if(!!(T=(I=n[l]).length))for(var I,T,P=I[T-1],D=P[0],G=P[1]/2+w1,Y=Ri(G),et=Ni(G),at=0;at<T;++at,D=wt,Y=Gt,et=ee,P=rt){var rt=I[at],wt=rt[0],xt=rt[1]/2+w1,Gt=Ri(xt),ee=Ni(xt),$t=wt-D,Zt=$t>=0?1:-1,Mt=Zt*$t,It=Mt>mr,Wt=Y*Gt;if(Bv.add(Bd(Wt*Zt*Ri(Mt),et*ee+Wt*Ni(Mt))),c+=It?$t+Zt*sc:$t,It^D>=e^wt>=e){var ft=yy(Ud(P),Ud(rt));t0(ft);var re=yy(s,ft);t0(re);var Yt=(It^$t>=0?-1:1)*rp(re[2]);(r>Yt||r===Yt&&(ft[0]||ft[1]))&&(p+=It^$t>=0?1:-1)}}return(c<-ei||c<ei&&Bv<-ei)^p&1}tf();function M1(n){return n}tf();tf();var Vd=1/0,vy=Vd,bm=-Vd,xy=bm,D1={point:BE,lineStart:tm,lineEnd:tm,polygonStart:tm,polygonEnd:tm,result:function(){var n=[[Vd,vy],[bm,xy]];return bm=xy=-(vy=Vd=1/0),n}};function BE(n,t){n<Vd&&(Vd=n),n>bm&&(bm=n),t<vy&&(vy=t),t>xy&&(xy=t)}tf();function Ab(n,t,e,r){return function(s,c){var p=t(c),l=s.invert(r[0],r[1]),x=Eb(),I=t(x),T=!1,P,D,G,Y={point:et,lineStart:rt,lineEnd:wt,polygonStart:function(){Y.point=xt,Y.lineStart=Gt,Y.lineEnd=ee,D=[],P=[]},polygonEnd:function(){Y.point=et,Y.lineStart=rt,Y.lineEnd=wt,D=Tb(D);var $t=FE(P,l);D.length?(T||(c.polygonStart(),T=!0),Sb(D,VE,$t,e,c)):$t&&(T||(c.polygonStart(),T=!0),c.lineStart(),e(null,null,1,c),c.lineEnd()),T&&(c.polygonEnd(),T=!1),D=P=null},sphere:function(){c.polygonStart(),c.lineStart(),e(null,null,1,c),c.lineEnd(),c.polygonEnd()}};function et($t,Zt){var Mt=s($t,Zt);n($t=Mt[0],Zt=Mt[1])&&c.point($t,Zt)}function at($t,Zt){var Mt=s($t,Zt);p.point(Mt[0],Mt[1])}function rt(){Y.point=at,p.lineStart()}function wt(){Y.point=et,p.lineEnd()}function xt($t,Zt){G.push([$t,Zt]);var Mt=s($t,Zt);I.point(Mt[0],Mt[1])}function Gt(){I.lineStart(),G=[]}function ee(){xt(G[0][0],G[0][1]),I.lineEnd();var $t=I.clean(),Zt=x.result(),Mt,It=Zt.length,Wt,ft,re;if(G.pop(),P.push(G),G=null,!!It){if($t&1){if(ft=Zt[0],(Wt=ft.length-1)>0){for(T||(c.polygonStart(),T=!0),c.lineStart(),Mt=0;Mt<Wt;++Mt)c.point((re=ft[Mt])[0],re[1]);c.lineEnd()}return}It>1&&$t&2&&Zt.push(Zt.pop().concat(Zt.shift())),D.push(Zt.filter(UE))}}return Y}}function UE(n){return n.length>1}function VE(n,t){return((n=n.x)[0]<0?n[1]-Qu-ei:Qu-n[1])-((t=t.x)[0]<0?t[1]-Qu-ei:Qu-t[1])}const N1=Ab(function(){return!0},GE,XE,[-mr,-Qu]);function GE(n){var t=NaN,e=NaN,r=NaN,s;return{lineStart:function(){n.lineStart(),s=1},point:function(c,p){var l=c>0?mr:-mr,x=Ho(c-t);Ho(x-mr)<ei?(n.point(t,e=(e+p)/2>0?Qu:-Qu),n.point(r,e),n.lineEnd(),n.lineStart(),n.point(l,e),n.point(c,e),s=0):r!==l&&x>=mr&&(Ho(t-r)<ei&&(t-=r*ei),Ho(c-l)<ei&&(c-=l*ei),e=qE(t,e,c,p),n.point(r,e),n.lineEnd(),n.lineStart(),n.point(l,e),s=0),n.point(t=c,e=p),r=l},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-s}}}function qE(n,t,e,r){var s,c,p=Ri(n-e);return Ho(p)>ei?LE((Ri(t)*(c=Ni(r))*Ri(e)-Ri(r)*(s=Ni(t))*Ri(n))/(s*c*p)):(t+r)/2}function XE(n,t,e,r){var s;if(n==null)s=e*Qu,r.point(-mr,s),r.point(0,s),r.point(mr,s),r.point(mr,0),r.point(mr,-s),r.point(0,-s),r.point(-mr,-s),r.point(-mr,0),r.point(-mr,s);else if(Ho(n[0]-t[0])>ei){var c=n[0]<t[0]?mr:-mr;s=e*c/2,r.point(-c,s),r.point(0,s),r.point(c,s)}else r.point(t[0],t[1])}function ZE(n,t){var e=Ni(n),r=e>0,s=Ho(e)>ei;function c(T,P,D,G){NE(G,n,t,D,T,P)}function p(T,P){return Ni(T)*Ni(P)>e}function l(T){var P,D,G,Y,et;return{lineStart:function(){Y=G=!1,et=1},point:function(at,rt){var wt=[at,rt],xt,Gt=p(at,rt),ee=r?Gt?0:I(at,rt):Gt?I(at+(at<0?mr:-mr),rt):0;if(!P&&(Y=G=Gt)&&T.lineStart(),Gt!==G&&(xt=x(P,wt),(!xt||ry(P,xt)||ry(wt,xt))&&(wt[0]+=ei,wt[1]+=ei,Gt=p(wt[0],wt[1]))),Gt!==G)et=0,Gt?(T.lineStart(),xt=x(wt,P),T.point(xt[0],xt[1])):(xt=x(P,wt),T.point(xt[0],xt[1]),T.lineEnd()),P=xt;else if(s&&P&&r^Gt){var $t;!(ee&D)&&($t=x(wt,P,!0))&&(et=0,r?(T.lineStart(),T.point($t[0][0],$t[0][1]),T.point($t[1][0],$t[1][1]),T.lineEnd()):(T.point($t[1][0],$t[1][1]),T.lineEnd(),T.lineStart(),T.point($t[0][0],$t[0][1])))}Gt&&(!P||!ry(P,wt))&&T.point(wt[0],wt[1]),P=wt,G=Gt,D=ee},lineEnd:function(){G&&T.lineEnd(),P=null},clean:function(){return et|(Y&&G)<<1}}}function x(T,P,D){var G=Ud(T),Y=Ud(P),et=[1,0,0],at=yy(G,Y),rt=Y_(at,at),wt=at[0],xt=rt-wt*wt;if(!xt)return!D&&T;var Gt=e*rt/xt,ee=-e*wt/xt,$t=yy(et,at),Zt=W_(et,Gt),Mt=W_(at,ee);Fv(Zt,Mt);var It=$t,Wt=Y_(Zt,It),ft=Y_(It,It),re=Wt*Wt-ft*(Y_(Zt,Zt)-1);if(!(re<0)){var Yt=Qd(re),Ft=W_(It,(-Wt-Yt)/ft);if(Fv(Ft,Zt),Ft=$v(Ft),!D)return Ft;var Oe=T[0],Jt=P[0],$e=T[1],pn=P[1],Cn;Jt<Oe&&(Cn=Oe,Oe=Jt,Jt=Cn);var _r=Jt-Oe,Xn=Ho(_r-mr)<ei,oi=Xn||_r<ei;if(!Xn&&pn<$e&&(Cn=$e,$e=pn,pn=Cn),oi?Xn?$e+pn>0^Ft[1]<(Ho(Ft[0]-Oe)<ei?$e:pn):$e<=Ft[1]&&Ft[1]<=pn:_r>mr^(Oe<=Ft[0]&&Ft[0]<=Jt)){var Nr=W_(It,(-Wt+Yt)/ft);return Fv(Nr,Zt),[Ft,$v(Nr)]}}}function I(T,P){var D=r?n:mr-n,G=0;return T<-D?G|=1:T>D&&(G|=2),P<-D?G|=4:P>D&&(G|=8),G}return Ab(p,l,c,r?[0,-n]:[-mr,n-mr])}function Pb(n){return function(t){var e=new n0;for(var r in n)e[r]=n[r];return e.stream=t,e}}function n0(){}n0.prototype={constructor:n0,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Lb(n,t,e){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],c=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),c!=null&&n.clipExtent(null),ME(e,n.stream(D1));var p=D1.result(),l=Math.min(r/(p[1][0]-p[0][0]),s/(p[1][1]-p[0][1])),x=+t[0][0]+(r-l*(p[1][0]+p[0][0]))/2,I=+t[0][1]+(s-l*(p[1][1]+p[0][1]))/2;return c!=null&&n.clipExtent(c),n.scale(l*150).translate([x,I])}function YE(n,t,e){return Lb(n,[[0,0],t],e)}var R1=16,WE=Ni(30*Il);function z1(n,t){return+t?HE(n,t):jE(n)}function jE(n){return Pb({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function HE(n,t){function e(r,s,c,p,l,x,I,T,P,D,G,Y,et,at){var rt=I-r,wt=T-s,xt=rt*rt+wt*wt;if(xt>4*t&&et--){var Gt=p+D,ee=l+G,$t=x+Y,Zt=Qd(Gt*Gt+ee*ee+$t*$t),Mt=rp($t/=Zt),It=Ho(Ho($t)-1)<ei||Ho(c-P)<ei?(c+P)/2:Bd(ee,Gt),Wt=n(It,Mt),ft=Wt[0],re=Wt[1],Yt=ft-r,Ft=re-s,Oe=wt*Yt-rt*Ft;(Oe*Oe/xt>t||Ho((rt*Yt+wt*Ft)/xt-.5)>.3||p*D+l*G+x*Y<WE)&&(e(r,s,c,p,l,x,ft,re,It,Gt/=Zt,ee/=Zt,$t,et,at),at.point(ft,re),e(ft,re,It,Gt,ee,$t,I,T,P,D,G,Y,et,at))}}return function(r){var s,c,p,l,x,I,T,P,D,G,Y,et,at={point:rt,lineStart:wt,lineEnd:Gt,polygonStart:function(){r.polygonStart(),at.lineStart=ee},polygonEnd:function(){r.polygonEnd(),at.lineStart=wt}};function rt(Mt,It){Mt=n(Mt,It),r.point(Mt[0],Mt[1])}function wt(){P=NaN,at.point=xt,r.lineStart()}function xt(Mt,It){var Wt=Ud([Mt,It]),ft=n(Mt,It);e(P,D,T,G,Y,et,P=ft[0],D=ft[1],T=Mt,G=Wt[0],Y=Wt[1],et=Wt[2],R1,r),r.point(P,D)}function Gt(){at.point=rt,r.lineEnd()}function ee(){wt(),at.point=$t,at.lineEnd=Zt}function $t(Mt,It){xt(s=Mt,It),c=P,p=D,l=G,x=Y,I=et,at.point=xt}function Zt(){e(P,D,T,G,Y,et,c,p,s,l,x,I,R1,r),at.lineEnd=Gt,Gt()}return at}}var KE=Pb({point:function(n,t){this.stream.point(n*Il,t*Il)}});function JE(n){return QE(function(){return n})()}function QE(n){var t,e=150,r=480,s=250,c,p,l=0,x=0,I=0,T=0,P=0,D,G,Y=null,et=N1,at=null,rt,wt,xt,Gt=M1,ee=.5,$t=z1(ft,ee),Zt,Mt;function It(Ft){return Ft=G(Ft[0]*Il,Ft[1]*Il),[Ft[0]*e+c,p-Ft[1]*e]}function Wt(Ft){return Ft=G.invert((Ft[0]-c)/e,(p-Ft[1])/e),Ft&&[Ft[0]*Bh,Ft[1]*Bh]}function ft(Ft,Oe){return Ft=t(Ft,Oe),[Ft[0]*e+c,p-Ft[1]*e]}It.stream=function(Ft){return Zt&&Mt===Ft?Zt:Zt=KE(et(D,$t(Gt(Mt=Ft))))},It.clipAngle=function(Ft){return arguments.length?(et=+Ft?ZE(Y=Ft*Il,6*Il):(Y=null,N1),Yt()):Y*Bh},It.clipExtent=function(Ft){return arguments.length?(Gt=Ft==null?(at=rt=wt=xt=null,M1):kE(at=+Ft[0][0],rt=+Ft[0][1],wt=+Ft[1][0],xt=+Ft[1][1]),Yt()):at==null?null:[[at,rt],[wt,xt]]},It.scale=function(Ft){return arguments.length?(e=+Ft,re()):e},It.translate=function(Ft){return arguments.length?(r=+Ft[0],s=+Ft[1],re()):[r,s]},It.center=function(Ft){return arguments.length?(l=Ft[0]%360*Il,x=Ft[1]%360*Il,re()):[l*Bh,x*Bh]},It.rotate=function(Ft){return arguments.length?(I=Ft[0]%360*Il,T=Ft[1]%360*Il,P=Ft.length>2?Ft[2]%360*Il:0,re()):[I*Bh,T*Bh,P*Bh]},It.precision=function(Ft){return arguments.length?($t=z1(ft,ee=Ft*Ft),Yt()):Qd(ee)},It.fitExtent=function(Ft,Oe){return Lb(It,Ft,Oe)},It.fitSize=function(Ft,Oe){return YE(It,Ft,Oe)};function re(){G=Ib(D=DE(I,T,P),t);var Ft=t(l,x);return c=r-Ft[0]*e,p=s+Ft[1]*e,Yt()}function Yt(){return Zt=Mt=null,It}return function(){return t=n.apply(this,arguments),It.invert=t.invert&&Wt,re()}}function Mb(n){return function(t,e){var r=Ni(t),s=Ni(e),c=n(r*s);return[c*s*Ri(t),c*Ri(e)]}}function Db(n){return function(t,e){var r=Qd(t*t+e*e),s=n(r),c=Ri(s),p=Ni(s);return[Bd(t*c,r*p),rp(r&&e*c/r)]}}var $E=Mb(function(n){return Qd(2/(1+n))});$E.invert=Db(function(n){return 2*rp(n/2)});var Nb=Mb(function(n){return(n=wb(n))&&n/Ri(n)});Nb.invert=Db(function(n){return n});function tS(){return JE(Nb).scale(79.4188).clipAngle(180-.001)}function O1(n,t){return[n,t]}O1.invert=O1;function eS(n,t,e){e=e||{};var r=e.units||"kilometers",s=e.steps||8;if(!n)throw new Error("geojson is required");if(typeof e!="object")throw new Error("options must be an object");if(typeof s!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(s<=0)throw new Error("steps must be greater than 0");var c=[];switch(n.type){case"GeometryCollection":return jx(n,function(p){var l=iy(p,t,r,s);l&&c.push(l)}),Kv(c);case"FeatureCollection":return m1(n,function(p){var l=iy(p,t,r,s);l&&m1(l,function(x){x&&c.push(x)})}),Kv(c)}return iy(n,t,r,s)}function iy(n,t,e,r){var s=n.properties||{},c=n.type==="Feature"?n.geometry:n;if(c.type==="GeometryCollection"){var p=[];return jx(n,function(et){var at=iy(et,t,e,r);at&&p.push(at)}),Kv(p)}var l=nS(c),x={type:c.type,coordinates:zb(c.coordinates,l)},I=new b0,T=I.read(x),P=cE(hE(t,e),"meters"),D=ho.bufferOp(T,P,r),G=new ib;if(D=G.write(D),!Rb(D.coordinates)){var Y={type:D.type,coordinates:Ob(D.coordinates,l)};return Yx(Y,s)}}function Rb(n){return Array.isArray(n[0])?Rb(n[0]):isNaN(n[0])}function zb(n,t){return typeof n[0]!="object"?t(n):n.map(function(e){return zb(e,t)})}function Ob(n,t){return typeof n[0]!="object"?t.invert(n):n.map(function(e){return Ob(e,t)})}function nS(n){var t=fE(n).geometry.coordinates,e=[-t[0],-t[1]];return tS().rotate(e).scale(Qs)}var L0={exports:{}},kb={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Uf,function(){function e(p,l,x,I,T){r(p,l,x||0,I||p.length-1,T||c)}function r(p,l,x,I,T){for(;I>x;){if(I-x>600){var P=I-x+1,D=l-x+1,G=Math.log(P),Y=.5*Math.exp(2*G/3),et=.5*Math.sqrt(G*Y*(P-Y)/P)*(D-P/2<0?-1:1),at=Math.max(x,Math.floor(l-D*Y/P+et)),rt=Math.min(I,Math.floor(l+(P-D)*Y/P+et));r(p,l,at,rt,T)}var wt=p[l],xt=x,Gt=I;for(s(p,x,l),T(p[I],wt)>0&&s(p,x,I);xt<Gt;){for(s(p,xt,Gt),xt++,Gt--;T(p[xt],wt)<0;)xt++;for(;T(p[Gt],wt)>0;)Gt--}T(p[x],wt)===0?s(p,x,Gt):(Gt++,s(p,Gt,I)),Gt<=l&&(x=Gt+1),l<=Gt&&(I=Gt-1)}}function s(p,l,x){var I=p[l];p[l]=p[x],p[x]=I}function c(p,l){return p<l?-1:p>l?1:0}return e})})(kb);L0.exports=wm;L0.exports.default=wm;var rS=kb.exports;function wm(n,t){if(!(this instanceof wm))return new wm(n,t);this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}wm.prototype={all:function(){return this._all(this.data,[])},search:function(n){var t=this.data,e=[],r=this.toBBox;if(!J_(n,t))return e;for(var s=[],c,p,l,x;t;){for(c=0,p=t.children.length;c<p;c++)l=t.children[c],x=t.leaf?r(l):l,J_(n,x)&&(t.leaf?e.push(l):Vv(n,x)?this._all(l,e):s.push(l));t=s.pop()}return e},collides:function(n){var t=this.data,e=this.toBBox;if(!J_(n,t))return!1;for(var r=[],s,c,p,l;t;){for(s=0,c=t.children.length;s<c;s++)if(p=t.children[s],l=t.leaf?e(p):p,J_(n,l)){if(t.leaf||Vv(n,l))return!0;r.push(p)}t=r.pop()}return!1},load:function(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(var t=0,e=n.length;t<e;t++)this.insert(n[t]);return this}var r=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var s=this.data;this.data=r,r=s}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(n){return n&&this._insert(n,this.data.height-1),this},clear:function(){return this.data=fd([]),this},remove:function(n,t){if(!n)return this;for(var e=this.data,r=this.toBBox(n),s=[],c=[],p,l,x,I;e||s.length;){if(e||(e=s.pop(),l=s[s.length-1],p=c.pop(),I=!0),e.leaf&&(x=iS(n,e.children,t),x!==-1))return e.children.splice(x,1),s.push(e),this._condense(s),this;!I&&!e.leaf&&Vv(e,r)?(s.push(e),c.push(p),p=0,l=e,e=e.children[0]):l?(p++,e=l.children[p],I=!1):e=null}return this},toBBox:function(n){return n},compareMinX:k1,compareMinY:F1,toJSON:function(){return this.data},fromJSON:function(n){return this.data=n,this},_all:function(n,t){for(var e=[];n;)n.leaf?t.push.apply(t,n.children):e.push.apply(e,n.children),n=e.pop();return t},_build:function(n,t,e,r){var s=e-t+1,c=this._maxEntries,p;if(s<=c)return p=fd(n.slice(t,e+1)),hd(p,this.toBBox),p;r||(r=Math.ceil(Math.log(s)/Math.log(c)),c=Math.ceil(s/Math.pow(c,r-1))),p=fd([]),p.leaf=!1,p.height=r;var l=Math.ceil(s/c),x=l*Math.ceil(Math.sqrt(c)),I,T,P,D;for(B1(n,t,e,x,this.compareMinX),I=t;I<=e;I+=x)for(P=Math.min(I+x-1,e),B1(n,I,P,l,this.compareMinY),T=I;T<=P;T+=l)D=Math.min(T+l-1,P),p.children.push(this._build(n,T,D,r-1));return hd(p,this.toBBox),p},_chooseSubtree:function(n,t,e,r){for(var s,c,p,l,x,I,T,P;r.push(t),!(t.leaf||r.length-1===e);){for(T=P=1/0,s=0,c=t.children.length;s<c;s++)p=t.children[s],x=Uv(p),I=oS(n,p)-x,I<P?(P=I,T=x<T?x:T,l=p):I===P&&x<T&&(T=x,l=p);t=l||t.children[0]}return t},_insert:function(n,t,e){var r=this.toBBox,s=e?n:r(n),c=[],p=this._chooseSubtree(s,this.data,t,c);for(p.children.push(n),rm(p,s);t>=0&&c[t].children.length>this._maxEntries;)this._split(c,t),t--;this._adjustParentBBoxes(s,c,t)},_split:function(n,t){var e=n[t],r=e.children.length,s=this._minEntries;this._chooseSplitAxis(e,s,r);var c=this._chooseSplitIndex(e,s,r),p=fd(e.children.splice(c,e.children.length-c));p.height=e.height,p.leaf=e.leaf,hd(e,this.toBBox),hd(p,this.toBBox),t?n[t-1].children.push(p):this._splitRoot(e,p)},_splitRoot:function(n,t){this.data=fd([n,t]),this.data.height=n.height+1,this.data.leaf=!1,hd(this.data,this.toBBox)},_chooseSplitIndex:function(n,t,e){var r,s,c,p,l,x,I,T;for(x=I=1/0,r=t;r<=e-t;r++)s=nm(n,0,r,this.toBBox),c=nm(n,r,e,this.toBBox),p=sS(s,c),l=Uv(s)+Uv(c),p<x?(x=p,T=r,I=l<I?l:I):p===x&&l<I&&(I=l,T=r);return T},_chooseSplitAxis:function(n,t,e){var r=n.leaf?this.compareMinX:k1,s=n.leaf?this.compareMinY:F1,c=this._allDistMargin(n,t,e,r),p=this._allDistMargin(n,t,e,s);c<p&&n.children.sort(r)},_allDistMargin:function(n,t,e,r){n.children.sort(r);var s=this.toBBox,c=nm(n,0,t,s),p=nm(n,e-t,e,s),l=K_(c)+K_(p),x,I;for(x=t;x<e-t;x++)I=n.children[x],rm(c,n.leaf?s(I):I),l+=K_(c);for(x=e-t-1;x>=t;x--)I=n.children[x],rm(p,n.leaf?s(I):I),l+=K_(p);return l},_adjustParentBBoxes:function(n,t,e){for(var r=e;r>=0;r--)rm(t[r],n)},_condense:function(n){for(var t=n.length-1,e;t>=0;t--)n[t].children.length===0?t>0?(e=n[t-1].children,e.splice(e.indexOf(n[t]),1)):this.clear():hd(n[t],this.toBBox)},_initFormat:function(n){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(n[0])),this.compareMinY=new Function("a","b",t.join(n[1])),this.toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}};function iS(n,t,e){if(!e)return t.indexOf(n);for(var r=0;r<t.length;r++)if(e(n,t[r]))return r;return-1}function hd(n,t){nm(n,0,n.children.length,t,n)}function nm(n,t,e,r,s){s||(s=fd(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var c=t,p;c<e;c++)p=n.children[c],rm(s,n.leaf?r(p):p);return s}function rm(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function k1(n,t){return n.minX-t.minX}function F1(n,t){return n.minY-t.minY}function Uv(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function K_(n){return n.maxX-n.minX+(n.maxY-n.minY)}function oS(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function sS(n,t){var e=Math.max(n.minX,t.minX),r=Math.max(n.minY,t.minY),s=Math.min(n.maxX,t.maxX),c=Math.min(n.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,c-r)}function Vv(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function J_(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function fd(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function B1(n,t,e,r,s){for(var c=[t,e],p;c.length;)e=c.pop(),t=c.pop(),!(e-t<=r)&&(p=t+Math.ceil((e-t)/r/2)*r,rS(n,p,t,e,s),c.push(t,p,p,e))}var aS=function(n,t){for(var e=n[0],r=n[1],s=!1,c=0,p=t.length-1;c<t.length;p=c++){var l=t[c][0],x=t[c][1],I=t[p][0],T=t[p][1],P=x>r!=T>r&&e<(I-l)*(r-x)/(T-x)+l;P&&(s=!s)}return s};function lS(n){for(var t=n[0],e={minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]},r=1;r<n.length;r++){var s=n[r],c=s[0];c<e.minX?e.minX=c:c>e.maxX&&(e.maxX=c);var p=s[1];p<e.minY?e.minY=p:p>e.maxY&&(e.maxY=p)}return e}var uS={getBoundingBox:lS},r0={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,t){(function(){var e,r="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",l="Invalid `variable` option passed into `_.template`",x="__lodash_hash_undefined__",I=500,T="__lodash_placeholder__",P=1,D=2,G=4,Y=1,et=2,at=1,rt=2,wt=4,xt=8,Gt=16,ee=32,$t=64,Zt=128,Mt=256,It=512,Wt=30,ft="...",re=800,Yt=16,Ft=1,Oe=2,Jt=3,$e=1/0,pn=9007199254740991,Cn=17976931348623157e292,_r=0/0,Xn=4294967295,oi=Xn-1,Nr=Xn>>>1,to=[["ary",Zt],["bind",at],["bindKey",rt],["curry",xt],["curryRight",Gt],["flip",It],["partial",ee],["partialRight",$t],["rearg",Mt]],Hr="[object Arguments]",Vi="[object Array]",vs="[object AsyncFunction]",eo="[object Boolean]",es="[object Date]",Ul="[object DOMException]",Fs="[object Error]",Mo="[object Function]",Kr="[object GeneratorFunction]",si="[object Map]",xs="[object Number]",sa="[object Null]",ai="[object Object]",il="[object Promise]",bs="[object Proxy]",Gi="[object RegExp]",Rr="[object Set]",ws="[object String]",ye="[object Symbol]",aa="[object Undefined]",bn="[object WeakMap]",Bs="[object WeakSet]",ns="[object ArrayBuffer]",Bt="[object DataView]",ge="[object Float32Array]",no="[object Float64Array]",Si="[object Int8Array]",Bn="[object Int16Array]",Vn="[object Int32Array]",Qn="[object Uint8Array]",Do="[object Uint8ClampedArray]",dn="[object Uint16Array]",ue="[object Uint32Array]",gn=/\b__p \+= '';/g,tn=/\b(__p \+=) '' \+/g,Ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ro=/&(?:amp|lt|gt|quot|#39);/g,cn=/[&<>"']/g,Is=RegExp(ro.source),rs=RegExp(cn.source),Us=/<%-([\s\S]+?)%>/g,Jr=/<%([\s\S]+?)%>/g,$n=/<%=([\s\S]+?)%>/g,No=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Es=/^\w*$/,Qr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qi=/[\\^$.*+?()[\]{}|]/g,yo=RegExp(qi.source),Ra=/^\s+/,ol=/\s/,Vs=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,$=/\{\n\/\* \[wrapped with (.+)\] \*/,O=/,? & /,B=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,K=/[()=,{}\[\]\/\s]/,tt=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,ht=/^[-+]0x[0-9a-f]+$/i,pt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,Vt=/^0o[0-7]+$/i,te=/^(?:0|[1-9]\d*)$/,zt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ae=/($^)/,we=/['\n\r\u2028\u2029\\]/g,De="\\ud800-\\udfff",ke="\\u0300-\\u036f",Mn="\\ufe20-\\ufe2f",In="\\u20d0-\\u20ff",wn=ke+Mn+In,sn="\\u2700-\\u27bf",an="a-z\\xdf-\\xf6\\xf8-\\xff",zr="\\xac\\xb1\\xd7\\xf7",Lr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",pi="\\u2000-\\u206f",Ti=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Su="A-Z\\xc0-\\xd6\\xd8-\\xde",lt="\\ufe0e\\ufe0f",xe=zr+Lr+pi+Ti,Je="['\u2019]",Un="["+De+"]",Ai="["+xe+"]",di="["+wn+"]",za="\\d+",sl="["+sn+"]",Gs="["+an+"]",io="[^"+De+xe+za+sn+an+Su+"]",qs="\\ud83c[\\udffb-\\udfff]",Ro="(?:"+di+"|"+qs+")",is="[^"+De+"]",al="(?:\\ud83c[\\udde6-\\uddff]){2}",ll="[\\ud800-\\udbff][\\udc00-\\udfff]",la="["+Su+"]",uc="\\u200d",cc="(?:"+Gs+"|"+io+")",hc="(?:"+la+"|"+io+")",fc="(?:"+Je+"(?:d|ll|m|re|s|t|ve))?",Cu="(?:"+Je+"(?:D|LL|M|RE|S|T|VE))?",li=Ro+"?",Tu="["+lt+"]?",ef="(?:"+uc+"(?:"+[is,al,ll].join("|")+")"+Tu+li+")*",up="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cp="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",pc=Tu+li+ef,nf="(?:"+[sl,al,ll].join("|")+")"+pc,$d="(?:"+[is+di+"?",di,al,ll,Un].join("|")+")",tg=RegExp(Je,"g"),rf=RegExp(di,"g"),dc=RegExp(qs+"(?="+qs+")|"+$d+pc,"g"),of=RegExp([la+"?"+Gs+"+"+fc+"(?="+[Ai,la,"$"].join("|")+")",hc+"+"+Cu+"(?="+[Ai,la+cc,"$"].join("|")+")",la+"?"+cc+"+"+fc,la+"+"+Cu,cp,up,za,nf].join("|"),"g"),sf=RegExp("["+uc+De+wn+lt+"]"),hp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],eg=-1,cr={};cr[ge]=cr[no]=cr[Si]=cr[Bn]=cr[Vn]=cr[Qn]=cr[Do]=cr[dn]=cr[ue]=!0,cr[Hr]=cr[Vi]=cr[ns]=cr[eo]=cr[Bt]=cr[es]=cr[Fs]=cr[Mo]=cr[si]=cr[xs]=cr[ai]=cr[Gi]=cr[Rr]=cr[ws]=cr[bn]=!1;var ar={};ar[Hr]=ar[Vi]=ar[ns]=ar[Bt]=ar[eo]=ar[es]=ar[ge]=ar[no]=ar[Si]=ar[Bn]=ar[Vn]=ar[si]=ar[xs]=ar[ai]=ar[Gi]=ar[Rr]=ar[ws]=ar[ye]=ar[Qn]=ar[Do]=ar[dn]=ar[ue]=!0,ar[Fs]=ar[Mo]=ar[bn]=!1;var fp={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},os={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},af={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},eh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nh=parseFloat,lf=parseInt,rh=typeof Uf=="object"&&Uf&&Uf.Object===Object&&Uf,ih=typeof self=="object"&&self&&self.Object===Object&&self,Pi=rh||ih||Function("return this")(),gc=t&&!t.nodeType&&t,ua=gc&&!0&&n&&!n.nodeType&&n,uf=ua&&ua.exports===gc,oh=uf&&rh.process,Xi=function(){try{var Et=ua&&ua.require&&ua.require("util").types;return Et||oh&&oh.binding&&oh.binding("util")}catch{}}(),pp=Xi&&Xi.isArrayBuffer,dp=Xi&&Xi.isDate,gp=Xi&&Xi.isMap,mp=Xi&&Xi.isRegExp,_p=Xi&&Xi.isSet,yp=Xi&&Xi.isTypedArray;function vo(Et,jt,Nt){switch(Nt.length){case 0:return Et.call(jt);case 1:return Et.call(jt,Nt[0]);case 2:return Et.call(jt,Nt[0],Nt[1]);case 3:return Et.call(jt,Nt[0],Nt[1],Nt[2])}return Et.apply(jt,Nt)}function cf(Et,jt,Nt,Fe){for(var mn=-1,rr=Et==null?0:Et.length;++mn<rr;){var gi=Et[mn];jt(Fe,gi,Nt(gi),Et)}return Fe}function Zi(Et,jt){for(var Nt=-1,Fe=Et==null?0:Et.length;++Nt<Fe&&jt(Et[Nt],Nt,Et)!==!1;);return Et}function vp(Et,jt){for(var Nt=Et==null?0:Et.length;Nt--&&jt(Et[Nt],Nt,Et)!==!1;);return Et}function hf(Et,jt){for(var Nt=-1,Fe=Et==null?0:Et.length;++Nt<Fe;)if(!jt(Et[Nt],Nt,Et))return!1;return!0}function ca(Et,jt){for(var Nt=-1,Fe=Et==null?0:Et.length,mn=0,rr=[];++Nt<Fe;){var gi=Et[Nt];jt(gi,Nt,Et)&&(rr[mn++]=gi)}return rr}function ha(Et,jt){var Nt=Et==null?0:Et.length;return!!Nt&&Oa(Et,jt,0)>-1}function sh(Et,jt,Nt){for(var Fe=-1,mn=Et==null?0:Et.length;++Fe<mn;)if(Nt(jt,Et[Fe]))return!0;return!1}function lr(Et,jt){for(var Nt=-1,Fe=Et==null?0:Et.length,mn=Array(Fe);++Nt<Fe;)mn[Nt]=jt(Et[Nt],Nt,Et);return mn}function ss(Et,jt){for(var Nt=-1,Fe=jt.length,mn=Et.length;++Nt<Fe;)Et[mn+Nt]=jt[Nt];return Et}function ah(Et,jt,Nt,Fe){var mn=-1,rr=Et==null?0:Et.length;for(Fe&&rr&&(Nt=Et[++mn]);++mn<rr;)Nt=jt(Nt,Et[mn],mn,Et);return Nt}function ff(Et,jt,Nt,Fe){var mn=Et==null?0:Et.length;for(Fe&&mn&&(Nt=Et[--mn]);mn--;)Nt=jt(Nt,Et[mn],mn,Et);return Nt}function ln(Et,jt){for(var Nt=-1,Fe=Et==null?0:Et.length;++Nt<Fe;)if(jt(Et[Nt],Nt,Et))return!0;return!1}var lh=Au("length");function nr(Et){return Et.split("")}function uh(Et){return Et.match(B)||[]}function wr(Et,jt,Nt){var Fe;return Nt(Et,function(mn,rr,gi){if(jt(mn,rr,gi))return Fe=rr,!1}),Fe}function Er(Et,jt,Nt,Fe){for(var mn=Et.length,rr=Nt+(Fe?1:-1);Fe?rr--:++rr<mn;)if(jt(Et[rr],rr,Et))return rr;return-1}function Oa(Et,jt,Nt){return jt===jt?Ip(Et,jt,Nt):Er(Et,xp,Nt)}function pf(Et,jt,Nt,Fe){for(var mn=Nt-1,rr=Et.length;++mn<rr;)if(Fe(Et[mn],jt))return mn;return-1}function xp(Et){return Et!==Et}function ch(Et,jt){var Nt=Et==null?0:Et.length;return Nt?_c(Et,jt)/Nt:_r}function Au(Et){return function(jt){return jt==null?e:jt[Et]}}function Pu(Et){return function(jt){return Et==null?e:Et[jt]}}function mc(Et,jt,Nt,Fe,mn){return mn(Et,function(rr,gi,Yn){Nt=Fe?(Fe=!1,rr):jt(Nt,rr,gi,Yn)}),Nt}function hh(Et,jt){var Nt=Et.length;for(Et.sort(jt);Nt--;)Et[Nt]=Et[Nt].value;return Et}function _c(Et,jt){for(var Nt,Fe=-1,mn=Et.length;++Fe<mn;){var rr=jt(Et[Fe]);rr!==e&&(Nt=Nt===e?rr:Nt+rr)}return Nt}function ul(Et,jt){for(var Nt=-1,Fe=Array(Et);++Nt<Et;)Fe[Nt]=jt(Nt);return Fe}function fh(Et,jt){return lr(jt,function(Nt){return[Nt,Et[Nt]]})}function Ss(Et){return Et&&Et.slice(0,mf(Et)+1).replace(Ra,"")}function zo(Et){return function(jt){return Et(jt)}}function ph(Et,jt){return lr(jt,function(Nt){return Et[Nt]})}function Lu(Et,jt){return Et.has(jt)}function Vl(Et,jt){for(var Nt=-1,Fe=Et.length;++Nt<Fe&&Oa(jt,Et[Nt],0)>-1;);return Nt}function yc(Et,jt){for(var Nt=Et.length;Nt--&&Oa(jt,Et[Nt],0)>-1;);return Nt}function df(Et,jt){for(var Nt=Et.length,Fe=0;Nt--;)Et[Nt]===jt&&++Fe;return Fe}var bp=Pu(fp),dh=Pu(os);function gh(Et){return"\\"+eh[Et]}function wp(Et,jt){return Et==null?e:Et[jt]}function fa(Et){return sf.test(Et)}function gf(Et){return hp.test(Et)}function mh(Et){for(var jt,Nt=[];!(jt=Et.next()).done;)Nt.push(jt.value);return Nt}function Mu(Et){var jt=-1,Nt=Array(Et.size);return Et.forEach(function(Fe,mn){Nt[++jt]=[mn,Fe]}),Nt}function Gl(Et,jt){return function(Nt){return Et(jt(Nt))}}function Cs(Et,jt){for(var Nt=-1,Fe=Et.length,mn=0,rr=[];++Nt<Fe;){var gi=Et[Nt];(gi===jt||gi===T)&&(Et[Nt]=T,rr[mn++]=Nt)}return rr}function vc(Et){var jt=-1,Nt=Array(Et.size);return Et.forEach(function(Fe){Nt[++jt]=Fe}),Nt}function xc(Et){var jt=-1,Nt=Array(Et.size);return Et.forEach(function(Fe){Nt[++jt]=[Fe,Fe]}),Nt}function Ip(Et,jt,Nt){for(var Fe=Nt-1,mn=Et.length;++Fe<mn;)if(Et[Fe]===jt)return Fe;return-1}function Ep(Et,jt,Nt){for(var Fe=Nt+1;Fe--;)if(Et[Fe]===jt)return Fe;return Fe}function ql(Et){return fa(Et)?wc(Et):lh(Et)}function oo(Et){return fa(Et)?as(Et):nr(Et)}function mf(Et){for(var jt=Et.length;jt--&&ol.test(Et.charAt(jt)););return jt}var bc=Pu(af);function wc(Et){for(var jt=dc.lastIndex=0;dc.test(Et);)++jt;return jt}function as(Et){return Et.match(dc)||[]}function Oo(Et){return Et.match(of)||[]}var ng=function Et(jt){jt=jt==null?Pi:Ts.defaults(Pi.Object(),jt,Ts.pick(Pi,Zn));var Nt=jt.Array,Fe=jt.Date,mn=jt.Error,rr=jt.Function,gi=jt.Math,Yn=jt.Object,cl=jt.RegExp,Ne=jt.String,ko=jt.TypeError,hl=Nt.prototype,Xl=rr.prototype,pa=Yn.prototype,be=jt["__core-js_shared__"],Du=Xl.toString,ur=pa.hasOwnProperty,rg=0,Nu=function(){var f=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),Ic=pa.toString,Sp=Du.call(Yn),ig=Pi._,og=cl("^"+Du.call(ur).replace(qi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zl=uf?jt.Buffer:e,da=jt.Symbol,Ru=jt.Uint8Array,_h=Zl?Zl.allocUnsafe:e,Yi=Gl(Yn.getPrototypeOf,Yn),ka=Yn.create,_f=pa.propertyIsEnumerable,zu=hl.splice,Yl=da?da.isConcatSpreadable:e,Wl=da?da.iterator:e,ga=da?da.toStringTag:e,xo=function(){try{var f=Nc(Yn,"defineProperty");return f({},"",{}),f}catch{}}(),Sr=jt.clearTimeout!==Pi.clearTimeout&&jt.clearTimeout,yh=Fe&&Fe.now!==Pi.Date.now&&Fe.now,vh=jt.setTimeout!==Pi.setTimeout&&jt.setTimeout,Ou=gi.ceil,Ec=gi.floor,xh=Yn.getOwnPropertySymbols,sg=Zl?Zl.isBuffer:e,Xs=jt.isFinite,bh=hl.join,Be=Gl(Yn.keys,Yn),Le=gi.max,mi=gi.min,Sc=Fe.now,yf=jt.parseInt,_i=gi.random,jl=hl.reverse,so=Nc(jt,"DataView"),Cc=Nc(jt,"Map"),Hl=Nc(jt,"Promise"),ir=Nc(jt,"Set"),Or=Nc(jt,"WeakMap"),ku=Nc(Yn,"create"),Fa=Or&&new Or,ma={},y=Zu(so),o=Zu(Cc),h=Zu(Hl),m=Zu(ir),v=Zu(Or),E=da?da.prototype:e,L=E?E.valueOf:e,N=E?E.toString:e;function C(f){if(ti(f)&&!je(f)&&!(f instanceof W)){if(f instanceof Z)return f;if(ur.call(f,"__wrapped__"))return Mg(f)}return new Z(f)}var k=function(){function f(){}return function(g){if(!Vr(g))return{};if(ka)return ka(g);f.prototype=g;var S=new f;return f.prototype=e,S}}();function V(){}function Z(f,g){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=e}C.templateSettings={escape:Us,evaluate:Jr,interpolate:$n,variable:"",imports:{_:C}},C.prototype=V.prototype,C.prototype.constructor=C,Z.prototype=k(V.prototype),Z.prototype.constructor=Z;function W(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Xn,this.__views__=[]}function ot(){var f=new W(this.__wrapped__);return f.__actions__=Go(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=Go(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=Go(this.__views__),f}function J(){if(this.__filtered__){var f=new W(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function it(){var f=this.__wrapped__.value(),g=this.__dir__,S=je(f),R=g<0,q=S?f.length:0,Q=s_(0,q,this.__views__),st=Q.start,_t=Q.end,At=_t-st,ie=R?_t:st-1,oe=this.__iteratees__,fe=oe.length,ze=0,Ke=mi(At,this.__takeCount__);if(!S||!R&&q==At&&Ke==At)return If(f,this.__actions__);var _n=[];t:for(;At--&&ze<Ke;){ie+=g;for(var kn=-1,yn=f[ie];++kn<fe;){var Wn=oe[kn],or=Wn.iteratee,Ga=Wn.type,Js=or(yn);if(Ga==Oe)yn=Js;else if(!Js){if(Ga==Ft)continue t;break t}}_n[ze++]=yn}return _n}W.prototype=k(V.prototype),W.prototype.constructor=W;function mt(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var R=f[g];this.set(R[0],R[1])}}function yt(){this.__data__=ku?ku(null):{},this.size=0}function Tt(f){var g=this.has(f)&&delete this.__data__[f];return this.size-=g?1:0,g}function bt(f){var g=this.__data__;if(ku){var S=g[f];return S===x?e:S}return ur.call(g,f)?g[f]:e}function Kt(f){var g=this.__data__;return ku?g[f]!==e:ur.call(g,f)}function Ut(f,g){var S=this.__data__;return this.size+=this.has(f)?0:1,S[f]=ku&&g===e?x:g,this}mt.prototype.clear=yt,mt.prototype.delete=Tt,mt.prototype.get=bt,mt.prototype.has=Kt,mt.prototype.set=Ut;function kt(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var R=f[g];this.set(R[0],R[1])}}function se(){this.__data__=[],this.size=0}function me(f){var g=this.__data__,S=gr(g,f);if(S<0)return!1;var R=g.length-1;return S==R?g.pop():zu.call(g,S,1),--this.size,!0}function Ht(f){var g=this.__data__,S=gr(g,f);return S<0?e:g[S][1]}function Re(f){return gr(this.__data__,f)>-1}function Ie(f,g){var S=this.__data__,R=gr(S,f);return R<0?(++this.size,S.push([f,g])):S[R][1]=g,this}kt.prototype.clear=se,kt.prototype.delete=me,kt.prototype.get=Ht,kt.prototype.has=Re,kt.prototype.set=Ie;function We(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var R=f[g];this.set(R[0],R[1])}}function Nn(){this.size=0,this.__data__={hash:new mt,map:new(Cc||kt),string:new mt}}function En(f){var g=Af(this,f).delete(f);return this.size-=g?1:0,g}function Dn(f){return Af(this,f).get(f)}function kr(f){return Af(this,f).has(f)}function hn(f,g){var S=Af(this,f),R=S.size;return S.set(f,g),this.size+=S.size==R?0:1,this}We.prototype.clear=Nn,We.prototype.delete=En,We.prototype.get=Dn,We.prototype.has=kr,We.prototype.set=hn;function Tn(f){var g=-1,S=f==null?0:f.length;for(this.__data__=new We;++g<S;)this.add(f[g])}function hr(f){return this.__data__.set(f,x),this}function Wi(f){return this.__data__.has(f)}Tn.prototype.add=Tn.prototype.push=hr,Tn.prototype.has=Wi;function Fr(f){var g=this.__data__=new kt(f);this.size=g.size}function As(){this.__data__=new kt,this.size=0}function Ps(f){var g=this.__data__,S=g.delete(f);return this.size=g.size,S}function fl(f){return this.__data__.get(f)}function Fo(f){return this.__data__.has(f)}function _a(f,g){var S=this.__data__;if(S instanceof kt){var R=S.__data__;if(!Cc||R.length<s-1)return R.push([f,g]),this.size=++S.size,this;S=this.__data__=new We(R)}return S.set(f,g),this.size=S.size,this}Fr.prototype.clear=As,Fr.prototype.delete=Ps,Fr.prototype.get=fl,Fr.prototype.has=Fo,Fr.prototype.set=_a;function pl(f,g){var S=je(f),R=!S&&Ui(f),q=!S&&!R&&Xo(f),Q=!S&&!R&&!q&&xl(f),st=S||R||q||Q,_t=st?ul(f.length,Ne):[],At=_t.length;for(var ie in f)(g||ur.call(f,ie))&&!(st&&(ie=="length"||q&&(ie=="offset"||ie=="parent")||Q&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||yl(ie,At)))&&_t.push(ie);return _t}function Bo(f){var g=f.length;return g?f[Mp(0,g-1)]:e}function Gn(f,g){return Oc(Go(f),dl(g,0,f.length))}function tr(f){return Oc(Go(f))}function $r(f,g,S){(S!==e&&!qn(f[g],S)||S===e&&!(g in f))&&Ys(f,g,S)}function Li(f,g,S){var R=f[g];(!(ur.call(f,g)&&qn(R,S))||S===e&&!(g in f))&&Ys(f,g,S)}function gr(f,g){for(var S=f.length;S--;)if(qn(f[S][0],g))return S;return-1}function Kl(f,g,S,R){return Ql(f,function(q,Q,st){g(R,q,S(q),st)}),R}function Zs(f,g){return f&&_l(g,Zo(g),f)}function wh(f,g){return f&&_l(g,Ia(g),f)}function Ys(f,g,S){g=="__proto__"&&xo?xo(f,g,{configurable:!0,enumerable:!0,value:S,writable:!0}):f[g]=S}function Fu(f,g){for(var S=-1,R=g.length,q=Nt(R),Q=f==null;++S<R;)q[S]=Q?e:Cv(f,g[S]);return q}function dl(f,g,S){return f===f&&(S!==e&&(f=f<=S?f:S),g!==e&&(f=f>=g?f:g)),f}function ki(f,g,S,R,q,Q){var st,_t=g&P,At=g&D,ie=g&G;if(S&&(st=q?S(f,R,q,Q):S(f)),st!==e)return st;if(!Vr(f))return f;var oe=je(f);if(oe){if(st=Cg(f),!_t)return Go(f,st)}else{var fe=bo(f),ze=fe==Mo||fe==Kr;if(Xo(f))return Op(f,_t);if(fe==ai||fe==Hr||ze&&!q){if(st=At||ze?{}:Tg(f),!_t)return At?jy(f,wh(st,f)):Wy(f,Zs(st,f))}else{if(!ar[fe])return q?f:{};st=a_(f,fe,_t)}}Q||(Q=new Fr);var Ke=Q.get(f);if(Ke)return Ke;Q.set(f,st),Kg(f)?f.forEach(function(yn){st.add(ki(yn,g,S,yn,f,Q))}):Hg(f)&&f.forEach(function(yn,Wn){st.set(Wn,ki(yn,g,S,Wn,f,Q))});var _n=ie?At?Yp:Zp:At?Ia:Zo,kn=oe?e:_n(f);return Zi(kn||f,function(yn,Wn){kn&&(Wn=yn,yn=f[Wn]),Li(st,Wn,ki(yn,g,S,Wn,f,Q))}),st}function Ih(f){var g=Zo(f);return function(S){return Ws(S,f,g)}}function Ws(f,g,S){var R=S.length;if(f==null)return!R;for(f=Yn(f);R--;){var q=S[R],Q=g[q],st=f[q];if(st===e&&!(q in f)||!Q(st))return!1}return!0}function Jl(f,g,S){if(typeof f!="function")throw new ko(p);return Xu(function(){f.apply(e,S)},g)}function Eh(f,g,S,R){var q=-1,Q=ha,st=!0,_t=f.length,At=[],ie=g.length;if(!_t)return At;S&&(g=lr(g,zo(S))),R?(Q=sh,st=!1):g.length>=s&&(Q=Lu,st=!1,g=new Tn(g));t:for(;++q<_t;){var oe=f[q],fe=S==null?oe:S(oe);if(oe=R||oe!==0?oe:0,st&&fe===fe){for(var ze=ie;ze--;)if(g[ze]===fe)continue t;At.push(oe)}else Q(g,fe,R)||At.push(oe)}return At}var Ql=Wm(Uo),Dm=Wm(ug,!0);function ag(f,g){var S=!0;return Ql(f,function(R,q,Q){return S=!!g(R,q,Q),S}),S}function Bu(f,g,S){for(var R=-1,q=f.length;++R<q;){var Q=f[R],st=g(Q);if(st!=null&&(_t===e?st===st&&!bi(st):S(st,_t)))var _t=st,At=Q}return At}function Sh(f,g,S,R){var q=f.length;for(S=zn(S),S<0&&(S=-S>q?0:q+S),R=R===e||R>q?q:zn(R),R<0&&(R+=q),R=S>R?0:D0(R);S<R;)f[S++]=g;return f}function gl(f,g){var S=[];return Ql(f,function(R,q,Q){g(R,q,Q)&&S.push(R)}),S}function Cr(f,g,S,R,q){var Q=-1,st=f.length;for(S||(S=Rh),q||(q=[]);++Q<st;){var _t=f[Q];g>0&&S(_t)?g>1?Cr(_t,g-1,S,R,q):ss(q,_t):R||(q[q.length]=_t)}return q}var ml=bg(),lg=bg(!0);function Uo(f,g){return f&&ml(f,g,Zo)}function ug(f,g){return f&&lg(f,g,Zo)}function vf(f,g){return ca(g,function(S){return Va(f[S])})}function Tr(f,g){g=eu(g,f);for(var S=0,R=g.length;f!=null&&S<R;)f=f[Ba(g[S++])];return S&&S==R?f:e}function Cp(f,g,S){var R=g(f);return je(f)?R:ss(R,S(f))}function Vo(f){return f==null?f===e?aa:sa:ga&&ga in Yn(f)?Pf(f):$y(f)}function $l(f,g){return f>g}function Tc(f,g){return f!=null&&ur.call(f,g)}function Tp(f,g){return f!=null&&g in Yn(f)}function cg(f,g,S){return f>=mi(g,S)&&f<Le(g,S)}function Ap(f,g,S){for(var R=S?sh:ha,q=f[0].length,Q=f.length,st=Q,_t=Nt(Q),At=1/0,ie=[];st--;){var oe=f[st];st&&g&&(oe=lr(oe,zo(g))),At=mi(oe.length,At),_t[st]=!S&&(g||q>=120&&oe.length>=120)?new Tn(st&&oe):e}oe=f[0];var fe=-1,ze=_t[0];t:for(;++fe<q&&ie.length<At;){var Ke=oe[fe],_n=g?g(Ke):Ke;if(Ke=S||Ke!==0?Ke:0,!(ze?Lu(ze,_n):R(ie,_n,S))){for(st=Q;--st;){var kn=_t[st];if(!(kn?Lu(kn,_n):R(f[st],_n,S)))continue t}ze&&ze.push(_n),ie.push(Ke)}}return ie}function Uy(f,g,S,R){return Uo(f,function(q,Q,st){g(R,S(q),Q,st)}),R}function Ch(f,g,S){g=eu(g,f),f=f_(f,g);var R=f==null?f:f[Ba(xa(g))];return R==null?e:vo(R,f,S)}function Nm(f){return ti(f)&&Vo(f)==Hr}function hg(f){return ti(f)&&Vo(f)==ns}function Vy(f){return ti(f)&&Vo(f)==es}function Ac(f,g,S,R,q){return f===g?!0:f==null||g==null||!ti(f)&&!ti(g)?f!==f&&g!==g:Rm(f,g,S,R,Ac,q)}function Rm(f,g,S,R,q,Q){var st=je(f),_t=je(g),At=st?Vi:bo(f),ie=_t?Vi:bo(g);At=At==Hr?ai:At,ie=ie==Hr?ai:ie;var oe=At==ai,fe=ie==ai,ze=At==ie;if(ze&&Xo(f)){if(!Xo(g))return!1;st=!0,oe=!1}if(ze&&!oe)return Q||(Q=new Fr),st||xl(f)?i_(f,g,S,R,q,Q):o_(f,g,At,S,R,q,Q);if(!(S&Y)){var Ke=oe&&ur.call(f,"__wrapped__"),_n=fe&&ur.call(g,"__wrapped__");if(Ke||_n){var kn=Ke?f.value():f,yn=_n?g.value():g;return Q||(Q=new Fr),q(kn,yn,S,R,Q)}}return ze?(Q||(Q=new Fr),Eg(f,g,S,R,q,Q)):!1}function zm(f){return ti(f)&&bo(f)==si}function Uu(f,g,S,R){var q=S.length,Q=q,st=!R;if(f==null)return!Q;for(f=Yn(f);q--;){var _t=S[q];if(st&&_t[2]?_t[1]!==f[_t[0]]:!(_t[0]in f))return!1}for(;++q<Q;){_t=S[q];var At=_t[0],ie=f[At],oe=_t[1];if(st&&_t[2]){if(ie===e&&!(At in f))return!1}else{var fe=new Fr;if(R)var ze=R(ie,oe,At,f,g,fe);if(!(ze===e?Ac(oe,ie,Y|et,R,fe):ze))return!1}}return!0}function Om(f){if(!Vr(f)||Jy(f))return!1;var g=Va(f)?og:gt;return g.test(Zu(f))}function xf(f){return ti(f)&&Vo(f)==Gi}function Pp(f){return ti(f)&&bo(f)==Rr}function Lp(f){return ti(f)&&kf(f.length)&&!!cr[Vo(f)]}function km(f){return typeof f=="function"?f:f==null?Ea:typeof f=="object"?je(f)?Fm(f[0],f[1]):Ah(f):q0(f)}function fg(f){if(!Lf(f))return Be(f);var g=[];for(var S in Yn(f))ur.call(f,S)&&S!="constructor"&&g.push(S);return g}function Th(f){if(!Vr(f))return c_(f);var g=Lf(f),S=[];for(var R in f)R=="constructor"&&(g||!ur.call(f,R))||S.push(R);return S}function bf(f,g){return f<g}function pg(f,g){var S=-1,R=Ur(f)?Nt(f.length):[];return Ql(f,function(q,Q,st){R[++S]=g(q,Q,st)}),R}function Ah(f){var g=Sg(f);return g.length==1&&g[0][2]?u_(g[0][0],g[0][1]):function(S){return S===f||Uu(S,f,g)}}function Fm(f,g){return Ag(f)&&l_(g)?u_(Ba(f),g):function(S){var R=Cv(S,f);return R===e&&R===g?Tv(S,f):Ac(g,R,Y|et)}}function Pc(f,g,S,R,q){f!==g&&ml(g,function(Q,st){if(q||(q=new Fr),Vr(Q))Bm(f,g,st,S,Pc,R,q);else{var _t=R?R(Mf(f,st),Q,st+"",f,g,q):e;_t===e&&(_t=Q),$r(f,st,_t)}},Ia)}function Bm(f,g,S,R,q,Q,st){var _t=Mf(f,S),At=Mf(g,S),ie=st.get(At);if(ie){$r(f,S,ie);return}var oe=Q?Q(_t,At,S+"",f,g,st):e,fe=oe===e;if(fe){var ze=je(At),Ke=!ze&&Xo(At),_n=!ze&&!Ke&&xl(At);oe=At,ze||Ke||_n?je(_t)?oe=_t:pr(_t)?oe=Go(_t):Ke?(fe=!1,oe=Op(At,!0)):_n?(fe=!1,oe=Ym(At,!0)):oe=[]:Ff(At)||Ui(At)?(oe=_t,Ui(_t)?oe=N0(_t):(!Vr(_t)||Va(_t))&&(oe=Tg(At))):fe=!1}fe&&(st.set(At,oe),q(oe,At,R,Q,st),st.delete(At)),$r(f,S,oe)}function dg(f,g){var S=f.length;if(!!S)return g+=g<0?S:0,yl(g,S)?f[g]:e}function Um(f,g,S){g.length?g=lr(g,function(Q){return je(Q)?function(st){return Tr(st,Q.length===1?Q[0]:Q)}:Q}):g=[Ea];var R=-1;g=lr(g,zo(un()));var q=pg(f,function(Q,st,_t){var At=lr(g,function(ie){return ie(Q)});return{criteria:At,index:++R,value:Q}});return hh(q,function(Q,st){return Yy(Q,st,S)})}function gg(f,g){return mg(f,g,function(S,R){return Tv(f,R)})}function mg(f,g,S){for(var R=-1,q=g.length,Q={};++R<q;){var st=g[R],_t=Tr(f,st);S(_t,st)&&Ph(Q,eu(st,f),_t)}return Q}function _g(f){return function(g){return Tr(g,f)}}function Lc(f,g,S,R){var q=R?pf:Oa,Q=-1,st=g.length,_t=f;for(f===g&&(g=Go(g)),S&&(_t=lr(f,zo(S)));++Q<st;)for(var At=0,ie=g[Q],oe=S?S(ie):ie;(At=q(_t,oe,At,R))>-1;)_t!==f&&zu.call(_t,At,1),zu.call(f,At,1);return f}function Ls(f,g){for(var S=f?g.length:0,R=S-1;S--;){var q=g[S];if(S==R||q!==Q){var Q=q;yl(q)?zu.call(f,q,1):Gu(f,q)}}return f}function Mp(f,g){return f+Ec(_i()*(g-f+1))}function Gy(f,g,S,R){for(var q=-1,Q=Le(Ou((g-f)/(S||1)),0),st=Nt(Q);Q--;)st[R?Q:++q]=f,f+=S;return st}function yg(f,g){var S="";if(!f||g<1||g>pn)return S;do g%2&&(S+=f),g=Ec(g/2),g&&(f+=f);while(g);return S}function Rn(f,g){return Rc(h_(f,g,Ea),f+"")}function vg(f){return Bo(cd(f))}function Dp(f,g){var S=cd(f);return Oc(S,dl(g,0,S.length))}function Ph(f,g,S,R){if(!Vr(f))return f;g=eu(g,f);for(var q=-1,Q=g.length,st=Q-1,_t=f;_t!=null&&++q<Q;){var At=Ba(g[q]),ie=S;if(At==="__proto__"||At==="constructor"||At==="prototype")return f;if(q!=st){var oe=_t[At];ie=R?R(oe,At,_t):e,ie===e&&(ie=Vr(oe)?oe:yl(g[q+1])?[]:{})}Li(_t,At,ie),_t=_t[At]}return f}var tu=Fa?function(f,g){return Fa.set(f,g),f}:Ea,wf=xo?function(f,g){return xo(f,"toString",{configurable:!0,enumerable:!1,value:Pv(g),writable:!0})}:Ea;function qy(f){return Oc(cd(f))}function ya(f,g,S){var R=-1,q=f.length;g<0&&(g=-g>q?0:q+g),S=S>q?q:S,S<0&&(S+=q),q=g>S?0:S-g>>>0,g>>>=0;for(var Q=Nt(q);++R<q;)Q[R]=f[R+g];return Q}function Xy(f,g){var S;return Ql(f,function(R,q,Q){return S=g(R,q,Q),!S}),!!S}function Np(f,g,S){var R=0,q=f==null?R:f.length;if(typeof g=="number"&&g===g&&q<=Nr){for(;R<q;){var Q=R+q>>>1,st=f[Q];st!==null&&!bi(st)&&(S?st<=g:st<g)?R=Q+1:q=Q}return q}return xg(f,g,Ea,S)}function xg(f,g,S,R){var q=0,Q=f==null?0:f.length;if(Q===0)return 0;g=S(g);for(var st=g!==g,_t=g===null,At=bi(g),ie=g===e;q<Q;){var oe=Ec((q+Q)/2),fe=S(f[oe]),ze=fe!==e,Ke=fe===null,_n=fe===fe,kn=bi(fe);if(st)var yn=R||_n;else ie?yn=_n&&(R||ze):_t?yn=_n&&ze&&(R||!Ke):At?yn=_n&&ze&&!Ke&&(R||!kn):Ke||kn?yn=!1:yn=R?fe<=g:fe<g;yn?q=oe+1:Q=oe}return mi(Q,oi)}function Vm(f,g){for(var S=-1,R=f.length,q=0,Q=[];++S<R;){var st=f[S],_t=g?g(st):st;if(!S||!qn(_t,At)){var At=_t;Q[q++]=st===0?0:st}}return Q}function Gm(f){return typeof f=="number"?f:bi(f)?_r:+f}function ls(f){if(typeof f=="string")return f;if(je(f))return lr(f,ls)+"";if(bi(f))return N?N.call(f):"";var g=f+"";return g=="0"&&1/f==-$e?"-0":g}function Vu(f,g,S){var R=-1,q=ha,Q=f.length,st=!0,_t=[],At=_t;if(S)st=!1,q=sh;else if(Q>=s){var ie=g?null:t_(f);if(ie)return vc(ie);st=!1,q=Lu,At=new Tn}else At=g?[]:_t;t:for(;++R<Q;){var oe=f[R],fe=g?g(oe):oe;if(oe=S||oe!==0?oe:0,st&&fe===fe){for(var ze=At.length;ze--;)if(At[ze]===fe)continue t;g&&At.push(fe),_t.push(oe)}else q(At,fe,S)||(At!==_t&&At.push(fe),_t.push(oe))}return _t}function Gu(f,g){return g=eu(g,f),f=f_(f,g),f==null||delete f[Ba(xa(g))]}function qm(f,g,S,R){return Ph(f,g,S(Tr(f,g)),R)}function Mr(f,g,S,R){for(var q=f.length,Q=R?q:-1;(R?Q--:++Q<q)&&g(f[Q],Q,f););return S?ya(f,R?0:Q,R?Q+1:q):ya(f,R?Q+1:0,R?q:Q)}function If(f,g){var S=f;return S instanceof W&&(S=S.value()),ah(g,function(R,q){return q.func.apply(q.thisArg,ss([R],q.args))},S)}function Rp(f,g,S){var R=f.length;if(R<2)return R?Vu(f[0]):[];for(var q=-1,Q=Nt(R);++q<R;)for(var st=f[q],_t=-1;++_t<R;)_t!=q&&(Q[q]=Eh(Q[q]||st,f[_t],g,S));return Vu(Cr(Q,1),g,S)}function Ef(f,g,S){for(var R=-1,q=f.length,Q=g.length,st={};++R<q;){var _t=R<Q?g[R]:e;S(st,f[R],_t)}return st}function Lh(f){return pr(f)?f:[]}function Mc(f){return typeof f=="function"?f:Ea}function eu(f,g){return je(f)?f:Ag(f,g)?[f]:d_(Ir(f))}var Xm=Rn;function va(f,g,S){var R=f.length;return S=S===e?R:S,!g&&S>=R?f:ya(f,g,S)}var zp=Sr||function(f){return Pi.clearTimeout(f)};function Op(f,g){if(g)return f.slice();var S=f.length,R=_h?_h(S):new f.constructor(S);return f.copy(R),R}function kp(f){var g=new f.constructor(f.byteLength);return new Ru(g).set(new Ru(f)),g}function Zy(f,g){var S=g?kp(f.buffer):f.buffer;return new f.constructor(S,f.byteOffset,f.byteLength)}function Zm(f){var g=new f.constructor(f.source,dt.exec(f));return g.lastIndex=f.lastIndex,g}function Sf(f){return L?Yn(L.call(f)):{}}function Ym(f,g){var S=g?kp(f.buffer):f.buffer;return new f.constructor(S,f.byteOffset,f.length)}function Fp(f,g){if(f!==g){var S=f!==e,R=f===null,q=f===f,Q=bi(f),st=g!==e,_t=g===null,At=g===g,ie=bi(g);if(!_t&&!ie&&!Q&&f>g||Q&&st&&At&&!_t&&!ie||R&&st&&At||!S&&At||!q)return 1;if(!R&&!Q&&!ie&&f<g||ie&&S&&q&&!R&&!Q||_t&&S&&q||!st&&q||!At)return-1}return 0}function Yy(f,g,S){for(var R=-1,q=f.criteria,Q=g.criteria,st=q.length,_t=S.length;++R<st;){var At=Fp(q[R],Q[R]);if(At){if(R>=_t)return At;var ie=S[R];return At*(ie=="desc"?-1:1)}}return f.index-g.index}function Bp(f,g,S,R){for(var q=-1,Q=f.length,st=S.length,_t=-1,At=g.length,ie=Le(Q-st,0),oe=Nt(At+ie),fe=!R;++_t<At;)oe[_t]=g[_t];for(;++q<st;)(fe||q<Q)&&(oe[S[q]]=f[q]);for(;ie--;)oe[_t++]=f[q++];return oe}function Up(f,g,S,R){for(var q=-1,Q=f.length,st=-1,_t=S.length,At=-1,ie=g.length,oe=Le(Q-_t,0),fe=Nt(oe+ie),ze=!R;++q<oe;)fe[q]=f[q];for(var Ke=q;++At<ie;)fe[Ke+At]=g[At];for(;++st<_t;)(ze||q<Q)&&(fe[Ke+S[st]]=f[q++]);return fe}function Go(f,g){var S=-1,R=f.length;for(g||(g=Nt(R));++S<R;)g[S]=f[S];return g}function _l(f,g,S,R){var q=!S;S||(S={});for(var Q=-1,st=g.length;++Q<st;){var _t=g[Q],At=R?R(S[_t],f[_t],_t,S,f):e;At===e&&(At=f[_t]),q?Ys(S,_t,At):Li(S,_t,At)}return S}function Wy(f,g){return _l(f,Mi(f),g)}function jy(f,g){return _l(f,Hp(f),g)}function Vp(f,g){return function(S,R){var q=je(S)?cf:Kl,Q=g?g():{};return q(S,f,un(R,2),Q)}}function js(f){return Rn(function(g,S){var R=-1,q=S.length,Q=q>1?S[q-1]:e,st=q>2?S[2]:e;for(Q=f.length>3&&typeof Q=="function"?(q--,Q):e,st&&us(S[0],S[1],st)&&(Q=q<3?e:Q,q=1),g=Yn(g);++R<q;){var _t=S[R];_t&&f(g,_t,R,Q)}return g})}function Wm(f,g){return function(S,R){if(S==null)return S;if(!Ur(S))return f(S,R);for(var q=S.length,Q=g?q:-1,st=Yn(S);(g?Q--:++Q<q)&&R(st[Q],Q,st)!==!1;);return S}}function bg(f){return function(g,S,R){for(var q=-1,Q=Yn(g),st=R(g),_t=st.length;_t--;){var At=st[f?_t:++q];if(S(Q[At],At,Q)===!1)break}return g}}function Mh(f,g,S){var R=g&at,q=Cf(f);function Q(){var st=this&&this!==Pi&&this instanceof Q?q:f;return st.apply(R?S:this,arguments)}return Q}function jm(f){return function(g){g=Ir(g);var S=fa(g)?oo(g):e,R=S?S[0]:g.charAt(0),q=S?va(S,1).join(""):g.slice(1);return R[f]()+q}}function Dh(f){return function(g){return ah(V0(U0(g).replace(tg,"")),f,"")}}function Cf(f){return function(){var g=arguments;switch(g.length){case 0:return new f;case 1:return new f(g[0]);case 2:return new f(g[0],g[1]);case 3:return new f(g[0],g[1],g[2]);case 4:return new f(g[0],g[1],g[2],g[3]);case 5:return new f(g[0],g[1],g[2],g[3],g[4]);case 6:return new f(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new f(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var S=k(f.prototype),R=f.apply(S,g);return Vr(R)?R:S}}function Hm(f,g,S){var R=Cf(f);function q(){for(var Q=arguments.length,st=Nt(Q),_t=Q,At=Nh(q);_t--;)st[_t]=arguments[_t];var ie=Q<3&&st[0]!==At&&st[Q-1]!==At?[]:Cs(st,At);if(Q-=ie.length,Q<S)return $m(f,g,Gp,q.placeholder,e,st,ie,e,e,S-Q);var oe=this&&this!==Pi&&this instanceof q?R:f;return vo(oe,this,st)}return q}function wg(f){return function(g,S,R){var q=Yn(g);if(!Ur(g)){var Q=un(S,3);g=Zo(g),S=function(_t){return Q(q[_t],_t,q)}}var st=f(g,S,R);return st>-1?q[Q?g[st]:st]:e}}function Km(f){return ru(function(g){var S=g.length,R=S,q=Z.prototype.thru;for(f&&g.reverse();R--;){var Q=g[R];if(typeof Q!="function")throw new ko(p);if(q&&!st&&jp(Q)=="wrapper")var st=new Z([],!0)}for(R=st?R:S;++R<S;){Q=g[R];var _t=jp(Q),At=_t=="wrapper"?Wp(Q):e;At&&Pg(At[0])&&At[1]==(Zt|xt|ee|Mt)&&!At[4].length&&At[9]==1?st=st[jp(At[0])].apply(st,At[3]):st=Q.length==1&&Pg(Q)?st[_t]():st.thru(Q)}return function(){var ie=arguments,oe=ie[0];if(st&&ie.length==1&&je(oe))return st.plant(oe).value();for(var fe=0,ze=S?g[fe].apply(this,ie):oe;++fe<S;)ze=g[fe].call(this,ze);return ze}})}function Gp(f,g,S,R,q,Q,st,_t,At,ie){var oe=g&Zt,fe=g&at,ze=g&rt,Ke=g&(xt|Gt),_n=g&It,kn=ze?e:Cf(f);function yn(){for(var Wn=arguments.length,or=Nt(Wn),Ga=Wn;Ga--;)or[Ga]=arguments[Ga];if(Ke)var Js=Nh(yn),qa=df(or,Js);if(R&&(or=Bp(or,R,q,Ke)),Q&&(or=Up(or,Q,st,Ke)),Wn-=qa,Ke&&Wn<ie){var Hi=Cs(or,Js);return $m(f,g,Gp,yn.placeholder,S,or,Hi,_t,At,ie-Wn)}var lu=fe?S:this,Uc=ze?lu[f]:f;return Wn=or.length,_t?or=p_(or,_t):_n&&Wn>1&&or.reverse(),oe&&At<Wn&&(or.length=At),this&&this!==Pi&&this instanceof yn&&(Uc=kn||Cf(Uc)),Uc.apply(lu,or)}return yn}function Jm(f,g){return function(S,R){return Uy(S,f,g(R),{})}}function qp(f,g){return function(S,R){var q;if(S===e&&R===e)return g;if(S!==e&&(q=S),R!==e){if(q===e)return R;typeof S=="string"||typeof R=="string"?(S=ls(S),R=ls(R)):(S=Gm(S),R=Gm(R)),q=f(S,R)}return q}}function Tf(f){return ru(function(g){return g=lr(g,zo(un())),Rn(function(S){var R=this;return f(g,function(q){return vo(q,R,S)})})})}function qu(f,g){g=g===e?" ":ls(g);var S=g.length;if(S<2)return S?yg(g,f):g;var R=yg(g,Ou(f/ql(g)));return fa(g)?va(oo(R),0,f).join(""):R.slice(0,f)}function Ig(f,g,S,R){var q=g&at,Q=Cf(f);function st(){for(var _t=-1,At=arguments.length,ie=-1,oe=R.length,fe=Nt(oe+At),ze=this&&this!==Pi&&this instanceof st?Q:f;++ie<oe;)fe[ie]=R[ie];for(;At--;)fe[ie++]=arguments[++_t];return vo(ze,q?S:this,fe)}return st}function Qm(f){return function(g,S,R){return R&&typeof R!="number"&&us(g,S,R)&&(S=R=e),g=Bc(g),S===e?(S=g,g=0):S=Bc(S),R=R===e?g<S?1:-1:Bc(R),Gy(g,S,R,f)}}function Xp(f){return function(g,S){return typeof g=="string"&&typeof S=="string"||(g=bl(g),S=bl(S)),f(g,S)}}function $m(f,g,S,R,q,Q,st,_t,At,ie){var oe=g&xt,fe=oe?st:e,ze=oe?e:st,Ke=oe?Q:e,_n=oe?e:Q;g|=oe?ee:$t,g&=~(oe?$t:ee),g&wt||(g&=~(at|rt));var kn=[f,g,q,Ke,fe,_n,ze,_t,At,ie],yn=S.apply(e,kn);return Pg(f)&&Lg(yn,kn),yn.placeholder=R,zc(yn,f,g)}function Dc(f){var g=gi[f];return function(S,R){if(S=bl(S),R=R==null?0:mi(zn(R),292),R&&Xs(S)){var q=(Ir(S)+"e").split("e"),Q=g(q[0]+"e"+(+q[1]+R));return q=(Ir(Q)+"e").split("e"),+(q[0]+"e"+(+q[1]-R))}return g(S)}}var t_=ir&&1/vc(new ir([,-0]))[1]==$e?function(f){return new ir(f)}:Dv;function e_(f){return function(g){var S=bo(g);return S==si?Mu(g):S==Rr?xc(g):fh(g,f(g))}}function nu(f,g,S,R,q,Q,st,_t){var At=g&rt;if(!At&&typeof f!="function")throw new ko(p);var ie=R?R.length:0;if(ie||(g&=~(ee|$t),R=q=e),st=st===e?st:Le(zn(st),0),_t=_t===e?_t:zn(_t),ie-=q?q.length:0,g&$t){var oe=R,fe=q;R=q=e}var ze=At?e:Wp(f),Ke=[f,g,S,R,q,oe,fe,Q,st,_t];if(ze&&zh(Ke,ze),f=Ke[0],g=Ke[1],S=Ke[2],R=Ke[3],q=Ke[4],_t=Ke[9]=Ke[9]===e?At?0:f.length:Le(Ke[9]-ie,0),!_t&&g&(xt|Gt)&&(g&=~(xt|Gt)),!g||g==at)var _n=Mh(f,g,S);else g==xt||g==Gt?_n=Hm(f,g,_t):(g==ee||g==(at|ee))&&!q.length?_n=Ig(f,g,S,R):_n=Gp.apply(e,Ke);var kn=ze?tu:Lg;return zc(kn(_n,Ke),f,g)}function n_(f,g,S,R){return f===e||qn(f,pa[S])&&!ur.call(R,S)?g:f}function r_(f,g,S,R,q,Q){return Vr(f)&&Vr(g)&&(Q.set(g,f),Pc(f,g,e,r_,Q),Q.delete(g)),f}function Hy(f){return Ff(f)?e:f}function i_(f,g,S,R,q,Q){var st=S&Y,_t=f.length,At=g.length;if(_t!=At&&!(st&&At>_t))return!1;var ie=Q.get(f),oe=Q.get(g);if(ie&&oe)return ie==g&&oe==f;var fe=-1,ze=!0,Ke=S&et?new Tn:e;for(Q.set(f,g),Q.set(g,f);++fe<_t;){var _n=f[fe],kn=g[fe];if(R)var yn=st?R(kn,_n,fe,g,f,Q):R(_n,kn,fe,f,g,Q);if(yn!==e){if(yn)continue;ze=!1;break}if(Ke){if(!ln(g,function(Wn,or){if(!Lu(Ke,or)&&(_n===Wn||q(_n,Wn,S,R,Q)))return Ke.push(or)})){ze=!1;break}}else if(!(_n===kn||q(_n,kn,S,R,Q))){ze=!1;break}}return Q.delete(f),Q.delete(g),ze}function o_(f,g,S,R,q,Q,st){switch(S){case Bt:if(f.byteLength!=g.byteLength||f.byteOffset!=g.byteOffset)return!1;f=f.buffer,g=g.buffer;case ns:return!(f.byteLength!=g.byteLength||!Q(new Ru(f),new Ru(g)));case eo:case es:case xs:return qn(+f,+g);case Fs:return f.name==g.name&&f.message==g.message;case Gi:case ws:return f==g+"";case si:var _t=Mu;case Rr:var At=R&Y;if(_t||(_t=vc),f.size!=g.size&&!At)return!1;var ie=st.get(f);if(ie)return ie==g;R|=et,st.set(f,g);var oe=i_(_t(f),_t(g),R,q,Q,st);return st.delete(f),oe;case ye:if(L)return L.call(f)==L.call(g)}return!1}function Eg(f,g,S,R,q,Q){var st=S&Y,_t=Zp(f),At=_t.length,ie=Zp(g),oe=ie.length;if(At!=oe&&!st)return!1;for(var fe=At;fe--;){var ze=_t[fe];if(!(st?ze in g:ur.call(g,ze)))return!1}var Ke=Q.get(f),_n=Q.get(g);if(Ke&&_n)return Ke==g&&_n==f;var kn=!0;Q.set(f,g),Q.set(g,f);for(var yn=st;++fe<At;){ze=_t[fe];var Wn=f[ze],or=g[ze];if(R)var Ga=st?R(or,Wn,ze,g,f,Q):R(Wn,or,ze,f,g,Q);if(!(Ga===e?Wn===or||q(Wn,or,S,R,Q):Ga)){kn=!1;break}yn||(yn=ze=="constructor")}if(kn&&!yn){var Js=f.constructor,qa=g.constructor;Js!=qa&&"constructor"in f&&"constructor"in g&&!(typeof Js=="function"&&Js instanceof Js&&typeof qa=="function"&&qa instanceof qa)&&(kn=!1)}return Q.delete(f),Q.delete(g),kn}function ru(f){return Rc(h_(f,e,x_),f+"")}function Zp(f){return Cp(f,Zo,Mi)}function Yp(f){return Cp(f,Ia,Hp)}var Wp=Fa?function(f){return Fa.get(f)}:Dv;function jp(f){for(var g=f.name+"",S=ma[g],R=ur.call(ma,g)?S.length:0;R--;){var q=S[R],Q=q.func;if(Q==null||Q==f)return q.name}return g}function Nh(f){var g=ur.call(C,"placeholder")?C:f;return g.placeholder}function un(){var f=C.iteratee||Lv;return f=f===Lv?km:f,arguments.length?f(arguments[0],arguments[1]):f}function Af(f,g){var S=f.__data__;return Ky(g)?S[typeof g=="string"?"string":"hash"]:S.map}function Sg(f){for(var g=Zo(f),S=g.length;S--;){var R=g[S],q=f[R];g[S]=[R,q,l_(q)]}return g}function Nc(f,g){var S=wp(f,g);return Om(S)?S:e}function Pf(f){var g=ur.call(f,ga),S=f[ga];try{f[ga]=e;var R=!0}catch{}var q=Ic.call(f);return R&&(g?f[ga]=S:delete f[ga]),q}var Mi=xh?function(f){return f==null?[]:(f=Yn(f),ca(xh(f),function(g){return _f.call(f,g)}))}:Nv,Hp=xh?function(f){for(var g=[];f;)ss(g,Mi(f)),f=Yi(f);return g}:Nv,bo=Vo;(so&&bo(new so(new ArrayBuffer(1)))!=Bt||Cc&&bo(new Cc)!=si||Hl&&bo(Hl.resolve())!=il||ir&&bo(new ir)!=Rr||Or&&bo(new Or)!=bn)&&(bo=function(f){var g=Vo(f),S=g==ai?f.constructor:e,R=S?Zu(S):"";if(R)switch(R){case y:return Bt;case o:return si;case h:return il;case m:return Rr;case v:return bn}return g});function s_(f,g,S){for(var R=-1,q=S.length;++R<q;){var Q=S[R],st=Q.size;switch(Q.type){case"drop":f+=st;break;case"dropRight":g-=st;break;case"take":g=mi(g,f+st);break;case"takeRight":f=Le(f,g-st);break}}return{start:f,end:g}}function fr(f){var g=f.match($);return g?g[1].split(O):[]}function iu(f,g,S){g=eu(g,f);for(var R=-1,q=g.length,Q=!1;++R<q;){var st=Ba(g[R]);if(!(Q=f!=null&&S(f,st)))break;f=f[st]}return Q||++R!=q?Q:(q=f==null?0:f.length,!!q&&kf(q)&&yl(st,q)&&(je(f)||Ui(f)))}function Cg(f){var g=f.length,S=new f.constructor(g);return g&&typeof f[0]=="string"&&ur.call(f,"index")&&(S.index=f.index,S.input=f.input),S}function Tg(f){return typeof f.constructor=="function"&&!Lf(f)?k(Yi(f)):{}}function a_(f,g,S){var R=f.constructor;switch(g){case ns:return kp(f);case eo:case es:return new R(+f);case Bt:return Zy(f,S);case ge:case no:case Si:case Bn:case Vn:case Qn:case Do:case dn:case ue:return Ym(f,S);case si:return new R;case xs:case ws:return new R(f);case Gi:return Zm(f);case Rr:return new R;case ye:return Sf(f)}}function ou(f,g){var S=g.length;if(!S)return f;var R=S-1;return g[R]=(S>1?"& ":"")+g[R],g=g.join(S>2?", ":" "),f.replace(Vs,`{
/* [wrapped with `+g+`] */
`)}function Rh(f){return je(f)||Ui(f)||!!(Yl&&f&&f[Yl])}function yl(f,g){var S=typeof f;return g=g==null?pn:g,!!g&&(S=="number"||S!="symbol"&&te.test(f))&&f>-1&&f%1==0&&f<g}function us(f,g,S){if(!Vr(S))return!1;var R=typeof g;return(R=="number"?Ur(S)&&yl(g,S.length):R=="string"&&g in S)?qn(S[g],f):!1}function Ag(f,g){if(je(f))return!1;var S=typeof f;return S=="number"||S=="symbol"||S=="boolean"||f==null||bi(f)?!0:Es.test(f)||!No.test(f)||g!=null&&f in Yn(g)}function Ky(f){var g=typeof f;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?f!=="__proto__":f===null}function Pg(f){var g=jp(f),S=C[g];if(typeof S!="function"||!(g in W.prototype))return!1;if(f===S)return!0;var R=Wp(S);return!!R&&f===R[0]}function Jy(f){return!!Nu&&Nu in f}var Qy=be?Va:Rv;function Lf(f){var g=f&&f.constructor,S=typeof g=="function"&&g.prototype||pa;return f===S}function l_(f){return f===f&&!Vr(f)}function u_(f,g){return function(S){return S==null?!1:S[f]===g&&(g!==e||f in Yn(S))}}function Kp(f){var g=Ve(f,function(R){return S.size===I&&S.clear(),R}),S=g.cache;return g}function zh(f,g){var S=f[1],R=g[1],q=S|R,Q=q<(at|rt|Zt),st=R==Zt&&S==xt||R==Zt&&S==Mt&&f[7].length<=g[8]||R==(Zt|Mt)&&g[7].length<=g[8]&&S==xt;if(!(Q||st))return f;R&at&&(f[2]=g[2],q|=S&at?0:wt);var _t=g[3];if(_t){var At=f[3];f[3]=At?Bp(At,_t,g[4]):_t,f[4]=At?Cs(f[3],T):g[4]}return _t=g[5],_t&&(At=f[5],f[5]=At?Up(At,_t,g[6]):_t,f[6]=At?Cs(f[5],T):g[6]),_t=g[7],_t&&(f[7]=_t),R&Zt&&(f[8]=f[8]==null?g[8]:mi(f[8],g[8])),f[9]==null&&(f[9]=g[9]),f[0]=g[0],f[1]=q,f}function c_(f){var g=[];if(f!=null)for(var S in Yn(f))g.push(S);return g}function $y(f){return Ic.call(f)}function h_(f,g,S){return g=Le(g===e?f.length-1:g,0),function(){for(var R=arguments,q=-1,Q=Le(R.length-g,0),st=Nt(Q);++q<Q;)st[q]=R[g+q];q=-1;for(var _t=Nt(g+1);++q<g;)_t[q]=R[q];return _t[g]=S(st),vo(f,this,_t)}}function f_(f,g){return g.length<2?f:Tr(f,ya(g,0,-1))}function p_(f,g){for(var S=f.length,R=mi(g.length,S),q=Go(f);R--;){var Q=g[R];f[R]=yl(Q,S)?q[Q]:e}return f}function Mf(f,g){if(!(g==="constructor"&&typeof f[g]=="function")&&g!="__proto__")return f[g]}var Lg=Df(tu),Xu=vh||function(f,g){return Pi.setTimeout(f,g)},Rc=Df(wf);function zc(f,g,S){var R=g+"";return Rc(f,ou(R,tv(fr(R),S)))}function Df(f){var g=0,S=0;return function(){var R=Sc(),q=Yt-(R-S);if(S=R,q>0){if(++g>=re)return arguments[0]}else g=0;return f.apply(e,arguments)}}function Oc(f,g){var S=-1,R=f.length,q=R-1;for(g=g===e?R:g;++S<g;){var Q=Mp(S,q),st=f[Q];f[Q]=f[S],f[S]=st}return f.length=g,f}var d_=Kp(function(f){var g=[];return f.charCodeAt(0)===46&&g.push(""),f.replace(Qr,function(S,R,q,Q){g.push(q?Q.replace(tt,"$1"):R||S)}),g});function Ba(f){if(typeof f=="string"||bi(f))return f;var g=f+"";return g=="0"&&1/f==-$e?"-0":g}function Zu(f){if(f!=null){try{return Du.call(f)}catch{}try{return f+""}catch{}}return""}function tv(f,g){return Zi(to,function(S){var R="_."+S[0];g&S[1]&&!ha(f,R)&&f.push(R)}),f.sort()}function Mg(f){if(f instanceof W)return f.clone();var g=new Z(f.__wrapped__,f.__chain__);return g.__actions__=Go(f.__actions__),g.__index__=f.__index__,g.__values__=f.__values__,g}function g_(f,g,S){(S?us(f,g,S):g===e)?g=1:g=Le(zn(g),0);var R=f==null?0:f.length;if(!R||g<1)return[];for(var q=0,Q=0,st=Nt(Ou(R/g));q<R;)st[Q++]=ya(f,q,q+=g);return st}function Dg(f){for(var g=-1,S=f==null?0:f.length,R=0,q=[];++g<S;){var Q=f[g];Q&&(q[R++]=Q)}return q}function Ng(){var f=arguments.length;if(!f)return[];for(var g=Nt(f-1),S=arguments[0],R=f;R--;)g[R-1]=arguments[R];return ss(je(S)?Go(S):[S],Cr(g,1))}var ev=Rn(function(f,g){return pr(f)?Eh(f,Cr(g,1,pr,!0)):[]}),nv=Rn(function(f,g){var S=xa(g);return pr(S)&&(S=e),pr(f)?Eh(f,Cr(g,1,pr,!0),un(S,2)):[]}),m_=Rn(function(f,g){var S=xa(g);return pr(S)&&(S=e),pr(f)?Eh(f,Cr(g,1,pr,!0),e,S):[]});function su(f,g,S){var R=f==null?0:f.length;return R?(g=S||g===e?1:zn(g),ya(f,g<0?0:g,R)):[]}function __(f,g,S){var R=f==null?0:f.length;return R?(g=S||g===e?1:zn(g),g=R-g,ya(f,0,g<0?0:g)):[]}function Yu(f,g){return f&&f.length?Mr(f,un(g,3),!0,!0):[]}function y_(f,g){return f&&f.length?Mr(f,un(g,3),!0):[]}function v_(f,g,S,R){var q=f==null?0:f.length;return q?(S&&typeof S!="number"&&us(f,g,S)&&(S=0,R=q),Sh(f,g,S,R)):[]}function Rg(f,g,S){var R=f==null?0:f.length;if(!R)return-1;var q=S==null?0:zn(S);return q<0&&(q=Le(R+q,0)),Er(f,un(g,3),q)}function zg(f,g,S){var R=f==null?0:f.length;if(!R)return-1;var q=R-1;return S!==e&&(q=zn(S),q=S<0?Le(R+q,0):mi(q,R-1)),Er(f,un(g,3),q,!0)}function x_(f){var g=f==null?0:f.length;return g?Cr(f,1):[]}function rv(f){var g=f==null?0:f.length;return g?Cr(f,$e):[]}function b_(f,g){var S=f==null?0:f.length;return S?(g=g===e?1:zn(g),Cr(f,g)):[]}function w_(f){for(var g=-1,S=f==null?0:f.length,R={};++g<S;){var q=f[g];R[q[0]]=q[1]}return R}function Og(f){return f&&f.length?f[0]:e}function Jp(f,g,S){var R=f==null?0:f.length;if(!R)return-1;var q=S==null?0:zn(S);return q<0&&(q=Le(R+q,0)),Oa(f,g,q)}function I_(f){var g=f==null?0:f.length;return g?ya(f,0,-1):[]}var Qp=Rn(function(f){var g=lr(f,Lh);return g.length&&g[0]===f[0]?Ap(g):[]}),$p=Rn(function(f){var g=xa(f),S=lr(f,Lh);return g===xa(S)?g=e:S.pop(),S.length&&S[0]===f[0]?Ap(S,un(g,2)):[]}),td=Rn(function(f){var g=xa(f),S=lr(f,Lh);return g=typeof g=="function"?g:e,g&&S.pop(),S.length&&S[0]===f[0]?Ap(S,e,g):[]});function iv(f,g){return f==null?"":bh.call(f,g)}function xa(f){var g=f==null?0:f.length;return g?f[g-1]:e}function ov(f,g,S){var R=f==null?0:f.length;if(!R)return-1;var q=R;return S!==e&&(q=zn(S),q=q<0?Le(R+q,0):mi(q,R-1)),g===g?Ep(f,g,q):Er(f,xp,q,!0)}function sv(f,g){return f&&f.length?dg(f,zn(g)):e}var Oh=Rn(ed);function ed(f,g){return f&&f.length&&g&&g.length?Lc(f,g):f}function E_(f,g,S){return f&&f.length&&g&&g.length?Lc(f,g,un(S,2)):f}function kg(f,g,S){return f&&f.length&&g&&g.length?Lc(f,g,e,S):f}var av=ru(function(f,g){var S=f==null?0:f.length,R=Fu(f,g);return Ls(f,lr(g,function(q){return yl(q,S)?+q:q}).sort(Fp)),R});function Wu(f,g){var S=[];if(!(f&&f.length))return S;var R=-1,q=[],Q=f.length;for(g=un(g,3);++R<Q;){var st=f[R];g(st,R,f)&&(S.push(st),q.push(R))}return Ls(f,q),S}function nd(f){return f==null?f:jl.call(f)}function S_(f,g,S){var R=f==null?0:f.length;return R?(S&&typeof S!="number"&&us(f,g,S)?(g=0,S=R):(g=g==null?0:zn(g),S=S===e?R:zn(S)),ya(f,g,S)):[]}function lv(f,g){return Np(f,g)}function uv(f,g,S){return xg(f,g,un(S,2))}function cv(f,g){var S=f==null?0:f.length;if(S){var R=Np(f,g);if(R<S&&qn(f[R],g))return R}return-1}function rd(f,g){return Np(f,g,!0)}function Fg(f,g,S){return xg(f,g,un(S,2),!0)}function hv(f,g){var S=f==null?0:f.length;if(S){var R=Np(f,g,!0)-1;if(qn(f[R],g))return R}return-1}function Bg(f){return f&&f.length?Vm(f):[]}function Ug(f,g){return f&&f.length?Vm(f,un(g,2)):[]}function kh(f){var g=f==null?0:f.length;return g?ya(f,1,g):[]}function fv(f,g,S){return f&&f.length?(g=S||g===e?1:zn(g),ya(f,0,g<0?0:g)):[]}function Vg(f,g,S){var R=f==null?0:f.length;return R?(g=S||g===e?1:zn(g),g=R-g,ya(f,g<0?0:g,R)):[]}function C_(f,g){return f&&f.length?Mr(f,un(g,3),!1,!0):[]}function id(f,g){return f&&f.length?Mr(f,un(g,3)):[]}var Gg=Rn(function(f){return Vu(Cr(f,1,pr,!0))}),pv=Rn(function(f){var g=xa(f);return pr(g)&&(g=e),Vu(Cr(f,1,pr,!0),un(g,2))}),dv=Rn(function(f){var g=xa(f);return g=typeof g=="function"?g:e,Vu(Cr(f,1,pr,!0),e,g)});function gv(f){return f&&f.length?Vu(f):[]}function mv(f,g){return f&&f.length?Vu(f,un(g,2)):[]}function _v(f,g){return g=typeof g=="function"?g:e,f&&f.length?Vu(f,e,g):[]}function od(f){if(!(f&&f.length))return[];var g=0;return f=ca(f,function(S){if(pr(S))return g=Le(S.length,g),!0}),ul(g,function(S){return lr(f,Au(S))})}function Br(f,g){if(!(f&&f.length))return[];var S=od(f);return g==null?S:lr(S,function(R){return vo(g,e,R)})}var kc=Rn(function(f,g){return pr(f)?Eh(f,g):[]}),T_=Rn(function(f){return Rp(ca(f,pr))}),A_=Rn(function(f){var g=xa(f);return pr(g)&&(g=e),Rp(ca(f,pr),un(g,2))}),P_=Rn(function(f){var g=xa(f);return g=typeof g=="function"?g:e,Rp(ca(f,pr),e,g)}),L_=Rn(od);function M_(f,g){return Ef(f||[],g||[],Li)}function qg(f,g){return Ef(f||[],g||[],Ph)}var sd=Rn(function(f){var g=f.length,S=g>1?f[g-1]:e;return S=typeof S=="function"?(f.pop(),S):e,Br(f,S)});function Xg(f){var g=C(f);return g.__chain__=!0,g}function Zg(f,g){return g(f),f}function Nf(f,g){return g(f)}var ba=ru(function(f){var g=f.length,S=g?f[0]:0,R=this.__wrapped__,q=function(Q){return Fu(Q,f)};return g>1||this.__actions__.length||!(R instanceof W)||!yl(S)?this.thru(q):(R=R.slice(S,+S+(g?1:0)),R.__actions__.push({func:Nf,args:[q],thisArg:e}),new Z(R,this.__chain__).thru(function(Q){return g&&!Q.length&&Q.push(e),Q}))});function Rf(){return Xg(this)}function D_(){return new Z(this.value(),this.__chain__)}function N_(){this.__values__===e&&(this.__values__=M0(this.value()));var f=this.__index__>=this.__values__.length,g=f?e:this.__values__[this.__index__++];return{done:f,value:g}}function R_(){return this}function z_(f){for(var g,S=this;S instanceof V;){var R=Mg(S);R.__index__=0,R.__values__=e,g?q.__wrapped__=R:g=R;var q=R;S=S.__wrapped__}return q.__wrapped__=f,g}function O_(){var f=this.__wrapped__;if(f instanceof W){var g=f;return this.__actions__.length&&(g=new W(this)),g=g.reverse(),g.__actions__.push({func:Nf,args:[nd],thisArg:e}),new Z(g,this.__chain__)}return this.thru(nd)}function k_(){return If(this.__wrapped__,this.__actions__)}var yv=Vp(function(f,g,S){ur.call(f,S)?++f[S]:Ys(f,S,1)});function Yg(f,g,S){var R=je(f)?hf:ag;return S&&us(f,g,S)&&(g=e),R(f,un(g,3))}function ad(f,g){var S=je(f)?ca:gl;return S(f,un(g,3))}var zf=wg(Rg),Wg=wg(zg);function vv(f,g){return Cr(M(f,g),1)}function a(f,g){return Cr(M(f,g),$e)}function i(f,g,S){return S=S===e?1:zn(S),Cr(M(f,g),S)}function u(f,g){var S=je(f)?Zi:Ql;return S(f,un(g,3))}function d(f,g){var S=je(f)?vp:Dm;return S(f,un(g,3))}var _=Vp(function(f,g,S){ur.call(f,S)?f[S].push(g):Ys(f,S,[g])});function b(f,g,S,R){f=Ur(f)?f:cd(f),S=S&&!R?zn(S):0;var q=f.length;return S<0&&(S=Le(q+S,0)),uo(f)?S<=q&&f.indexOf(g,S)>-1:!!q&&Oa(f,g,S)>-1}var w=Rn(function(f,g,S){var R=-1,q=typeof g=="function",Q=Ur(f)?Nt(f.length):[];return Ql(f,function(st){Q[++R]=q?vo(g,st,S):Ch(st,g,S)}),Q}),A=Vp(function(f,g,S){Ys(f,S,g)});function M(f,g){var S=je(f)?lr:pg;return S(f,un(g,3))}function z(f,g,S,R){return f==null?[]:(je(g)||(g=g==null?[]:[g]),S=R?e:S,je(S)||(S=S==null?[]:[S]),Um(f,g,S))}var F=Vp(function(f,g,S){f[S?0:1].push(g)},function(){return[[],[]]});function U(f,g,S){var R=je(f)?ah:mc,q=arguments.length<3;return R(f,un(g,4),S,q,Ql)}function X(f,g,S){var R=je(f)?ff:mc,q=arguments.length<3;return R(f,un(g,4),S,q,Dm)}function j(f,g){var S=je(f)?ca:gl;return S(f,Sn(un(g,3)))}function H(f){var g=je(f)?Bo:vg;return g(f)}function ut(f,g,S){(S?us(f,g,S):g===e)?g=1:g=zn(g);var R=je(f)?Gn:Dp;return R(f,g)}function ct(f){var g=je(f)?tr:qy;return g(f)}function St(f){if(f==null)return 0;if(Ur(f))return uo(f)?ql(f):f.length;var g=bo(f);return g==si||g==Rr?f.size:fg(f).length}function Rt(f,g,S){var R=je(f)?ln:Xy;return S&&us(f,g,S)&&(g=e),R(f,un(g,3))}var Lt=Rn(function(f,g){if(f==null)return[];var S=g.length;return S>1&&us(f,g[0],g[1])?g=[]:S>2&&us(g[0],g[1],g[2])&&(g=[g[0]]),Um(f,Cr(g,1),[])}),qt=yh||function(){return Pi.Date.now()};function ne(f,g){if(typeof g!="function")throw new ko(p);return f=zn(f),function(){if(--f<1)return g.apply(this,arguments)}}function Qt(f,g,S){return g=S?e:g,g=f&&g==null?f.length:g,nu(f,Zt,e,e,e,e,g)}function Me(f,g){var S;if(typeof g!="function")throw new ko(p);return f=zn(f),function(){return--f>0&&(S=g.apply(this,arguments)),f<=1&&(g=e),S}}var Ue=Rn(function(f,g,S){var R=at;if(S.length){var q=Cs(S,Nh(Ue));R|=ee}return nu(f,R,g,S,q)}),Ee=Rn(function(f,g,S){var R=at|rt;if(S.length){var q=Cs(S,Nh(Ee));R|=ee}return nu(g,R,f,S,q)});function Se(f,g,S){g=S?e:g;var R=nu(f,xt,e,e,e,e,e,g);return R.placeholder=Se.placeholder,R}function _e(f,g,S){g=S?e:g;var R=nu(f,Gt,e,e,e,e,e,g);return R.placeholder=_e.placeholder,R}function Pe(f,g,S){var R,q,Q,st,_t,At,ie=0,oe=!1,fe=!1,ze=!0;if(typeof f!="function")throw new ko(p);g=bl(g)||0,Vr(S)&&(oe=!!S.leading,fe="maxWait"in S,Q=fe?Le(bl(S.maxWait)||0,g):Q,ze="trailing"in S?!!S.trailing:ze);function Ke(Hi){var lu=R,Uc=q;return R=q=e,ie=Hi,st=f.apply(Uc,lu),st}function _n(Hi){return ie=Hi,_t=Xu(Wn,g),oe?Ke(Hi):st}function kn(Hi){var lu=Hi-At,Uc=Hi-ie,X0=g-lu;return fe?mi(X0,Q-Uc):X0}function yn(Hi){var lu=Hi-At,Uc=Hi-ie;return At===e||lu>=g||lu<0||fe&&Uc>=Q}function Wn(){var Hi=qt();if(yn(Hi))return or(Hi);_t=Xu(Wn,kn(Hi))}function or(Hi){return _t=e,ze&&R?Ke(Hi):(R=q=e,st)}function Ga(){_t!==e&&zp(_t),ie=0,R=At=q=_t=e}function Js(){return _t===e?st:or(qt())}function qa(){var Hi=qt(),lu=yn(Hi);if(R=arguments,q=this,At=Hi,lu){if(_t===e)return _n(At);if(fe)return zp(_t),_t=Xu(Wn,g),Ke(At)}return _t===e&&(_t=Xu(Wn,g)),st}return qa.cancel=Ga,qa.flush=Js,qa}var Ce=Rn(function(f,g){return Jl(f,1,g)}),ce=Rn(function(f,g,S){return Jl(f,bl(g)||0,S)});function He(f){return nu(f,It)}function Ve(f,g){if(typeof f!="function"||g!=null&&typeof g!="function")throw new ko(p);var S=function(){var R=arguments,q=g?g.apply(this,R):R[0],Q=S.cache;if(Q.has(q))return Q.get(q);var st=f.apply(this,R);return S.cache=Q.set(q,st)||Q,st};return S.cache=new(Ve.Cache||We),S}Ve.Cache=We;function Sn(f){if(typeof f!="function")throw new ko(p);return function(){var g=arguments;switch(g.length){case 0:return!f.call(this);case 1:return!f.call(this,g[0]);case 2:return!f.call(this,g[0],g[1]);case 3:return!f.call(this,g[0],g[1],g[2])}return!f.apply(this,g)}}function er(f){return Me(2,f)}var Ar=Xm(function(f,g){g=g.length==1&&je(g[0])?lr(g[0],zo(un())):lr(Cr(g,1),zo(un()));var S=g.length;return Rn(function(R){for(var q=-1,Q=mi(R.length,S);++q<Q;)R[q]=g[q].call(this,R[q]);return vo(f,this,R)})}),yr=Rn(function(f,g){var S=Cs(g,Nh(yr));return nu(f,ee,e,g,S)}),ji=Rn(function(f,g){var S=Cs(g,Nh(ji));return nu(f,$t,e,g,S)}),yi=ru(function(f,g){return nu(f,Mt,e,e,e,g)});function vi(f,g){if(typeof f!="function")throw new ko(p);return g=g===e?g:zn(g),Rn(f,g)}function Fi(f,g){if(typeof f!="function")throw new ko(p);return g=g==null?0:Le(zn(g),0),Rn(function(S){var R=S[g],q=va(S,0,g);return R&&ss(q,R),vo(f,this,q)})}function ao(f,g,S){var R=!0,q=!0;if(typeof f!="function")throw new ko(p);return Vr(S)&&(R="leading"in S?!!S.leading:R,q="trailing"in S?!!S.trailing:q),Pe(f,g,{leading:R,maxWait:g,trailing:q})}function wo(f){return Qt(f,1)}function cs(f,g){return yr(Mc(g),f)}function xi(){if(!arguments.length)return[];var f=arguments[0];return je(f)?f:[f]}function lo(f){return ki(f,G)}function Io(f,g){return g=typeof g=="function"?g:e,ki(f,G,g)}function qo(f){return ki(f,P|G)}function hs(f,g){return g=typeof g=="function"?g:e,ki(f,P|G,g)}function fs(f,g){return g==null||Ws(f,g,Zo(g))}function qn(f,g){return f===g||f!==f&&g!==g}var Bi=Xp($l),An=Xp(function(f,g){return f>=g}),Ui=Nm(function(){return arguments}())?Nm:function(f){return ti(f)&&ur.call(f,"callee")&&!_f.call(f,"callee")},je=Nt.isArray,Eo=pp?zo(pp):hg;function Ur(f){return f!=null&&kf(f.length)&&!Va(f)}function pr(f){return ti(f)&&Ur(f)}function Ua(f){return f===!0||f===!1||ti(f)&&Vo(f)==eo}var Xo=sg||Rv,wa=dp?zo(dp):Vy;function Hs(f){return ti(f)&&f.nodeType===1&&!Ff(f)}function ps(f){if(f==null)return!0;if(Ur(f)&&(je(f)||typeof f=="string"||typeof f.splice=="function"||Xo(f)||xl(f)||Ui(f)))return!f.length;var g=bo(f);if(g==si||g==Rr)return!f.size;if(Lf(f))return!fg(f).length;for(var S in f)if(ur.call(f,S))return!1;return!0}function au(f,g){return Ac(f,g)}function Of(f,g,S){S=typeof S=="function"?S:e;var R=S?S(f,g):e;return R===e?Ac(f,g,e,S):!!R}function ld(f){if(!ti(f))return!1;var g=Vo(f);return g==Fs||g==Ul||typeof f.message=="string"&&typeof f.name=="string"&&!Ff(f)}function jg(f){return typeof f=="number"&&Xs(f)}function Va(f){if(!Vr(f))return!1;var g=Vo(f);return g==Mo||g==Kr||g==vs||g==bs}function vl(f){return typeof f=="number"&&f==zn(f)}function kf(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=pn}function Vr(f){var g=typeof f;return f!=null&&(g=="object"||g=="function")}function ti(f){return f!=null&&typeof f=="object"}var Hg=gp?zo(gp):zm;function xv(f,g){return f===g||Uu(f,g,Sg(g))}function bv(f,g,S){return S=typeof S=="function"?S:e,Uu(f,g,Sg(g),S)}function wv(f){return F_(f)&&f!=+f}function Iv(f){if(Qy(f))throw new mn(c);return Om(f)}function Ev(f){return f===null}function Sv(f){return f==null}function F_(f){return typeof f=="number"||ti(f)&&Vo(f)==xs}function Ff(f){if(!ti(f)||Vo(f)!=ai)return!1;var g=Yi(f);if(g===null)return!0;var S=ur.call(g,"constructor")&&g.constructor;return typeof S=="function"&&S instanceof S&&Du.call(S)==Sp}var Ks=mp?zo(mp):xf;function ud(f){return vl(f)&&f>=-pn&&f<=pn}var Kg=_p?zo(_p):Pp;function uo(f){return typeof f=="string"||!je(f)&&ti(f)&&Vo(f)==ws}function bi(f){return typeof f=="symbol"||ti(f)&&Vo(f)==ye}var xl=yp?zo(yp):Lp;function Bf(f){return f===e}function B_(f){return ti(f)&&bo(f)==bn}function Fc(f){return ti(f)&&Vo(f)==Bs}var qb=Xp(bf),Xb=Xp(function(f,g){return f<=g});function M0(f){if(!f)return[];if(Ur(f))return uo(f)?oo(f):Go(f);if(Wl&&f[Wl])return mh(f[Wl]());var g=bo(f),S=g==si?Mu:g==Rr?vc:cd;return S(f)}function Bc(f){if(!f)return f===0?f:0;if(f=bl(f),f===$e||f===-$e){var g=f<0?-1:1;return g*Cn}return f===f?f:0}function zn(f){var g=Bc(f),S=g%1;return g===g?S?g-S:g:0}function D0(f){return f?dl(zn(f),0,Xn):0}function bl(f){if(typeof f=="number")return f;if(bi(f))return _r;if(Vr(f)){var g=typeof f.valueOf=="function"?f.valueOf():f;f=Vr(g)?g+"":g}if(typeof f!="string")return f===0?f:+f;f=Ss(f);var S=pt.test(f);return S||Vt.test(f)?lf(f.slice(2),S?2:8):ht.test(f)?_r:+f}function N0(f){return _l(f,Ia(f))}function Zb(f){return f?dl(zn(f),-pn,pn):f===0?f:0}function Ir(f){return f==null?"":ls(f)}var Yb=js(function(f,g){if(Lf(g)||Ur(g)){_l(g,Zo(g),f);return}for(var S in g)ur.call(g,S)&&Li(f,S,g[S])}),R0=js(function(f,g){_l(g,Ia(g),f)}),U_=js(function(f,g,S,R){_l(g,Ia(g),f,R)}),Wb=js(function(f,g,S,R){_l(g,Zo(g),f,R)}),jb=ru(Fu);function Hb(f,g){var S=k(f);return g==null?S:Zs(S,g)}var Kb=Rn(function(f,g){f=Yn(f);var S=-1,R=g.length,q=R>2?g[2]:e;for(q&&us(g[0],g[1],q)&&(R=1);++S<R;)for(var Q=g[S],st=Ia(Q),_t=-1,At=st.length;++_t<At;){var ie=st[_t],oe=f[ie];(oe===e||qn(oe,pa[ie])&&!ur.call(f,ie))&&(f[ie]=Q[ie])}return f}),Jb=Rn(function(f){return f.push(e,r_),vo(z0,e,f)});function Qb(f,g){return wr(f,un(g,3),Uo)}function $b(f,g){return wr(f,un(g,3),ug)}function tw(f,g){return f==null?f:ml(f,un(g,3),Ia)}function ew(f,g){return f==null?f:lg(f,un(g,3),Ia)}function nw(f,g){return f&&Uo(f,un(g,3))}function rw(f,g){return f&&ug(f,un(g,3))}function iw(f){return f==null?[]:vf(f,Zo(f))}function ow(f){return f==null?[]:vf(f,Ia(f))}function Cv(f,g,S){var R=f==null?e:Tr(f,g);return R===e?S:R}function sw(f,g){return f!=null&&iu(f,g,Tc)}function Tv(f,g){return f!=null&&iu(f,g,Tp)}var aw=Jm(function(f,g,S){g!=null&&typeof g.toString!="function"&&(g=Ic.call(g)),f[g]=S},Pv(Ea)),lw=Jm(function(f,g,S){g!=null&&typeof g.toString!="function"&&(g=Ic.call(g)),ur.call(f,g)?f[g].push(S):f[g]=[S]},un),uw=Rn(Ch);function Zo(f){return Ur(f)?pl(f):fg(f)}function Ia(f){return Ur(f)?pl(f,!0):Th(f)}function cw(f,g){var S={};return g=un(g,3),Uo(f,function(R,q,Q){Ys(S,g(R,q,Q),R)}),S}function hw(f,g){var S={};return g=un(g,3),Uo(f,function(R,q,Q){Ys(S,q,g(R,q,Q))}),S}var fw=js(function(f,g,S){Pc(f,g,S)}),z0=js(function(f,g,S,R){Pc(f,g,S,R)}),pw=ru(function(f,g){var S={};if(f==null)return S;var R=!1;g=lr(g,function(Q){return Q=eu(Q,f),R||(R=Q.length>1),Q}),_l(f,Yp(f),S),R&&(S=ki(S,P|D|G,Hy));for(var q=g.length;q--;)Gu(S,g[q]);return S});function dw(f,g){return O0(f,Sn(un(g)))}var gw=ru(function(f,g){return f==null?{}:gg(f,g)});function O0(f,g){if(f==null)return{};var S=lr(Yp(f),function(R){return[R]});return g=un(g),mg(f,S,function(R,q){return g(R,q[0])})}function mw(f,g,S){g=eu(g,f);var R=-1,q=g.length;for(q||(q=1,f=e);++R<q;){var Q=f==null?e:f[Ba(g[R])];Q===e&&(R=q,Q=S),f=Va(Q)?Q.call(f):Q}return f}function _w(f,g,S){return f==null?f:Ph(f,g,S)}function yw(f,g,S,R){return R=typeof R=="function"?R:e,f==null?f:Ph(f,g,S,R)}var k0=e_(Zo),F0=e_(Ia);function vw(f,g,S){var R=je(f),q=R||Xo(f)||xl(f);if(g=un(g,4),S==null){var Q=f&&f.constructor;q?S=R?new Q:[]:Vr(f)?S=Va(Q)?k(Yi(f)):{}:S={}}return(q?Zi:Uo)(f,function(st,_t,At){return g(S,st,_t,At)}),S}function xw(f,g){return f==null?!0:Gu(f,g)}function bw(f,g,S){return f==null?f:qm(f,g,Mc(S))}function ww(f,g,S,R){return R=typeof R=="function"?R:e,f==null?f:qm(f,g,Mc(S),R)}function cd(f){return f==null?[]:ph(f,Zo(f))}function Iw(f){return f==null?[]:ph(f,Ia(f))}function Ew(f,g,S){return S===e&&(S=g,g=e),S!==e&&(S=bl(S),S=S===S?S:0),g!==e&&(g=bl(g),g=g===g?g:0),dl(bl(f),g,S)}function Sw(f,g,S){return g=Bc(g),S===e?(S=g,g=0):S=Bc(S),f=bl(f),cg(f,g,S)}function Cw(f,g,S){if(S&&typeof S!="boolean"&&us(f,g,S)&&(g=S=e),S===e&&(typeof g=="boolean"?(S=g,g=e):typeof f=="boolean"&&(S=f,f=e)),f===e&&g===e?(f=0,g=1):(f=Bc(f),g===e?(g=f,f=0):g=Bc(g)),f>g){var R=f;f=g,g=R}if(S||f%1||g%1){var q=_i();return mi(f+q*(g-f+nh("1e-"+((q+"").length-1))),g)}return Mp(f,g)}var Tw=Dh(function(f,g,S){return g=g.toLowerCase(),f+(S?B0(g):g)});function B0(f){return Av(Ir(f).toLowerCase())}function U0(f){return f=Ir(f),f&&f.replace(zt,bp).replace(rf,"")}function Aw(f,g,S){f=Ir(f),g=ls(g);var R=f.length;S=S===e?R:dl(zn(S),0,R);var q=S;return S-=g.length,S>=0&&f.slice(S,q)==g}function Pw(f){return f=Ir(f),f&&rs.test(f)?f.replace(cn,dh):f}function Lw(f){return f=Ir(f),f&&yo.test(f)?f.replace(qi,"\\$&"):f}var Mw=Dh(function(f,g,S){return f+(S?"-":"")+g.toLowerCase()}),Dw=Dh(function(f,g,S){return f+(S?" ":"")+g.toLowerCase()}),Nw=jm("toLowerCase");function Rw(f,g,S){f=Ir(f),g=zn(g);var R=g?ql(f):0;if(!g||R>=g)return f;var q=(g-R)/2;return qu(Ec(q),S)+f+qu(Ou(q),S)}function zw(f,g,S){f=Ir(f),g=zn(g);var R=g?ql(f):0;return g&&R<g?f+qu(g-R,S):f}function Ow(f,g,S){f=Ir(f),g=zn(g);var R=g?ql(f):0;return g&&R<g?qu(g-R,S)+f:f}function kw(f,g,S){return S||g==null?g=0:g&&(g=+g),yf(Ir(f).replace(Ra,""),g||0)}function Fw(f,g,S){return(S?us(f,g,S):g===e)?g=1:g=zn(g),yg(Ir(f),g)}function Bw(){var f=arguments,g=Ir(f[0]);return f.length<3?g:g.replace(f[1],f[2])}var Uw=Dh(function(f,g,S){return f+(S?"_":"")+g.toLowerCase()});function Vw(f,g,S){return S&&typeof S!="number"&&us(f,g,S)&&(g=S=e),S=S===e?Xn:S>>>0,S?(f=Ir(f),f&&(typeof g=="string"||g!=null&&!Ks(g))&&(g=ls(g),!g&&fa(f))?va(oo(f),0,S):f.split(g,S)):[]}var Gw=Dh(function(f,g,S){return f+(S?" ":"")+Av(g)});function qw(f,g,S){return f=Ir(f),S=S==null?0:dl(zn(S),0,f.length),g=ls(g),f.slice(S,S+g.length)==g}function Xw(f,g,S){var R=C.templateSettings;S&&us(f,g,S)&&(g=e),f=Ir(f),g=U_({},g,R,n_);var q=U_({},g.imports,R.imports,n_),Q=Zo(q),st=ph(q,Q),_t,At,ie=0,oe=g.interpolate||Ae,fe="__p += '",ze=cl((g.escape||Ae).source+"|"+oe.source+"|"+(oe===$n?nt:Ae).source+"|"+(g.evaluate||Ae).source+"|$","g"),Ke="//# sourceURL="+(ur.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++eg+"]")+`
`;f.replace(ze,function(yn,Wn,or,Ga,Js,qa){return or||(or=Ga),fe+=f.slice(ie,qa).replace(we,gh),Wn&&(_t=!0,fe+=`' +
__e(`+Wn+`) +
'`),Js&&(At=!0,fe+=`';
`+Js+`;
__p += '`),or&&(fe+=`' +
((__t = (`+or+`)) == null ? '' : __t) +
'`),ie=qa+yn.length,yn}),fe+=`';
`;var _n=ur.call(g,"variable")&&g.variable;if(!_n)fe=`with (obj) {
`+fe+`
}
`;else if(K.test(_n))throw new mn(l);fe=(At?fe.replace(gn,""):fe).replace(tn,"$1").replace(Ci,"$1;"),fe="function("+(_n||"obj")+`) {
`+(_n?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_t?", __e = _.escape":"")+(At?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+fe+`return __p
}`;var kn=G0(function(){return rr(Q,Ke+"return "+fe).apply(e,st)});if(kn.source=fe,ld(kn))throw kn;return kn}function Zw(f){return Ir(f).toLowerCase()}function Yw(f){return Ir(f).toUpperCase()}function Ww(f,g,S){if(f=Ir(f),f&&(S||g===e))return Ss(f);if(!f||!(g=ls(g)))return f;var R=oo(f),q=oo(g),Q=Vl(R,q),st=yc(R,q)+1;return va(R,Q,st).join("")}function jw(f,g,S){if(f=Ir(f),f&&(S||g===e))return f.slice(0,mf(f)+1);if(!f||!(g=ls(g)))return f;var R=oo(f),q=yc(R,oo(g))+1;return va(R,0,q).join("")}function Hw(f,g,S){if(f=Ir(f),f&&(S||g===e))return f.replace(Ra,"");if(!f||!(g=ls(g)))return f;var R=oo(f),q=Vl(R,oo(g));return va(R,q).join("")}function Kw(f,g){var S=Wt,R=ft;if(Vr(g)){var q="separator"in g?g.separator:q;S="length"in g?zn(g.length):S,R="omission"in g?ls(g.omission):R}f=Ir(f);var Q=f.length;if(fa(f)){var st=oo(f);Q=st.length}if(S>=Q)return f;var _t=S-ql(R);if(_t<1)return R;var At=st?va(st,0,_t).join(""):f.slice(0,_t);if(q===e)return At+R;if(st&&(_t+=At.length-_t),Ks(q)){if(f.slice(_t).search(q)){var ie,oe=At;for(q.global||(q=cl(q.source,Ir(dt.exec(q))+"g")),q.lastIndex=0;ie=q.exec(oe);)var fe=ie.index;At=At.slice(0,fe===e?_t:fe)}}else if(f.indexOf(ls(q),_t)!=_t){var ze=At.lastIndexOf(q);ze>-1&&(At=At.slice(0,ze))}return At+R}function Jw(f){return f=Ir(f),f&&Is.test(f)?f.replace(ro,bc):f}var Qw=Dh(function(f,g,S){return f+(S?" ":"")+g.toUpperCase()}),Av=jm("toUpperCase");function V0(f,g,S){return f=Ir(f),g=S?e:g,g===e?gf(f)?Oo(f):uh(f):f.match(g)||[]}var G0=Rn(function(f,g){try{return vo(f,e,g)}catch(S){return ld(S)?S:new mn(S)}}),$w=ru(function(f,g){return Zi(g,function(S){S=Ba(S),Ys(f,S,Ue(f[S],f))}),f});function t2(f){var g=f==null?0:f.length,S=un();return f=g?lr(f,function(R){if(typeof R[1]!="function")throw new ko(p);return[S(R[0]),R[1]]}):[],Rn(function(R){for(var q=-1;++q<g;){var Q=f[q];if(vo(Q[0],this,R))return vo(Q[1],this,R)}})}function e2(f){return Ih(ki(f,P))}function Pv(f){return function(){return f}}function n2(f,g){return f==null||f!==f?g:f}var r2=Km(),i2=Km(!0);function Ea(f){return f}function Lv(f){return km(typeof f=="function"?f:ki(f,P))}function o2(f){return Ah(ki(f,P))}function s2(f,g){return Fm(f,ki(g,P))}var a2=Rn(function(f,g){return function(S){return Ch(S,f,g)}}),l2=Rn(function(f,g){return function(S){return Ch(f,S,g)}});function Mv(f,g,S){var R=Zo(g),q=vf(g,R);S==null&&!(Vr(g)&&(q.length||!R.length))&&(S=g,g=f,f=this,q=vf(g,Zo(g)));var Q=!(Vr(S)&&"chain"in S)||!!S.chain,st=Va(f);return Zi(q,function(_t){var At=g[_t];f[_t]=At,st&&(f.prototype[_t]=function(){var ie=this.__chain__;if(Q||ie){var oe=f(this.__wrapped__),fe=oe.__actions__=Go(this.__actions__);return fe.push({func:At,args:arguments,thisArg:f}),oe.__chain__=ie,oe}return At.apply(f,ss([this.value()],arguments))})}),f}function u2(){return Pi._===this&&(Pi._=ig),this}function Dv(){}function c2(f){return f=zn(f),Rn(function(g){return dg(g,f)})}var h2=Tf(lr),f2=Tf(hf),p2=Tf(ln);function q0(f){return Ag(f)?Au(Ba(f)):_g(f)}function d2(f){return function(g){return f==null?e:Tr(f,g)}}var g2=Qm(),m2=Qm(!0);function Nv(){return[]}function Rv(){return!1}function _2(){return{}}function y2(){return""}function v2(){return!0}function x2(f,g){if(f=zn(f),f<1||f>pn)return[];var S=Xn,R=mi(f,Xn);g=un(g),f-=Xn;for(var q=ul(R,g);++S<f;)g(S);return q}function b2(f){return je(f)?lr(f,Ba):bi(f)?[f]:Go(d_(Ir(f)))}function w2(f){var g=++rg;return Ir(f)+g}var I2=qp(function(f,g){return f+g},0),E2=Dc("ceil"),S2=qp(function(f,g){return f/g},1),C2=Dc("floor");function T2(f){return f&&f.length?Bu(f,Ea,$l):e}function A2(f,g){return f&&f.length?Bu(f,un(g,2),$l):e}function P2(f){return ch(f,Ea)}function L2(f,g){return ch(f,un(g,2))}function M2(f){return f&&f.length?Bu(f,Ea,bf):e}function D2(f,g){return f&&f.length?Bu(f,un(g,2),bf):e}var N2=qp(function(f,g){return f*g},1),R2=Dc("round"),z2=qp(function(f,g){return f-g},0);function O2(f){return f&&f.length?_c(f,Ea):0}function k2(f,g){return f&&f.length?_c(f,un(g,2)):0}return C.after=ne,C.ary=Qt,C.assign=Yb,C.assignIn=R0,C.assignInWith=U_,C.assignWith=Wb,C.at=jb,C.before=Me,C.bind=Ue,C.bindAll=$w,C.bindKey=Ee,C.castArray=xi,C.chain=Xg,C.chunk=g_,C.compact=Dg,C.concat=Ng,C.cond=t2,C.conforms=e2,C.constant=Pv,C.countBy=yv,C.create=Hb,C.curry=Se,C.curryRight=_e,C.debounce=Pe,C.defaults=Kb,C.defaultsDeep=Jb,C.defer=Ce,C.delay=ce,C.difference=ev,C.differenceBy=nv,C.differenceWith=m_,C.drop=su,C.dropRight=__,C.dropRightWhile=Yu,C.dropWhile=y_,C.fill=v_,C.filter=ad,C.flatMap=vv,C.flatMapDeep=a,C.flatMapDepth=i,C.flatten=x_,C.flattenDeep=rv,C.flattenDepth=b_,C.flip=He,C.flow=r2,C.flowRight=i2,C.fromPairs=w_,C.functions=iw,C.functionsIn=ow,C.groupBy=_,C.initial=I_,C.intersection=Qp,C.intersectionBy=$p,C.intersectionWith=td,C.invert=aw,C.invertBy=lw,C.invokeMap=w,C.iteratee=Lv,C.keyBy=A,C.keys=Zo,C.keysIn=Ia,C.map=M,C.mapKeys=cw,C.mapValues=hw,C.matches=o2,C.matchesProperty=s2,C.memoize=Ve,C.merge=fw,C.mergeWith=z0,C.method=a2,C.methodOf=l2,C.mixin=Mv,C.negate=Sn,C.nthArg=c2,C.omit=pw,C.omitBy=dw,C.once=er,C.orderBy=z,C.over=h2,C.overArgs=Ar,C.overEvery=f2,C.overSome=p2,C.partial=yr,C.partialRight=ji,C.partition=F,C.pick=gw,C.pickBy=O0,C.property=q0,C.propertyOf=d2,C.pull=Oh,C.pullAll=ed,C.pullAllBy=E_,C.pullAllWith=kg,C.pullAt=av,C.range=g2,C.rangeRight=m2,C.rearg=yi,C.reject=j,C.remove=Wu,C.rest=vi,C.reverse=nd,C.sampleSize=ut,C.set=_w,C.setWith=yw,C.shuffle=ct,C.slice=S_,C.sortBy=Lt,C.sortedUniq=Bg,C.sortedUniqBy=Ug,C.split=Vw,C.spread=Fi,C.tail=kh,C.take=fv,C.takeRight=Vg,C.takeRightWhile=C_,C.takeWhile=id,C.tap=Zg,C.throttle=ao,C.thru=Nf,C.toArray=M0,C.toPairs=k0,C.toPairsIn=F0,C.toPath=b2,C.toPlainObject=N0,C.transform=vw,C.unary=wo,C.union=Gg,C.unionBy=pv,C.unionWith=dv,C.uniq=gv,C.uniqBy=mv,C.uniqWith=_v,C.unset=xw,C.unzip=od,C.unzipWith=Br,C.update=bw,C.updateWith=ww,C.values=cd,C.valuesIn=Iw,C.without=kc,C.words=V0,C.wrap=cs,C.xor=T_,C.xorBy=A_,C.xorWith=P_,C.zip=L_,C.zipObject=M_,C.zipObjectDeep=qg,C.zipWith=sd,C.entries=k0,C.entriesIn=F0,C.extend=R0,C.extendWith=U_,Mv(C,C),C.add=I2,C.attempt=G0,C.camelCase=Tw,C.capitalize=B0,C.ceil=E2,C.clamp=Ew,C.clone=lo,C.cloneDeep=qo,C.cloneDeepWith=hs,C.cloneWith=Io,C.conformsTo=fs,C.deburr=U0,C.defaultTo=n2,C.divide=S2,C.endsWith=Aw,C.eq=qn,C.escape=Pw,C.escapeRegExp=Lw,C.every=Yg,C.find=zf,C.findIndex=Rg,C.findKey=Qb,C.findLast=Wg,C.findLastIndex=zg,C.findLastKey=$b,C.floor=C2,C.forEach=u,C.forEachRight=d,C.forIn=tw,C.forInRight=ew,C.forOwn=nw,C.forOwnRight=rw,C.get=Cv,C.gt=Bi,C.gte=An,C.has=sw,C.hasIn=Tv,C.head=Og,C.identity=Ea,C.includes=b,C.indexOf=Jp,C.inRange=Sw,C.invoke=uw,C.isArguments=Ui,C.isArray=je,C.isArrayBuffer=Eo,C.isArrayLike=Ur,C.isArrayLikeObject=pr,C.isBoolean=Ua,C.isBuffer=Xo,C.isDate=wa,C.isElement=Hs,C.isEmpty=ps,C.isEqual=au,C.isEqualWith=Of,C.isError=ld,C.isFinite=jg,C.isFunction=Va,C.isInteger=vl,C.isLength=kf,C.isMap=Hg,C.isMatch=xv,C.isMatchWith=bv,C.isNaN=wv,C.isNative=Iv,C.isNil=Sv,C.isNull=Ev,C.isNumber=F_,C.isObject=Vr,C.isObjectLike=ti,C.isPlainObject=Ff,C.isRegExp=Ks,C.isSafeInteger=ud,C.isSet=Kg,C.isString=uo,C.isSymbol=bi,C.isTypedArray=xl,C.isUndefined=Bf,C.isWeakMap=B_,C.isWeakSet=Fc,C.join=iv,C.kebabCase=Mw,C.last=xa,C.lastIndexOf=ov,C.lowerCase=Dw,C.lowerFirst=Nw,C.lt=qb,C.lte=Xb,C.max=T2,C.maxBy=A2,C.mean=P2,C.meanBy=L2,C.min=M2,C.minBy=D2,C.stubArray=Nv,C.stubFalse=Rv,C.stubObject=_2,C.stubString=y2,C.stubTrue=v2,C.multiply=N2,C.nth=sv,C.noConflict=u2,C.noop=Dv,C.now=qt,C.pad=Rw,C.padEnd=zw,C.padStart=Ow,C.parseInt=kw,C.random=Cw,C.reduce=U,C.reduceRight=X,C.repeat=Fw,C.replace=Bw,C.result=mw,C.round=R2,C.runInContext=Et,C.sample=H,C.size=St,C.snakeCase=Uw,C.some=Rt,C.sortedIndex=lv,C.sortedIndexBy=uv,C.sortedIndexOf=cv,C.sortedLastIndex=rd,C.sortedLastIndexBy=Fg,C.sortedLastIndexOf=hv,C.startCase=Gw,C.startsWith=qw,C.subtract=z2,C.sum=O2,C.sumBy=k2,C.template=Xw,C.times=x2,C.toFinite=Bc,C.toInteger=zn,C.toLength=D0,C.toLower=Zw,C.toNumber=bl,C.toSafeInteger=Zb,C.toString=Ir,C.toUpper=Yw,C.trim=Ww,C.trimEnd=jw,C.trimStart=Hw,C.truncate=Kw,C.unescape=Jw,C.uniqueId=w2,C.upperCase=Qw,C.upperFirst=Av,C.each=u,C.eachRight=d,C.first=Og,Mv(C,function(){var f={};return Uo(C,function(g,S){ur.call(C.prototype,S)||(f[S]=g)}),f}(),{chain:!1}),C.VERSION=r,Zi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){C[f].placeholder=C}),Zi(["drop","take"],function(f,g){W.prototype[f]=function(S){S=S===e?1:Le(zn(S),0);var R=this.__filtered__&&!g?new W(this):this.clone();return R.__filtered__?R.__takeCount__=mi(S,R.__takeCount__):R.__views__.push({size:mi(S,Xn),type:f+(R.__dir__<0?"Right":"")}),R},W.prototype[f+"Right"]=function(S){return this.reverse()[f](S).reverse()}}),Zi(["filter","map","takeWhile"],function(f,g){var S=g+1,R=S==Ft||S==Jt;W.prototype[f]=function(q){var Q=this.clone();return Q.__iteratees__.push({iteratee:un(q,3),type:S}),Q.__filtered__=Q.__filtered__||R,Q}}),Zi(["head","last"],function(f,g){var S="take"+(g?"Right":"");W.prototype[f]=function(){return this[S](1).value()[0]}}),Zi(["initial","tail"],function(f,g){var S="drop"+(g?"":"Right");W.prototype[f]=function(){return this.__filtered__?new W(this):this[S](1)}}),W.prototype.compact=function(){return this.filter(Ea)},W.prototype.find=function(f){return this.filter(f).head()},W.prototype.findLast=function(f){return this.reverse().find(f)},W.prototype.invokeMap=Rn(function(f,g){return typeof f=="function"?new W(this):this.map(function(S){return Ch(S,f,g)})}),W.prototype.reject=function(f){return this.filter(Sn(un(f)))},W.prototype.slice=function(f,g){f=zn(f);var S=this;return S.__filtered__&&(f>0||g<0)?new W(S):(f<0?S=S.takeRight(-f):f&&(S=S.drop(f)),g!==e&&(g=zn(g),S=g<0?S.dropRight(-g):S.take(g-f)),S)},W.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},W.prototype.toArray=function(){return this.take(Xn)},Uo(W.prototype,function(f,g){var S=/^(?:filter|find|map|reject)|While$/.test(g),R=/^(?:head|last)$/.test(g),q=C[R?"take"+(g=="last"?"Right":""):g],Q=R||/^find/.test(g);!q||(C.prototype[g]=function(){var st=this.__wrapped__,_t=R?[1]:arguments,At=st instanceof W,ie=_t[0],oe=At||je(st),fe=function(Wn){var or=q.apply(C,ss([Wn],_t));return R&&ze?or[0]:or};oe&&S&&typeof ie=="function"&&ie.length!=1&&(At=oe=!1);var ze=this.__chain__,Ke=!!this.__actions__.length,_n=Q&&!ze,kn=At&&!Ke;if(!Q&&oe){st=kn?st:new W(this);var yn=f.apply(st,_t);return yn.__actions__.push({func:Nf,args:[fe],thisArg:e}),new Z(yn,ze)}return _n&&kn?f.apply(this,_t):(yn=this.thru(fe),_n?R?yn.value()[0]:yn.value():yn)})}),Zi(["pop","push","shift","sort","splice","unshift"],function(f){var g=hl[f],S=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",R=/^(?:pop|shift)$/.test(f);C.prototype[f]=function(){var q=arguments;if(R&&!this.__chain__){var Q=this.value();return g.apply(je(Q)?Q:[],q)}return this[S](function(st){return g.apply(je(st)?st:[],q)})}}),Uo(W.prototype,function(f,g){var S=C[g];if(S){var R=S.name+"";ur.call(ma,R)||(ma[R]=[]),ma[R].push({name:g,func:S})}}),ma[Gp(e,rt).name]=[{name:"wrapper",func:e}],W.prototype.clone=ot,W.prototype.reverse=J,W.prototype.value=it,C.prototype.at=ba,C.prototype.chain=Rf,C.prototype.commit=D_,C.prototype.next=N_,C.prototype.plant=z_,C.prototype.reverse=O_,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=k_,C.prototype.first=C.prototype.head,Wl&&(C.prototype[Wl]=R_),C},Ts=ng();ua?((ua.exports=Ts)._=Ts,gc._=Ts):Pi._=Ts}).call(Uf)})(r0,r0.exports);var cS=L0.exports,U1=aS,hS=uS,fS=r0.exports;function Mm(n){n!==void 0&&this.loadFeatureCollection(n)}function Fb(n,t){var e=t.geometry.coordinates[0];if(U1(n,e)){for(var r=1;r<t.geometry.coordinates.length;r++)if(U1(n,t.geometry.coordinates[r]))return!1;return!0}return!1}Mm.prototype.searchForOnePolygon=function(t,e){var r=this.rtree.search({minX:t,minY:e,maxX:t,maxY:e}),s=[t,e],c=r.map(function(p,l){return this.polygons[r[l].polyId]},this);return fS.find(c,function(p){return Fb(s,p)})};Mm.prototype.searchForMultiplePolygons=function(t,e,r){r===-1&&(r=Number.MAX_SAFE_INTEGER);var s=[t,e],c=this.rtree.search({minX:t,minY:e,maxX:t,maxY:e}),p=c.map(function(x,I){return this.polygons[c[I].polyId]},this),l=0;return p=p.filter(function(x){if(l>=r)return!1;var I=Fb(s,x);return I?(l++,!0):!1}),{type:"FeatureCollection",features:p}};Mm.prototype.search=function(t,e,r){return r===void 0?this.searchForOnePolygon(t,e):this.searchForMultiplePolygons(t,e,r)};Mm.prototype.loadFeatureCollection=function(t){var e=[],r=[],s=0;function c(l){r.push(l);var x=hS.getBoundingBox(l.geometry.coordinates[0]);x.polyId=s++,e.push(x)}function p(l){if(l.geometry&&l.geometry.coordinates[0]!==void 0&&l.geometry.coordinates[0].length>0)switch(l.geometry.type){case"Polygon":c(l);break;case"MultiPolygon":for(var x=l.geometry.coordinates,I=0;I<x.length;I++){var T={type:"Feature",properties:l.properties,geometry:{type:"Polygon",coordinates:x[I]}};c(T)}break}}t.features.forEach(p),this.rtree=new cS().load(e),this.polygons=r};var pS=Mm;function dS(n){let t;return{c(){t=ae("i"),this.h()},l(e){t=le(e,"I",{class:!0}),he(t).forEach(vt),this.h()},h(){Dt(t,"class","bi bi-square-fill")},m(e,r){de(e,t,r)},d(e){e&&vt(t)}}}function gS(n){let t;return{c(){t=ae("i"),this.h()},l(e){t=le(e,"I",{class:!0}),he(t).forEach(vt),this.h()},h(){Dt(t,"class","bi bi-pencil-fill")},m(e,r){de(e,t,r)},d(e){e&&vt(t)}}}function mS(n){let t;return{c(){t=ae("i"),this.h()},l(e){t=le(e,"I",{class:!0}),he(t).forEach(vt),this.h()},h(){Dt(t,"class","bi bi-house-door-fill")},m(e,r){de(e,t,r)},d(e){e&&vt(t)}}}function _S(n){let t,e,r,s,c,p,l;function x(P,D){var G,Y;return((G=P[1])==null?void 0:G.type)==="address"?mS:((Y=P[1])==null?void 0:Y.type)==="school"?gS:dS}let I=x(n),T=I(n);return{c(){t=ae("div"),e=rn(),r=ae("div"),s=ae("div"),T.c(),c=rn(),p=ae("div"),l=ae("span"),this.h()},l(P){t=le(P,"DIV",{class:!0,id:!0}),he(t).forEach(vt),e=on(P),r=le(P,"DIV",{id:!0,class:!0});var D=he(r);s=le(D,"DIV",{class:!0,style:!0});var G=he(s);T.l(G),G.forEach(vt),c=on(D),p=le(D,"DIV",{class:!0});var Y=he(p);l=le(Y,"SPAN",{class:!0}),he(l).forEach(vt),Y.forEach(vt),D.forEach(vt),this.h()},h(){var P;Dt(t,"class","map svelte-uuco2x"),Dt(t,"id","map"),Dt(s,"class","bg-white w-100 flex-grow-1 flex-shrink-1 rounded d-flex align-items-center justify-content-center fs-2"),br(s,"color",n[3]((P=n[1])==null?void 0:P.value)),Dt(l,"class","arrow-down svelte-uuco2x"),Dt(p,"class","text-white flex-grow-0 flex-shrink-0 d-flex justify-content-center"),Dt(r,"id","markerContainer"),Dt(r,"class","d-flex flex-column justify-content-center svelte-uuco2x")},m(P,D){de(P,t,D),n[11](t),de(P,e,D),de(P,r,D),Xt(r,s),T.m(s,null),Xt(r,c),Xt(r,p),Xt(p,l),n[12](r)},p(P,[D]){var G;I!==(I=x(P))&&(T.d(1),T=I(P),T&&(T.c(),T.m(s,null))),D&10&&br(s,"color",P[3]((G=P[1])==null?void 0:G.value))},i:Gr,o:Gr,d(P){P&&vt(t),n[11](null),P&&vt(e),P&&vt(r),T.d(),n[12](null)}}}const Q_=15;function yS(n,t,e){let r,s,c,p,l;Ms(n,Hv,Zt=>e(14,s=Zt)),Ms(n,Gc,Zt=>e(1,c=Zt)),Ms(n,Gx,Zt=>e(3,p=Zt));let{gridRawData:x,schools:I}=t;const T="SSN7TaGjnXj55RMzgIwF";let P,D,G,Y,et;const at=eE("(min-width: 768px)");Ms(n,at,Zt=>e(10,l=Zt));const rt=oE(x,x.objects.test),wt=lE(x,x.objects.test.geometries),xt=cy(eS(wt,10));Hv.set(rE(x)),Vx.set(wt),rt.features.forEach((Zt,Mt)=>{Zt.id=Mt,Zt.properties.color=p(Zt.properties.NO2_stima)});const Gt=new pS(rt);F2(()=>{e(7,P=new $g.exports.Map({container:D,style:`https://api.maptiler.com/maps/toner/style.json?key=${T}`,bounds:s,fitBoundsOptions:{padding:20},maxZoom:16,minZoom:11,maxBounds:xt}));const Zt=new $g.exports.GeolocateControl({positionOptions:{enableHighAccuracy:!0}});Zt.on("geolocate",function(Mt){const It=Gt.search(Mt.coords.longitude,Mt.coords.latitude),Wt=X_(It);Gc.set({type:"grid",address:Wt.geometry.coordinates.map(ft=>ft.toFixed(5)).join(","),readableAddress:Wt.geometry.coordinates.map(ft=>ft.toFixed(5)).join(","),value:It.properties.NO2_stima,feature:{...Wt,proporties:It.properties},square:It})}),P.addControl(Zt,"bottom-left"),P.addControl(new $g.exports.NavigationControl({showCompass:!1}),"bottom-left"),P.on("load",function(){const Mt=P.getStyle().layers;let It="";P.setPaintProperty("road_label_primary","text-color","rgba(0,0,0,0.5)"),P.setPaintProperty("road_label_primary","text-halo-width",1),P.setPaintProperty("road_label_primary","text-halo-color","rgba(255,255,255,0.5)"),P.setPaintProperty("road_label_secondary","text-color","rgba(0,0,0,0.5)"),P.setPaintProperty("road_label_secondary","text-halo-width",1),P.setPaintProperty("road_label_secondary","text-halo-color","rgba(255,255,255,0.5)");for(let Wt=0;Wt<Mt.length;Wt++){if(Mt[Wt].type==="symbol"&&Mt[Wt].layout["text-field"]&&Mt[Wt].id!=="waterway_label"){It=Mt[Wt].id;break}if((Mt[Wt].id==="water"||Mt[Wt].id==="waterway")&&P.setPaintProperty(Mt[Wt].id,`${Mt[Wt].type}-color`,"#d4dadc"),["road_secondary","road_primary","road_highway"].includes(Mt[Wt].id)){const re={stops:[[10,"#444444"],[12,"#444444"],[15,"#444444"]]};P.setPaintProperty(Mt[Wt].id,`${Mt[Wt].type}-color`,re)}}P.addSource("grid",{type:"geojson",data:rt}),P.addSource("schools",{type:"geojson",data:I}),P.addLayer({id:"grid",type:"fill",source:"grid",paint:{"fill-color":["get","color"],"fill-opacity":.9}},It),P.addLayer({id:"schools",type:"circle",source:"schools",paint:{"circle-color":"black","circle-opacity":.5}},It),P.addLayer({id:"gridLine",type:"line",source:"grid",paint:{"line-color":"white","line-width":["case",["boolean",["feature-state","hover"],!1],3,0]}},It),P.addSource("selectedGrid",{type:"geojson",data:null}),P.addLayer({id:"selectedGrid",type:"line",source:"selectedGrid",minzoom:15,paint:{"line-color":"white","line-width":3}},It)}),P.on("mousemove","grid",function(Mt){Mt.features.length>0&&(G&&P.setFeatureState({source:"grid",id:G},{hover:!1}),G=Mt.features[0].id,P.setFeatureState({source:"grid",id:G},{hover:!0}))}),P.on("mouseleave","grid",function(){G&&P.setFeatureState({source:"grid",id:G},{hover:!1}),G=null}),P.on("click","grid",function(Mt){const It=X_(Mt.features[0]);Gc.set({type:"grid",address:It.geometry.coordinates.map(Wt=>Wt.toFixed(5)).join(","),readableAddress:It.geometry.coordinates.map(Wt=>Wt.toFixed(5)).join(","),value:Mt.features[0].properties.NO2_stima,feature:{...It,proporties:Mt.features[0].properties},square:Mt.features[0]})})}),bx(()=>{P&&P.remove()});function ee(Zt){md[Zt?"unshift":"push"](()=>{D=Zt,e(2,D)})}function $t(Zt){md[Zt?"unshift":"push"](()=>{et=Zt,e(0,et)})}return n.$$set=Zt=>{"gridRawData"in Zt&&e(5,x=Zt.gridRawData),"schools"in Zt&&e(6,I=Zt.schools)},n.$$.update=()=>{if(n.$$.dirty&1024&&e(9,r=l?{right:450}:{bottom:150,top:75}),n.$$.dirty&129&&P&&et&&e(8,Y=new $g.exports.Marker({element:et,anchor:"bottom"}).setLngLat([0,0]).addTo(P)),n.$$.dirty&898)if(c&&(c.type==="address"||c.type==="school")){const Zt=Gt.search(...c.feature.geometry.coordinates);if(Gc.update(Mt=>(Mt.value=Zt.properties.NO2_stima,Mt)),P){P.easeTo({center:c.feature.geometry.coordinates,zoom:P.getZoom()>Q_?P.getZoom():Q_,padding:r}),P.getSource("selectedGrid").setData({type:"FeatureCollection",features:[Zt]});const Mt=X_(Zt);Y.setLngLat(Mt.geometry.coordinates)}}else if(c&&c.type==="grid"){if(P!=null&&P.getSource("selectedGrid")){P.getSource("selectedGrid").setData({type:"FeatureCollection",features:[c.square]});const Zt=X_(c.square);Y.setLngLat(Zt.geometry.coordinates),P.flyTo({center:c.feature.geometry.coordinates,zoom:P.getZoom()>Q_?P.getZoom():Q_,padding:r})}}else!c&&(P==null?void 0:P.getSource("selectedGrid"))&&P.getSource("selectedGrid")._data&&P.getSource("selectedGrid").setData({type:"FeatureCollection",features:[]})},[et,c,D,p,at,x,I,P,Y,r,l,ee,$t]}class vS extends $a{constructor(t){super(),tl(this,t,yS,_S,el,{gridRawData:5,schools:6})}}function xS(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function bS(n){return n.type==="Feature"?n.geometry:n}function Bb(n,t,e){if(e===void 0&&(e={}),!n)throw new Error("point is required");if(!t)throw new Error("polygon is required");var r=xS(n),s=bS(t),c=s.type,p=t.bbox,l=s.coordinates;if(p&&wS(r,p)===!1)return!1;c==="Polygon"&&(l=[l]);for(var x=!1,I=0;I<l.length&&!x;I++)if(V1(r,l[I][0],e.ignoreBoundary)){for(var T=!1,P=1;P<l[I].length&&!T;)V1(r,l[I][P],!e.ignoreBoundary)&&(T=!0),P++;T||(x=!0)}return x}function V1(n,t,e){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var s=0,c=t.length-1;s<t.length;c=s++){var p=t[s][0],l=t[s][1],x=t[c][0],I=t[c][1],T=n[1]*(p-x)+l*(x-n[0])+I*(n[0]-p)===0&&(p-n[0])*(x-n[0])<=0&&(l-n[1])*(I-n[1])<=0;if(T)return!e;var P=l>n[1]!=I>n[1]&&n[0]<(x-p)*(n[1]-l)/(I-l)+p;P&&(r=!r)}return r}function wS(n,t){return t[0]<=n[0]&&t[1]<=n[1]&&t[2]>=n[0]&&t[3]>=n[1]}function G1(n){return Object.prototype.toString.call(n)==="[object Date]"}function i0(n,t){if(n===t||n!==n)return()=>n;const e=typeof n;if(e!==typeof t||Array.isArray(n)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const r=t.map((s,c)=>i0(n[c],s));return s=>r.map(c=>c(s))}if(e==="object"){if(!n||!t)throw new Error("Object cannot be null");if(G1(n)&&G1(t)){n=n.getTime(),t=t.getTime();const c=t-n;return p=>new Date(n+p*c)}const r=Object.keys(t),s={};return r.forEach(c=>{s[c]=i0(n[c],t[c])}),c=>{const p={};return r.forEach(l=>{p[l]=s[l](c)}),p}}if(e==="number"){const r=t-n;return s=>n+s*r}throw new Error(`Cannot interpolate ${e} values`)}function oy(n,t={}){const e=Yd(n);let r,s=n;function c(p,l){if(n==null)return e.set(n=p),Promise.resolve();s=p;let x=r,I=!1,{delay:T=0,duration:P=400,easing:D=xx,interpolate:G=i0}=Z0(Z0({},t),l);if(P===0)return x&&(x.abort(),x=null),e.set(n=s),Promise.resolve();const Y=B2()+T;let et;return r=U2(at=>{if(at<Y)return!0;I||(et=G(n,p),typeof P=="function"&&(P=P(n,p)),I=!0),x&&(x.abort(),x=null);const rt=at-Y;return rt>P?(e.set(n=p),!1):(e.set(n=et(D(rt/P))),!0)}),r.promise}return{set:c,update:(p,l)=>c(p(s,n),l),subscribe:e.subscribe}}function q1(n,t,e){const r=n.slice();return r[10]=t[e],r[12]=e,r}function X1(n,t,e){const r=n.slice();return r[10]=t[e],r}function Z1(n,t,e){const r=n.slice();return r[15]=t[e],r}function Y1(n,t,e){const r=n.slice();return r[10]=t[e],r}function W1(n,t,e){const r=n.slice();return r[20]=t[e],r}function j1(n){let t,e=n[20]+"",r;return{c(){t=ae("div"),r=Ge(e),this.h()},l(s){t=le(s,"DIV",{class:!0});var c=he(t);r=qe(c,e),c.forEach(vt),this.h()},h(){Dt(t,"class","fs-7")},m(s,c){de(s,t,c),Xt(t,r)},p(s,c){c&4&&e!==(e=s[20]+"")&&To(r,e)},d(s){s&&vt(t)}}}function H1(n){let t,e=n[10].value+"",r,s;return{c(){t=ae("div"),r=Ge(e),s=rn(),this.h()},l(c){t=le(c,"DIV",{style:!0,class:!0});var p=he(t);r=qe(p,e),s=on(p),p.forEach(vt),this.h()},h(){br(t,"margin-left",n[3](n[10].value)+"%"),Dt(t,"class","annotationValue position-absolute fs-7 svelte-1dsgy3y")},m(c,p){de(c,t,p),Xt(t,r),Xt(t,s)},p(c,p){p&8&&br(t,"margin-left",c[3](c[10].value)+"%")},d(c){c&&vt(t)}}}function K1(n){let t;return{c(){t=ae("div"),this.h()},l(e){t=le(e,"DIV",{class:!0,style:!0}),he(t).forEach(vt),this.h()},h(){Dt(t,"class","step h-100 svelte-1dsgy3y"),br(t,"background-color",n[2](n[4](n[15])))},m(e,r){de(e,t,r)},p(e,r){r&52&&br(t,"background-color",e[2](e[4](e[15])))},d(e){e&&vt(t)}}}function J1(n){let t;return{c(){t=ae("div"),this.h()},l(e){t=le(e,"DIV",{style:!0,class:!0}),he(t).forEach(vt),this.h()},h(){br(t,"margin-left",n[3](n[10].value)+"%"),Dt(t,"class","annotationBar bg-dark border border-white position-absolute h-100 svelte-1dsgy3y")},m(e,r){de(e,t,r)},p(e,r){r&8&&br(t,"margin-left",e[3](e[10].value)+"%")},d(e){e&&vt(t)}}}function Q1(n){let t,e=n[10].text+"",r,s;return{c(){t=ae("div"),r=Ge(e),s=rn(),this.h()},l(c){t=le(c,"DIV",{style:!0,class:!0});var p=he(t);r=qe(p,e),s=on(p),p.forEach(vt),this.h()},h(){br(t,"margin-left",(n[12]?0:n[3](n[10].value))+"%"),br(t,"left",(n[12]?n[3](n[10].value):0)+"%"),Dt(t,"class","annotationText fs-7 text-center lh-1 svelte-1dsgy3y"),Ki(t,"position-absolute",n[12]>0)},m(c,p){de(c,t,p),Xt(t,r),Xt(t,s)},p(c,p){p&8&&br(t,"margin-left",(c[12]?0:c[3](c[10].value))+"%"),p&8&&br(t,"left",(c[12]?c[3](c[10].value):0)+"%")},d(c){c&&vt(t)}}}function IS(n){let t,e,r,s,c,p,l,x,I,T,P=Math.round(n[6])+"",D,G,Y,et=n[2].domain(),at=[];for(let It=0;It<et.length;It+=1)at[It]=j1(W1(n,et,It));let rt=n[8],wt=[];for(let It=0;It<rt.length;It+=1)wt[It]=H1(Y1(n,rt,It));let xt=n[5],Gt=[];for(let It=0;It<xt.length;It+=1)Gt[It]=K1(Z1(n,xt,It));let ee=n[8],$t=[];for(let It=0;It<ee.length;It+=1)$t[It]=J1(X1(n,ee,It));let Zt=n[8],Mt=[];for(let It=0;It<Zt.length;It+=1)Mt[It]=Q1(q1(n,Zt,It));return{c(){t=ae("div"),e=ae("div");for(let It=0;It<at.length;It+=1)at[It].c();r=rn();for(let It=0;It<wt.length;It+=1)wt[It].c();s=rn(),c=ae("div"),p=ae("div");for(let It=0;It<Gt.length;It+=1)Gt[It].c();x=rn();for(let It=0;It<$t.length;It+=1)$t[It].c();I=rn(),T=ae("div"),D=Ge(P),G=rn(),Y=ae("div");for(let It=0;It<Mt.length;It+=1)Mt[It].c();this.h()},l(It){t=le(It,"DIV",{class:!0});var Wt=he(t);e=le(Wt,"DIV",{class:!0});var ft=he(e);for(let Jt=0;Jt<at.length;Jt+=1)at[Jt].l(ft);r=on(ft);for(let Jt=0;Jt<wt.length;Jt+=1)wt[Jt].l(ft);ft.forEach(vt),s=on(Wt),c=le(Wt,"DIV",{class:!0});var re=he(c);p=le(re,"DIV",{class:!0});var Yt=he(p);for(let Jt=0;Jt<Gt.length;Jt+=1)Gt[Jt].l(Yt);Yt.forEach(vt),x=on(re);for(let Jt=0;Jt<$t.length;Jt+=1)$t[Jt].l(re);I=on(re),T=le(re,"DIV",{style:!0,class:!0});var Ft=he(T);D=qe(Ft,P),Ft.forEach(vt),re.forEach(vt),G=on(Wt),Y=le(Wt,"DIV",{class:!0});var Oe=he(Y);for(let Jt=0;Jt<Mt.length;Jt+=1)Mt[Jt].l(Oe);Oe.forEach(vt),Wt.forEach(vt),this.h()},h(){Dt(e,"class","d-flex justify-content-between position-relative"),Dt(p,"class","bg-gradient rounded-pill overflow-hidden position-absolute w-100 d-flex svelte-1dsgy3y"),by(()=>n[9].call(p)),br(T,"margin-left",n[3](n[0])+"%"),br(T,"color",n[2](n[0])),Dt(T,"class","value border border-dark-gray fw-bold rounded-circle bg-white d-flex align-items-center justify-content-center position-relative svelte-1dsgy3y"),Dt(c,"class","w-100 position-relative"),Dt(Y,"class","w-100 position-relative mt-2 d-flex"),Dt(t,"class","barContainer w-100")},m(It,Wt){de(It,t,Wt),Xt(t,e);for(let ft=0;ft<at.length;ft+=1)at[ft].m(e,null);Xt(e,r);for(let ft=0;ft<wt.length;ft+=1)wt[ft].m(e,null);Xt(t,s),Xt(t,c),Xt(c,p);for(let ft=0;ft<Gt.length;ft+=1)Gt[ft].m(p,null);l=V2(p,n[9].bind(p)),Xt(c,x);for(let ft=0;ft<$t.length;ft+=1)$t[ft].m(c,null);Xt(c,I),Xt(c,T),Xt(T,D),Xt(t,G),Xt(t,Y);for(let ft=0;ft<Mt.length;ft+=1)Mt[ft].m(Y,null)},p(It,[Wt]){if(Wt&4){et=It[2].domain();let ft;for(ft=0;ft<et.length;ft+=1){const re=W1(It,et,ft);at[ft]?at[ft].p(re,Wt):(at[ft]=j1(re),at[ft].c(),at[ft].m(e,r))}for(;ft<at.length;ft+=1)at[ft].d(1);at.length=et.length}if(Wt&264){rt=It[8];let ft;for(ft=0;ft<rt.length;ft+=1){const re=Y1(It,rt,ft);wt[ft]?wt[ft].p(re,Wt):(wt[ft]=H1(re),wt[ft].c(),wt[ft].m(e,null))}for(;ft<wt.length;ft+=1)wt[ft].d(1);wt.length=rt.length}if(Wt&52){xt=It[5];let ft;for(ft=0;ft<xt.length;ft+=1){const re=Z1(It,xt,ft);Gt[ft]?Gt[ft].p(re,Wt):(Gt[ft]=K1(re),Gt[ft].c(),Gt[ft].m(p,null))}for(;ft<Gt.length;ft+=1)Gt[ft].d(1);Gt.length=xt.length}if(Wt&264){ee=It[8];let ft;for(ft=0;ft<ee.length;ft+=1){const re=X1(It,ee,ft);$t[ft]?$t[ft].p(re,Wt):($t[ft]=J1(re),$t[ft].c(),$t[ft].m(c,I))}for(;ft<$t.length;ft+=1)$t[ft].d(1);$t.length=ee.length}if(Wt&64&&P!==(P=Math.round(It[6])+"")&&To(D,P),Wt&9&&br(T,"margin-left",It[3](It[0])+"%"),Wt&5&&br(T,"color",It[2](It[0])),Wt&264){Zt=It[8];let ft;for(ft=0;ft<Zt.length;ft+=1){const re=q1(It,Zt,ft);Mt[ft]?Mt[ft].p(re,Wt):(Mt[ft]=Q1(re),Mt[ft].c(),Mt[ft].m(Y,null))}for(;ft<Mt.length;ft+=1)Mt[ft].d(1);Mt.length=Zt.length}},i:Gr,o:Gr,d(It){It&&vt(t),Vc(at,It),Vc(wt,It),Vc(Gt,It),l(),Vc($t,It),Vc(Mt,It)}}}function ES(n,t,e){let r,s,c,p,l;Ms(n,Gx,G=>e(2,p=G));let{value:x}=t,I;const T=oy(void 0);Ms(n,T,G=>e(6,l=G));const P=[{value:10,text:"Soglia annua a tutela della salute"},{value:40,text:"Limite medio annuo di legge"}];function D(){I=this.clientWidth,e(1,I)}return n.$$set=G=>{"value"in G&&e(0,x=G.value)},n.$$.update=()=>{n.$$.dirty&2&&e(5,r=nI(I)),n.$$.dirty&6&&e(4,s=am().domain([0,I]).range(p.domain())),n.$$.dirty&4&&e(3,c=am().range([0,100]).domain(p.domain())),n.$$.dirty&1&&T.set(x)},[x,I,p,c,s,r,l,T,P,D]}class SS extends $a{constructor(t){super(),tl(this,t,ES,IS,el,{value:0})}}function CS(n){let t,e,r;const s=n[4].default,c=Gd(s,n,n[3],null);return{c(){t=ae("div"),c&&c.c(),this.h()},l(p){t=le(p,"DIV",{class:!0,style:!0});var l=he(t);c&&c.l(l),l.forEach(vt),this.h()},h(){Dt(t,"class",e=Y0(`box bg-white  rounded p-3 mb-2 position-relative ${n[2]}`)+" svelte-etpmoz"),br(t,"height",n[0]?n[0]:"auto"),br(t,"background-image",n[1]?"linear-gradient(180deg, rgba(41, 41, 72, 0.5) 40%, rgba(47, 47, 74, 0) 100%), "+n[1]:"unset")},m(p,l){de(p,t,l),c&&c.m(t,null),r=!0},p(p,[l]){c&&c.p&&(!r||l&8)&&qd(c,s,p,p[3],r?Zd(s,p[3],l,null):Xd(p[3]),null),(!r||l&4&&e!==(e=Y0(`box bg-white  rounded p-3 mb-2 position-relative ${p[2]}`)+" svelte-etpmoz"))&&Dt(t,"class",e),(!r||l&1)&&br(t,"height",p[0]?p[0]:"auto"),(!r||l&2)&&br(t,"background-image",p[1]?"linear-gradient(180deg, rgba(41, 41, 72, 0.5) 40%, rgba(47, 47, 74, 0) 100%), "+p[1]:"unset")},i(p){r||(Ye(c,p),r=!0)},o(p){en(c,p),r=!1},d(p){p&&vt(t),c&&c.d(p)}}}function TS(n,t,e){let{$$slots:r={},$$scope:s}=t,{height:c,background:p,className:l}=t;return n.$$set=x=>{"height"in x&&e(0,c=x.height),"background"in x&&e(1,p=x.background),"className"in x&&e(2,l=x.className),"$$scope"in x&&e(3,s=x.$$scope)},[c,p,l,s,r]}class Sa extends $a{constructor(t){super(),tl(this,t,TS,CS,el,{height:0,background:1,className:2})}}function AS(n){let t,e;return{c(){t=ae("a"),e=ae("i"),this.h()},l(r){t=le(r,"A",{style:!0,class:!0,role:!0,href:!0,target:!0});var s=he(t);e=le(s,"I",{class:!0}),he(e).forEach(vt),s.forEach(vt),this.h()},h(){Dt(e,"class","fs-2 bi bi-twitter text-info"),br(t,"width","50px"),br(t,"height","50px"),Dt(t,"class","rounded-circle btn btn-lg btn-dark-gray p-0 d-flex align-items-center justify-content-center mx-1 lh-1"),Dt(t,"role","button"),Dt(t,"href",n[0]),Dt(t,"target","_blank")},m(r,s){de(r,t,s),Xt(t,e)},p(r,[s]){s&1&&Dt(t,"href",r[0])},i:Gr,o:Gr,d(r){r&&vt(t)}}}function PS(n,t,e){let r,s,{text:c}=t,{url:p}=t,{hashtags:l}=t,{via:x}=t,{related:I}=t;return n.$$set=T=>{"text"in T&&e(1,c=T.text),"url"in T&&e(2,p=T.url),"hashtags"in T&&e(3,l=T.hashtags),"via"in T&&e(4,x=T.via),"related"in T&&e(5,I=T.related)},n.$$.update=()=>{n.$$.dirty&62&&e(6,r=[c&&`text=${encodeURIComponent(c)}`,p&&`url=${encodeURIComponent(p)}`,l&&`hashtags=${l}`,x&&`via=${encodeURIComponent(x)}`,I&&`related=${encodeURIComponent(I)}`].filter(Boolean).join("&")),n.$$.dirty&64&&e(0,s=`https://twitter.com/intent/tweet?${r}`)},[s,c,p,l,x,I,r]}class LS extends $a{constructor(t){super(),tl(this,t,PS,AS,el,{text:1,url:2,hashtags:3,via:4,related:5})}}function MS(n){let t,e;return{c(){t=ae("a"),e=ae("i"),this.h()},l(r){t=le(r,"A",{style:!0,class:!0,role:!0,href:!0,target:!0});var s=he(t);e=le(s,"I",{class:!0}),he(e).forEach(vt),s.forEach(vt),this.h()},h(){Dt(e,"class","fs-2 bi bi-facebook text-primary"),br(t,"width","50px"),br(t,"height","50px"),Dt(t,"class","rounded-circle btn btn-dark-gray btn-lg p-0 d-flex align-items-center justify-content-center mx-1 lh-1"),Dt(t,"role","button"),Dt(t,"href",n[0]),Dt(t,"target","_blank")},m(r,s){de(r,t,s),Xt(t,e)},p(r,[s]){s&1&&Dt(t,"href",r[0])},i:Gr,o:Gr,d(r){r&&vt(t)}}}function DS(n,t,e){let r,s,{url:c}=t;return n.$$set=p=>{"url"in p&&e(1,c=p.url)},n.$$.update=()=>{n.$$.dirty&2&&e(2,r=[c&&`u=${encodeURIComponent(c)}`].filter(Boolean).join("&")),n.$$.dirty&4&&e(0,s=`https://facebook.com/sharer/sharer.php?${r}`)},[s,c,r]}class NS extends $a{constructor(t){super(),tl(this,t,DS,MS,el,{url:1})}}function RS(n){let t,e;return{c(){t=ae("a"),e=ae("i"),this.h()},l(r){t=le(r,"A",{style:!0,class:!0,role:!0,href:!0,target:!0});var s=he(t);e=le(s,"I",{class:!0}),he(e).forEach(vt),s.forEach(vt),this.h()},h(){Dt(e,"class","fs-2 bi bi-whatsapp whatsapp svelte-4ak1q5"),br(t,"width","50px"),br(t,"height","50px"),Dt(t,"class","rounded-circle btn btn-dark-gray btn-lg p-0 d-flex align-items-center justify-content-center mx-1 lh-1"),Dt(t,"role","button"),Dt(t,"href",n[0]),Dt(t,"target","_blank")},m(r,s){de(r,t,s),Xt(t,e)},p(r,[s]){s&1&&Dt(t,"href",r[0])},i:Gr,o:Gr,d(r){r&&vt(t)}}}function zS(n,t,e){let r,s,{text:c}=t;return n.$$set=p=>{"text"in p&&e(1,c=p.text)},n.$$.update=()=>{n.$$.dirty&2&&e(2,r=[c&&`text=${encodeURIComponent(c)}`].filter(Boolean).join("&")),n.$$.dirty&4&&e(0,s=`https://wa.me/?${r}`)},[s,c,r]}class OS extends $a{constructor(t){super(),tl(this,t,zS,RS,el,{text:1})}}function kS(n){let t,e;return{c(){t=ae("a"),e=ae("i"),this.h()},l(r){t=le(r,"A",{style:!0,class:!0,role:!0,href:!0,target:!0});var s=he(t);e=le(s,"I",{class:!0}),he(e).forEach(vt),s.forEach(vt),this.h()},h(){Dt(e,"class","fs-2 bi bi-telegram telegram svelte-1dbpal6"),br(t,"width","50px"),br(t,"height","50px"),Dt(t,"class","rounded-circle btn btn-dark-gray p-0 btn-lg d-flex align-items-center justify-content-center mx-1 lh-1"),Dt(t,"role","button"),Dt(t,"href",n[0]),Dt(t,"target","_blank")},m(r,s){de(r,t,s),Xt(t,e)},p(r,[s]){s&1&&Dt(t,"href",r[0])},i:Gr,o:Gr,d(r){r&&vt(t)}}}function FS(n,t,e){let r,s,{text:c}=t,{url:p}=t;return n.$$set=l=>{"text"in l&&e(1,c=l.text),"url"in l&&e(2,p=l.url)},n.$$.update=()=>{n.$$.dirty&6&&e(3,r=[c&&`text=${encodeURIComponent(c)}`,p&&`url=${encodeURIComponent(p)}`].filter(Boolean).join("&")),n.$$.dirty&8&&e(0,s=`https://t.me/share/url?${r}`)},[s,c,p,r]}class BS extends $a{constructor(t){super(),tl(this,t,FS,kS,el,{text:1,url:2})}}function $1(n,t,e){const r=n.slice();return r[12]=t[e],r[14]=e,r}function US(n){let t;return{c(){t=Ge(".")},l(e){t=qe(e,".")},m(e,r){de(e,t,r)},d(e){e&&vt(t)}}}function VS(n){let t="e ",e;return{c(){e=Ge(t)},l(r){e=qe(r,t)},m(r,s){de(r,e,s)},d(r){r&&vt(e)}}}function tx(n){let t=n[12]+"",e,r,s,c=Math.round(n[1]["percentage"+n[14]])+"",p,l,x,I;function T(G,Y){return G[14]===0?VS:US}let D=T(n)(n);return{c(){e=Ge(t),r=Ge(`
		del `),s=ae("b"),p=Ge(c),l=Ge("%"),x=rn(),D.c(),I=ri()},l(G){e=qe(G,t),r=qe(G,`
		del `),s=le(G,"B",{});var Y=he(s);p=qe(Y,c),l=qe(Y,"%"),Y.forEach(vt),x=on(G),D.l(G),I=ri()},m(G,Y){de(G,e,Y),de(G,r,Y),de(G,s,Y),Xt(s,p),Xt(s,l),de(G,x,Y),D.m(G,Y),de(G,I,Y)},p(G,Y){Y&1&&t!==(t=G[12]+"")&&To(e,t),Y&2&&c!==(c=Math.round(G[1]["percentage"+G[14]])+"")&&To(p,c)},d(G){G&&vt(e),G&&vt(r),G&&vt(s),G&&vt(x),D.d(G),G&&vt(I)}}}function GS(n){let t,e,r,s=Math.round(n[2])+"",c,p,l,x,I,T,P=n[0],D=[];for(let G=0;G<P.length;G+=1)D[G]=tx($1(n,P,G));return{c(){t=ae("p"),e=Ge("L'esposizione cronica a "),r=ae("b"),c=Ge(s),p=Ge(" \xB5g/m3"),l=Ge(" di NO"),x=ae("sub"),I=Ge("2"),T=Ge(` comporta un aumento
	del rischio `);for(let G=0;G<D.length;G+=1)D[G].c();this.h()},l(G){t=le(G,"P",{class:!0});var Y=he(t);e=qe(Y,"L'esposizione cronica a "),r=le(Y,"B",{});var et=he(r);c=qe(et,s),p=qe(et," \xB5g/m3"),et.forEach(vt),l=qe(Y," di NO"),x=le(Y,"SUB",{});var at=he(x);I=qe(at,"2"),at.forEach(vt),T=qe(Y,` comporta un aumento
	del rischio `);for(let rt=0;rt<D.length;rt+=1)D[rt].l(Y);Y.forEach(vt),this.h()},h(){Dt(t,"class","fs-5 mb-0")},m(G,Y){de(G,t,Y),Xt(t,e),Xt(t,r),Xt(r,c),Xt(r,p),Xt(t,l),Xt(t,x),Xt(x,I),Xt(t,T);for(let et=0;et<D.length;et+=1)D[et].m(t,null)},p(G,[Y]){if(Y&4&&s!==(s=Math.round(G[2])+"")&&To(c,s),Y&3){P=G[0];let et;for(et=0;et<P.length;et+=1){const at=$1(G,P,et);D[et]?D[et].p(at,Y):(D[et]=tx(at),D[et].c(),D[et].m(t,null))}for(;et<D.length;et+=1)D[et].d(1);D.length=P.length}},i:Gr,o:Gr,d(G){G&&vt(t),Vc(D,G)}}}function qS(n,t,e){let r,s,c,p,l,x,I;Ms(n,Gc,et=>e(10,x=et));let{value:T}=t;const P=oy(void 0);Ms(n,P,et=>e(9,l=et));const D=oy(void 0);Ms(n,D,et=>e(8,p=et));const G=oy(void 0);Ms(n,G,et=>e(2,I=et));const Y={address:{"di mortalit\xE0":4,"di infarto":3},grid:{"di mortalit\xE0":4,"di infarto":3},school:{"di asma nei bambini e giovani":12,"di infezioni respiratorie acute nei bambini":9}};return n.$$set=et=>{"value"in et&&e(6,T=et.value)},n.$$.update=()=>{n.$$.dirty&1024&&e(7,r=x.type),n.$$.dirty&768&&e(1,s={percentage0:l,percentage1:p}),n.$$.dirty&128&&e(0,c=Object.keys(Y[r])),n.$$.dirty&193&&(P.set(Math.floor(T/10)*Y[r][c[0]]),D.set(Math.floor(T/10)*Y[r][c[1]])),n.$$.dirty&64&&G.set(T)},[c,s,I,P,D,G,T,r,p,l,x]}class XS extends $a{constructor(t){super(),tl(this,t,qS,GS,el,{value:6})}}function ZS(n){var Y;let t,e,r,s,c,p,l,x,I,T,P,D,G;return D=new SS({props:{value:(Y=n[2])==null?void 0:Y.value}}),{c(){t=ae("p"),e=Ge("concentrazione di NO"),r=ae("sub"),s=Ge("2"),c=rn(),p=ae("span"),l=Ge("(\xB5g/m"),x=ae("sup"),I=Ge("3"),T=Ge(")"),P=rn(),qr(D.$$.fragment),this.h()},l(et){t=le(et,"P",{class:!0});var at=he(t);e=qe(at,"concentrazione di NO"),r=le(at,"SUB",{});var rt=he(r);s=qe(rt,"2"),rt.forEach(vt),c=on(at),p=le(at,"SPAN",{class:!0});var wt=he(p);l=qe(wt,"(\xB5g/m"),x=le(wt,"SUP",{});var xt=he(x);I=qe(xt,"3"),xt.forEach(vt),T=qe(wt,")"),wt.forEach(vt),at.forEach(vt),P=on(et),Xr(D.$$.fragment,et),this.h()},h(){Dt(p,"class","text-lowercase"),Dt(t,"class","m-0 fs-6 fw-semibold text-uppercase text-center mb-2")},m(et,at){de(et,t,at),Xt(t,e),Xt(t,r),Xt(r,s),Xt(t,c),Xt(t,p),Xt(p,l),Xt(p,x),Xt(x,I),Xt(p,T),de(et,P,at),Zr(D,et,at),G=!0},p(et,at){var wt;const rt={};at&4&&(rt.value=(wt=et[2])==null?void 0:wt.value),D.$set(rt)},i(et){G||(Ye(D.$$.fragment,et),G=!0)},o(et){en(D.$$.fragment,et),G=!1},d(et){et&&vt(t),et&&vt(P),Yr(D,et)}}}function YS(n){let t,e;return t=new Sa({props:{height:"165px",background:`url(${n[7]})`,$$slots:{default:[jS]},$$scope:{ctx:n}}}),{c(){qr(t.$$.fragment)},l(r){Xr(t.$$.fragment,r)},m(r,s){Zr(t,r,s),e=!0},p(r,s){const c={};s&128&&(c.background=`url(${r[7]})`),s&131076&&(c.$$scope={dirty:s,ctx:r}),t.$set(c)},i(r){e||(Ye(t.$$.fragment,r),e=!0)},o(r){en(t.$$.fragment,r),e=!1},d(r){Yr(t,r)}}}function WS(n){let t,e,r,s={ctx:n,current:null,token:null,hasCatch:!1,pending:eC,then:KS,catch:HS,value:16,blocks:[,,,]};return W0(e=n[11](n[5]),s),{c(){t=ri(),s.block.c()},l(c){t=ri(),s.block.l(c)},m(c,p){de(c,t,p),s.block.m(c,s.anchor=p),s.mount=()=>t.parentNode,s.anchor=t,r=!0},p(c,p){n=c,s.ctx=n,p&32&&e!==(e=n[11](n[5]))&&W0(e,s)||G2(s,n,p)},i(c){r||(Ye(s.block),r=!0)},o(c){for(let p=0;p<3;p+=1){const l=s.blocks[p];en(l)}r=!1},d(c){c&&vt(t),s.block.d(c),s.token=null,s=null}}}function jS(n){var l;let t,e,r,s,c=((l=n[2])==null?void 0:l.readableAddress)+"",p;return{c(){t=ae("p"),e=Ge("indirizzo"),r=rn(),s=ae("p"),p=Ge(c),this.h()},l(x){t=le(x,"P",{class:!0});var I=he(t);e=qe(I,"indirizzo"),I.forEach(vt),r=on(x),s=le(x,"P",{class:!0});var T=he(s);p=qe(T,c),T.forEach(vt),this.h()},h(){Dt(t,"class","m-0 fs-7 fw-semibold text-uppercase mb-2 text-white"),Dt(s,"class","fs-5 fw-bold text-white")},m(x,I){de(x,t,I),Xt(t,e),de(x,r,I),de(x,s,I),Xt(s,p)},p(x,I){var T;I&4&&c!==(c=((T=x[2])==null?void 0:T.readableAddress)+"")&&To(p,c)},d(x){x&&vt(t),x&&vt(r),x&&vt(s)}}}function HS(n){return{c:Gr,l:Gr,m:Gr,p:Gr,i:Gr,o:Gr,d:Gr}}function KS(n){let t,e,r,s;const c=[QS,JS],p=[];function l(x,I){return x[16].status!=="OK"?0:1}return t=l(n),e=p[t]=c[t](n),{c(){e.c(),r=ri()},l(x){e.l(x),r=ri()},m(x,I){p[t].m(x,I),de(x,r,I),s=!0},p(x,I){let T=t;t=l(x),t===T?p[t].p(x,I):(hu(),en(p[T],1,1,()=>{p[T]=null}),fu(),e=p[t],e?e.p(x,I):(e=p[t]=c[t](x),e.c()),Ye(e,1),e.m(r.parentNode,r))},i(x){s||(Ye(e),s=!0)},o(x){en(e),s=!1},d(x){p[t].d(x),x&&vt(r)}}}function JS(n){let t,e;return t=new Sa({props:{height:"165px",background:`url(${n[6]})`,$$slots:{default:[$S]},$$scope:{ctx:n}}}),{c(){qr(t.$$.fragment)},l(r){Xr(t.$$.fragment,r)},m(r,s){Zr(t,r,s),e=!0},p(r,s){const c={};s&64&&(c.background=`url(${r[6]})`),s&131076&&(c.$$scope={dirty:s,ctx:r}),t.$set(c)},i(r){e||(Ye(t.$$.fragment,r),e=!0)},o(r){en(t.$$.fragment,r),e=!1},d(r){Yr(t,r)}}}function QS(n){let t,e;return t=new Sa({props:{height:"165px",background:`url(${n[7]})`,$$slots:{default:[tC]},$$scope:{ctx:n}}}),{c(){qr(t.$$.fragment)},l(r){Xr(t.$$.fragment,r)},m(r,s){Zr(t,r,s),e=!0},p(r,s){const c={};s&128&&(c.background=`url(${r[7]})`),s&131076&&(c.$$scope={dirty:s,ctx:r}),t.$set(c)},i(r){e||(Ye(t.$$.fragment,r),e=!0)},o(r){en(t.$$.fragment,r),e=!1},d(r){Yr(t,r)}}}function $S(n){var l;let t,e,r,s,c=((l=n[2])==null?void 0:l.readableAddress)+"",p;return{c(){t=ae("p"),e=Ge("indirizzo"),r=rn(),s=ae("p"),p=Ge(c),this.h()},l(x){t=le(x,"P",{class:!0});var I=he(t);e=qe(I,"indirizzo"),I.forEach(vt),r=on(x),s=le(x,"P",{class:!0});var T=he(s);p=qe(T,c),T.forEach(vt),this.h()},h(){Dt(t,"class","m-0 fs-7 fw-semibold text-uppercase mb-2 text-white"),Dt(s,"class","fs-5 fw-bold text-white")},m(x,I){de(x,t,I),Xt(t,e),de(x,r,I),de(x,s,I),Xt(s,p)},p(x,I){var T;I&4&&c!==(c=((T=x[2])==null?void 0:T.readableAddress)+"")&&To(p,c)},d(x){x&&vt(t),x&&vt(r),x&&vt(s)}}}function tC(n){var l;let t,e,r,s,c=((l=n[2])==null?void 0:l.readableAddress)+"",p;return{c(){t=ae("p"),e=Ge("indirizzo"),r=rn(),s=ae("p"),p=Ge(c),this.h()},l(x){t=le(x,"P",{class:!0});var I=he(t);e=qe(I,"indirizzo"),I.forEach(vt),r=on(x),s=le(x,"P",{class:!0});var T=he(s);p=qe(T,c),T.forEach(vt),this.h()},h(){Dt(t,"class","m-0 fs-7 fw-semibold text-uppercase mb-2 text-white"),Dt(s,"class","fs-5 fw-bold text-white")},m(x,I){de(x,t,I),Xt(t,e),de(x,r,I),de(x,s,I),Xt(s,p)},p(x,I){var T;I&4&&c!==(c=((T=x[2])==null?void 0:T.readableAddress)+"")&&To(p,c)},d(x){x&&vt(t),x&&vt(r),x&&vt(s)}}}function eC(n){let t,e;return t=new Sa({props:{height:"165px",$$slots:{default:[nC]},$$scope:{ctx:n}}}),{c(){qr(t.$$.fragment)},l(r){Xr(t.$$.fragment,r)},m(r,s){Zr(t,r,s),e=!0},p(r,s){const c={};s&131076&&(c.$$scope={dirty:s,ctx:r}),t.$set(c)},i(r){e||(Ye(t.$$.fragment,r),e=!0)},o(r){en(t.$$.fragment,r),e=!1},d(r){Yr(t,r)}}}function nC(n){var l;let t,e,r,s,c=((l=n[2])==null?void 0:l.readableAddress)+"",p;return{c(){t=ae("p"),e=Ge("indirizzo"),r=rn(),s=ae("p"),p=Ge(c),this.h()},l(x){t=le(x,"P",{class:!0});var I=he(t);e=qe(I,"indirizzo"),I.forEach(vt),r=on(x),s=le(x,"P",{class:!0});var T=he(s);p=qe(T,c),T.forEach(vt),this.h()},h(){Dt(t,"class","m-0 fs-7 text-white fw-semibold text-uppercase mb-2"),Dt(s,"class","fs-5 fw-bold text-white")},m(x,I){de(x,t,I),Xt(t,e),de(x,r,I),de(x,s,I),Xt(s,p)},p(x,I){var T;I&4&&c!==(c=((T=x[2])==null?void 0:T.readableAddress)+"")&&To(p,c)},d(x){x&&vt(t),x&&vt(r),x&&vt(s)}}}function rC(n){var p;let t,e,r,s,c;return s=new XS({props:{value:(p=n[2])==null?void 0:p.value}}),{c(){t=ae("p"),e=Ge("effetti sulla salute"),r=rn(),qr(s.$$.fragment),this.h()},l(l){t=le(l,"P",{class:!0});var x=he(t);e=qe(x,"effetti sulla salute"),x.forEach(vt),r=on(l),Xr(s.$$.fragment,l),this.h()},h(){Dt(t,"class","m-0 fs-7 fw-semibold text-uppercase mb-2")},m(l,x){de(l,t,x),Xt(t,e),de(l,r,x),Zr(s,l,x),c=!0},p(l,x){var T;const I={};x&4&&(I.value=(T=l[2])==null?void 0:T.value),s.$set(I)},i(l){c||(Ye(s.$$.fragment,l),c=!0)},o(l){en(s.$$.fragment,l),c=!1},d(l){l&&vt(t),l&&vt(r),Yr(s,l)}}}function iC(n){let t,e,r,s;return{c(){t=ae("div"),e=ae("a"),r=Ge("Sottoscrivi l'appello!"),this.h()},l(c){t=le(c,"DIV",{class:!0});var p=he(t);e=le(p,"A",{href:!0,class:!0,role:!0});var l=he(e);r=qe(l,"Sottoscrivi l'appello!"),l.forEach(vt),p.forEach(vt),this.h()},h(){var c;Dt(e,"href",s=`https://cittadiniperlaria.org/appello-al-sindaco/?no2value=${(c=n[2])==null?void 0:c.value}&municipality=${n[4]}`),Dt(e,"class","btn btn-lg btn-accent rounded-pill fw-bold"),Dt(e,"role","button"),Dt(t,"class","d-grid mt-1 mb-2")},m(c,p){de(c,t,p),Xt(t,e),Xt(e,r)},p(c,p){var l;p&20&&s!==(s=`https://cittadiniperlaria.org/appello-al-sindaco/?no2value=${(l=c[2])==null?void 0:l.value}&municipality=${c[4]}`)&&Dt(e,"href",s)},d(c){c&&vt(t)}}}function oC(n){let t,e,r,s,c,p,l,x,I;return e=new LS({props:{text:n[9],url:n[8],hashtags:uC,via:cC}}),s=new NS({props:{url:n[8]}}),p=new BS({props:{text:n[10],url:n[8]}}),x=new OS({props:{text:`${n[10]} ${n[3].url.href}`}}),{c(){t=ae("div"),qr(e.$$.fragment),r=rn(),qr(s.$$.fragment),c=rn(),qr(p.$$.fragment),l=rn(),qr(x.$$.fragment),this.h()},l(T){t=le(T,"DIV",{class:!0});var P=he(t);Xr(e.$$.fragment,P),r=on(P),Xr(s.$$.fragment,P),c=on(P),Xr(p.$$.fragment,P),l=on(P),Xr(x.$$.fragment,P),P.forEach(vt),this.h()},h(){Dt(t,"class","d-flex mt-1")},m(T,P){de(T,t,P),Zr(e,t,null),Xt(t,r),Zr(s,t,null),Xt(t,c),Zr(p,t,null),Xt(t,l),Zr(x,t,null),I=!0},p(T,P){const D={};P&512&&(D.text=T[9]),P&256&&(D.url=T[8]),e.$set(D);const G={};P&256&&(G.url=T[8]),s.$set(G);const Y={};P&1024&&(Y.text=T[10]),P&256&&(Y.url=T[8]),p.$set(Y);const et={};P&1032&&(et.text=`${T[10]} ${T[3].url.href}`),x.$set(et)},i(T){I||(Ye(e.$$.fragment,T),Ye(s.$$.fragment,T),Ye(p.$$.fragment,T),Ye(x.$$.fragment,T),I=!0)},o(T){en(e.$$.fragment,T),en(s.$$.fragment,T),en(p.$$.fragment,T),en(x.$$.fragment,T),I=!1},d(T){T&&vt(t),Yr(e),Yr(s),Yr(p),Yr(x)}}}function sC(n){let t,e,r,s,c,p,l,x,I,T,P,D,G,Y,et,at;return{c(){t=ae("p"),e=Ge("fonte/elaborazione"),r=rn(),s=ae("p"),c=ae("a"),p=Ge('Elaborazione dati 2/2020: Comitato scientifico del progetto "NO'),l=ae("sub"),x=Ge("2"),I=Ge(' NO Grazie!"'),T=rn(),P=ae("p"),D=Ge("design e sviluppo mappa"),G=rn(),Y=ae("p"),et=ae("a"),at=Ge("Studio Calibro"),this.h()},l(rt){t=le(rt,"P",{class:!0});var wt=he(t);e=qe(wt,"fonte/elaborazione"),wt.forEach(vt),r=on(rt),s=le(rt,"P",{});var xt=he(s);c=le(xt,"A",{class:!0,href:!0,target:!0});var Gt=he(c);p=qe(Gt,'Elaborazione dati 2/2020: Comitato scientifico del progetto "NO'),l=le(Gt,"SUB",{});var ee=he(l);x=qe(ee,"2"),ee.forEach(vt),I=qe(Gt,' NO Grazie!"'),Gt.forEach(vt),xt.forEach(vt),T=on(rt),P=le(rt,"P",{class:!0});var $t=he(P);D=qe($t,"design e sviluppo mappa"),$t.forEach(vt),G=on(rt),Y=le(rt,"P",{class:!0});var Zt=he(Y);et=le(Zt,"A",{class:!0,href:!0,target:!0});var Mt=he(et);at=qe(Mt,"Studio Calibro"),Mt.forEach(vt),Zt.forEach(vt),this.h()},h(){Dt(t,"class","m-0 fs-7 fw-semibold text-uppercase mb-2"),Dt(c,"class","text-body"),Dt(c,"href","https://www.cittadiniperlaria.org/comitato-scientifico-del-progetto-no2-no-grazie/"),Dt(c,"target","_blank"),Dt(P,"class","m-0 fs-7 fw-semibold text-uppercase mb-2"),Dt(et,"class","text-body"),Dt(et,"href","https://calib.ro"),Dt(et,"target","_blank"),Dt(Y,"class","mb-0")},m(rt,wt){de(rt,t,wt),Xt(t,e),de(rt,r,wt),de(rt,s,wt),Xt(s,c),Xt(c,p),Xt(c,l),Xt(l,x),Xt(c,I),de(rt,T,wt),de(rt,P,wt),Xt(P,D),de(rt,G,wt),de(rt,Y,wt),Xt(Y,et),Xt(et,at)},p:Gr,d(rt){rt&&vt(t),rt&&vt(r),rt&&vt(s),rt&&vt(T),rt&&vt(P),rt&&vt(G),rt&&vt(Y)}}}function aC(n){let t,e,r,s,c,p,l;return{c(){t=ae("div"),e=ae("div"),r=Ge("un progetto di"),s=rn(),c=ae("a"),p=ae("img"),this.h()},l(x){t=le(x,"DIV",{class:!0});var I=he(t);e=le(I,"DIV",{class:!0});var T=he(e);r=qe(T,"un progetto di"),T.forEach(vt),s=on(I),c=le(I,"A",{href:!0,role:!0,style:!0,class:!0,target:!0});var P=he(c);p=le(P,"IMG",{src:!0,class:!0,alt:!0}),P.forEach(vt),I.forEach(vt),this.h()},h(){Dt(e,"class","text-uppercase me-2 fs-7 fw-bold flex-grow-0 flex-shrink-0"),wx(p.src,l=`${Sx}/logo.png`)||Dt(p,"src",l),Dt(p,"class","img-fluid"),Dt(p,"alt","logo cittadini per l'aria"),Dt(c,"href","https://www.cittadiniperlaria.org/"),Dt(c,"role","button"),br(c,"max-width","200px"),Dt(c,"class","btn btn-dark-gray rounded-pill"),Dt(c,"target","_blank"),Dt(t,"class","d-flex align-items-center justify-content-center")},m(x,I){de(x,t,I),Xt(t,e),Xt(e,r),Xt(t,s),Xt(t,c),Xt(c,p)},p:Gr,d(x){x&&vt(t)}}}function lC(n){let t,e,r,s,c,p,l,x,I,T,P,D,G,Y,et,at,rt,wt,xt,Gt,ee,$t;p=new Sa({props:{$$slots:{default:[ZS]},$$scope:{ctx:n}}});const Zt=[WS,YS],Mt=[];function It(Wt,ft){var re,Yt;return((re=Wt[2])==null?void 0:re.type)==="address"||((Yt=Wt[2])==null?void 0:Yt.type)==="school"?0:1}return x=It(n),I=Mt[x]=Zt[x](n),P=new Sa({props:{$$slots:{default:[rC]},$$scope:{ctx:n}}}),G=new Sa({props:{$$slots:{default:[iC]},$$scope:{ctx:n}}}),et=new Sa({props:{$$slots:{default:[oC]},$$scope:{ctx:n}}}),rt=new Sa({props:{$$slots:{default:[sC]},$$scope:{ctx:n}}}),xt=new Sa({props:{$$slots:{default:[aC]},$$scope:{ctx:n}}}),{c(){t=ae("div"),e=ae("div"),r=ae("div"),s=ae("i"),c=rn(),qr(p.$$.fragment),l=rn(),I.c(),T=rn(),qr(P.$$.fragment),D=rn(),qr(G.$$.fragment),Y=rn(),qr(et.$$.fragment),at=rn(),qr(rt.$$.fragment),wt=rn(),qr(xt.$$.fragment),this.h()},l(Wt){t=le(Wt,"DIV",{style:!0,class:!0});var ft=he(t);e=le(ft,"DIV",{class:!0});var re=he(e);r=le(re,"DIV",{"aria-label":!0,class:!0});var Yt=he(r);s=le(Yt,"I",{class:!0}),he(s).forEach(vt),Yt.forEach(vt),re.forEach(vt),c=on(ft),Xr(p.$$.fragment,ft),l=on(ft),I.l(ft),T=on(ft),Xr(P.$$.fragment,ft),D=on(ft),Xr(G.$$.fragment,ft),Y=on(ft),Xr(et.$$.fragment,ft),at=on(ft),Xr(rt.$$.fragment,ft),wt=on(ft),Xr(xt.$$.fragment,ft),ft.forEach(vt),this.h()},h(){Dt(s,"class","bi"),Ki(s,"bi-chevron-compact-up",n[1]),Ki(s,"bi-chevron-compact-down",!n[1]),Dt(r,"aria-label","open and close information panel"),Dt(r,"class","d-flex align-items-center justify-content-center"),Dt(e,"class","d-md-none d-grid"),br(t,"overflow",n[1]?"hidden":"auto"),Dt(t,"class","rightPanel w-100 h-100 bg-dark-gray shadow-sm p-3 pt-0 p-md-3 svelte-4xvmsq")},m(Wt,ft){de(Wt,t,ft),Xt(t,e),Xt(e,r),Xt(r,s),Xt(t,c),Zr(p,t,null),Xt(t,l),Mt[x].m(t,null),Xt(t,T),Zr(P,t,null),Xt(t,D),Zr(G,t,null),Xt(t,Y),Zr(et,t,null),Xt(t,at),Zr(rt,t,null),Xt(t,wt),Zr(xt,t,null),Gt=!0,ee||($t=[So(r,"click",n[14]),So(t,"scroll",n[12])],ee=!0)},p(Wt,[ft]){ft&2&&Ki(s,"bi-chevron-compact-up",Wt[1]),ft&2&&Ki(s,"bi-chevron-compact-down",!Wt[1]);const re={};ft&131076&&(re.$$scope={dirty:ft,ctx:Wt}),p.$set(re);let Yt=x;x=It(Wt),x===Yt?Mt[x].p(Wt,ft):(hu(),en(Mt[Yt],1,1,()=>{Mt[Yt]=null}),fu(),I=Mt[x],I?I.p(Wt,ft):(I=Mt[x]=Zt[x](Wt),I.c()),Ye(I,1),I.m(t,T));const Ft={};ft&131076&&(Ft.$$scope={dirty:ft,ctx:Wt}),P.$set(Ft);const Oe={};ft&131092&&(Oe.$$scope={dirty:ft,ctx:Wt}),G.$set(Oe);const Jt={};ft&132872&&(Jt.$$scope={dirty:ft,ctx:Wt}),et.$set(Jt);const $e={};ft&131072&&($e.$$scope={dirty:ft,ctx:Wt}),rt.$set($e);const pn={};ft&131072&&(pn.$$scope={dirty:ft,ctx:Wt}),xt.$set(pn),(!Gt||ft&2)&&br(t,"overflow",Wt[1]?"hidden":"auto")},i(Wt){Gt||(Ye(p.$$.fragment,Wt),Ye(I),Ye(P.$$.fragment,Wt),Ye(G.$$.fragment,Wt),Ye(et.$$.fragment,Wt),Ye(rt.$$.fragment,Wt),Ye(xt.$$.fragment,Wt),Gt=!0)},o(Wt){en(p.$$.fragment,Wt),en(I),en(P.$$.fragment,Wt),en(G.$$.fragment,Wt),en(et.$$.fragment,Wt),en(rt.$$.fragment,Wt),en(xt.$$.fragment,Wt),Gt=!1},d(Wt){Wt&&vt(t),Yr(p),Mt[x].d(),Yr(P),Yr(G),Yr(et),Yr(rt),Yr(xt),ee=!1,Im($t)}}}const uC="",cC="";function hC(n,t,e){let r,s,c,p,l,x,I,T;Ms(n,Gc,xt=>e(2,I=xt)),Ms(n,W2,xt=>e(3,T=xt));let{togglePanel:P,panelOpen:D,municipi:G}=t,Y;const et="AIzaSyDcpULOqwVOKTZgsGFrg4d1c04-8cTw-Yk",at=async function(xt){const Gt=await fetch(xt);return Gt.ok?await Gt.json():{status:"ZERO_RESULTS"}},rt=xt=>{xt.target.scrollTop===0&&P()},wt=()=>P();return n.$$set=xt=>{"togglePanel"in xt&&e(0,P=xt.togglePanel),"panelOpen"in xt&&e(1,D=xt.panelOpen),"municipi"in xt&&e(13,G=xt.municipi)},n.$$.update=()=>{n.$$.dirty&4&&e(10,r=`A #Milano, ${I==null?void 0:I.readableAddress}, c'\xE8 una concentrazione media annua di ${I==null?void 0:I.value} \xB5g/m3 di #NO2. ${Math.round(Math.floor(I==null?void 0:I.value)/10)} volte oltre il limite a tutela della salute \u{1F637}. Scopri quanta NO2 respiri sulla mappa di Cittadini per l'aria!`),n.$$.dirty&4&&e(9,s=`A #Milano, ${I==null?void 0:I.readableAddress}, c'\xE8 una concentrazione media annua di ${I==null?void 0:I.value} \xB5g/m3 di #NO2. ${Math.round(Math.floor(I==null?void 0:I.value)/10)} volte oltre il limite a tutela della salute \u{1F637}. Scopri quanta NO2 respiri sulla mappa di @citizensforair! @BeppeSala @AriannaCensi @Anna_Scavuzzo`),n.$$.dirty&8&&e(8,c=T.url.href),n.$$.dirty&8196&&I&&G.features.forEach(xt=>{Bb(I.feature,xt)&&e(4,Y=xt.properties.MUNICIPIO)}),n.$$.dirty&4&&e(7,p=`https://maps.googleapis.com/maps/api/staticmap?center=${I==null?void 0:I.feature.geometry.coordinates[1]},${I==null?void 0:I.feature.geometry.coordinates[0]}&zoom=19&scale=2&size=458x165&maptype=satellite&key=${et}&format=png`),n.$$.dirty&4&&e(6,l=`https://maps.googleapis.com/maps/api/streetview?size=458x165&key=${et}&location=${I==null?void 0:I.feature.geometry.coordinates[1]},${I==null?void 0:I.feature.geometry.coordinates[0]}&source=outdoor`),n.$$.dirty&4&&e(5,x=`https://maps.googleapis.com/maps/api/streetview/metadata?size=458x165&key=${et}&location=${I==null?void 0:I.feature.geometry.coordinates[1]},${I==null?void 0:I.feature.geometry.coordinates[0]}&source=outdoor`)},[P,D,I,T,Y,x,l,p,c,s,r,at,rt,G,wt]}class fC extends $a{constructor(t){super(),tl(this,t,hC,lC,el,{togglePanel:0,panelOpen:1,municipi:13})}}const pC=n=>({noResultsText:n[0]&2048}),ex=n=>({noResultsText:n[11]}),dC=n=>({createText:n[0]&16384}),nx=n=>({createText:n[14]}),gC=n=>({loadingText:n[0]&4096}),rx=n=>({loadingText:n[12]});function ix(n,t,e){const r=n.slice();return r[116]=t[e],r[118]=e,r}const mC=n=>({item:n[1]&1,label:n[1]&1}),ox=n=>({item:n[116].item,label:n[116].highlighted?n[116].highlighted:n[116].label});function sx(n,t,e){const r=n.slice();return r[119]=t[e],r}const _C=n=>({label:n[0]&2,item:n[0]&2}),ax=n=>({label:n[38](n[119]),item:n[119],unselectItem:n[45]});function lx(n,t,e){const r=n.slice();return r[118]=t[e],r}function yC(n){let t,e=n[1],r=[];for(let s=0;s<e.length;s+=1)r[s]=ux(lx(n,e,s));return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=ri()},l(s){for(let c=0;c<r.length;c+=1)r[c].l(s);t=ri()},m(s,c){for(let p=0;p<r.length;p+=1)r[p].m(s,c);de(s,t,c)},p(s,c){if(c[0]&18|c[1]&128){e=s[1];let p;for(p=0;p<e.length;p+=1){const l=lx(s,e,p);r[p]?r[p].p(l,c):(r[p]=ux(l),r[p].c(),r[p].m(t.parentNode,t))}for(;p<r.length;p+=1)r[p].d(1);r.length=e.length}},d(s){Vc(r,s),s&&vt(t)}}}function vC(n){let t,e;return{c(){t=ae("option"),e=Ge(n[3]),this.h()},l(r){t=le(r,"OPTION",{class:!0});var s=he(t);e=qe(s,n[3]),s.forEach(vt),this.h()},h(){t.__value=n[2],t.value=t.__value,t.selected=!0,Dt(t,"class","svelte-1nqq7zl")},m(r,s){de(r,t,s),Xt(t,e)},p(r,s){s[0]&8&&To(e,r[3]),s[0]&4&&(t.__value=r[2],t.value=t.__value)},d(r){r&&vt(t)}}}function ux(n){let t,e=n[38](n[118])+"",r,s,c;return{c(){t=ae("option"),r=Ge(e),s=rn(),this.h()},l(p){t=le(p,"OPTION",{class:!0});var l=he(t);r=qe(l,e),s=on(l),l.forEach(vt),this.h()},h(){t.__value=c=n[4](n[118],!0),t.value=t.__value,t.selected=!0,Dt(t,"class","svelte-1nqq7zl")},m(p,l){de(p,t,l),Xt(t,r),Xt(t,s)},p(p,l){l[0]&2&&e!==(e=p[38](p[118])+"")&&To(r,e),l[0]&18&&c!==(c=p[4](p[118],!0))&&(t.__value=c,t.value=t.__value)},d(p){p&&vt(t)}}}function cx(n){let t,e,r=n[1],s=[];for(let p=0;p<r.length;p+=1)s[p]=hx(sx(n,r,p));const c=p=>en(s[p],1,1,()=>{s[p]=null});return{c(){for(let p=0;p<s.length;p+=1)s[p].c();t=ri()},l(p){for(let l=0;l<s.length;l+=1)s[l].l(p);t=ri()},m(p,l){for(let x=0;x<s.length;x+=1)s[x].m(p,l);de(p,t,l),e=!0},p(p,l){if(l[0]&2|l[1]&16512|l[2]&1048576){r=p[1];let x;for(x=0;x<r.length;x+=1){const I=sx(p,r,x);s[x]?(s[x].p(I,l),Ye(s[x],1)):(s[x]=hx(I),s[x].c(),Ye(s[x],1),s[x].m(t.parentNode,t))}for(hu(),x=r.length;x<s.length;x+=1)c(x);fu()}},i(p){if(!e){for(let l=0;l<r.length;l+=1)Ye(s[l]);e=!0}},o(p){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)en(s[l]);e=!1},d(p){Vc(s,p),p&&vt(t)}}}function xC(n){let t,e,r=n[38](n[119])+"",s,c,p,l,x,I;return{c(){t=ae("div"),e=ae("span"),s=Ge(r),c=rn(),p=ae("span"),l=rn(),this.h()},l(T){t=le(T,"DIV",{class:!0});var P=he(t);e=le(P,"SPAN",{class:!0});var D=he(e);s=qe(D,r),D.forEach(vt),c=on(P),p=le(P,"SPAN",{class:!0}),he(p).forEach(vt),P.forEach(vt),l=on(T),this.h()},h(){Dt(e,"class","tag svelte-1nqq7zl"),Dt(p,"class","tag is-delete svelte-1nqq7zl"),Dt(t,"class","tags has-addons svelte-1nqq7zl")},m(T,P){de(T,t,P),Xt(t,e),Xt(e,s),Xt(t,c),Xt(t,p),de(T,l,P),x||(I=So(p,"click",q2(function(){X2(n[45](n[119]))&&n[45](n[119]).apply(this,arguments)})),x=!0)},p(T,P){n=T,P[0]&2&&r!==(r=n[38](n[119])+"")&&To(s,r)},d(T){T&&vt(t),T&&vt(l),x=!1,I()}}}function hx(n){let t;const e=n[83].tag,r=Gd(e,n,n[82],ax),s=r||xC(n);return{c(){s&&s.c()},l(c){s&&s.l(c)},m(c,p){s&&s.m(c,p),t=!0},p(c,p){r?r.p&&(!t||p[0]&2|p[2]&1048576)&&qd(r,e,c,c[82],t?Zd(e,c[82],p,_C):Xd(c[82]),ax):s&&s.p&&(!t||p[0]&2)&&s.p(c,t?p:[-1,-1,-1,-1])},i(c){t||(Ye(s,c),t=!0)},o(c){en(s,c),t=!1},d(c){s&&s.d(c)}}}function fx(n){let t,e,r,s;return{c(){t=ae("span"),e=Ge("\u2716"),this.h()},l(c){t=le(c,"SPAN",{class:!0});var p=he(t);e=qe(p,"\u2716"),p.forEach(vt),this.h()},h(){Dt(t,"class","autocomplete-clear-button svelte-1nqq7zl")},m(c,p){de(c,t,p),Xt(t,e),r||(s=So(t,"click",n[49]),r=!0)},p:Gr,d(c){c&&vt(t),r=!1,s()}}}function bC(n){let t,e;const r=n[83]["no-results"],s=Gd(r,n,n[82],ex),c=s||SC(n);return{c(){t=ae("div"),c&&c.c(),this.h()},l(p){t=le(p,"DIV",{class:!0});var l=he(t);c&&c.l(l),l.forEach(vt),this.h()},h(){Dt(t,"class","autocomplete-list-item-no-results svelte-1nqq7zl")},m(p,l){de(p,t,l),c&&c.m(t,null),e=!0},p(p,l){s?s.p&&(!e||l[0]&2048|l[2]&1048576)&&qd(s,r,p,p[82],e?Zd(r,p[82],l,pC):Xd(p[82]),ex):c&&c.p&&(!e||l[0]&2048)&&c.p(p,e?l:[-1,-1,-1,-1])},i(p){e||(Ye(c,p),e=!0)},o(p){en(c,p),e=!1},d(p){p&&vt(t),c&&c.d(p)}}}function wC(n){let t,e,r,s;const c=n[83].create,p=Gd(c,n,n[82],nx),l=p||CC(n);return{c(){t=ae("div"),l&&l.c(),this.h()},l(x){t=le(x,"DIV",{class:!0});var I=he(t);l&&l.l(I),I.forEach(vt),this.h()},h(){Dt(t,"class","autocomplete-list-item-create svelte-1nqq7zl")},m(x,I){de(x,t,I),l&&l.m(t,null),e=!0,r||(s=So(t,"click",n[39]),r=!0)},p(x,I){p?p.p&&(!e||I[0]&16384|I[2]&1048576)&&qd(p,c,x,x[82],e?Zd(c,x[82],I,dC):Xd(x[82]),nx):l&&l.p&&(!e||I[0]&16384)&&l.p(x,e?I:[-1,-1,-1,-1])},i(x){e||(Ye(l,x),e=!0)},o(x){en(l,x),e=!1},d(x){x&&vt(t),l&&l.d(x),r=!1,s()}}}function IC(n){let t,e;const r=n[83].loading,s=Gd(r,n,n[82],rx),c=s||TC(n);return{c(){t=ae("div"),c&&c.c(),this.h()},l(p){t=le(p,"DIV",{class:!0});var l=he(t);c&&c.l(l),l.forEach(vt),this.h()},h(){Dt(t,"class","autocomplete-list-item-loading svelte-1nqq7zl")},m(p,l){de(p,t,l),c&&c.m(t,null),e=!0},p(p,l){s?s.p&&(!e||l[0]&4096|l[2]&1048576)&&qd(s,r,p,p[82],e?Zd(r,p[82],l,gC):Xd(p[82]),rx):c&&c.p&&(!e||l[0]&4096)&&c.p(p,e?l:[-1,-1,-1,-1])},i(p){e||(Ye(c,p),e=!0)},o(p){en(c,p),e=!1},d(p){p&&vt(t),c&&c.d(p)}}}function EC(n){let t,e,r,s=n[31],c=[];for(let x=0;x<s.length;x+=1)c[x]=dx(ix(n,s,x));const p=x=>en(c[x],1,1,()=>{c[x]=null});let l=n[5]>0&&n[31].length>n[5]&&gx(n);return{c(){for(let x=0;x<c.length;x+=1)c[x].c();t=rn(),l&&l.c(),e=ri()},l(x){for(let I=0;I<c.length;I+=1)c[I].l(x);t=on(x),l&&l.l(x),e=ri()},m(x,I){for(let T=0;T<c.length;T+=1)c[T].m(x,I);de(x,t,I),l&&l.m(x,I),de(x,e,I),r=!0},p(x,I){if(I[0]&1073741856|I[1]&524801|I[2]&1048576){s=x[31];let T;for(T=0;T<s.length;T+=1){const P=ix(x,s,T);c[T]?(c[T].p(P,I),Ye(c[T],1)):(c[T]=dx(P),c[T].c(),Ye(c[T],1),c[T].m(t.parentNode,t))}for(hu(),T=s.length;T<c.length;T+=1)p(T);fu()}x[5]>0&&x[31].length>x[5]?l?l.p(x,I):(l=gx(x),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i(x){if(!r){for(let I=0;I<s.length;I+=1)Ye(c[I]);r=!0}},o(x){c=c.filter(Boolean);for(let I=0;I<c.length;I+=1)en(c[I]);r=!1},d(x){Vc(c,x),x&&vt(t),l&&l.d(x),x&&vt(e)}}}function SC(n){let t;return{c(){t=Ge(n[11])},l(e){t=qe(e,n[11])},m(e,r){de(e,t,r)},p(e,r){r[0]&2048&&To(t,e[11])},d(e){e&&vt(t)}}}function CC(n){let t;return{c(){t=Ge(n[14])},l(e){t=qe(e,n[14])},m(e,r){de(e,t,r)},p(e,r){r[0]&16384&&To(t,e[14])},d(e){e&&vt(t)}}}function TC(n){let t;return{c(){t=Ge(n[12])},l(e){t=qe(e,n[12])},m(e,r){de(e,t,r)},p(e,r){r[0]&4096&&To(t,e[12])},d(e){e&&vt(t)}}}function px(n){let t,e,r,s,c;const p=n[83].item,l=Gd(p,n,n[82],ox),x=l||LC(n);function I(){return n[86](n[116])}function T(){return n[87](n[118])}return{c(){t=ae("div"),x&&x.c(),this.h()},l(P){t=le(P,"DIV",{class:!0});var D=he(t);x&&x.l(D),D.forEach(vt),this.h()},h(){Dt(t,"class",e="autocomplete-list-item "+(n[118]===n[30]?"selected":"")+" svelte-1nqq7zl"),Ki(t,"confirmed",n[50](n[116].item))},m(P,D){de(P,t,D),x&&x.m(t,null),r=!0,s||(c=[So(t,"click",I),So(t,"pointerenter",T)],s=!0)},p(P,D){n=P,l?l.p&&(!r||D[1]&1|D[2]&1048576)&&qd(l,p,n,n[82],r?Zd(p,n[82],D,mC):Xd(n[82]),ox):x&&x.p&&(!r||D[1]&1)&&x.p(n,r?D:[-1,-1,-1,-1]),(!r||D[0]&1073741824&&e!==(e="autocomplete-list-item "+(n[118]===n[30]?"selected":"")+" svelte-1nqq7zl"))&&Dt(t,"class",e),D[0]&1073741824|D[1]&524289&&Ki(t,"confirmed",n[50](n[116].item))},i(P){r||(Ye(x,P),r=!0)},o(P){en(x,P),r=!1},d(P){P&&vt(t),x&&x.d(P),s=!1,Im(c)}}}function AC(n){let t,e=n[116].label+"",r;return{c(){t=new s0(!1),r=ri(),this.h()},l(s){t=a0(s,!1),r=ri(),this.h()},h(){t.a=r},m(s,c){t.m(e,s,c),de(s,r,c)},p(s,c){c[1]&1&&e!==(e=s[116].label+"")&&t.p(e)},d(s){s&&vt(r),s&&t.d()}}}function PC(n){let t,e=n[116].highlighted+"",r;return{c(){t=new s0(!1),r=ri(),this.h()},l(s){t=a0(s,!1),r=ri(),this.h()},h(){t.a=r},m(s,c){t.m(e,s,c),de(s,r,c)},p(s,c){c[1]&1&&e!==(e=s[116].highlighted+"")&&t.p(e)},d(s){s&&vt(r),s&&t.d()}}}function LC(n){let t;function e(c,p){return c[116].highlighted?PC:AC}let r=e(n),s=r(n);return{c(){s.c(),t=ri()},l(c){s.l(c),t=ri()},m(c,p){s.m(c,p),de(c,t,p)},p(c,p){r===(r=e(c))&&s?s.p(c,p):(s.d(1),s=r(c),s&&(s.c(),s.m(t.parentNode,t)))},d(c){s.d(c),c&&vt(t)}}}function dx(n){let t,e,r=n[116]&&(n[5]<=0||n[118]<n[5])&&px(n);return{c(){r&&r.c(),t=ri()},l(s){r&&r.l(s),t=ri()},m(s,c){r&&r.m(s,c),de(s,t,c),e=!0},p(s,c){s[116]&&(s[5]<=0||s[118]<s[5])?r?(r.p(s,c),c[0]&32|c[1]&1&&Ye(r,1)):(r=px(s),r.c(),Ye(r,1),r.m(t.parentNode,t)):r&&(hu(),en(r,1,1,()=>{r=null}),fu())},i(s){e||(Ye(r),e=!0)},o(s){en(r),e=!1},d(s){r&&r.d(s),s&&vt(t)}}}function gx(n){let t,e=n[13]&&mx(n);return{c(){e&&e.c(),t=ri()},l(r){e&&e.l(r),t=ri()},m(r,s){e&&e.m(r,s),de(r,t,s)},p(r,s){r[13]?e?e.p(r,s):(e=mx(r),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(r){e&&e.d(r),r&&vt(t)}}}function mx(n){let t,e,r=n[31].length-n[5]+"",s,c,p;return{c(){t=ae("div"),e=Ge("..."),s=Ge(r),c=rn(),p=Ge(n[13]),this.h()},l(l){t=le(l,"DIV",{class:!0});var x=he(t);e=qe(x,"..."),s=qe(x,r),c=on(x),p=qe(x,n[13]),x.forEach(vt),this.h()},h(){Dt(t,"class","autocomplete-list-item-no-results svelte-1nqq7zl")},m(l,x){de(l,t,x),Xt(t,e),Xt(t,s),Xt(t,c),Xt(t,p)},p(l,x){x[0]&32|x[1]&1&&r!==(r=l[31].length-l[5]+"")&&To(s,r),x[0]&8192&&To(p,l[13])},d(l){l&&vt(t)}}}function MC(n){let t,e,r,s,c,p,l,x,I,T,P,D,G,Y,et,at,rt,wt,xt,Gt;function ee(Yt,Ft){if(!Yt[6]&&Yt[2])return vC;if(Yt[6]&&Yt[1])return yC}let $t=ee(n),Zt=$t&&$t(n),Mt=n[6]&&n[1]&&cx(n),It=n[35]&&fx(n);const Wt=[EC,IC,wC,bC],ft=[];function re(Yt,Ft){return Yt[31]&&Yt[31].length>0?0:Yt[34]&&Yt[12]?1:Yt[7]?2:Yt[11]?3:-1}return~(Y=re(n))&&(et=ft[Y]=Wt[Y](n)),{c(){t=ae("div"),e=ae("select"),Zt&&Zt.c(),r=rn(),s=ae("div"),Mt&&Mt.c(),c=rn(),p=ae("input"),P=rn(),It&&It.c(),D=rn(),G=ae("div"),et&&et.c(),this.h()},l(Yt){t=le(Yt,"DIV",{class:!0});var Ft=he(t);e=le(Ft,"SELECT",{name:!0,id:!0,class:!0});var Oe=he(e);Zt&&Zt.l(Oe),Oe.forEach(vt),r=on(Ft),s=le(Ft,"DIV",{class:!0});var Jt=he(s);Mt&&Mt.l(Jt),c=on(Jt),p=le(Jt,"INPUT",{type:!0,class:!0,id:!0,autocomplete:!0,placeholder:!0,name:!0,title:!0,tabindex:!0}),P=on(Jt),It&&It.l(Jt),Jt.forEach(vt),D=on(Ft),G=le(Ft,"DIV",{class:!0});var $e=he(G);et&&et.l($e),$e.forEach(vt),Ft.forEach(vt),this.h()},h(){Dt(e,"name",n[20]),Dt(e,"id",n[21]),e.multiple=n[6],Dt(e,"class","svelte-1nqq7zl"),Dt(p,"type","text"),Dt(p,"class",l=(n[17]?n[17]:"")+" "+(n[27]?"":"input autocomplete-input")+" svelte-1nqq7zl"),Dt(p,"id",x=n[18]?n[18]:""),Dt(p,"autocomplete",I=n[23]?"on":"off"),Dt(p,"placeholder",n[15]),Dt(p,"name",n[19]),p.disabled=n[26],p.required=n[28],Dt(p,"title",n[22]),p.readOnly=T=n[24]||n[8]&&n[1],Dt(p,"tabindex",n[29]),Dt(s,"class","input-container svelte-1nqq7zl"),Dt(G,"class",at=(n[25]?n[25]:"")+" autocomplete-list "+(n[36]?"":"hidden")+" is-fullwidth svelte-1nqq7zl"),Dt(t,"class",rt=(n[16]?n[16]:"")+" "+(n[9]||!n[0].length?"hide-arrow":"")+" "+(n[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+n[37]+" svelte-1nqq7zl"),Ki(t,"show-clear",n[35]),Ki(t,"is-loading",n[10]&&n[34])},m(Yt,Ft){de(Yt,t,Ft),Xt(t,e),Zt&&Zt.m(e,null),Xt(t,r),Xt(t,s),Mt&&Mt.m(s,null),Xt(s,c),Xt(s,p),n[84](p),j0(p,n[3]),Xt(s,P),It&&It.m(s,null),Xt(t,D),Xt(t,G),~Y&&ft[Y].m(G,null),n[88](G),wt=!0,xt||(Gt=[So(window,"click",n[41]),So(p,"input",n[85]),So(p,"input",n[44]),So(p,"focus",n[47]),So(p,"blur",n[48]),So(p,"keydown",n[42]),So(p,"click",n[46]),So(p,"keypress",n[43])],xt=!0)},p(Yt,Ft){$t===($t=ee(Yt))&&Zt?Zt.p(Yt,Ft):(Zt&&Zt.d(1),Zt=$t&&$t(Yt),Zt&&(Zt.c(),Zt.m(e,null))),(!wt||Ft[0]&1048576)&&Dt(e,"name",Yt[20]),(!wt||Ft[0]&2097152)&&Dt(e,"id",Yt[21]),(!wt||Ft[0]&64)&&(e.multiple=Yt[6]),Yt[6]&&Yt[1]?Mt?(Mt.p(Yt,Ft),Ft[0]&66&&Ye(Mt,1)):(Mt=cx(Yt),Mt.c(),Ye(Mt,1),Mt.m(s,c)):Mt&&(hu(),en(Mt,1,1,()=>{Mt=null}),fu()),(!wt||Ft[0]&134348800&&l!==(l=(Yt[17]?Yt[17]:"")+" "+(Yt[27]?"":"input autocomplete-input")+" svelte-1nqq7zl"))&&Dt(p,"class",l),(!wt||Ft[0]&262144&&x!==(x=Yt[18]?Yt[18]:""))&&Dt(p,"id",x),(!wt||Ft[0]&8388608&&I!==(I=Yt[23]?"on":"off"))&&Dt(p,"autocomplete",I),(!wt||Ft[0]&32768)&&Dt(p,"placeholder",Yt[15]),(!wt||Ft[0]&524288)&&Dt(p,"name",Yt[19]),(!wt||Ft[0]&67108864)&&(p.disabled=Yt[26]),(!wt||Ft[0]&268435456)&&(p.required=Yt[28]),(!wt||Ft[0]&4194304)&&Dt(p,"title",Yt[22]),(!wt||Ft[0]&16777474&&T!==(T=Yt[24]||Yt[8]&&Yt[1]))&&(p.readOnly=T),(!wt||Ft[0]&536870912)&&Dt(p,"tabindex",Yt[29]),Ft[0]&8&&p.value!==Yt[3]&&j0(p,Yt[3]),Yt[35]?It?It.p(Yt,Ft):(It=fx(Yt),It.c(),It.m(s,null)):It&&(It.d(1),It=null);let Oe=Y;Y=re(Yt),Y===Oe?~Y&&ft[Y].p(Yt,Ft):(et&&(hu(),en(ft[Oe],1,1,()=>{ft[Oe]=null}),fu()),~Y?(et=ft[Y],et?et.p(Yt,Ft):(et=ft[Y]=Wt[Y](Yt),et.c()),Ye(et,1),et.m(G,null)):et=null),(!wt||Ft[0]&33554432|Ft[1]&32&&at!==(at=(Yt[25]?Yt[25]:"")+" autocomplete-list "+(Yt[36]?"":"hidden")+" is-fullwidth svelte-1nqq7zl"))&&Dt(G,"class",at),(!wt||Ft[0]&66113&&rt!==(rt=(Yt[16]?Yt[16]:"")+" "+(Yt[9]||!Yt[0].length?"hide-arrow":"")+" "+(Yt[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+Yt[37]+" svelte-1nqq7zl"))&&Dt(t,"class",rt),Ft[0]&66113|Ft[1]&16&&Ki(t,"show-clear",Yt[35]),Ft[0]&67137|Ft[1]&8&&Ki(t,"is-loading",Yt[10]&&Yt[34])},i(Yt){wt||(Ye(Mt),Ye(et),wt=!0)},o(Yt){en(Mt),en(et),wt=!1},d(Yt){Yt&&vt(t),Zt&&Zt.d(),Mt&&Mt.d(),n[84](null),It&&It.d(),~Y&&ft[Y].d(),n[88](null),xt=!1,Im(Gt)}}}function DC(n,t){if(typeof n!="function"){console.error("Not a function: "+n+", argument: "+t);return}let e;try{e=n(t)}catch{console.warn("Error executing Autocomplete function on value: "+t+" function: "+n)}return e}function $_(n,t){let e=DC(n,t);return e==null&&(e=""),typeof e!="string"&&(e=e.toString()),e}function o0(n,t){if(!n)return 0;const e=n.keywords;let r=0;return t.forEach(s=>{e.includes(s)&&r++}),r}function NC(n,t,e){return o0(t,e)-o0(n,e)}function ty(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function RC(n,t,e){let r,s,{$$slots:c={},$$scope:p}=t,{items:l=[]}=t,{searchFunction:x=!1}=t,{labelFieldName:I=void 0}=t,{keywordsFieldName:T=I}=t,{valueFieldName:P=void 0}=t,{labelFunction:D=function(lt){return lt==null?"":I?lt[I]:lt}}=t,{keywordsFunction:G=function(lt){return lt==null?"":T?lt[T]:D(lt)}}=t,{valueFunction:Y=function(lt,xe=!1){return lt==null?lt:!It||xe?P?lt[P]:lt:lt.map(Je=>P?Je[P]:Je)}}=t,{keywordsCleanFunction:et=function(lt){return lt}}=t,{textCleanFunction:at=function(lt){return lt}}=t,{beforeChange:rt=function(lt,xe){return!0}}=t,{onChange:wt=function(lt){}}=t,{onFocus:xt=function(){}}=t,{onBlur:Gt=function(){}}=t,{onCreate:ee=function(lt){ye&&console.log("onCreate: "+lt)}}=t,{selectFirstIfEmpty:$t=!1}=t,{minCharactersToSearch:Zt=1}=t,{maxItemsToShowInList:Mt=0}=t,{multiple:It=!1}=t,{create:Wt=!1}=t,{ignoreAccents:ft=!0}=t,{matchAllKeywords:re=!0}=t,{sortByMatchedKeywords:Yt=!1}=t,{itemFilterFunction:Ft=void 0}=t,{itemSortFunction:Oe=void 0}=t,{lock:Jt=!1}=t,{delay:$e=0}=t,{localFiltering:pn=!0}=t,{localSorting:Cn=!0}=t,{cleanUserText:_r=!0}=t,{closeOnBlur:Xn=!1}=t,{hideArrow:oi=!1}=t,{showClear:Nr=!1}=t,{showLoadingIndicator:to=!1}=t,{noResultsText:Hr="No results found"}=t,{loadingText:Vi="Loading results..."}=t,{moreItemsText:vs="items not shown"}=t,{createText:eo="Not found, add anyway?"}=t,{placeholder:es=void 0}=t,{className:Ul=void 0}=t,{inputClassName:Fs=void 0}=t,{inputId:Mo=void 0}=t,{name:Kr=void 0}=t,{selectName:si=void 0}=t,{selectId:xs=void 0}=t,{title:sa=void 0}=t,{html5autocomplete:ai=void 0}=t,{readonly:il=void 0}=t,{dropdownClassName:bs=void 0}=t,{disabled:Gi=!1}=t,{noInputStyles:Rr=!1}=t,{required:ws=null}=t,{debug:ye=!1}=t,{tabindex:aa=0}=t,{selectedItem:bn=It?[]:void 0}=t,{value:Bs=void 0}=t,{highlightedItem:ns=void 0}=t;const Bt="sautocomplete-"+Math.floor(Math.random()*1e3);let ge,no,Si=!1,Bn=!1,Vn=-1,{text:Qn}=t,Do=0,dn,ue=[],gn=0,tn=0,Ci;function ro(lt){return $_(D,lt)}function cn(lt){const xe=$_(G,lt);let Je=$_(et,xe);return Je=Je.toLowerCase().trim(),ft&&(Je=ty(Je)),ye&&console.log("Extracted keywords: '"+Je+"' from item: "+JSON.stringify(lt)),Je}function Is(){let lt;ye&&(lt=`Autocomplete prepare list ${Mo?`(id: ${Mo})`:""}`,console.time(lt),console.log("Prepare items to search"),console.log("items: "+JSON.stringify(l))),Array.isArray(l)||(console.warn("Autocomplete items / search function did not return array but",l),e(0,l=[]));const xe=l?l.length:0;ue=new Array(xe),xe>0&&l.forEach((Je,Un)=>{const Ai=rs(Je);Ai===void 0&&console.log("Undefined item for: ",Je),ue[Un]=Ai}),e(31,dn=ue),ye&&(console.log(ue.length+" items to search"),console.timeEnd(lt))}function rs(lt){return{keywords:pn?cn(lt):[],label:ro(lt),item:lt}}function Us(){e(2,Bs=Y(bn)),e(3,Qn=It?"":ro(bn)),e(31,dn=ue),wt(bn)}function Jr(lt){if(lt==null)return"";if(!_r)return lt;const xe=lt.replace(/[&/\\#,+()$~%.'":*?<>{}]/g," ").trim();return $_(at,xe).toLowerCase().trim()}async function $n(){let lt;ye&&(lt=`Autocomplete search ${Mo?`(id: ${Mo})`:""}`,console.time(lt),console.log("Searching user entered text: '"+Qn+"'"));let xe=Jr(Qn);if(Zt>1&&xe.length<Zt&&(xe=""),e(81,Do=xe.length),ye&&console.log("Changed user entered text '"+Qn+"' into '"+xe+"'"),xe===""){x?(e(0,l=[]),ye&&console.log("User entered text is empty clear list of items")):(e(31,dn=ue),ye&&console.log("User entered text is empty set the list of items to all items")),In(),ye&&console.timeEnd(lt);return}if(!x)Es(xe);else{gn=gn+1;const Je=gn;if(e(34,Bn=!0),x.constructor.name==="AsyncGeneratorFunction"){for await(const Un of x(xe,Mt)){if(Je<tn)return!1;Je>tn&&e(0,l=[]),tn=Je,e(0,l=[...l,...Un]),Es(xe)}tn<Je&&(tn=Je,e(0,l=[]),Es(xe))}else{let Un=await x(xe,Mt);if(Je<tn)return!1;tn=Je,e(0,l=Un),Es(xe)}e(34,Bn=!1)}ye&&(console.timeEnd(lt),console.log("Search found "+dn.length+" items"))}function No(lt,xe){const Je=o0(lt,xe);return re?Je>=xe.length:Je>0}function Es(lt){Is();const Je=(ft?ty(lt):lt).split(/\s+/g).filter(di=>di!=="");let Un;pn?(Ft?Un=ue.filter(di=>Ft(di.item,Je)):Un=ue.filter(di=>No(di,Je)),Cn&&(Oe?Un=Un.sort((di,za)=>Oe(di.item,za.item,Je)):Yt&&(Un=Un.sort((di,za)=>NC(di,za,Je))))):Un=ue;const Ai=sn(Je,"label");return e(31,dn=Un.map(Ai)),In(),!0}function Qr(lt){let xe;if(ye&&console.log("createdItem",lt),typeof lt<"u"){Is(),e(31,dn=ue);let Je=we(lt,dn);Je<=0&&(e(0,l=[lt]),Is(),e(31,dn=ue),Je=0),Je>=0&&(e(30,Vn=Je),xe=dn[Vn])}return xe}function qi(lt){if(ye&&console.log("selectListItem",lt),typeof lt>"u"&&Wt){const Je=ee(Qn);if(typeof Je<"u"){if(typeof Je.then=="function")return Je.then(Un=>{if(typeof Un<"u"){const Ai=Qr(Un);typeof Ai<"u"&&qi(Ai)}}),!0;lt=Qr(Je)}}if(typeof lt>"u")return ye&&console.log("listItem is undefined. Can not select."),!1;if(Jt&&bn)return!0;const xe=lt.item;return rt(bn,xe)&&(It?bn?bn.includes(xe)?e(1,bn=bn.filter(Je=>Je!==xe)):e(1,bn=[...bn,xe]):e(1,bn=[xe]):(e(1,bn=void 0),e(1,bn=xe))),!0}function yo(){ye&&console.log("selectItem",Vn);const lt=dn[Vn];qi(lt)?(ye&&console.log("selectListItem true, closing"),ke(),It&&ge.focus()):ye&&console.log("selectListItem false, not closing")}function Ra(){ye&&console.log("up"),De(),Vn>0&&e(30,Vn--,Vn),Vs()}function ol(){ye&&console.log("down"),De(),Vn<dn.length-1&&e(30,Vn++,Vn),Vs()}function Vs(){ye&&console.log("highlight");const lt=".selected";ye&&console.log("Seaching DOM element: "+lt+" in "+no);const xe=no&&no.querySelector(lt);xe?typeof xe.scrollIntoViewIfNeeded=="function"?(ye&&console.log("Scrolling selected item into view"),xe.scrollIntoViewIfNeeded()):xe.scrollIntoView==="function"?(ye&&console.log("Scrolling selected item into view"),xe.scrollIntoView()):ye&&console.warn("Could not scroll selected item into view, scrollIntoViewIfNeeded not supported"):ye&&console.warn("Selected item not found to scroll into view")}function $(lt){ye&&console.log("onListItemClick"),qi(lt)&&(ke(),It&&ge.focus())}function O(lt){ye&&console.log("onDocumentClick"),lt.composedPath().some(xe=>xe.classList&&xe.classList.contains(Bt))?(ye&&console.log("onDocumentClick inside"),Vs()):(ye&&console.log("onDocumentClick outside"),ke())}function B(lt){ye&&console.log("onKeyDown");let xe=lt.key;xe==="Tab"&&lt.shiftKey&&(xe="ShiftTab");const Un={Tab:Si?ke():null,ShiftTab:Si?ke():null,ArrowDown:ol.bind(this),ArrowUp:Ra.bind(this),Escape:gt.bind(this),Backspace:It&&bn&&bn.length&&!Qn?Vt.bind(this):null}[xe];typeof Un=="function"&&Un(lt)}function K(lt){ye&&console.log("onKeyPress"),lt.key==="Enter"&&(lt.preventDefault(),tt())}function tt(){yo()}function nt(lt){ye&&console.log("onInput"),e(3,Qn=lt.target.value),Ci&&clearTimeout(Ci),$e?Ci=setTimeout(ht,$e):ht()}function dt(lt){ye&&console.log("unselectItem",lt),e(1,bn=bn.filter(xe=>xe!==lt)),ge.focus()}function ht(){$n()&&(e(30,Vn=0),De())}function pt(){ye&&console.log("onInputClick"),Ae()}function gt(lt){ye&&console.log("onEsc"),lt.stopPropagation(),Si&&(ge.focus(),ke())}function Vt(lt){ye&&console.log("onBackspace"),dt(bn[bn.length-1])}function te(){ye&&console.log("onFocus"),xt(),Ae()}function zt(){ye&&console.log("onBlur"),Xn&&ke(),Gt()}function Ae(){if(ye&&console.log("resetListToAllItemsAndOpen"),Qn?!ue.length&&bn&&x&&$n():e(31,dn=ue),De(),bn){ye&&console.log("Searching currently selected item: "+JSON.stringify(bn));const lt=we(bn,dn);lt>=0&&(e(30,Vn=lt),Vs())}}function we(lt,xe){ye&&console.log("Finding index for item",lt);let Je=-1;for(let Un=0;Un<xe.length;Un++){const Ai=xe[Un];if(typeof Ai>"u"){ye&&console.log(`listItem ${Un} is undefined. Skipping.`);continue}if(ye&&console.log("Item "+Un+": "+JSON.stringify(Ai)),lt===Ai.item){Je=Un;break}}return ye&&(Je>=0?console.log("Found index for item: "+Je):console.warn("Not found index for item: "+lt)),Je}function De(){ye&&console.log("open"),!Mn()&&e(80,Si=!0)}function ke(){ye&&console.log("close"),e(80,Si=!1),e(34,Bn=!1),!Qn&&$t&&(e(30,Vn=0),yo())}function Mn(){return Zt>1&&Do<Zt}function In(){Mn()&&ke()}function wn(){ye&&console.log("clear"),e(3,Qn=""),e(1,bn=It?[]:void 0),setTimeout(()=>{ge.focus(),ke()})}function sn(lt,xe){return Je=>{let Un=Je[xe];const Ai=Object.assign({highlighted:void 0},Je);Ai.highlighted=Un;const di=Un.toLowerCase(),za=ft?ty(di):di;if(lt&&lt.length){const sl=[];for(let Gs=0;Gs<lt.length;Gs++){let io=lt[Gs];ft&&(io=ty(io));const qs=io.length;let Ro=0;do if(Ro=za.indexOf(io,Ro),Ro>=0){let is=Ro+qs;sl.push([Ro,is]),Ro=is}while(Ro!==-1)}if(sl.length>0){const Gs=new Set;for(let io=0;io<sl.length;io++){const qs=sl[io],Ro=qs[0],is=qs[1],al=di.substring(Ro,is);Gs.add(al)}for(let io of Gs){if(io==="b")continue;const qs=new RegExp("("+io+")","ig"),Ro=Ai.highlighted.replace(qs,"<b>$1</b>");Ai.highlighted=Ro}}}return Ai}}function an(lt){return bn?It?bn.includes(lt):lt===bn:!1}function zr(lt){md[lt?"unshift":"push"](()=>{ge=lt,e(32,ge)})}function Lr(){Qn=this.value,e(3,Qn)}const pi=lt=>$(lt),Ti=lt=>{e(30,Vn=lt)};function Su(lt){md[lt?"unshift":"push"](()=>{no=lt,e(33,no)})}return n.$$set=lt=>{"items"in lt&&e(0,l=lt.items),"searchFunction"in lt&&e(52,x=lt.searchFunction),"labelFieldName"in lt&&e(53,I=lt.labelFieldName),"keywordsFieldName"in lt&&e(54,T=lt.keywordsFieldName),"valueFieldName"in lt&&e(55,P=lt.valueFieldName),"labelFunction"in lt&&e(56,D=lt.labelFunction),"keywordsFunction"in lt&&e(57,G=lt.keywordsFunction),"valueFunction"in lt&&e(4,Y=lt.valueFunction),"keywordsCleanFunction"in lt&&e(58,et=lt.keywordsCleanFunction),"textCleanFunction"in lt&&e(59,at=lt.textCleanFunction),"beforeChange"in lt&&e(60,rt=lt.beforeChange),"onChange"in lt&&e(61,wt=lt.onChange),"onFocus"in lt&&e(62,xt=lt.onFocus),"onBlur"in lt&&e(63,Gt=lt.onBlur),"onCreate"in lt&&e(64,ee=lt.onCreate),"selectFirstIfEmpty"in lt&&e(65,$t=lt.selectFirstIfEmpty),"minCharactersToSearch"in lt&&e(66,Zt=lt.minCharactersToSearch),"maxItemsToShowInList"in lt&&e(5,Mt=lt.maxItemsToShowInList),"multiple"in lt&&e(6,It=lt.multiple),"create"in lt&&e(7,Wt=lt.create),"ignoreAccents"in lt&&e(67,ft=lt.ignoreAccents),"matchAllKeywords"in lt&&e(68,re=lt.matchAllKeywords),"sortByMatchedKeywords"in lt&&e(69,Yt=lt.sortByMatchedKeywords),"itemFilterFunction"in lt&&e(70,Ft=lt.itemFilterFunction),"itemSortFunction"in lt&&e(71,Oe=lt.itemSortFunction),"lock"in lt&&e(8,Jt=lt.lock),"delay"in lt&&e(72,$e=lt.delay),"localFiltering"in lt&&e(73,pn=lt.localFiltering),"localSorting"in lt&&e(74,Cn=lt.localSorting),"cleanUserText"in lt&&e(75,_r=lt.cleanUserText),"closeOnBlur"in lt&&e(76,Xn=lt.closeOnBlur),"hideArrow"in lt&&e(9,oi=lt.hideArrow),"showClear"in lt&&e(77,Nr=lt.showClear),"showLoadingIndicator"in lt&&e(10,to=lt.showLoadingIndicator),"noResultsText"in lt&&e(11,Hr=lt.noResultsText),"loadingText"in lt&&e(12,Vi=lt.loadingText),"moreItemsText"in lt&&e(13,vs=lt.moreItemsText),"createText"in lt&&e(14,eo=lt.createText),"placeholder"in lt&&e(15,es=lt.placeholder),"className"in lt&&e(16,Ul=lt.className),"inputClassName"in lt&&e(17,Fs=lt.inputClassName),"inputId"in lt&&e(18,Mo=lt.inputId),"name"in lt&&e(19,Kr=lt.name),"selectName"in lt&&e(20,si=lt.selectName),"selectId"in lt&&e(21,xs=lt.selectId),"title"in lt&&e(22,sa=lt.title),"html5autocomplete"in lt&&e(23,ai=lt.html5autocomplete),"readonly"in lt&&e(24,il=lt.readonly),"dropdownClassName"in lt&&e(25,bs=lt.dropdownClassName),"disabled"in lt&&e(26,Gi=lt.disabled),"noInputStyles"in lt&&e(27,Rr=lt.noInputStyles),"required"in lt&&e(28,ws=lt.required),"debug"in lt&&e(78,ye=lt.debug),"tabindex"in lt&&e(29,aa=lt.tabindex),"selectedItem"in lt&&e(1,bn=lt.selectedItem),"value"in lt&&e(2,Bs=lt.value),"highlightedItem"in lt&&e(51,ns=lt.highlightedItem),"text"in lt&&e(3,Qn=lt.text),"$$scope"in lt&&e(82,p=lt.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1|n.$$.dirty[1]&2097152&&(x||Is()),n.$$.dirty[0]&2&&Us(),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1&&e(51,ns=dn&&Vn&&Vn>=0&&Vn<dn.length?dn[Vn].item:null),n.$$.dirty[0]&1|n.$$.dirty[2]&786432&&e(36,r=Si&&(l&&l.length>0||Do>0)),n.$$.dirty[0]&322|n.$$.dirty[2]&32768&&e(35,s=Nr||(Jt||It)&&bn)},[l,bn,Bs,Qn,Y,Mt,It,Wt,Jt,oi,to,Hr,Vi,vs,eo,es,Ul,Fs,Mo,Kr,si,xs,sa,ai,il,bs,Gi,Rr,ws,aa,Vn,dn,ge,no,Bn,s,r,Bt,ro,yo,$,O,B,K,nt,dt,pt,te,zt,wn,an,ns,x,I,T,P,D,G,et,at,rt,wt,xt,Gt,ee,$t,Zt,ft,re,Yt,Ft,Oe,$e,pn,Cn,_r,Xn,Nr,ye,sn,Si,Do,p,c,zr,Lr,pi,Ti,Su]}class Ub extends $a{constructor(t){super(),tl(this,t,RC,MC,el,{items:0,searchFunction:52,labelFieldName:53,keywordsFieldName:54,valueFieldName:55,labelFunction:56,keywordsFunction:57,valueFunction:4,keywordsCleanFunction:58,textCleanFunction:59,beforeChange:60,onChange:61,onFocus:62,onBlur:63,onCreate:64,selectFirstIfEmpty:65,minCharactersToSearch:66,maxItemsToShowInList:5,multiple:6,create:7,ignoreAccents:67,matchAllKeywords:68,sortByMatchedKeywords:69,itemFilterFunction:70,itemSortFunction:71,lock:8,delay:72,localFiltering:73,localSorting:74,cleanUserText:75,closeOnBlur:76,hideArrow:9,showClear:77,showLoadingIndicator:10,noResultsText:11,loadingText:12,moreItemsText:13,createText:14,placeholder:15,className:16,inputClassName:17,inputId:18,name:19,selectName:20,selectId:21,title:22,html5autocomplete:23,readonly:24,dropdownClassName:25,disabled:26,noInputStyles:27,required:28,debug:78,tabindex:29,selectedItem:1,value:2,highlightedItem:51,text:3,highlightFilter:79},null,[-1,-1,-1,-1])}get highlightFilter(){return this.$$.ctx[79]}}function zC(n){let t,e,r,s;const c=[kC,OC],p=[];function l(x,I){return x[4]==="address"?0:1}return t=l(n),e=p[t]=c[t](n),{c(){e.c(),r=ri()},l(x){e.l(x),r=ri()},m(x,I){p[t].m(x,I),de(x,r,I),s=!0},p(x,I){let T=t;t=l(x),t===T?p[t].p(x,I):(hu(),en(p[T],1,1,()=>{p[T]=null}),fu(),e=p[t],e?e.p(x,I):(e=p[t]=c[t](x),e.c()),Ye(e,1),e.m(r.parentNode,r))},i(x){s||(Ye(e),s=!0)},o(x){en(e),s=!1},d(x){p[t].d(x),x&&vt(r)}}}function OC(n){let t,e,r;function s(p){n[13](p)}let c={items:n[6],inputId:n[0],labelFieldName:"address",valueFieldName:"id",keywordsFunction:UC,className:"w-100",inputClassName:"form-control form-control-lg",placeholder:"es: Vittorio Veneto",noResultsText:"nessuna scuola trovata",moreItemsText:"scuole non mostrate",maxItemsToShowInList:5,hideArrow:!0,showClear:!1,disabled:!n[5].length,$$slots:{item:[FC,({label:p,item:l})=>({14:p,15:l}),({label:p,item:l})=>(p?16384:0)|(l?32768:0)]},$$scope:{ctx:n}};return n[1]!==void 0&&(c.selectedItem=n[1]),t=new Ub({props:c}),md.push(()=>Ix(t,"selectedItem",s)),{c(){qr(t.$$.fragment)},l(p){Xr(t.$$.fragment,p)},m(p,l){Zr(t,p,l),r=!0},p(p,l){const x={};l&1&&(x.inputId=p[0]),l&32&&(x.disabled=!p[5].length),l&114688&&(x.$$scope={dirty:l,ctx:p}),!e&&l&2&&(e=!0,x.selectedItem=p[1],Ex(()=>e=!1)),t.$set(x)},i(p){r||(Ye(t.$$.fragment,p),r=!0)},o(p){en(t.$$.fragment,p),r=!1},d(p){Yr(t,p)}}}function kC(n){let t,e,r;function s(p){n[12](p)}let c={inputId:n[0],searchFunction:n[7],delay:"200",localFiltering:!1,showLoadingIndicator:!0,labelFieldName:"address",valueFieldName:"id",className:"w-100",inputClassName:"form-control form-control-lg",placeholder:"es: Piazza Duomo 1",noResultsText:"nessun indirizzo trovato",maxItemsToShowInList:"5",hideArrow:!0,showClear:n[2],disabled:!n[3]};return n[1]!==void 0&&(c.selectedItem=n[1]),t=new Ub({props:c}),md.push(()=>Ix(t,"selectedItem",s)),{c(){qr(t.$$.fragment)},l(p){Xr(t.$$.fragment,p)},m(p,l){Zr(t,p,l),r=!0},p(p,l){const x={};l&1&&(x.inputId=p[0]),l&4&&(x.showClear=p[2]),l&8&&(x.disabled=!p[3]),!e&&l&2&&(e=!0,x.selectedItem=p[1],Ex(()=>e=!1)),t.$set(x)},i(p){r||(Ye(t.$$.fragment,p),r=!0)},o(p){en(t.$$.fragment,p),r=!1},d(p){Yr(t,p)}}}function FC(n){let t,e,r=n[14]+"",s,c,p=n[15].feature.properties.GRADO+"",l,x,I=n[15].feature.properties.INDIRIZZO+"",T;return{c(){t=ae("div"),e=new s0(!1),s=rn(),c=ae("div"),l=Ge(p),x=Ge(" - "),T=Ge(I),this.h()},l(P){t=le(P,"DIV",{slot:!0});var D=he(t);e=a0(D,!1),s=on(D),c=le(D,"DIV",{class:!0});var G=he(c);l=qe(G,p),x=qe(G," - "),T=qe(G,I),G.forEach(vt),D.forEach(vt),this.h()},h(){e.a=s,Dt(c,"class","fs-7 mt-1"),Dt(t,"slot","item")},m(P,D){de(P,t,D),e.m(r,t),Xt(t,s),Xt(t,c),Xt(c,l),Xt(c,x),Xt(c,T)},p(P,D){D&16384&&r!==(r=P[14]+"")&&e.p(r),D&32768&&p!==(p=P[15].feature.properties.GRADO+"")&&To(l,p),D&32768&&I!==(I=P[15].feature.properties.INDIRIZZO+"")&&To(T,I)},d(P){P&&vt(t)}}}function BC(n){let t,e,r,s,c,p,l,x,I,T,P,D=zC(n);return{c(){t=ae("div"),e=ae("div"),r=ae("div"),s=Ge("Cerca un indirizzo"),c=rn(),p=ae("div"),l=Ge("Cerca una scuola"),x=rn(),D&&D.c(),this.h()},l(G){t=le(G,"DIV",{class:!0});var Y=he(t);e=le(Y,"DIV",{class:!0});var et=he(e);r=le(et,"DIV",{class:!0});var at=he(r);s=qe(at,"Cerca un indirizzo"),at.forEach(vt),c=on(et),p=le(et,"DIV",{class:!0});var rt=he(p);l=qe(rt,"Cerca una scuola"),rt.forEach(vt),et.forEach(vt),x=on(Y),D&&D.l(Y),Y.forEach(vt),this.h()},h(){Dt(r,"class","pointer badge rounded-pill text-bg-dark-gray px-3 py-2"),Ki(r,"text-black-50",n[4]!=="address"),Ki(r,"text-decoration-underline",n[4]==="address"),Dt(p,"class","ms-2 pointer badge rounded-pill text-bg-dark-gray px-3 py-2"),Ki(p,"text-black-50",n[4]!=="school"),Ki(p,"text-decoration-underline",n[4]==="school"),Dt(e,"class","d-flex fs-6 fw-bold mb-2 justify-content-center"),Dt(t,"class","w-100 autocompleteContainer svelte-xut5pc")},m(G,Y){de(G,t,Y),Xt(t,e),Xt(e,r),Xt(r,s),Xt(e,c),Xt(e,p),Xt(p,l),Xt(t,x),D&&D.m(t,null),I=!0,T||(P=[So(r,"click",n[10]),So(p,"click",n[11])],T=!0)},p(G,[Y]){Y&16&&Ki(r,"text-black-50",G[4]!=="address"),Y&16&&Ki(r,"text-decoration-underline",G[4]==="address"),Y&16&&Ki(p,"text-black-50",G[4]!=="school"),Y&16&&Ki(p,"text-decoration-underline",G[4]==="school"),D.p(G,Y)},i(G){I||(Ye(D),I=!0)},o(G){en(D),I=!1},d(G){G&&vt(t),D&&D.d(),T=!1,Im(P)}}}const UC=n=>n.address+" "+n.feature.properties.INDIRIZZO;function VC(n,t,e){let r,s,c;Ms(n,Vx,rt=>e(3,r=rt)),Ms(n,p1,rt=>e(4,s=rt)),Ms(n,Hv,rt=>e(5,c=rt));let{id:p,schools:l}=t,x,I;const T=l==null?void 0:l.features.map(rt=>({type:"school",feature:rt,address:rt.properties.NOME,readableAddress:rt.properties.NOME,id:rt.properties.NOME}));async function P(rt){var ee;rt.length>1?e(2,I=!0):e(2,I=!1);const wt=new google.maps.Geocoder;let xt;try{xt=(await wt.geocode({address:`${rt}, Milano`,componentRestrictions:{country:"IT"}})).results}catch{xt=[]}const Gt=[];for(let $t of xt){let Zt=[$t.geometry.location.lng(),$t.geometry.location.lat()];const Mt=(ee=$t.address_components.filter(Wt=>Wt.types[0]==="route")[0])==null?void 0:ee.short_name;let It={type:"address",feature:{type:"Feature",geometry:{type:"Point",coordinates:Zt},properties:{readableAddress:Mt}},address:$t.formatted_address,readableAddress:Mt,id:$t.place_id};Bb(It.feature,r)&&Gt.push(It)}return Gt}function D(rt){e(1,x=null),p1.set(rt)}const G=()=>D("address"),Y=()=>D("school");function et(rt){x=rt,e(1,x)}function at(rt){x=rt,e(1,x)}return n.$$set=rt=>{"id"in rt&&e(0,p=rt.id),"schools"in rt&&e(9,l=rt.schools)},n.$$.update=()=>{n.$$.dirty&2&&x&&Gc.set(x)},[p,x,I,r,s,c,T,P,D,l,G,Y,et,at]}class Vb extends $a{constructor(t){super(),tl(this,t,VC,BC,el,{id:0,schools:9})}}function GC(n){let t,e,r,s,c,p,l,x,I,T,P,D,G,Y,et,at,rt,wt,xt,Gt,ee,$t,Zt,Mt,It,Wt,ft;return{c(){t=ae("h6"),e=Ge("Sai cosa respiri?"),r=rn(),s=ae("p"),c=Ge("Scopri quanto NO"),p=ae("sub"),l=Ge("2"),x=Ge(" respiri a Milano!"),I=rn(),T=ae("p"),P=Ge("Il biossido di azoto (NO"),D=ae("sub"),G=Ge("2"),Y=Ge(`), che proviene dai veicoli diesel che percorrono le vie
				di Milano, causa la morte prematura di `),et=ae("b"),at=Ge("1500"),rt=Ge(" persone ogni anno nel capoluogo lombardo."),wt=rn(),xt=ae("p"),Gt=Ge("Scopri la concentrazione annua di NO"),ee=ae("sub"),$t=Ge("2"),Zt=Ge(` inserendo il tuo indirizzo a Milano, quello
				di dove lavori, o selezionando una scuola.`),Mt=rn(),It=ae("p"),Wt=ae("a"),ft=Ge(`Forniamo al pubblico la stima pi\xF9 dettagliata sulle concentrazioni di inquinamento da
					traffico a Milano`),this.h()},l(re){t=le(re,"H6",{class:!0});var Yt=he(t);e=qe(Yt,"Sai cosa respiri?"),Yt.forEach(vt),r=on(re),s=le(re,"P",{class:!0});var Ft=he(s);c=qe(Ft,"Scopri quanto NO"),p=le(Ft,"SUB",{class:!0});var Oe=he(p);l=qe(Oe,"2"),Oe.forEach(vt),x=qe(Ft," respiri a Milano!"),Ft.forEach(vt),I=on(re),T=le(re,"P",{});var Jt=he(T);P=qe(Jt,"Il biossido di azoto (NO"),D=le(Jt,"SUB",{});var $e=he(D);G=qe($e,"2"),$e.forEach(vt),Y=qe(Jt,`), che proviene dai veicoli diesel che percorrono le vie
				di Milano, causa la morte prematura di `),et=le(Jt,"B",{});var pn=he(et);at=qe(pn,"1500"),pn.forEach(vt),rt=qe(Jt," persone ogni anno nel capoluogo lombardo."),Jt.forEach(vt),wt=on(re),xt=le(re,"P",{});var Cn=he(xt);Gt=qe(Cn,"Scopri la concentrazione annua di NO"),ee=le(Cn,"SUB",{});var _r=he(ee);$t=qe(_r,"2"),_r.forEach(vt),Zt=qe(Cn,` inserendo il tuo indirizzo a Milano, quello
				di dove lavori, o selezionando una scuola.`),Cn.forEach(vt),Mt=on(re),It=le(re,"P",{class:!0});var Xn=he(It);Wt=le(Xn,"A",{class:!0,href:!0,target:!0});var oi=he(Wt);ft=qe(oi,`Forniamo al pubblico la stima pi\xF9 dettagliata sulle concentrazioni di inquinamento da
					traffico a Milano`),oi.forEach(vt),Xn.forEach(vt),this.h()},h(){Dt(t,"class","mb-3 text-uppercase"),Dt(p,"class","questionNumber svelte-18zqwf1"),Dt(s,"class","question fs-1 lh-sm fw-bold svelte-18zqwf1"),Dt(Wt,"class","text-body"),Dt(Wt,"href","https://www.cittadiniperlaria.org/no2-no-grazie-2020/"),Dt(Wt,"target","_blank"),Dt(It,"class","mb-0 fs-7 text-decoration-underline")},m(re,Yt){de(re,t,Yt),Xt(t,e),de(re,r,Yt),de(re,s,Yt),Xt(s,c),Xt(s,p),Xt(p,l),Xt(s,x),de(re,I,Yt),de(re,T,Yt),Xt(T,P),Xt(T,D),Xt(D,G),Xt(T,Y),Xt(T,et),Xt(et,at),Xt(T,rt),de(re,wt,Yt),de(re,xt,Yt),Xt(xt,Gt),Xt(xt,ee),Xt(ee,$t),Xt(xt,Zt),de(re,Mt,Yt),de(re,It,Yt),Xt(It,Wt),Xt(Wt,ft)},p:Gr,d(re){re&&vt(t),re&&vt(r),re&&vt(s),re&&vt(I),re&&vt(T),re&&vt(wt),re&&vt(xt),re&&vt(Mt),re&&vt(It)}}}function qC(n){let t,e;return t=new Vb({props:{id:"intro_address",schools:n[0]}}),{c(){qr(t.$$.fragment)},l(r){Xr(t.$$.fragment,r)},m(r,s){Zr(t,r,s),e=!0},p(r,s){const c={};s&1&&(c.schools=r[0]),t.$set(c)},i(r){e||(Ye(t.$$.fragment,r),e=!0)},o(r){en(t.$$.fragment,r),e=!1},d(r){Yr(t,r)}}}function XC(n){let t,e,r,s;return{c(){t=ae("button"),e=Ge("oppure esplora la mappa"),this.h()},l(c){t=le(c,"BUTTON",{class:!0});var p=he(t);e=qe(p,"oppure esplora la mappa"),p.forEach(vt),this.h()},h(){Dt(t,"class","btn btn-dark-gray rounded-pill w-100")},m(c,p){de(c,t,p),Xt(t,e),r||(s=So(t,"click",n[1]),r=!0)},p:Gr,d(c){c&&vt(t),r=!1,s()}}}function ZC(n){let t,e,r,s,c,p,l;return{c(){t=ae("div"),e=ae("div"),r=Ge("un progetto di"),s=rn(),c=ae("a"),p=ae("img"),this.h()},l(x){t=le(x,"DIV",{class:!0});var I=he(t);e=le(I,"DIV",{class:!0});var T=he(e);r=qe(T,"un progetto di"),T.forEach(vt),s=on(I),c=le(I,"A",{href:!0,role:!0,class:!0,target:!0});var P=he(c);p=le(P,"IMG",{src:!0,class:!0,alt:!0}),P.forEach(vt),I.forEach(vt),this.h()},h(){Dt(e,"class","text-uppercase me-2 fs-7 fw-bold flex-grow-0 flex-shrink-0"),wx(p.src,l=`${Sx}/logo.png`)||Dt(p,"src",l),Dt(p,"class","img-fluid"),Dt(p,"alt","logo cittadini per l'aria"),Dt(c,"href","https://www.cittadiniperlaria.org/"),Dt(c,"role","button"),Dt(c,"class","btn btn-dark-gray rounded-pill"),Dt(c,"target","_blank"),Dt(t,"class","d-flex align-items-center")},m(x,I){de(x,t,I),Xt(t,e),Xt(e,r),Xt(t,s),Xt(t,c),Xt(c,p)},p:Gr,d(x){x&&vt(t)}}}function YC(n){let t,e,r,s,c,p,l,x,I,T;return r=new Sa({props:{$$slots:{default:[GC]},$$scope:{ctx:n}}}),c=new Sa({props:{$$slots:{default:[qC]},$$scope:{ctx:n}}}),l=new Sa({props:{$$slots:{default:[XC]},$$scope:{ctx:n}}}),I=new Sa({props:{$$slots:{default:[ZC]},$$scope:{ctx:n}}}),{c(){t=ae("div"),e=ae("div"),qr(r.$$.fragment),s=rn(),qr(c.$$.fragment),p=rn(),qr(l.$$.fragment),x=rn(),qr(I.$$.fragment),this.h()},l(P){t=le(P,"DIV",{class:!0});var D=he(t);e=le(D,"DIV",{class:!0});var G=he(e);Xr(r.$$.fragment,G),s=on(G),Xr(c.$$.fragment,G),p=on(G),Xr(l.$$.fragment,G),x=on(G),Xr(I.$$.fragment,G),G.forEach(vt),D.forEach(vt),this.h()},h(){Dt(e,"class","infoContainer bg-dark-gray rounded-md p-3 d-flex flex-column svelte-18zqwf1"),Dt(t,"class","w-100 h-100 bg-dark bg-opacity-25 d-flex align-items-center justify-content-center overflow-hidden")},m(P,D){de(P,t,D),Xt(t,e),Zr(r,e,null),Xt(e,s),Zr(c,e,null),Xt(e,p),Zr(l,e,null),Xt(e,x),Zr(I,e,null),T=!0},p(P,[D]){const G={};D&8&&(G.$$scope={dirty:D,ctx:P}),r.$set(G);const Y={};D&9&&(Y.$$scope={dirty:D,ctx:P}),c.$set(Y);const et={};D&8&&(et.$$scope={dirty:D,ctx:P}),l.$set(et);const at={};D&8&&(at.$$scope={dirty:D,ctx:P}),I.$set(at)},i(P){T||(Ye(r.$$.fragment,P),Ye(c.$$.fragment,P),Ye(l.$$.fragment,P),Ye(I.$$.fragment,P),T=!0)},o(P){en(r.$$.fragment,P),en(c.$$.fragment,P),en(l.$$.fragment,P),en(I.$$.fragment,P),T=!1},d(P){P&&vt(t),Yr(r),Yr(c),Yr(l),Yr(I)}}}function WC(n,t,e){let{schools:r}=t;const s={address:"Piazza del Duomo, Duomo, Municipio 1, Milano, Lombardia, Italia",feature:{geometry:{coordinates:[9.189292,45.464693],type:"Point"},type:"Feature"},id:463529462,readableAddress:"Piazza del Duomo",type:"address"},c=()=>{Gc.set(s)};return n.$$set=p=>{"schools"in p&&e(0,r=p.schools)},[r,c]}class jC extends $a{constructor(t){super(),tl(this,t,WC,YC,el,{schools:0})}}const HC=300,KC=60,Gb="none";function Qg(n,t,e){return n.addEventListener(t,e),()=>n.removeEventListener(t,e)}function JC(n,t){return t.filter(e=>n.pointerId!==e.pointerId)}function ey(n,t,e,r,s){n.dispatchEvent(new CustomEvent(`${t}${s}`,{detail:{event:e,pointersCount:r.length}}))}function QC(n,t,e,r,s,c=Gb){t.style.touchAction=c;let p=[];function l(I){p.push(I),ey(t,n,I,p,"down"),r==null||r(p,I);const T=I.pointerId;function P(rt){T===rt.pointerId&&(p=JC(rt,p),p.length||D(),ey(t,n,rt,p,"up"),s==null||s(p,rt))}function D(){G(),Y(),et(),at()}const G=Qg(t,"pointermove",rt=>{p=p.map(wt=>rt.pointerId===wt.pointerId?rt:wt),ey(t,n,rt,p,"move"),e==null||e(p,rt)}),Y=Qg(t,"lostpointercapture",rt=>{P(rt)}),et=Qg(t,"pointerup",rt=>{P(rt)}),at=Qg(t,"pointerleave",rt=>{p=[],D(),ey(t,n,rt,p,"up"),s==null||s(p,rt)})}const x=Qg(t,"pointerdown",l);return{destroy:()=>{x()}}}function $C(n,t={timeframe:HC,minSwipeDistance:KC,touchAction:Gb}){const e="swipe";let r,s,c,p;function l(I,T){s=T.clientX,c=T.clientY,r=Date.now(),I.length===1&&(p=T.target)}function x(I,T){if(T.type==="pointerup"&&I.length===0&&Date.now()-r<t.timeframe){const P=T.clientX-s,D=T.clientY-c,G=Math.abs(P),Y=Math.abs(D);let et=null;G>=2*Y&&G>t.minSwipeDistance?et=P>0?"right":"left":Y>=2*G&&Y>t.minSwipeDistance&&(et=D>0?"bottom":"top"),et&&n.dispatchEvent(new CustomEvent(e,{detail:{direction:et,target:p}}))}}return QC(e,n,null,l,x,t.touchAction)}function _x(n){let t,e,r,s,c,p;return e=new fC({props:{togglePanel:n[7],panelOpen:n[6],municipi:n[2]}}),{c(){t=ae("div"),qr(e.$$.fragment),this.h()},l(l){t=le(l,"DIV",{class:!0});var x=he(t);Xr(e.$$.fragment,x),x.forEach(vt),this.h()},h(){Dt(t,"class","rightPanelContainer position-absolute svelte-rkee57"),Ki(t,"topRightPanel",n[6])},m(l,x){de(l,t,x),Zr(e,t,null),s=!0,c||(p=[Z2($C.call(null,t,{timeframe:300,minSwipeDistance:60})),So(t,"swipe",n[8])],c=!0)},p(l,x){const I={};x&64&&(I.panelOpen=l[6]),x&4&&(I.municipi=l[2]),e.$set(I),x&64&&Ki(t,"topRightPanel",l[6])},i(l){s||(Ye(e.$$.fragment,l),by(()=>{r||(r=_d(t,yd,{},!0)),r.run(1)}),s=!0)},o(l){en(e.$$.fragment,l),r||(r=_d(t,yd,{},!1)),r.run(0),s=!1},d(l){l&&vt(t),Yr(e),l&&r&&r.end(),c=!1,Im(p)}}}function yx(n){let t,e,r,s,c;return r=new Vb({props:{id:"map_address",schools:n[1]}}),{c(){t=ae("div"),e=ae("div"),qr(r.$$.fragment),this.h()},l(p){t=le(p,"DIV",{class:!0});var l=he(t);e=le(l,"DIV",{class:!0});var x=he(e);Xr(r.$$.fragment,x),x.forEach(vt),l.forEach(vt),this.h()},h(){Dt(e,"class","rounded bg-white p-2 p-md-3"),Dt(t,"class","rounded-md adderssSearchContainer position-absolute bg-dark-gray p-2 svelte-rkee57")},m(p,l){de(p,t,l),Xt(t,e),Zr(r,e,null),c=!0},p(p,l){const x={};l&2&&(x.schools=p[1]),r.$set(x)},i(p){c||(Ye(r.$$.fragment,p),by(()=>{s||(s=_d(t,yd,{},!0)),s.run(1)}),c=!0)},o(p){en(r.$$.fragment,p),s||(s=_d(t,yd,{},!1)),s.run(0),c=!1},d(p){p&&vt(t),Yr(r),p&&s&&s.end()}}}function vx(n){let t,e,r,s;return e=new jC({props:{schools:n[1]}}),{c(){t=ae("div"),qr(e.$$.fragment),this.h()},l(c){t=le(c,"DIV",{class:!0});var p=he(t);Xr(e.$$.fragment,p),p.forEach(vt),this.h()},h(){Dt(t,"class","introPanelContainer position-absolute w-100 svelte-rkee57")},m(c,p){de(c,t,p),Zr(e,t,null),s=!0},p(c,p){const l={};p&2&&(l.schools=c[1]),e.$set(l)},i(c){s||(Ye(e.$$.fragment,c),by(()=>{r||(r=_d(t,yd,{},!0)),r.run(1)}),s=!0)},o(c){en(e.$$.fragment,c),r||(r=_d(t,yd,{},!1)),r.run(0),s=!1},d(c){c&&vt(t),Yr(e),c&&r&&r.end()}}}function tT(n){let t,e,r,s,c,p,l;e=new vS({props:{gridRawData:n[0],schools:n[1]}});let x=n[4]&&_x(n),I=!n[3]&&yx(n),T=n[5]&&n[3]&&vx(n);return{c(){t=ae("div"),qr(e.$$.fragment),r=rn(),x&&x.c(),s=rn(),I&&I.c(),c=rn(),T&&T.c(),p=ri(),this.h()},l(P){t=le(P,"DIV",{class:!0});var D=he(t);Xr(e.$$.fragment,D),D.forEach(vt),r=on(P),x&&x.l(P),s=on(P),I&&I.l(P),c=on(P),T&&T.l(P),p=ri(),this.h()},h(){Dt(t,"class","mapContainer position-absolute w-100 h-100")},m(P,D){de(P,t,D),Zr(e,t,null),de(P,r,D),x&&x.m(P,D),de(P,s,D),I&&I.m(P,D),de(P,c,D),T&&T.m(P,D),de(P,p,D),l=!0},p(P,[D]){const G={};D&1&&(G.gridRawData=P[0]),D&2&&(G.schools=P[1]),e.$set(G),P[4]?x?(x.p(P,D),D&16&&Ye(x,1)):(x=_x(P),x.c(),Ye(x,1),x.m(s.parentNode,s)):x&&(hu(),en(x,1,1,()=>{x=null}),fu()),P[3]?I&&(hu(),en(I,1,1,()=>{I=null}),fu()):I?(I.p(P,D),D&8&&Ye(I,1)):(I=yx(P),I.c(),Ye(I,1),I.m(c.parentNode,c)),P[5]&&P[3]?T?(T.p(P,D),D&40&&Ye(T,1)):(T=vx(P),T.c(),Ye(T,1),T.m(p.parentNode,p)):T&&(hu(),en(T,1,1,()=>{T=null}),fu())},i(P){l||(Ye(e.$$.fragment,P),Ye(x),Ye(I),Ye(T),l=!0)},o(P){en(e.$$.fragment,P),en(x),en(I),en(T),l=!1},d(P){P&&vt(t),Yr(e),P&&vt(r),x&&x.d(P),P&&vt(s),I&&I.d(P),P&&vt(c),T&&T.d(P),P&&vt(p)}}}async function oT({fetch:n}){const e=await n("/grid.json"),s=await n("/all_schools.json"),p=await n("/municipi.json");return{status:e.status,props:{grid:e.ok&&await e.json(),schools:s.ok&&await s.json(),municipi:p.ok&&await p.json()}}}function eT(n,t,e){let r;Ms(n,Gc,D=>e(4,r=D));let{grid:s,schools:c,municipi:p}=t,l=!0,x=!0,I=!0;function T(){e(6,I=!I)}function P(D){const G=D.detail.direction;G==="top"?e(6,I=!1):G==="bottom"&&e(6,I=!0)}return n.$$set=D=>{"grid"in D&&e(0,s=D.grid),"schools"in D&&e(1,c=D.schools),"municipi"in D&&e(2,p=D.municipi)},n.$$.update=()=>{n.$$.dirty&16&&r&&e(3,x=!1),n.$$.dirty&24&&e(5,l=r?!1:!!x)},[s,c,p,x,r,l,I,T,P]}class sT extends $a{constructor(t){super(),tl(this,t,eT,tT,el,{grid:0,schools:1,municipi:2})}}export{sT as default,oT as load};
